<a class="edit-docs-link" href="https://github.com/Automattic/mongoose/blob/master/lib/index.js" target="_blank"> <img src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4NCjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+DQo8c3ZnIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgeD0iMHB4IiB5PSIwcHgiIHZpZXdCb3g9IjAgMCAxMDAwIDEwMDAiIGVuYWJsZS1iYWNrZ3JvdW5kPSJuZXcgMCAwIDEwMDAgMTAwMCIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+DQo8Zz48ZyB0cmFuc2Zvcm09Im1hdHJpeCgxIDAgMCAtMSAwIDQ4MCkiPjxwYXRoIHN0cm9rZT0iIzA5NzFCMiIgZmlsbD0iIzA5NzFCMiIgZD0iTTkzMC45LDQyMC41Yy0zMy4xLDMxLjgtNjkuMyw0Ny43LTEwOC43LDQ3LjdjLTQ0LjUsMC04My45LTE3LjItMTE4LjItNTEuNUw5OS40LTE4NS45Yy0zLjgtMy44LTYuNC04LjktNy42LTE1LjNjLTIuNS04LjktMjkuMi05Ny45LTgwLjEtMjY3Yy0zLjgtMTIuNy0xLjMtMjMuNSw3LjYtMzIuNGM2LjQtNS4xLDE0LTcuNiwyMi45LTcuNmg5LjVjMTMyLjIsNDQuNSwyMTkuOSw3My4xLDI2My4yLDg1LjhjMy44LDEuMyw3LjYsMy44LDExLjQsNy42YzM3NSwzNzAsNTc3LjIsNTcwLjIsNjA2LjQsNjAwLjdjMzguMSwzOS40LDU3LjIsNzkuNSw1Ny4yLDEyMC4xQzk4OC43LDM0Ni44LDk2OSwzODQuOSw5MzAuOSw0MjAuNXogTTY5NC40LDMxOS40YzMxLjgtNy42LDYxLjctMjUuNCw4OS42LTUzLjRjMjYuNy0yNi43LDQzLjItNTcuMiw0OS42LTkxLjVDNzQ3LjIsODguMSw1NzguNy03OS4xLDMyOC4zLTMyN2MtMTIuNywzMC41LTI5LjksNTYuNi01MS41LDc4LjJjLTI2LjcsMjYuNy01Ni42LDQ3LTg5LjYsNjFMMzMyLjEtNDIuOWwyMTAuNywyMTAuN0w2OTQuNCwzMTkuNHogTTE0NS4yLTIzOS4zYzMxLjgtNy42LDYxLTI1LjQsODcuNy01My40YzIxLjYtMjEuNiwzNi45LTQ3LDQ1LjgtNzYuM2MtMTIuNy0zLjgtNDIuOS0xNC05MC42LTMwLjVjLTQ3LjctMTYuNS04Mi4zLTI4LTEwMy45LTM0LjNjNi40LDE5LjEsMTYuOCw1Mi4xLDMxLjUsOTkuMkMxMzAuMy0yODcuNiwxNDAuMS0yNTUuOCwxNDUuMi0yMzkuM3ogTTg4OC45LDIyOS44bC01LjctNS43Yy0xMi43LDMzLjEtMzEuMSw2MS43LTU1LjMsODUuOEM4MDIuNSwzMzUuMyw3NzQuNSwzNTUsNzQ0LDM2OWwxLjksMS45bDEuOSwxLjljMjIuOSwyMi45LDQ3LjcsMzQuMyw3NC40LDM0LjNjMjIuOSwwLDQ1LjEtMTAuOCw2Ni43LTMyLjRjMjUuNC0yNC4yLDM4LjEtNDcuNywzOC4xLTcwLjZTOTE0LjQsMjU2LjUsODg4LjksMjI5Ljh6Ii8+PC9nPjwvZz4NCjwvc3ZnPg=="> </a><h1>Mongoose</h1>

<div class="api-content">
<h3 id="mongoose_Mongoose">Mongoose()</h3>
<h5>Parameters</h5>
<ul class="params"><li class="param">options <span class="method-type">«Object»</span> see <a href="mongoose#mongoose_Mongoose-set"><code>Mongoose#set()</code> docs</a> </li></ul>
<div>
<p>Mongoose constructor.</p> <p>The exports object of the <code>mongoose</code> module is an instance of this class. Most apps will only use this one instance.</p> <h4>Example:</h4> <pre data-language="javascript"><span class="hljs-keyword">const</span> mongoose = <span class="hljs-built_in">require</span>(<span class="hljs-string">'mongoose'</span>);
mongoose <span class="hljs-keyword">instanceof</span> mongoose.Mongoose; <span class="hljs-comment">// true</span>

<span class="hljs-comment">// Create a new Mongoose instance with its own `connect()`, `set()`, `model()`, etc.</span>
<span class="hljs-keyword">const</span> m = <span class="hljs-keyword">new</span> mongoose.Mongoose();</pre> </div>
<h3 id="mongoose_Mongoose-Aggregate">Mongoose.prototype.Aggregate()</h3>
<div>
<p>The Mongoose Aggregate constructor</p> </div>
<h3 id="mongoose_Mongoose-CastError">Mongoose.prototype.CastError()</h3>
<h5>Parameters</h5>
<ul class="params">
<li class="param">type <span class="method-type">«String»</span> The name of the type </li>
<li class="param">value <span class="method-type">«Any»</span> The value that failed to cast </li>
<li class="param">path <span class="method-type">«String»</span> The path <code>a.b.c</code> in the doc where this cast error occurred </li>
<li class="param">[reason] <span class="method-type">«Error»</span> The original error that was thrown </li>
</ul>
<div>
<p>The Mongoose CastError constructor</p> </div>
<h3 id="mongoose_Mongoose-Collection">Mongoose.prototype.Collection()</h3>
<div>
<p>The Mongoose Collection constructor</p> </div>
<h3 id="mongoose_Mongoose-Connection">Mongoose.prototype.Connection()</h3>
<div>
<p>The Mongoose <a href="#connection_Connection">Connection</a> constructor</p> </div>
<h3 id="mongoose_Mongoose-Date">Mongoose.prototype.Date</h3>
<h5>Type:</h5>
<ul><li><span class="method-type">«property»</span></li></ul>
<div>
<p>The Mongoose Date <a href="../schematypes">SchemaType</a>.</p> <h4>Example:</h4> <pre data-language="javascript"><span class="hljs-keyword">const</span> schema = <span class="hljs-keyword">new</span> Schema({ <span class="hljs-attr">test</span>: <span class="hljs-built_in">Date</span> });
schema.path(<span class="hljs-string">'test'</span>) <span class="hljs-keyword">instanceof</span> mongoose.Date; <span class="hljs-comment">// true</span></pre> </div>
<h3 id="mongoose_Mongoose-Decimal128">Mongoose.prototype.Decimal128</h3>
<h5>Type:</h5>
<ul><li><span class="method-type">«property»</span></li></ul>
<div>
<p>The Mongoose Decimal128 <a href="../schematypes">SchemaType</a>. Used for declaring paths in your schema that should be <a href="http://thecodebarbarian.com/a-nodejs-perspective-on-mongodb-34-decimal.html">128-bit decimal floating points</a>. Do not use this to create a new Decimal128 instance, use <code>mongoose.Types.Decimal128</code> instead.</p> <h4>Example:</h4> <pre data-language="javascript"><span class="hljs-keyword">const</span> vehicleSchema = <span class="hljs-keyword">new</span> Schema({ <span class="hljs-attr">fuelLevel</span>: mongoose.Decimal128 });</pre> </div>
<h3 id="mongoose_Mongoose-Document">Mongoose.prototype.Document()</h3>
<div>
<p>The Mongoose <a href="https://mongoosejs.com/api/document.html">Document</a> constructor.</p> </div>
<h3 id="mongoose_Mongoose-DocumentProvider">Mongoose.prototype.DocumentProvider()</h3>
<div>
<p>The Mongoose DocumentProvider constructor. Mongoose users should not have to use this directly</p> </div>
<h3 id="mongoose_Mongoose-Error">Mongoose.prototype.Error()</h3>
<div>
<p>The <a href="#error_MongooseError">MongooseError</a> constructor.</p> </div>
<h3 id="mongoose_Mongoose-Mixed">Mongoose.prototype.Mixed</h3>
<h5>Type:</h5>
<ul><li><span class="method-type">«property»</span></li></ul>
<div>
<p>The Mongoose Mixed <a href="../schematypes">SchemaType</a>. Used for declaring paths in your schema that Mongoose's change tracking, casting, and validation should ignore.</p> <h4>Example:</h4> <pre data-language="javascript"><span class="hljs-keyword">const</span> schema = <span class="hljs-keyword">new</span> Schema({ <span class="hljs-attr">arbitrary</span>: mongoose.Mixed });</pre> </div>
<h3 id="mongoose_Mongoose-Model">Mongoose.prototype.Model()</h3>
<div>
<p>The Mongoose <a href="#model_Model">Model</a> constructor.</p> </div>
<h3 id="mongoose_Mongoose-Mongoose">Mongoose.prototype.Mongoose()</h3>
<div>
<p>The Mongoose constructor</p> <p>The exports of the mongoose module is an instance of this class.</p> <h4>Example:</h4> <pre data-language="javascript"><span class="hljs-keyword">const</span> mongoose = <span class="hljs-built_in">require</span>(<span class="hljs-string">'mongoose'</span>);
<span class="hljs-keyword">const</span> mongoose2 = <span class="hljs-keyword">new</span> mongoose.Mongoose();</pre> </div>
<h3 id="mongoose_Mongoose-Number">Mongoose.prototype.Number</h3>
<h5>Type:</h5>
<ul><li><span class="method-type">«property»</span></li></ul>
<div>
<p>The Mongoose Number <a href="../schematypes">SchemaType</a>. Used for declaring paths in your schema that Mongoose should cast to numbers.</p> <h4>Example:</h4> <pre data-language="javascript"><span class="hljs-keyword">const</span> schema = <span class="hljs-keyword">new</span> Schema({ <span class="hljs-attr">num</span>: mongoose.Number });
<span class="hljs-comment">// Equivalent to:</span>
<span class="hljs-keyword">const</span> schema = <span class="hljs-keyword">new</span> Schema({ <span class="hljs-attr">num</span>: <span class="hljs-string">'number'</span> });</pre> </div>
<h3 id="mongoose_Mongoose-ObjectId">Mongoose.prototype.ObjectId</h3>
<h5>Type:</h5>
<ul><li><span class="method-type">«property»</span></li></ul>
<div>
<p>The Mongoose ObjectId <a href="../schematypes">SchemaType</a>. Used for declaring paths in your schema that should be <a href="https://docs.mongodb.com/manual/reference/method/ObjectId/">MongoDB ObjectIds</a>. Do not use this to create a new ObjectId instance, use <code>mongoose.Types.ObjectId</code> instead.</p> <h4>Example:</h4> <pre data-language="javascript"><span class="hljs-keyword">const</span> childSchema = <span class="hljs-keyword">new</span> Schema({ <span class="hljs-attr">parentId</span>: mongoose.ObjectId });</pre> </div>
<h3 id="mongoose_Mongoose-Promise">Mongoose.prototype.Promise</h3>
<h5>Type:</h5>
<ul><li><span class="method-type">«property»</span></li></ul>
<div>
<p>The Mongoose <a href="#promise_Promise">Promise</a> constructor.</p> </div>
<h3 id="mongoose_Mongoose-PromiseProvider">Mongoose.prototype.PromiseProvider()</h3>
<div>
<p>Storage layer for mongoose promises</p> </div>
<h3 id="mongoose_Mongoose-Query">Mongoose.prototype.Query()</h3>
<div>
<p>The Mongoose <a href="#query_Query">Query</a> constructor.</p> </div>
<h3 id="mongoose_Mongoose-STATES">Mongoose.prototype.STATES</h3>
<h5>Type:</h5>
<ul><li><span class="method-type">«property»</span></li></ul>
<div>
<p>Expose connection states for user-land</p> </div>
<h3 id="mongoose_Mongoose-Schema">Mongoose.prototype.Schema()</h3>
<div>
<p>The Mongoose <a href="#schema_Schema">Schema</a> constructor</p> <h4>Example:</h4> <pre data-language="javascript"><span class="hljs-keyword">const</span> mongoose = <span class="hljs-built_in">require</span>(<span class="hljs-string">'mongoose'</span>);
<span class="hljs-keyword">const</span> Schema = mongoose.Schema;
<span class="hljs-keyword">const</span> CatSchema = <span class="hljs-keyword">new</span> Schema(..);</pre> </div>
<h3 id="mongoose_Mongoose-SchemaType">Mongoose.prototype.SchemaType()</h3>
<div>
<p>The Mongoose <a href="#schematype_SchemaType">SchemaType</a> constructor</p> </div>
<h3 id="mongoose_Mongoose-SchemaTypeOptions">Mongoose.prototype.SchemaTypeOptions()</h3>
<div>
<p>The constructor used for schematype options</p> </div>
<h3 id="mongoose_Mongoose-SchemaTypes">Mongoose.prototype.SchemaTypes</h3>
<h5>Type:</h5>
<ul><li><span class="method-type">«property»</span></li></ul>
<div>
<p>The various Mongoose SchemaTypes.</p> <h4>Note:</h4> <p><em>Alias of mongoose.Schema.Types for backwards compatibility.</em></p> </div>
<h3 id="mongoose_Mongoose-Types">Mongoose.prototype.Types</h3>
<h5>Type:</h5>
<ul><li><span class="method-type">«property»</span></li></ul>
<div>
<p>The various Mongoose Types.</p> <h4>Example:</h4> <pre data-language="javascript"><span class="hljs-keyword">const</span> mongoose = <span class="hljs-built_in">require</span>(<span class="hljs-string">'mongoose'</span>);
<span class="hljs-keyword">const</span> array = mongoose.Types.Array;</pre> <h4>Types:</h4> <ul> <li><a href="../schematypes#arrays">Array</a></li> <li><a href="../schematypes#buffers">Buffer</a></li> <li><a href="../schematypes#schemas">Embedded</a></li> <li><a href="documentarraypath">DocumentArray</a></li> <li><a href="https://mongoosejs.com/docs/api.html#mongoose_Mongoose-Decimal128">Decimal128</a></li> <li><a href="../schematypes#objectids">ObjectId</a></li> <li><a href="../schematypes#maps">Map</a></li> <li><a href="../schematypes#schemas">Subdocument</a></li> </ul> <p>Using this exposed access to the <code>ObjectId</code> type, we can construct ids on demand.</p> <pre data-language="javascript"><span class="hljs-keyword">const</span> ObjectId = mongoose.Types.ObjectId;
<span class="hljs-keyword">const</span> id1 = <span class="hljs-keyword">new</span> ObjectId;</pre> </div>
<h3 id="mongoose_Mongoose-VirtualType">Mongoose.prototype.VirtualType()</h3>
<div>
<p>The Mongoose <a href="#virtualtype_VirtualType">VirtualType</a> constructor</p> </div>
<h3 id="mongoose_Mongoose-connect">Mongoose.prototype.connect()</h3>
<h5>Parameters</h5>
<ul class="params">
<li class="param">uri(s) <span class="method-type">«String»</span> </li>
<li class="param">[options] <span class="method-type">«Object»</span> passed down to the <a href="http://mongodb.github.io/node-mongodb-native/3.0/api/MongoClient.html">MongoDB driver's <code>connect()</code> function</a>, except for 4 mongoose-specific options explained below. </li>
<ul style="margin-top: 0.5em"><li>[options.bufferCommands=true] <span class="method-type">«Boolean»</span> Mongoose specific option. Set to false to <a href="http://mongoosejs.com/docs/faq.html#callback_never_executes">disable buffering</a> on all models associated with this connection. </li></ul>
<ul style="margin-top: 0.5em"><li>[options.bufferTimeoutMS=10000] <span class="method-type">«Number»</span> Mongoose specific option. If <code>bufferCommands</code> is true, Mongoose will throw an error after <code>bufferTimeoutMS</code> if the operation is still buffered. </li></ul>
<ul style="margin-top: 0.5em"><li>[options.dbName] <span class="method-type">«String»</span> The name of the database we want to use. If not provided, use database name from connection string. </li></ul>
<ul style="margin-top: 0.5em"><li>[options.user] <span class="method-type">«String»</span> username for authentication, equivalent to <code>options.auth.user</code>. Maintained for backwards compatibility. </li></ul>
<ul style="margin-top: 0.5em"><li>[options.pass] <span class="method-type">«String»</span> password for authentication, equivalent to <code>options.auth.password</code>. Maintained for backwards compatibility. </li></ul>
<ul style="margin-top: 0.5em"><li>[options.poolSize=5] <span class="method-type">«Number»</span> The maximum number of sockets the MongoDB driver will keep open for this connection. By default, <code>poolSize</code> is 5. Keep in mind that, as of MongoDB 3.4, MongoDB only allows one operation per socket at a time, so you may want to increase this if you find you have a few slow queries that are blocking faster queries from proceeding. See <a href="http://thecodebarbarian.com/slow-trains-in-mongodb-and-nodejs">Slow Trains in MongoDB and Node.js</a>. </li></ul>
<ul style="margin-top: 0.5em"><li>[options.useUnifiedTopology=false] <span class="method-type">«Boolean»</span> False by default. Set to <code>true</code> to opt in to the MongoDB driver's replica set and sharded cluster monitoring engine. </li></ul>
<ul style="margin-top: 0.5em"><li>[options.serverSelectionTimeoutMS] <span class="method-type">«Number»</span> If <code>useUnifiedTopology = true</code>, the MongoDB driver will try to find a server to send any given operation to, and keep retrying for <code>serverSelectionTimeoutMS</code> milliseconds before erroring out. If not set, the MongoDB driver defaults to using <code>30000</code> (30 seconds). </li></ul>
<ul style="margin-top: 0.5em"><li>[options.heartbeatFrequencyMS] <span class="method-type">«Number»</span> If <code>useUnifiedTopology = true</code>, the MongoDB driver sends a heartbeat every <code>heartbeatFrequencyMS</code> to check on the status of the connection. A heartbeat is subject to <code>serverSelectionTimeoutMS</code>, so the MongoDB driver will retry failed heartbeats for up to 30 seconds by default. Mongoose only emits a <code>'disconnected'</code> event after a heartbeat has failed, so you may want to decrease this setting to reduce the time between when your server goes down and when Mongoose emits <code>'disconnected'</code>. We recommend you do <strong>not</strong> set this setting below 1000, too many heartbeats can lead to performance degradation. </li></ul>
<ul style="margin-top: 0.5em"><li>[options.autoIndex=true] <span class="method-type">«Boolean»</span> Mongoose-specific option. Set to false to disable automatic index creation for all models associated with this connection. </li></ul>
<ul style="margin-top: 0.5em"><li>[options.useNewUrlParser=false] <span class="method-type">«Boolean»</span> False by default. Set to <code>true</code> to opt in to the MongoDB driver's new URL parser logic. </li></ul>
<ul style="margin-top: 0.5em"><li>[options.useCreateIndex=true] <span class="method-type">«Boolean»</span> Mongoose-specific option. If <code>true</code>, this connection will use <a href="../deprecations#ensureindex"><code>createIndex()</code> instead of <code>ensureIndex()</code></a> for automatic index builds via <a href="https://mongoosejs.com/docs/api.html#model_Model.init"><code>Model.init()</code></a>. </li></ul>
<ul style="margin-top: 0.5em"><li>[options.useFindAndModify=true] <span class="method-type">«Boolean»</span> True by default. Set to <code>false</code> to make <code>findOneAndUpdate()</code> and <code>findOneAndRemove()</code> use native <code>findOneAndUpdate()</code> rather than <code>findAndModify()</code>. </li></ul>
<ul style="margin-top: 0.5em"><li>[options.reconnectTries=30] <span class="method-type">«Number»</span> If you're connected to a single server or mongos proxy (as opposed to a replica set), the MongoDB driver will try to reconnect every <code>reconnectInterval</code> milliseconds for <code>reconnectTries</code> times, and give up afterward. When the driver gives up, the mongoose connection emits a <code>reconnectFailed</code> event. This option does nothing for replica set connections. </li></ul>
<ul style="margin-top: 0.5em"><li>[options.reconnectInterval=1000] <span class="method-type">«Number»</span> See <code>reconnectTries</code> option above. </li></ul>
<ul style="margin-top: 0.5em"><li>[options.promiseLibrary] <span class="method-type">«Class»</span> Sets the <a href="http://mongodb.github.io/node-mongodb-native/3.1/api/MongoClient.html">underlying driver's promise library</a>. </li></ul>
<ul style="margin-top: 0.5em"><li>[options.bufferMaxEntries] <span class="method-type">«Number»</span> This option does nothing if <code>useUnifiedTopology</code> is set. The MongoDB driver also has its own buffering mechanism that kicks in when the driver is disconnected. Set this option to 0 and set <code>bufferCommands</code> to <code>false</code> on your schemas if you want your database operations to fail immediately when the driver is not connected, as opposed to waiting for reconnection. </li></ul>
<ul style="margin-top: 0.5em"><li>[options.connectTimeoutMS=30000] <span class="method-type">«Number»</span> How long the MongoDB driver will wait before killing a socket due to inactivity <em>during initial connection</em>. Defaults to 30000. This option is passed transparently to <a href="https://nodejs.org/api/net.html#net_socket_settimeout_timeout_callback">Node.js' <code>socket#setTimeout()</code> function</a>. </li></ul>
<ul style="margin-top: 0.5em"><li>[options.socketTimeoutMS=30000] <span class="method-type">«Number»</span> How long the MongoDB driver will wait before killing a socket due to inactivity <em>after initial connection</em>. A socket may be inactive because of either no activity or a long-running operation. This is set to <code>30000</code> by default, you should set this to 2-3x your longest running operation if you expect some of your database operations to run longer than 20 seconds. This option is passed to <a href="https://nodejs.org/api/net.html#net_socket_settimeout_timeout_callback">Node.js <code>socket#setTimeout()</code> function</a> after the MongoDB driver successfully completes. </li></ul>
<ul style="margin-top: 0.5em"><li>[options.family=0] <span class="method-type">«Number»</span> Passed transparently to <a href="https://nodejs.org/api/dns.html#dns_dns_lookup_hostname_options_callback">Node.js' <code>dns.lookup()</code></a> function. May be either <code>0</code>, <code>4</code>, or <code>6</code>. <code>4</code> means use IPv4 only, <code>6</code> means use IPv6 only, <code>0</code> means try both. </li></ul>
<ul style="margin-top: 0.5em"><li>[options.autoCreate=false] <span class="method-type">«Boolean»</span> Set to <code>true</code> to make Mongoose automatically call <code>createCollection()</code> on every model created on this connection. </li></ul>
<li class="param">[callback] <span class="method-type">«Function»</span> </li>
</ul>
<h5>Returns:</h5>
<ul><li>
<span class="method-type">«Promise»</span> resolves to <code>this</code> if connection succeeded </li></ul>
<div>
<p>Opens the default mongoose connection.</p> <h4>Example:</h4> <pre data-language="javascript">mongoose.connect(<span class="hljs-string">'mongodb://user:pass@localhost:port/database'</span>);

<span class="hljs-comment">// replica sets</span>
<span class="hljs-keyword">const</span> uri = <span class="hljs-string">'mongodb://user:pass@localhost:port,anotherhost:port,yetanother:port/mydatabase'</span>;
mongoose.connect(uri);

<span class="hljs-comment">// with options</span>
mongoose.connect(uri, options);

<span class="hljs-comment">// optional callback that gets fired when initial connection completed</span>
<span class="hljs-keyword">const</span> uri = <span class="hljs-string">'mongodb://nonexistent.domain:27000'</span>;
mongoose.connect(uri, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">error</span>) </span>{
  <span class="hljs-comment">// if error is truthy, the initial connection failed.</span>
})</pre> </div>
<h3 id="mongoose_Mongoose-connection">Mongoose.prototype.connection</h3>
<h5>Type:</h5>
<ul><li><span class="method-type">«Connection»</span></li></ul>
<div>
<p>The Mongoose module's default connection. Equivalent to <code>mongoose.connections[0]</code>, see <a href="#mongoose_Mongoose-connections"><code>connections</code></a>.</p> <h4>Example:</h4> <pre data-language="javascript"><span class="hljs-keyword">const</span> mongoose = <span class="hljs-built_in">require</span>(<span class="hljs-string">'mongoose'</span>);
mongoose.connect(...);
mongoose.connection.on(<span class="hljs-string">'error'</span>, cb);</pre> <p>This is the connection used by default for every model created using <a href="#index_Mongoose-model">mongoose.model</a>.</p> <p>To create a new connection, use <a href="#mongoose_Mongoose-createConnection"><code>createConnection()</code></a>.</p> </div>
<h3 id="mongoose_Mongoose-connections">Mongoose.prototype.connections</h3>
<h5>Type:</h5>
<ul><li><span class="method-type">«Array»</span></li></ul>
<div>
<p>An array containing all <a href="connections">connections</a> associated with this Mongoose instance. By default, there is 1 connection. Calling <a href="#mongoose_Mongoose-createConnection"><code>createConnection()</code></a> adds a connection to this array.</p> <h4>Example:</h4> <pre data-language="javascript"><span class="hljs-keyword">const</span> mongoose = <span class="hljs-built_in">require</span>(<span class="hljs-string">'mongoose'</span>);
mongoose.connections.length; <span class="hljs-comment">// 1, just the default connection</span>
mongoose.connections[<span class="hljs-number">0</span>] === mongoose.connection; <span class="hljs-comment">// true</span>

mongoose.createConnection(<span class="hljs-string">'mongodb://localhost:27017/test'</span>);
mongoose.connections.length; <span class="hljs-comment">// 2</span></pre> </div>
<h3 id="mongoose_Mongoose-createConnection">Mongoose.prototype.createConnection()</h3>
<h5>Parameters</h5>
<ul class="params">
<li class="param">[uri] <span class="method-type">«String»</span> a mongodb:// URI </li>
<li class="param">[options] <span class="method-type">«Object»</span> passed down to the <a href="http://mongodb.github.io/node-mongodb-native/3.0/api/MongoClient.html">MongoDB driver's <code>connect()</code> function</a>, except for 4 mongoose-specific options explained below. </li>
<ul style="margin-top: 0.5em"><li>[options.bufferCommands=true] <span class="method-type">«Boolean»</span> Mongoose specific option. Set to false to <a href="http://mongoosejs.com/docs/faq.html#callback_never_executes">disable buffering</a> on all models associated with this connection. </li></ul>
<ul style="margin-top: 0.5em"><li>[options.dbName] <span class="method-type">«String»</span> The name of the database you want to use. If not provided, Mongoose uses the database name from connection string. </li></ul>
<ul style="margin-top: 0.5em"><li>[options.user] <span class="method-type">«String»</span> username for authentication, equivalent to <code>options.auth.user</code>. Maintained for backwards compatibility. </li></ul>
<ul style="margin-top: 0.5em"><li>[options.pass] <span class="method-type">«String»</span> password for authentication, equivalent to <code>options.auth.password</code>. Maintained for backwards compatibility. </li></ul>
<ul style="margin-top: 0.5em"><li>[options.autoIndex=true] <span class="method-type">«Boolean»</span> Mongoose-specific option. Set to false to disable automatic index creation for all models associated with this connection. </li></ul>
<ul style="margin-top: 0.5em"><li>[options.useNewUrlParser=false] <span class="method-type">«Boolean»</span> False by default. Set to <code>true</code> to make all connections set the <code>useNewUrlParser</code> option by default. </li></ul>
<ul style="margin-top: 0.5em"><li>[options.useUnifiedTopology=false] <span class="method-type">«Boolean»</span> False by default. Set to <code>true</code> to make all connections set the <code>useUnifiedTopology</code> option by default. </li></ul>
<ul style="margin-top: 0.5em"><li>[options.useCreateIndex=true] <span class="method-type">«Boolean»</span> Mongoose-specific option. If <code>true</code>, this connection will use <a href="../deprecations#ensureindex"><code>createIndex()</code> instead of <code>ensureIndex()</code></a> for automatic index builds via <a href="https://mongoosejs.com/docs/api.html#model_Model.init"><code>Model.init()</code></a>. </li></ul>
<ul style="margin-top: 0.5em"><li>[options.useFindAndModify=true] <span class="method-type">«Boolean»</span> True by default. Set to <code>false</code> to make <code>findOneAndUpdate()</code> and <code>findOneAndRemove()</code> use native <code>findOneAndUpdate()</code> rather than <code>findAndModify()</code>. </li></ul>
<ul style="margin-top: 0.5em"><li>[options.reconnectTries=30] <span class="method-type">«Number»</span> If you're connected to a single server or mongos proxy (as opposed to a replica set), the MongoDB driver will try to reconnect every <code>reconnectInterval</code> milliseconds for <code>reconnectTries</code> times, and give up afterward. When the driver gives up, the mongoose connection emits a <code>reconnectFailed</code> event. This option does nothing for replica set connections. </li></ul>
<ul style="margin-top: 0.5em"><li>[options.reconnectInterval=1000] <span class="method-type">«Number»</span> See <code>reconnectTries</code> option above. </li></ul>
<ul style="margin-top: 0.5em"><li>[options.promiseLibrary] <span class="method-type">«Class»</span> Sets the <a href="http://mongodb.github.io/node-mongodb-native/3.1/api/MongoClient.html">underlying driver's promise library</a>. </li></ul>
<ul style="margin-top: 0.5em"><li>[options.poolSize=5] <span class="method-type">«Number»</span> The maximum number of sockets the MongoDB driver will keep open for this connection. By default, <code>poolSize</code> is 5. Keep in mind that, as of MongoDB 3.4, MongoDB only allows one operation per socket at a time, so you may want to increase this if you find you have a few slow queries that are blocking faster queries from proceeding. See <a href="http://thecodebarbarian.com/slow-trains-in-mongodb-and-nodejs">Slow Trains in MongoDB and Node.js</a>. </li></ul>
<ul style="margin-top: 0.5em"><li>[options.bufferMaxEntries] <span class="method-type">«Number»</span> This option does nothing if <code>useUnifiedTopology</code> is set. The MongoDB driver also has its own buffering mechanism that kicks in when the driver is disconnected. Set this option to 0 and set <code>bufferCommands</code> to <code>false</code> on your schemas if you want your database operations to fail immediately when the driver is not connected, as opposed to waiting for reconnection. </li></ul>
<ul style="margin-top: 0.5em"><li>[options.connectTimeoutMS=30000] <span class="method-type">«Number»</span> How long the MongoDB driver will wait before killing a socket due to inactivity <em>during initial connection</em>. Defaults to 30000. This option is passed transparently to <a href="https://nodejs.org/api/net.html#net_socket_settimeout_timeout_callback">Node.js' <code>socket#setTimeout()</code> function</a>. </li></ul>
<ul style="margin-top: 0.5em"><li>[options.socketTimeoutMS=30000] <span class="method-type">«Number»</span> How long the MongoDB driver will wait before killing a socket due to inactivity <em>after initial connection</em>. A socket may be inactive because of either no activity or a long-running operation. This is set to <code>30000</code> by default, you should set this to 2-3x your longest running operation if you expect some of your database operations to run longer than 20 seconds. This option is passed to <a href="https://nodejs.org/api/net.html#net_socket_settimeout_timeout_callback">Node.js <code>socket#setTimeout()</code> function</a> after the MongoDB driver successfully completes. </li></ul>
<ul style="margin-top: 0.5em"><li>[options.family=0] <span class="method-type">«Number»</span> Passed transparently to <a href="https://nodejs.org/api/dns.html#dns_dns_lookup_hostname_options_callback">Node.js' <code>dns.lookup()</code></a> function. May be either <code>0</code>, <code>4</code>, or <code>6</code>. <code>4</code> means use IPv4 only, <code>6</code> means use IPv6 only, <code>0</code> means try both. </li></ul>
</ul>
<h5>Returns:</h5>
<ul><li>
<span class="method-type">«Connection»</span> the created Connection object. Connections are thenable, so you can do <code>await mongoose.createConnection()</code> </li></ul>
<div>
<p>Creates a Connection instance.</p> <p>Each <code>connection</code> instance maps to a single database. This method is helpful when managing multiple db connections.</p> <p><em>Options passed take precedence over options included in connection strings.</em></p> <h4>Example:</h4> <pre data-language="javascript"><span class="hljs-comment">// with mongodb:// URI</span>
db = mongoose.createConnection(<span class="hljs-string">'mongodb://user:pass@localhost:port/database'</span>);

<span class="hljs-comment">// and options</span>
<span class="hljs-keyword">const</span> opts = { <span class="hljs-attr">db</span>: { <span class="hljs-attr">native_parser</span>: <span class="hljs-literal">true</span> }}
db = mongoose.createConnection(<span class="hljs-string">'mongodb://user:pass@localhost:port/database'</span>, opts);

<span class="hljs-comment">// replica sets</span>
db = mongoose.createConnection(<span class="hljs-string">'mongodb://user:pass@localhost:port,anotherhost:port,yetanother:port/database'</span>);

<span class="hljs-comment">// and options</span>
<span class="hljs-keyword">const</span> opts = { <span class="hljs-attr">replset</span>: { <span class="hljs-attr">strategy</span>: <span class="hljs-string">'ping'</span>, <span class="hljs-attr">rs_name</span>: <span class="hljs-string">'testSet'</span> }}
db = mongoose.createConnection(<span class="hljs-string">'mongodb://user:pass@localhost:port,anotherhost:port,yetanother:port/database'</span>, opts);

<span class="hljs-comment">// and options</span>
<span class="hljs-keyword">const</span> opts = { <span class="hljs-attr">server</span>: { <span class="hljs-attr">auto_reconnect</span>: <span class="hljs-literal">false</span> }, <span class="hljs-attr">user</span>: <span class="hljs-string">'username'</span>, <span class="hljs-attr">pass</span>: <span class="hljs-string">'mypassword'</span> }
db = mongoose.createConnection(<span class="hljs-string">'localhost'</span>, <span class="hljs-string">'database'</span>, port, opts)

<span class="hljs-comment">// initialize now, connect later</span>
db = mongoose.createConnection();
db.openUri(<span class="hljs-string">'localhost'</span>, <span class="hljs-string">'database'</span>, port, [opts]);</pre> </div>
<h3 id="mongoose_Mongoose-deleteModel">Mongoose.prototype.deleteModel()</h3>
<h5>Parameters</h5>
<ul class="params"><li class="param">name <span class="method-type">«String|RegExp»</span> if string, the name of the model to remove. If regexp, removes all models whose name matches the regexp. </li></ul>
<h5>Returns:</h5>
<ul><li>
<span class="method-type">«Mongoose»</span> this </li></ul>
<div>
<p>Removes the model named <code>name</code> from the default connection, if it exists. You can use this function to clean up any models you created in your tests to prevent OverwriteModelErrors.</p> <p>Equivalent to <code>mongoose.connection.deleteModel(name)</code>.</p> <h4>Example:</h4> <pre data-language="javascript">mongoose.model(<span class="hljs-string">'User'</span>, <span class="hljs-keyword">new</span> Schema({ <span class="hljs-attr">name</span>: <span class="hljs-built_in">String</span> }));
<span class="hljs-built_in">console</span>.log(mongoose.model(<span class="hljs-string">'User'</span>)); <span class="hljs-comment">// Model object</span>
mongoose.deleteModel(<span class="hljs-string">'User'</span>);
<span class="hljs-built_in">console</span>.log(mongoose.model(<span class="hljs-string">'User'</span>)); <span class="hljs-comment">// undefined</span>

<span class="hljs-comment">// Usually useful in a Mocha `afterEach()` hook</span>
afterEach(<span class="hljs-function"><span class="hljs-keyword">function</span>() </span>{
  mongoose.deleteModel(<span class="hljs-regexp">/.+/</span>); <span class="hljs-comment">// Delete every model</span>
});</pre> </div>
<h3 id="mongoose_Mongoose-disconnect">Mongoose.prototype.disconnect()</h3>
<h5>Parameters</h5>
<ul class="params"><li class="param">[callback] <span class="method-type">«Function»</span> called after all connection close, or when first error occurred. </li></ul>
<h5>Returns:</h5>
<ul><li>
<span class="method-type">«Promise»</span> resolves when all connections are closed, or rejects with the first error that occurred. </li></ul>
<div>
<p>Runs <code>.close()</code> on all connections in parallel.</p> </div>
<h3 id="mongoose_Mongoose-driver">Mongoose.prototype.driver</h3>
<h5>Type:</h5>
<ul><li><span class="method-type">«property»</span></li></ul>
<div>
<p>Object with <code>get()</code> and <code>set()</code> containing the underlying driver this Mongoose instance uses to communicate with the database. A driver is a Mongoose-specific interface that defines functions like <code>find()</code>.</p> </div>
<h3 id="mongoose_Mongoose-get">Mongoose.prototype.get()</h3>
<h5>Parameters</h5>
<ul class="params"><li class="param">key <span class="method-type">«String»</span> </li></ul>
<div>
<p>Gets mongoose options</p> <h4>Example:</h4> <pre data-language="javascript">mongoose.get(<span class="hljs-string">'test'</span>) <span class="hljs-comment">// returns the 'test' value</span></pre> </div>
<h3 id="mongoose_Mongoose-isValidObjectId">Mongoose.prototype.isValidObjectId()</h3>
<div>
<p>Returns true if Mongoose can cast the given value to an ObjectId, or false otherwise.</p> <h4>Example:</h4> <pre data-language="javascript">mongoose.isValidObjectId(<span class="hljs-keyword">new</span> mongoose.Types.ObjectId()); <span class="hljs-comment">// true</span>
mongoose.isValidObjectId(<span class="hljs-string">'0123456789ab'</span>); <span class="hljs-comment">// true</span>
mongoose.isValidObjectId(<span class="hljs-number">6</span>); <span class="hljs-comment">// false</span></pre> </div>
<h3 id="mongoose_Mongoose-model">Mongoose.prototype.model()</h3>
<h5>Parameters</h5>
<ul class="params">
<li class="param">name <span class="method-type">«String|Function»</span> model name or class extending Model </li>
<li class="param">[schema] <span class="method-type">«Schema»</span> the schema to use. </li>
<li class="param">[collection] <span class="method-type">«String»</span> name (optional, inferred from model name) </li>
<li class="param">[skipInit] <span class="method-type">«Boolean|Object»</span> whether to skip initialization (defaults to false). If an object, treated as options. </li>
</ul>
<h5>Returns:</h5>
<ul><li>
<span class="method-type">«Model»</span> The model associated with <code>name</code>. Mongoose will create the model if it doesn't already exist. </li></ul>
<div>
<p>Defines a model or retrieves it.</p> <p>Models defined on the <code>mongoose</code> instance are available to all connection created by the same <code>mongoose</code> instance.</p> <p>If you call <code>mongoose.model()</code> with twice the same name but a different schema, you will get an <code>OverwriteModelError</code>. If you call <code>mongoose.model()</code> with the same name and same schema, you'll get the same schema back.</p> <h4>Example:</h4> <pre data-language="javascript"><span class="hljs-keyword">const</span> mongoose = <span class="hljs-built_in">require</span>(<span class="hljs-string">'mongoose'</span>);

<span class="hljs-comment">// define an Actor model with this mongoose instance</span>
<span class="hljs-keyword">const</span> schema = <span class="hljs-keyword">new</span> Schema({ <span class="hljs-attr">name</span>: <span class="hljs-built_in">String</span> });
mongoose.model(<span class="hljs-string">'Actor'</span>, schema);

<span class="hljs-comment">// create a new connection</span>
<span class="hljs-keyword">const</span> conn = mongoose.createConnection(..);

<span class="hljs-comment">// create Actor model</span>
<span class="hljs-keyword">const</span> Actor = conn.model(<span class="hljs-string">'Actor'</span>, schema);
conn.model(<span class="hljs-string">'Actor'</span>) === Actor; <span class="hljs-comment">// true</span>
conn.model(<span class="hljs-string">'Actor'</span>, schema) === Actor; <span class="hljs-comment">// true, same schema</span>
conn.model(<span class="hljs-string">'Actor'</span>, schema, <span class="hljs-string">'actors'</span>) === Actor; <span class="hljs-comment">// true, same schema and collection name</span>

<span class="hljs-comment">// This throws an `OverwriteModelError` because the schema is different.</span>
conn.model(<span class="hljs-string">'Actor'</span>, <span class="hljs-keyword">new</span> Schema({ <span class="hljs-attr">name</span>: <span class="hljs-built_in">String</span> }));</pre> <p><em>When no <code>collection</code> argument is passed, Mongoose uses the model name. If you don't like this behavior, either pass a collection name, use <code>mongoose.pluralize()</code>, or set your schemas collection name option.</em></p> <h4>Example:</h4> <pre data-language="javascript"><span class="hljs-keyword">const</span> schema = <span class="hljs-keyword">new</span> Schema({ <span class="hljs-attr">name</span>: <span class="hljs-built_in">String</span> }, { <span class="hljs-attr">collection</span>: <span class="hljs-string">'actor'</span> });

<span class="hljs-comment">// or</span>

schema.set(<span class="hljs-string">'collection'</span>, <span class="hljs-string">'actor'</span>);

<span class="hljs-comment">// or</span>

<span class="hljs-keyword">const</span> collectionName = <span class="hljs-string">'actor'</span>
<span class="hljs-keyword">const</span> M = mongoose.model(<span class="hljs-string">'Actor'</span>, schema, collectionName)</pre> </div>
<h3 id="mongoose_Mongoose-modelNames">Mongoose.prototype.modelNames()</h3>
<h5>Returns:</h5>
<ul><li>
<span class="method-type">«Array»</span> </li></ul>
<div>
<p>Returns an array of model names created on this instance of Mongoose.</p> <h4>Note:</h4> <p><em>Does not include names of models created using <code>connection.model()</code>.</em></p> </div>
<h3 id="mongoose_Mongoose-mongo">Mongoose.prototype.mongo</h3>
<h5>Type:</h5>
<ul><li><span class="method-type">«property»</span></li></ul>
<div>
<p>The <a href="https://github.com/mongodb/node-mongodb-native">node-mongodb-native</a> driver Mongoose uses.</p> </div>
<h3 id="mongoose_Mongoose-mquery">Mongoose.prototype.mquery</h3>
<h5>Type:</h5>
<ul><li><span class="method-type">«property»</span></li></ul>
<div>
<p>The <a href="https://github.com/aheckmann/mquery">mquery</a> query builder Mongoose uses.</p> </div>
<h3 id="mongoose_Mongoose-now">Mongoose.prototype.now()</h3>
<div>
<p>Mongoose uses this function to get the current time when setting <a href="../guide#timestamps">timestamps</a>. You may stub out this function using a tool like <a href="https://www.npmjs.com/package/sinon">Sinon</a> for testing.</p> </div>
<h3 id="mongoose_Mongoose-plugin">Mongoose.prototype.plugin()</h3>
<h5>Parameters</h5>
<ul class="params">
<li class="param">fn <span class="method-type">«Function»</span> plugin callback </li>
<li class="param">[opts] <span class="method-type">«Object»</span> optional options </li>
</ul>
<h5>Returns:</h5>
<ul><li>
<span class="method-type">«Mongoose»</span> this </li></ul>
<div>
<p>Declares a global plugin executed on all Schemas.</p> <p>Equivalent to calling <code>.plugin(fn)</code> on each Schema you create.</p> </div>
<h3 id="mongoose_Mongoose-pluralize">Mongoose.prototype.pluralize()</h3>
<h5>Parameters</h5>
<ul class="params"><li class="param">[fn] <span class="method-type">«Function|null»</span> overwrites the function used to pluralize collection names </li></ul>
<h5>Returns:</h5>
<ul><li>
<span class="method-type">«Function,null»</span> the current function used to pluralize collection names, defaults to the legacy function from <code>mongoose-legacy-pluralize</code>. </li></ul>
<div>
<p>Getter/setter around function for pluralizing collection names.</p> </div>
<h3 id="mongoose_Mongoose-set">Mongoose.prototype.set()</h3>
<h5>Parameters</h5>
<ul class="params">
<li class="param">key <span class="method-type">«String»</span> </li>
<li class="param">value <span class="method-type">«String|Function|Boolean»</span> </li>
</ul>
<div>
<p>Sets mongoose options</p> <h4>Example:</h4> <pre data-language="javascript">mongoose.set(<span class="hljs-string">'test'</span>, value) <span class="hljs-comment">// sets the 'test' option to `value`</span>

mongoose.set(<span class="hljs-string">'debug'</span>, <span class="hljs-literal">true</span>) <span class="hljs-comment">// enable logging collection methods + arguments to the console/file</span>

mongoose.set(<span class="hljs-string">'debug'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">collectionName, methodName, ...methodArgs</span>) </span>{}); <span class="hljs-comment">// use custom function to log collection methods + arguments</span></pre> <h2>Currently supported options are</h2> <ul> <li>'debug': If <code>true</code>, prints the operations mongoose sends to MongoDB to the console. If a writable stream is passed, it will log to that stream, without colorization. If a callback function is passed, it will receive the collection name, the method name, then all arugments passed to the method. For example, if you wanted to replicate the default logging, you could output from the callback <code>Mongoose: ${collectionName}.${methodName}(${methodArgs.join(', ')})</code>.</li> <li>'returnOriginal': If <code>false</code>, changes the default <code>returnOriginal</code> option to <code>findOneAndUpdate()</code>, <code>findByIdAndUpdate</code>, and <code>findOneAndReplace()</code> to false. This is equivalent to setting the <code>new</code> option to <code>true</code> for <code>findOneAndX()</code> calls by default. Read our <a href="../tutorials/findoneandupdate"><code>findOneAndUpdate()</code> tutorial</a> for more information.</li> <li>'bufferCommands': enable/disable mongoose's buffering mechanism for all connections and models</li> <li>'useCreateIndex': false by default. Set to <code>true</code> to make Mongoose's default index build use <code>createIndex()</code> instead of <code>ensureIndex()</code> to avoid deprecation warnings from the MongoDB driver.</li> <li>'useFindAndModify': true by default. Set to <code>false</code> to make <code>findOneAndUpdate()</code> and <code>findOneAndRemove()</code> use native <code>findOneAndUpdate()</code> rather than <code>findAndModify()</code>.</li> <li>'useNewUrlParser': false by default. Set to <code>true</code> to make all connections set the <code>useNewUrlParser</code> option by default</li> <li>'useUnifiedTopology': false by default. Set to <code>true</code> to make all connections set the <code>useUnifiedTopology</code> option by default</li> <li>'cloneSchemas': false by default. Set to <code>true</code> to <code>clone()</code> all schemas before compiling into a model.</li> <li>'applyPluginsToDiscriminators': false by default. Set to true to apply global plugins to discriminator schemas. This typically isn't necessary because plugins are applied to the base schema and discriminators copy all middleware, methods, statics, and properties from the base schema.</li> <li>'applyPluginsToChildSchemas': true by default. Set to false to skip applying global plugins to child schemas</li> <li>'objectIdGetter': true by default. Mongoose adds a getter to MongoDB ObjectId's called <code>_id</code> that returns <code>this</code> for convenience with populate. Set this to false to remove the getter.</li> <li>'runValidators': false by default. Set to true to enable <a href="../validation#update-validators">update validators</a> for all validators by default.</li> <li>'toObject': <code>{ transform: true, flattenDecimals: true }</code> by default. Overwrites default objects to <a href="https://mongoosejs.com/docs/api.html#document_Document-toObject"><code>toObject()</code></a>
</li> <li>'toJSON': <code>{ transform: true, flattenDecimals: true }</code> by default. Overwrites default objects to <a href="https://mongoosejs.com/docs/api.html#document_Document-toJSON"><code>toJSON()</code></a>, for determining how Mongoose documents get serialized by <code>JSON.stringify()</code>
</li> <li>'strict': true by default, may be <code>false</code>, <code>true</code>, or <code>'throw'</code>. Sets the default strict mode for schemas.</li> <li>'strictQuery': false by default, may be <code>false</code>, <code>true</code>, or <code>'throw'</code>. Sets the default <a href="../guide#strictQuery">strictQuery</a> mode for schemas.</li> <li>'selectPopulatedPaths': true by default. Set to false to opt out of Mongoose adding all fields that you <code>populate()</code> to your <code>select()</code>. The schema-level option <code>selectPopulatedPaths</code> overwrites this one.</li> <li>'typePojoToMixed': true by default, may be <code>false</code> or <code>true</code>. Sets the default typePojoToMixed for schemas.</li> <li>'maxTimeMS': If set, attaches <a href="https://docs.mongodb.com/manual/reference/operator/meta/maxTimeMS/">maxTimeMS</a> to every query</li> <li>'autoIndex': true by default. Set to false to disable automatic index creation for all models associated with this Mongoose instance.</li> <li>'autoCreate': Set to <code>true</code> to make Mongoose call <a href="model#model_Model.createCollection"><code>Model.createCollection()</code></a> automatically when you create a model with <code>mongoose.model()</code> or <code>conn.model()</code>. This is useful for testing transactions, change streams, and other features that require the collection to exist.</li> <li>'overwriteModels': Set to <code>true</code> to default to overwriting models with the same name when calling <code>mongoose.model()</code>, as opposed to throwing an <code>OverwriteModelError</code>.</li> </ul> </div>
<h3 id="mongoose_Mongoose-startSession">Mongoose.prototype.startSession()</h3>
<h5>Parameters</h5>
<ul class="params">
<li class="param">[options] <span class="method-type">«Object»</span> see the <a href="http://mongodb.github.io/node-mongodb-native/3.0/api/MongoClient.html#startSession">mongodb driver options</a> </li>
<ul style="margin-top: 0.5em"><li>[options.causalConsistency=true] <span class="method-type">«Boolean»</span> set to false to disable causal consistency </li></ul>
<li class="param">[callback] <span class="method-type">«Function»</span> </li>
</ul>
<h5>Returns:</h5>
<ul><li>
<span class="method-type">«Promise&lt;ClientSession&gt;»</span> promise that resolves to a MongoDB driver <code>ClientSession</code> </li></ul>
<div>
<p><em>Requires MongoDB &gt;= 3.6.0.</em> Starts a <a href="https://docs.mongodb.com/manual/release-notes/3.6/#client-sessions">MongoDB session</a> for benefits like causal consistency, <a href="https://docs.mongodb.com/manual/core/retryable-writes/">retryable writes</a>, and <a href="http://thecodebarbarian.com/a-node-js-perspective-on-mongodb-4-transactions.html">transactions</a>.</p> <p>Calling <code>mongoose.startSession()</code> is equivalent to calling <code>mongoose.connection.startSession()</code>. Sessions are scoped to a connection, so calling <code>mongoose.startSession()</code> starts a session on the <a href="https://mongoosejs.com/docs/api.html#mongoose_Mongoose-connection">default mongoose connection</a>.</p> </div>
<h3 id="mongoose_Mongoose-version">Mongoose.prototype.version</h3>
<h5>Type:</h5>
<ul><li><span class="method-type">«property»</span></li></ul>
<div>
<p>The Mongoose version</p> <h4>Example</h4> <pre data-language="javascript"><span class="hljs-built_in">console</span>.log(mongoose.version); <span class="hljs-comment">// '5.x.x'</span></pre> </div>
</div><div class="_attribution">
  <p class="_attribution-p">
    <a href="https://mongoosejs.com/docs/api/mongoose.html" class="_attribution-link" target="_blank">https://mongoosejs.com/docs/api/mongoose.html</a>
  </p>
</div>
