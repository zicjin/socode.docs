<a class="edit-docs-link" href="https://github.com/Automattic/mongoose/blob/master/lib/virtualtype.js" target="_blank"> <img src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4NCjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+DQo8c3ZnIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgeD0iMHB4IiB5PSIwcHgiIHZpZXdCb3g9IjAgMCAxMDAwIDEwMDAiIGVuYWJsZS1iYWNrZ3JvdW5kPSJuZXcgMCAwIDEwMDAgMTAwMCIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+DQo8Zz48ZyB0cmFuc2Zvcm09Im1hdHJpeCgxIDAgMCAtMSAwIDQ4MCkiPjxwYXRoIHN0cm9rZT0iIzA5NzFCMiIgZmlsbD0iIzA5NzFCMiIgZD0iTTkzMC45LDQyMC41Yy0zMy4xLDMxLjgtNjkuMyw0Ny43LTEwOC43LDQ3LjdjLTQ0LjUsMC04My45LTE3LjItMTE4LjItNTEuNUw5OS40LTE4NS45Yy0zLjgtMy44LTYuNC04LjktNy42LTE1LjNjLTIuNS04LjktMjkuMi05Ny45LTgwLjEtMjY3Yy0zLjgtMTIuNy0xLjMtMjMuNSw3LjYtMzIuNGM2LjQtNS4xLDE0LTcuNiwyMi45LTcuNmg5LjVjMTMyLjIsNDQuNSwyMTkuOSw3My4xLDI2My4yLDg1LjhjMy44LDEuMyw3LjYsMy44LDExLjQsNy42YzM3NSwzNzAsNTc3LjIsNTcwLjIsNjA2LjQsNjAwLjdjMzguMSwzOS40LDU3LjIsNzkuNSw1Ny4yLDEyMC4xQzk4OC43LDM0Ni44LDk2OSwzODQuOSw5MzAuOSw0MjAuNXogTTY5NC40LDMxOS40YzMxLjgtNy42LDYxLjctMjUuNCw4OS42LTUzLjRjMjYuNy0yNi43LDQzLjItNTcuMiw0OS42LTkxLjVDNzQ3LjIsODguMSw1NzguNy03OS4xLDMyOC4zLTMyN2MtMTIuNywzMC41LTI5LjksNTYuNi01MS41LDc4LjJjLTI2LjcsMjYuNy01Ni42LDQ3LTg5LjYsNjFMMzMyLjEtNDIuOWwyMTAuNywyMTAuN0w2OTQuNCwzMTkuNHogTTE0NS4yLTIzOS4zYzMxLjgtNy42LDYxLTI1LjQsODcuNy01My40YzIxLjYtMjEuNiwzNi45LTQ3LDQ1LjgtNzYuM2MtMTIuNy0zLjgtNDIuOS0xNC05MC42LTMwLjVjLTQ3LjctMTYuNS04Mi4zLTI4LTEwMy45LTM0LjNjNi40LDE5LjEsMTYuOCw1Mi4xLDMxLjUsOTkuMkMxMzAuMy0yODcuNiwxNDAuMS0yNTUuOCwxNDUuMi0yMzkuM3ogTTg4OC45LDIyOS44bC01LjctNS43Yy0xMi43LDMzLjEtMzEuMSw2MS43LTU1LjMsODUuOEM4MDIuNSwzMzUuMyw3NzQuNSwzNTUsNzQ0LDM2OWwxLjksMS45bDEuOSwxLjljMjIuOSwyMi45LDQ3LjcsMzQuMyw3NC40LDM0LjNjMjIuOSwwLDQ1LjEtMTAuOCw2Ni43LTMyLjRjMjUuNC0yNC4yLDM4LjEtNDcuNywzOC4xLTcwLjZTOTE0LjQsMjU2LjUsODg4LjksMjI5Ljh6Ii8+PC9nPjwvZz4NCjwvc3ZnPg=="> </a><h1>Virtualtype</h1>

<div class="api-content">
<h3 id="virtualtype_VirtualType">VirtualType()</h3>
<h5>Parameters</h5>
<ul class="params">
<li class="param">options <span class="method-type">«Object»</span> </li>
<ul style="margin-top: 0.5em"><li>[options.ref] <span class="method-type">«string|function»</span> if <code>ref</code> is not nullish, this becomes a <a href="../populate#populate-virtuals">populated virtual</a> </li></ul>
<ul style="margin-top: 0.5em"><li>[options.localField] <span class="method-type">«string|function»</span> the local field to populate on if this is a populated virtual. </li></ul>
<ul style="margin-top: 0.5em"><li>[options.foreignField] <span class="method-type">«string|function»</span> the foreign field to populate on if this is a populated virtual. </li></ul>
<ul style="margin-top: 0.5em"><li>[options.justOne=false] <span class="method-type">«boolean»</span> by default, a populated virtual is an array. If you set <code>justOne</code>, the populated virtual will be a single doc or <code>null</code>. </li></ul>
<ul style="margin-top: 0.5em"><li>[options.getters=false] <span class="method-type">«boolean»</span> if you set this to <code>true</code>, Mongoose will call any custom getters you defined on this virtual </li></ul>
<ul style="margin-top: 0.5em"><li>[options.count=false] <span class="method-type">«boolean»</span> if you set this to <code>true</code>, <code>populate()</code> will set this virtual to the number of populated documents, as opposed to the documents themselves, using <a href="api#query_Query-countDocuments"><code>Query#countDocuments()</code></a> </li></ul>
<ul style="margin-top: 0.5em"><li>[options.match=null] <span class="method-type">«Object|Function»</span> add an extra match condition to <code>populate()</code> </li></ul>
<ul style="margin-top: 0.5em"><li>[options.limit=null] <span class="method-type">«Number»</span> add a default <code>limit</code> to the <code>populate()</code> query </li></ul>
<ul style="margin-top: 0.5em"><li>[options.skip=null] <span class="method-type">«Number»</span> add a default <code>skip</code> to the <code>populate()</code> query </li></ul>
<ul style="margin-top: 0.5em"><li>[options.perDocumentLimit=null] <span class="method-type">«Number»</span> For legacy reasons, <code>limit</code> with <code>populate()</code> may give incorrect results because it only executes a single query for every document being populated. If you set <code>perDocumentLimit</code>, Mongoose will ensure correct <code>limit</code> per document by executing a separate query for each document to <code>populate()</code>. For example, <code>.find().populate({ path: 'test', perDocumentLimit: 2 })</code> will execute 2 additional queries if <code>.find()</code> returns 2 documents. </li></ul>
<ul style="margin-top: 0.5em"><li>[options.options=null] <span class="method-type">«Object»</span> Additional options like <code>limit</code> and <code>lean</code>. </li></ul>
</ul>
<div>
<p>VirtualType constructor</p> <p>This is what mongoose uses to define virtual attributes via <code>Schema.prototype.virtual</code>.</p> <h4>Example:</h4> <pre data-language="javascript"><span class="hljs-keyword">const</span> fullname = schema.virtual(<span class="hljs-string">'fullname'</span>);
fullname <span class="hljs-keyword">instanceof</span> mongoose.VirtualType <span class="hljs-comment">// true</span></pre> </div>
<h3 id="virtualtype_VirtualType-applyGetters">VirtualType.prototype.applyGetters()</h3>
<h5>Parameters</h5>
<ul class="params">
<li class="param">value <span class="method-type">«Object»</span> </li>
<li class="param">doc <span class="method-type">«Document»</span> The document this virtual is attached to </li>
</ul>
<h5>Returns:</h5>
<ul><li>
<span class="method-type">«any»</span> the value after applying all getters </li></ul>
<div>
<p>Applies getters to <code>value</code>.</p> </div>
<h3 id="virtualtype_VirtualType-applySetters">VirtualType.prototype.applySetters()</h3>
<h5>Parameters</h5>
<ul class="params">
<li class="param">value <span class="method-type">«Object»</span> </li>
<li class="param">doc <span class="method-type">«Document»</span> </li>
</ul>
<h5>Returns:</h5>
<ul><li>
<span class="method-type">«any»</span> the value after applying all setters </li></ul>
<div>
<p>Applies setters to <code>value</code>.</p> </div>
<h3 id="virtualtype_VirtualType-get">VirtualType.prototype.get()</h3>
<h5>Parameters</h5>
<ul class="params"><li class="param">VirtualType, <span class="method-type">«Function(Any|»</span> Document)} fn </li></ul>
<h5>Returns:</h5>
<ul><li>
<span class="method-type">«VirtualType»</span> this </li></ul>
<div>
<p>Adds a custom getter to this virtual.</p> <p>Mongoose calls the getter function with the below 3 parameters.</p> <ul> <li>
<code>value</code>: the value returned by the previous getter. If there is only one getter, <code>value</code> will be <code>undefined</code>.</li> <li>
<code>virtual</code>: the virtual object you called <code>.get()</code> on</li> <li>
<code>doc</code>: the document this virtual is attached to. Equivalent to <code>this</code>.</li> </ul> <h4>Example:</h4> <pre data-language="javascript"><span class="hljs-keyword">const</span> virtual = schema.virtual(<span class="hljs-string">'fullname'</span>);
virtual.get(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">value, virtual, doc</span>) </span>{
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.name.first + <span class="hljs-string">' '</span> + <span class="hljs-keyword">this</span>.name.last;
});</pre> </div>
<h3 id="virtualtype_VirtualType-set">VirtualType.prototype.set()</h3>
<h5>Parameters</h5>
<ul class="params"><li class="param">VirtualType, <span class="method-type">«Function(Any|»</span> Document)} fn </li></ul>
<h5>Returns:</h5>
<ul><li>
<span class="method-type">«VirtualType»</span> this </li></ul>
<div>
<p>Adds a custom setter to this virtual.</p> <p>Mongoose calls the setter function with the below 3 parameters.</p> <ul> <li>
<code>value</code>: the value being set</li> <li>
<code>virtual</code>: the virtual object you're calling <code>.set()</code> on</li> <li>
<code>doc</code>: the document this virtual is attached to. Equivalent to <code>this</code>.</li> </ul> <h4>Example:</h4> <pre data-language="javascript"><span class="hljs-keyword">const</span> virtual = schema.virtual(<span class="hljs-string">'fullname'</span>);
virtual.set(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">value, virtual, doc</span>) </span>{
  <span class="hljs-keyword">const</span> parts = value.split(<span class="hljs-string">' '</span>);
  <span class="hljs-keyword">this</span>.name.first = parts[<span class="hljs-number">0</span>];
  <span class="hljs-keyword">this</span>.name.last = parts[<span class="hljs-number">1</span>];
});

<span class="hljs-keyword">const</span> Model = mongoose.model(<span class="hljs-string">'Test'</span>, schema);
<span class="hljs-keyword">const</span> doc = <span class="hljs-keyword">new</span> Model();
<span class="hljs-comment">// Calls the setter with `value = 'Jean-Luc Picard'`</span>
doc.fullname = <span class="hljs-string">'Jean-Luc Picard'</span>;
doc.name.first; <span class="hljs-comment">// 'Jean-Luc'</span>
doc.name.last; <span class="hljs-comment">// 'Picard'</span></pre> </div>
</div><div class="_attribution">
  <p class="_attribution-p">
    <a href="https://mongoosejs.com/docs/api/virtualtype.html" class="_attribution-link" target="_blank">https://mongoosejs.com/docs/api/virtualtype.html</a>
  </p>
</div>
