<a class="edit-docs-link" href="https://github.com/Automattic/mongoose/blob/master/docs/deprecations.md" target="_blank"> <img src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4NCjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+DQo8c3ZnIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgeD0iMHB4IiB5PSIwcHgiIHZpZXdCb3g9IjAgMCAxMDAwIDEwMDAiIGVuYWJsZS1iYWNrZ3JvdW5kPSJuZXcgMCAwIDEwMDAgMTAwMCIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+DQo8Zz48ZyB0cmFuc2Zvcm09Im1hdHJpeCgxIDAgMCAtMSAwIDQ4MCkiPjxwYXRoIHN0cm9rZT0iIzA5NzFCMiIgZmlsbD0iIzA5NzFCMiIgZD0iTTkzMC45LDQyMC41Yy0zMy4xLDMxLjgtNjkuMyw0Ny43LTEwOC43LDQ3LjdjLTQ0LjUsMC04My45LTE3LjItMTE4LjItNTEuNUw5OS40LTE4NS45Yy0zLjgtMy44LTYuNC04LjktNy42LTE1LjNjLTIuNS04LjktMjkuMi05Ny45LTgwLjEtMjY3Yy0zLjgtMTIuNy0xLjMtMjMuNSw3LjYtMzIuNGM2LjQtNS4xLDE0LTcuNiwyMi45LTcuNmg5LjVjMTMyLjIsNDQuNSwyMTkuOSw3My4xLDI2My4yLDg1LjhjMy44LDEuMyw3LjYsMy44LDExLjQsNy42YzM3NSwzNzAsNTc3LjIsNTcwLjIsNjA2LjQsNjAwLjdjMzguMSwzOS40LDU3LjIsNzkuNSw1Ny4yLDEyMC4xQzk4OC43LDM0Ni44LDk2OSwzODQuOSw5MzAuOSw0MjAuNXogTTY5NC40LDMxOS40YzMxLjgtNy42LDYxLjctMjUuNCw4OS42LTUzLjRjMjYuNy0yNi43LDQzLjItNTcuMiw0OS42LTkxLjVDNzQ3LjIsODguMSw1NzguNy03OS4xLDMyOC4zLTMyN2MtMTIuNywzMC41LTI5LjksNTYuNi01MS41LDc4LjJjLTI2LjcsMjYuNy01Ni42LDQ3LTg5LjYsNjFMMzMyLjEtNDIuOWwyMTAuNywyMTAuN0w2OTQuNCwzMTkuNHogTTE0NS4yLTIzOS4zYzMxLjgtNy42LDYxLTI1LjQsODcuNy01My40YzIxLjYtMjEuNiwzNi45LTQ3LDQ1LjgtNzYuM2MtMTIuNy0zLjgtNDIuOS0xNC05MC42LTMwLjVjLTQ3LjctMTYuNS04Mi4zLTI4LTEwMy45LTM0LjNjNi40LDE5LjEsMTYuOCw1Mi4xLDMxLjUsOTkuMkMxMzAuMy0yODcuNiwxNDAuMS0yNTUuOCwxNDUuMi0yMzkuM3ogTTg4OC45LDIyOS44bC01LjctNS43Yy0xMi43LDMzLjEtMzEuMSw2MS43LTU1LjMsODUuOEM4MDIuNSwzMzUuMyw3NzQuNSwzNTUsNzQ0LDM2OWwxLjksMS45bDEuOSwxLjljMjIuOSwyMi45LDQ3LjcsMzQuMyw3NC40LDM0LjNjMjIuOSwwLDQ1LjEtMTAuOCw2Ni43LTMyLjRjMjUuNC0yNC4yLDM4LjEtNDcuNywzOC4xLTcwLjZTOTE0LjQsMjU2LjUsODg4LjksMjI5Ljh6Ii8+PC9nPjwvZz4NCjwvc3ZnPg=="> </a><h1 id="deprecation-warnings">  Deprecation Warnings  </h1>   <p>There are several deprecations in the <a href="http://npmjs.com/package/mongodb">MongoDB Node.js driver</a> that Mongoose users should be aware of. Mongoose provides options to work around these deprecation warnings, but you need to test whether these options cause any problems for your application. Please <a href="https://github.com/Automattic/mongoose/issues/new">report any issues on GitHub</a>.</p> <h2 id="summary">Summary</h2> <p>To fix all deprecation warnings, follow the below steps:</p> <ul> <li>Replace <code>update()</code> with <code>updateOne()</code>, <code>updateMany()</code>, or <code>replaceOne()</code>
</li> <li>Replace <code>remove()</code> with <code>deleteOne()</code> or <code>deleteMany()</code>.</li> <li>Replace <code>count()</code> with <code>countDocuments()</code>, unless you want to count how many documents are in the whole collection (no filter). In the latter case, use <code>estimatedDocumentCount()</code>.</li> </ul> <p>Read below for more a more detailed description of each deprecation warning.</p> <h2 id="remove"><code>remove()</code></h2> <p>The MongoDB driver's <a href="http://mongodb.github.io/node-mongodb-native/3.1/api/Collection.html#remove"><code>remove()</code> function</a> is deprecated in favor of <code>deleteOne()</code> and <code>deleteMany()</code>. This is to comply with the <a href="https://github.com/mongodb/specifications/blob/master/source/crud/crud.rst">MongoDB CRUD specification</a>, which aims to provide a consistent API for CRUD operations across all MongoDB drivers.</p> <pre data-language="javascript"><span class="hljs-title class_">DeprecationWarning</span>: collection.<span class="hljs-property">remove</span> is deprecated. <span class="hljs-title class_">Use</span> deleteOne,
deleteMany, or bulkWrite instead.
</pre> <p>To remove this deprecation warning, replace any usage of <code>remove()</code> with <code>deleteMany()</code>, <em>unless</em> you specify the <a href="https://mongoosejs.com/docs/api.html#model_Model-remove"><code>single</code> option to <code>remove()</code></a>. The <code>single</code> option limited <code>remove()</code> to deleting at most one document, so you should replace <code>remove(filter, { single: true })</code> with <code>deleteOne(filter)</code>.</p> <pre data-language="javascript"><span class="hljs-comment">// Replace this:</span>
<span class="hljs-title class_">MyModel</span>.<span class="hljs-title function_">remove</span>({ <span class="hljs-attr">foo</span>: <span class="hljs-string">'bar'</span> });
<span class="hljs-comment">// With this:</span>
<span class="hljs-title class_">MyModel</span>.<span class="hljs-title function_">deleteMany</span>({ <span class="hljs-attr">foo</span>: <span class="hljs-string">'bar'</span> });

<span class="hljs-comment">// Replace this:</span>
<span class="hljs-title class_">MyModel</span>.<span class="hljs-title function_">remove</span>({ <span class="hljs-attr">answer</span>: <span class="hljs-number">42</span> }, { <span class="hljs-attr">single</span>: <span class="hljs-literal">true</span> });
<span class="hljs-comment">// With this:</span>
<span class="hljs-title class_">MyModel</span>.<span class="hljs-title function_">deleteOne</span>({ <span class="hljs-attr">answer</span>: <span class="hljs-number">42</span> });
</pre> <h2 id="update"><code>update()</code></h2> <p>Like <code>remove()</code>, the <a href="https://mongoosejs.com/docs/api.html#model_Model-update"><code>update()</code> function</a> is deprecated in favor of the more explicit <a href="https://mongoosejs.com/docs/api.html#model_Model-updateOne"><code>updateOne()</code></a>, <a href="https://mongoosejs.com/docs/api.html#model_Model-updateMany"><code>updateMany()</code></a>, and <a href="https://mongoosejs.com/docs/api.html#model_Model-replaceOne"><code>replaceOne()</code></a> functions. You should replace <code>update()</code> with <code>updateOne()</code>, unless you use the <a href="https://mongoosejs.com/docs/api.html#model_Model-update"><code>multi</code> or <code>overwrite</code> options</a>.</p> <pre data-language="javascript">collection.<span class="hljs-property">update</span> is deprecated. <span class="hljs-title class_">Use</span> updateOne, updateMany, or bulkWrite
instead.
</pre> <pre data-language="javascript"><span class="hljs-comment">// Replace this:</span>
<span class="hljs-title class_">MyModel</span>.<span class="hljs-title function_">update</span>({ <span class="hljs-attr">foo</span>: <span class="hljs-string">'bar'</span> }, { <span class="hljs-attr">answer</span>: <span class="hljs-number">42</span> });
<span class="hljs-comment">// With this:</span>
<span class="hljs-title class_">MyModel</span>.<span class="hljs-title function_">updateOne</span>({ <span class="hljs-attr">foo</span>: <span class="hljs-string">'bar'</span> }, { <span class="hljs-attr">answer</span>: <span class="hljs-number">42</span> });

<span class="hljs-comment">// If you use `overwrite: true`, you should use `replaceOne()` instead:</span>
<span class="hljs-title class_">MyModel</span>.<span class="hljs-title function_">update</span>(filter, update, { <span class="hljs-attr">overwrite</span>: <span class="hljs-literal">true</span> });
<span class="hljs-comment">// Replace with this:</span>
<span class="hljs-title class_">MyModel</span>.<span class="hljs-title function_">replaceOne</span>(filter, update);

<span class="hljs-comment">// If you use `multi: true`, you should use `updateMany()` instead:</span>
<span class="hljs-title class_">MyModel</span>.<span class="hljs-title function_">update</span>(filter, update, { <span class="hljs-attr">multi</span>: <span class="hljs-literal">true</span> });
<span class="hljs-comment">// Replace with this:</span>
<span class="hljs-title class_">MyModel</span>.<span class="hljs-title function_">updateMany</span>(filter, update);
</pre> <h2 id="count"><code>count()</code></h2> <p>The MongoDB server has deprecated the <code>count()</code> function in favor of two separate functions, <a href="#query_Query-countDocuments"><code>countDocuments()</code></a> and <a href="#query_Query-estimatedDocumentCount"><code>estimatedDocumentCount()</code></a>.</p> <pre data-language="javascript"><span class="hljs-title class_">DeprecationWarning</span>: collection.<span class="hljs-property">count</span> is deprecated, and will be removed <span class="hljs-keyword">in</span> a future version. <span class="hljs-title class_">Use</span> collection.<span class="hljs-property">countDocuments</span> or collection.<span class="hljs-property">estimatedDocumentCount</span> instead
</pre> <p>The difference between the two is <code>countDocuments()</code> can accept a filter parameter like <a href="#query_Query-find"><code>find()</code></a>. The <code>estimatedDocumentCount()</code> function is faster, but can only tell you the total number of documents in a collection. You cannot pass a <code>filter</code> to <code>estimatedDocumentCount()</code>.</p> <p>To migrate, replace <code>count()</code> with <code>countDocuments()</code> <em>unless</em> you do not pass any arguments to <code>count()</code>. If you use <code>count()</code> to count all documents in a collection as opposed to counting documents that match a query, use <code>estimatedDocumentCount()</code> instead of <code>countDocuments()</code>.</p> <pre data-language="javascript"><span class="hljs-comment">// Replace this:</span>
<span class="hljs-title class_">MyModel</span>.<span class="hljs-title function_">count</span>({ <span class="hljs-attr">answer</span>: <span class="hljs-number">42</span> });
<span class="hljs-comment">// With this:</span>
<span class="hljs-title class_">MyModel</span>.<span class="hljs-title function_">countDocuments</span>({ <span class="hljs-attr">answer</span>: <span class="hljs-number">42</span> });

<span class="hljs-comment">// If you're counting all documents in the collection, use</span>
<span class="hljs-comment">// `estimatedDocumentCount()` instead.</span>
<span class="hljs-title class_">MyModel</span>.<span class="hljs-title function_">count</span>();
<span class="hljs-comment">// Replace with:</span>
<span class="hljs-title class_">MyModel</span>.<span class="hljs-title function_">estimatedDocumentCount</span>();

<span class="hljs-comment">// Replace this:</span>
<span class="hljs-title class_">MyModel</span>.<span class="hljs-title function_">find</span>({ <span class="hljs-attr">answer</span>: <span class="hljs-number">42</span> }).<span class="hljs-title function_">count</span>().<span class="hljs-title function_">exec</span>();
<span class="hljs-comment">// With this:</span>
<span class="hljs-title class_">MyModel</span>.<span class="hljs-title function_">find</span>({ <span class="hljs-attr">answer</span>: <span class="hljs-number">42</span> }).<span class="hljs-title function_">countDocuments</span>().<span class="hljs-title function_">exec</span>();

<span class="hljs-comment">// Replace this:</span>
<span class="hljs-title class_">MyModel</span>.<span class="hljs-title function_">find</span>().<span class="hljs-title function_">count</span>().<span class="hljs-title function_">exec</span>();
<span class="hljs-comment">// With this, since there's no filter</span>
<span class="hljs-title class_">MyModel</span>.<span class="hljs-title function_">find</span>().<span class="hljs-title function_">estimatedDocumentCount</span>().<span class="hljs-title function_">exec</span>();
</pre><div class="_attribution">
  <p class="_attribution-p">
    <a href="https://mongoosejs.com/docs/deprecations.html" class="_attribution-link" target="_blank">https://mongoosejs.com/docs/deprecations.html</a>
  </p>
</div>
