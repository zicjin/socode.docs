<h1>activate_plugin( string $plugin, string $redirect = '', bool $network_wide = false, bool $silent = false )</h1>  <section> <p>Attempts activation of plugin in a “sandbox” and redirects on success.</p> </section> <div class="content-toc">  <section> <h2 id="description">Description</h2> <p>A plugin that is already activated will not attempt to be activated again.</p> <p>The way it works is by setting the redirection to the error before trying to include the plugin file. If the plugin fails, then the redirection will not be overwritten with the success message. Also, the options will not be updated and the activation hook will not be called on plugin error.</p> <p>It should be noted that in no way the below code will actually prevent errors within the file. The code should not be used elsewhere to replicate the "sandbox", which uses redirection to work. {@source 13 1}</p> <p>If any errors are found or text is outputted, then it will be captured to ensure that the success redirection will update the error redirection.</p> </section>  <section> <h2 id="parameters">Parameters</h2> <dl> <dt>$plugin</dt> <dd> <p class="desc"> <span class="type">(<span class="string">string</span>)</span> <span class="required">(Required)</span> <span class="description">Path to the plugin file relative to the plugins directory.</span> </p> </dd> <dt>$redirect</dt> <dd> <p class="desc"> <span class="type">(<span class="string">string</span>)</span> <span class="required">(Optional)</span> <span class="description"> URL to redirect to.</span> </p> <p class="default">Default value: ''</p> </dd> <dt>$network_wide</dt> <dd> <p class="desc"> <span class="type">(<span class="bool">bool</span>)</span> <span class="required">(Optional)</span> <span class="description"> Whether to enable the plugin for all sites in the network or just the current site. Multisite only. </span> </p> <p class="default">Default value: false</p> </dd> <dt>$silent</dt> <dd> <p class="desc"> <span class="type">(<span class="bool">bool</span>)</span> <span class="required">(Optional)</span> <span class="description"> Whether to prevent calling activation hooks. </span> </p> <p class="default">Default value: false</p> </dd> </dl> </section>  <section> <h2 id="return">Return</h2> <p><span class="return-type">(null|<a href="../classes/wp_error">WP_Error</a>)</span> Null on success, <a href="../classes/wp_error">WP_Error</a> on invalid file.</p> </section>  <section> <h2 id="more-information">More Information</h2> <p>Plugin will fail to activate with the following generic response for multiple reasons, including; issues parsing the header information, issue with the ‘plugin’ cache (see <a href="../classes/wp_object_cache">WordPress Object Cache</a>), or a permissions error.</p> <pre class="brush: php; title: ; notranslate" title="" data-language="php">
The plugin does not have a valid header.
</pre> <p>Issues with the plugin cache, are caused when the plugin files are added or modified, after the plugins have all been initialised. This can be resolved by reloading the page, sending the <code>activate_plugin()</code> as a separate AJAX request, or if necessary, by manually updating the cache. Example below:</p> <section> <pre data-language="php">$cache_plugins = wp_cache_get( 'plugins', 'plugins' );
if ( !empty( $cache_plugins ) ) {
	$new_plugin = array(
		'Name' =&gt; $plugin_name,
		'PluginURI' =&gt; $plugin_uri,
		'Version' =&gt; $plugin_version,
		'Description' =&gt; $plugin_description,
		'Author' =&gt; $author_name,
		'AuthorURI' =&gt; $author_uri,
		'TextDomain' =&gt; '',
		'DomainPath' =&gt; '',
		'Network' =&gt; '',
		'Title' =&gt; $plugin_name,
		'AuthorName' =&gt; $author_name,
	);
	$cache_plugins[''][$plugin_path] = $new_plugin;
	wp_cache_set( 'plugins', $cache_plugins, 'plugins' );
}</pre>  </section> </section>  <section> <h2 id="source">Source</h2> <p> File: <a href="https://developer.wordpress.org/reference/files/wp-admin/includes/plugin.php/">wp-admin/includes/plugin.php</a> </p> <pre data-language="php">function activate_plugin( $plugin, $redirect = '', $network_wide = false, $silent = false ) {
	$plugin = plugin_basename( trim( $plugin ) );

	if ( is_multisite() &amp;&amp; ( $network_wide || is_network_only_plugin( $plugin ) ) ) {
		$network_wide        = true;
		$current             = get_site_option( 'active_sitewide_plugins', array() );
		$_GET['networkwide'] = 1; // Back compat for plugins looking for this value.
	} else {
		$current = get_option( 'active_plugins', array() );
	}

	$valid = validate_plugin( $plugin );
	if ( is_wp_error( $valid ) ) {
		return $valid;
	}

	$requirements = validate_plugin_requirements( $plugin );
	if ( is_wp_error( $requirements ) ) {
		return $requirements;
	}

	if ( $network_wide &amp;&amp; ! isset( $current[ $plugin ] )
		|| ! $network_wide &amp;&amp; ! in_array( $plugin, $current, true )
	) {
		if ( ! empty( $redirect ) ) {
			// We'll override this later if the plugin can be included without fatal error.
			wp_redirect( add_query_arg( '_error_nonce', wp_create_nonce( 'plugin-activation-error_' . $plugin ), $redirect ) );
		}

		ob_start();

		// Load the plugin to test whether it throws any errors.
		plugin_sandbox_scrape( $plugin );

		if ( ! $silent ) {
			/**
			 * Fires before a plugin is activated.
			 *
			 * If a plugin is silently activated (such as during an update),
			 * this hook does not fire.
			 *
			 * @since 2.9.0
			 *
			 * @param string $plugin       Path to the plugin file relative to the plugins directory.
			 * @param bool   $network_wide Whether to enable the plugin for all sites in the network
			 *                             or just the current site. Multisite only. Default false.
			 */
			do_action( 'activate_plugin', $plugin, $network_wide );

			/**
			 * Fires as a specific plugin is being activated.
			 *
			 * This hook is the "activation" hook used internally by register_activation_hook().
			 * The dynamic portion of the hook name, `$plugin`, refers to the plugin basename.
			 *
			 * If a plugin is silently activated (such as during an update), this hook does not fire.
			 *
			 * @since 2.0.0
			 *
			 * @param bool $network_wide Whether to enable the plugin for all sites in the network
			 *                           or just the current site. Multisite only. Default false.
			 */
			do_action( "activate_{$plugin}", $network_wide );
		}

		if ( $network_wide ) {
			$current            = get_site_option( 'active_sitewide_plugins', array() );
			$current[ $plugin ] = time();
			update_site_option( 'active_sitewide_plugins', $current );
		} else {
			$current   = get_option( 'active_plugins', array() );
			$current[] = $plugin;
			sort( $current );
			update_option( 'active_plugins', $current );
		}

		if ( ! $silent ) {
			/**
			 * Fires after a plugin has been activated.
			 *
			 * If a plugin is silently activated (such as during an update),
			 * this hook does not fire.
			 *
			 * @since 2.9.0
			 *
			 * @param string $plugin       Path to the plugin file relative to the plugins directory.
			 * @param bool   $network_wide Whether to enable the plugin for all sites in the network
			 *                             or just the current site. Multisite only. Default false.
			 */
			do_action( 'activated_plugin', $plugin, $network_wide );
		}

		if ( ob_get_length() &gt; 0 ) {
			$output = ob_get_clean();
			return new WP_Error( 'unexpected_output', __( 'The plugin generated unexpected output.' ), $output );
		}

		ob_end_clean();
	}

	return null;
}</pre>  </section>  <section> <h2 id="related">Related</h2> <article class="uses"> <h3 id="uses">Uses</h3> <table id="uses-table">  <thead> <tr> <th>Uses</th> <th class="related-desc">Description</th> </tr> </thead> <tbody> <tr> <td> <span>wp-admin/includes/plugin.php:</span> <a href="validate_plugin_requirements">validate_plugin_requirements()</a> </td> <td class="related-desc"> <p>Validates the plugin requirements for WordPress version and PHP version.</p> </td> </tr> <tr> <td> <span>wp-admin/includes/plugin.php:</span> <a href="validate_plugin">validate_plugin()</a> </td> <td class="related-desc"> <p>Validates the plugin path.</p> </td> </tr> <tr> <td> <span>wp-admin/includes/plugin.php:</span> <a href="is_network_only_plugin">is_network_only_plugin()</a> </td> <td class="related-desc"> <p>Checks for “Network: true” in the plugin header to see if this should be activated only as a network wide plugin. The plugin would also work when Multisite is not enabled.</p> </td> </tr> <tr> <td> <span>wp-admin/includes/plugin.php:</span> <a href="../hooks/activate_plugin">activate_{$plugin}</a> </td> <td class="related-desc"> <p>Fires as a specific plugin is being activated.</p> </td> </tr> <tr> <td> <span>wp-admin/includes/plugin.php:</span> <a href="../hooks/activated_plugin">activated_plugin</a> </td> <td class="related-desc"> <p>Fires after a plugin has been activated.</p> </td> </tr> <tr> <td> <span>wp-admin/includes/plugin.php:</span> <a href="plugin_sandbox_scrape">plugin_sandbox_scrape()</a> </td> <td class="related-desc"> <p>Loads a given plugin attempt to generate errors.</p> </td> </tr> <tr> <td> <span>wp-includes/l10n.php:</span> <a href="__">__()</a> </td> <td class="related-desc"> <p>Retrieve the translation of $text.</p> </td> </tr> <tr> <td> <span>wp-includes/pluggable.php:</span> <a href="wp_create_nonce">wp_create_nonce()</a> </td> <td class="related-desc"> <p>Creates a cryptographic token tied to a specific action, user, user session, and window of time.</p> </td> </tr> <tr> <td> <span>wp-includes/pluggable.php:</span> <a href="wp_redirect">wp_redirect()</a> </td> <td class="related-desc"> <p>Redirects to another page.</p> </td> </tr> <tr> <td> <span>wp-includes/load.php:</span> <a href="is_multisite">is_multisite()</a> </td> <td class="related-desc"> <p>If Multisite is enabled.</p> </td> </tr> <tr> <td> <span>wp-includes/functions.php:</span> <a href="add_query_arg">add_query_arg()</a> </td> <td class="related-desc"> <p>Retrieves a modified URL query string.</p> </td> </tr> <tr> <td> <span>wp-includes/plugin.php:</span> <a href="plugin_basename">plugin_basename()</a> </td> <td class="related-desc"> <p>Gets the basename of a plugin.</p> </td> </tr> <tr> <td> <span>wp-includes/plugin.php:</span> <a href="do_action">do_action()</a> </td> <td class="related-desc"> <p>Calls the callback functions that have been added to an action hook.</p> </td> </tr> <tr> <td> <span>wp-includes/option.php:</span> <a href="update_site_option">update_site_option()</a> </td> <td class="related-desc"> <p>Updates the value of an option that was already added for the current network.</p> </td> </tr> <tr> <td> <span>wp-includes/option.php:</span> <a href="get_site_option">get_site_option()</a> </td> <td class="related-desc"> <p>Retrieve an option value for the current network based on name of option.</p> </td> </tr> <tr> <td> <span>wp-includes/option.php:</span> <a href="update_option">update_option()</a> </td> <td class="related-desc"> <p>Updates the value of an option that was already added.</p> </td> </tr> <tr> <td> <span>wp-includes/option.php:</span> <a href="get_option">get_option()</a> </td> <td class="related-desc"> <p>Retrieves an option value based on an option name.</p> </td> </tr> <tr> <td> <span>wp-includes/load.php:</span> <a href="is_wp_error">is_wp_error()</a> </td> <td class="related-desc"> <p>Checks whether the given variable is a WordPress Error.</p> </td> </tr> <tr> <td> <span>wp-includes/class-wp-error.php:</span> <a href="../classes/wp_error/__construct">WP_Error::__construct()</a> </td> <td class="related-desc"> <p>Initializes the error.</p> </td> </tr> </tbody>

</table>   </article>  <article class="used-by"> <h3 id="used-by">Used By</h3> <table id="used-by-table">  <thead> <tr> <th>Used By</th> <th class="related-desc">Description</th> </tr> </thead> <tbody> <tr> <td> <span>wp-includes/rest-api/endpoints/class-wp-rest-plugins-controller.php:</span> <a href="../classes/wp_rest_plugins_controller/handle_plugin_status">WP_REST_Plugins_Controller::handle_plugin_status()</a> </td> <td class="related-desc"> <p>Handle updating a plugin’s status.</p> </td> </tr> <tr> <td> <span>wp-admin/includes/plugin.php:</span> <a href="activate_plugins">activate_plugins()</a> </td> <td class="related-desc"> <p>Activates multiple plugins.</p> </td> </tr> </tbody>

</table> </article> </section>  <section> <h2 id="changelog">Changelog</h2> <table>  <thead> <tr> <th class="changelog-version">Version</th> <th class="changelog-desc">Description</th> </tr> </thead> <tbody> <tr> <td><a href="https://developer.wordpress.org/reference/since/5.2.0/" alt="WordPress 5.2.0">5.2.0</a></td> <td><span class="since-description">Test for WordPress version and PHP version compatibility.</span></td> </tr> <tr> <td><a href="https://developer.wordpress.org/reference/since/2.5.0/" alt="WordPress 2.5.0">2.5.0</a></td> <td>Introduced.</td> </tr> </tbody> </table> </section>    </div><div class="_attribution">
  <p class="_attribution-p">
    <a href="https://developer.wordpress.org/reference/functions/activate_plugin" class="_attribution-link" target="_blank">https://developer.wordpress.org/reference/functions/activate_plugin</a>
  </p>
</div>
