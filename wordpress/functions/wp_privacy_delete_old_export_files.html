<h1>wp_privacy_delete_old_export_files()</h1>  <section> <p>Cleans up export files older than three days old.</p> </section> <div class="content-toc">  <section> <h2 id="description">Description</h2> <p>The export files are stored in <code>wp-content/uploads</code>, and are therefore publicly accessible. A CSPRN is appended to the filename to mitigate the risk of an unauthorized person downloading the file, but it is still possible. Deleting the file after the data subject has had a chance to delete it adds an additional layer of protection.</p> </section>  <section> <h2 id="source">Source</h2> <p> File: <a href="https://developer.wordpress.org/reference/files/wp-includes/functions.php/">wp-includes/functions.php</a> </p> <pre data-language="php">function wp_privacy_delete_old_export_files() {
	$exports_dir = wp_privacy_exports_dir();
	if ( ! is_dir( $exports_dir ) ) {
		return;
	}

	require_once ABSPATH . 'wp-admin/includes/file.php';
	$export_files = list_files( $exports_dir, 100, array( 'index.php' ) );

	/**
	 * Filters the lifetime, in seconds, of a personal data export file.
	 *
	 * By default, the lifetime is 3 days. Once the file reaches that age, it will automatically
	 * be deleted by a cron job.
	 *
	 * @since 4.9.6
	 *
	 * @param int $expiration The expiration age of the export, in seconds.
	 */
	$expiration = apply_filters( 'wp_privacy_export_expiration', 3 * DAY_IN_SECONDS );

	foreach ( (array) $export_files as $export_file ) {
		$file_age_in_seconds = time() - filemtime( $export_file );

		if ( $expiration &lt; $file_age_in_seconds ) {
			unlink( $export_file );
		}
	}
}</pre>  </section>  <section> <h2 id="related">Related</h2> <article class="uses"> <h3 id="uses">Uses</h3> <table id="uses-table">  <thead> <tr> <th>Uses</th> <th class="related-desc">Description</th> </tr> </thead> <tbody> <tr> <td> <span>wp-includes/functions.php:</span> <a href="../hooks/wp_privacy_export_expiration">wp_privacy_export_expiration</a> </td> <td class="related-desc"> <p>Filters the lifetime, in seconds, of a personal data export file.</p> </td> </tr> <tr> <td> <span>wp-includes/functions.php:</span> <a href="wp_privacy_exports_dir">wp_privacy_exports_dir()</a> </td> <td class="related-desc"> <p>Returns the directory used to store personal data export files.</p> </td> </tr> <tr> <td> <span>wp-admin/includes/file.php:</span> <a href="list_files">list_files()</a> </td> <td class="related-desc"> <p>Returns a listing of all files in the specified folder and all subdirectories up to 100 levels deep.</p> </td> </tr> <tr> <td> <span>wp-includes/plugin.php:</span> <a href="apply_filters">apply_filters()</a> </td> <td class="related-desc"> <p>Calls the callback functions that have been added to a filter hook.</p> </td> </tr> </tbody>

</table> </article> </section>  <section> <h2 id="changelog">Changelog</h2> <table>  <thead> <tr> <th class="changelog-version">Version</th> <th class="changelog-desc">Description</th> </tr> </thead> <tbody> <tr> <td><a href="https://developer.wordpress.org/reference/since/4.9.6/" alt="WordPress 4.9.6">4.9.6</a></td> <td>Introduced.</td> </tr> </tbody> </table> </section>    </div><div class="_attribution">
  <p class="_attribution-p">
    <a href="https://developer.wordpress.org/reference/functions/wp_privacy_delete_old_export_files" class="_attribution-link" target="_blank">https://developer.wordpress.org/reference/functions/wp_privacy_delete_old_export_files</a>
  </p>
</div>
