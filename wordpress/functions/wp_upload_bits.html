<h1>wp_upload_bits( string $name, null|string $deprecated, string $bits, string $time = null )</h1>  <section> <p>Create a file in the upload folder with given content.</p> </section> <div class="content-toc">  <section> <h2 id="description">Description</h2> <p>If there is an error, then the key ‘error’ will exist with the error message. If success, then the key ‘file’ will have the unique file path, the ‘url’ key will have the link to the new file. and the ‘error’ key will be set to false.</p> <p>This function will not move an uploaded file to the upload folder. It will create a new file with the content in $bits parameter. If you move the upload file, read the content of the uploaded file, and then you can give the filename and content to this function, which will add it to the upload folder.</p> <p>The permissions will be set on the new file automatically by this function.</p> </section>  <section> <h2 id="parameters">Parameters</h2> <dl> <dt>$name</dt> <dd> <p class="desc"> <span class="type">(<span class="string">string</span>)</span> <span class="required">(Required)</span> <span class="description">Filename.</span> </p> </dd> <dt>$deprecated</dt> <dd> <p class="desc"> <span class="type">(<span class="null">null</span>|<span class="string">string</span>)</span> <span class="required">(Required)</span> <span class="description">Never used. Set to null.</span> </p> </dd> <dt>$bits</dt> <dd> <p class="desc"> <span class="type">(<span class="string">string</span>)</span> <span class="required">(Required)</span> <span class="description">File content</span> </p> </dd> <dt>$time</dt> <dd> <p class="desc"> <span class="type">(<span class="string">string</span>)</span> <span class="required">(Optional)</span> <span class="description"> Time formatted in 'yyyy/mm'. </span> </p> <p class="default">Default value: null</p> </dd> </dl> </section>  <section> <h2 id="return">Return</h2> <p><span class="return-type">(array)</span> Information about the newly-uploaded file. </p>
<ul class="param-hash">
<li>
<b>'file'</b><br><i><span class="type">(string)</span></i> Filename of the newly-uploaded file.</li> <li>
<b>'url'</b><br><i><span class="type">(string)</span></i> URL of the uploaded file.</li> <li>
<b>'type'</b><br><i><span class="type">(string)</span></i> File type.</li> <li>
<b>'error'</b><br><i><span class="type">(string|false)</span></i> Error message, if there has been an error.</li> </ul> </section>  <section> <h2 id="source">Source</h2> <p> File: <a href="https://developer.wordpress.org/reference/files/wp-includes/functions.php/">wp-includes/functions.php</a> </p> <pre data-language="php">function wp_upload_bits( $name, $deprecated, $bits, $time = null ) {
	if ( ! empty( $deprecated ) ) {
		_deprecated_argument( __FUNCTION__, '2.0.0' );
	}

	if ( empty( $name ) ) {
		return array( 'error' =&gt; __( 'Empty filename' ) );
	}

	$wp_filetype = wp_check_filetype( $name );
	if ( ! $wp_filetype['ext'] &amp;&amp; ! current_user_can( 'unfiltered_upload' ) ) {
		return array( 'error' =&gt; __( 'Sorry, you are not allowed to upload this file type.' ) );
	}

	$upload = wp_upload_dir( $time );

	if ( false !== $upload['error'] ) {
		return $upload;
	}

	/**
	 * Filters whether to treat the upload bits as an error.
	 *
	 * Returning a non-array from the filter will effectively short-circuit preparing the upload bits
	 * and return that value instead. An error message should be returned as a string.
	 *
	 * @since 3.0.0
	 *
	 * @param array|string $upload_bits_error An array of upload bits data, or error message to return.
	 */
	$upload_bits_error = apply_filters(
		'wp_upload_bits',
		array(
			'name' =&gt; $name,
			'bits' =&gt; $bits,
			'time' =&gt; $time,
		)
	);
	if ( ! is_array( $upload_bits_error ) ) {
		$upload['error'] = $upload_bits_error;
		return $upload;
	}

	$filename = wp_unique_filename( $upload['path'], $name );

	$new_file = $upload['path'] . "/$filename";
	if ( ! wp_mkdir_p( dirname( $new_file ) ) ) {
		if ( 0 === strpos( $upload['basedir'], ABSPATH ) ) {
			$error_path = str_replace( ABSPATH, '', $upload['basedir'] ) . $upload['subdir'];
		} else {
			$error_path = wp_basename( $upload['basedir'] ) . $upload['subdir'];
		}

		$message = sprintf(
			/* translators: %s: Directory path. */
			__( 'Unable to create directory %s. Is its parent directory writable by the server?' ),
			$error_path
		);
		return array( 'error' =&gt; $message );
	}

	$ifp = @fopen( $new_file, 'wb' );
	if ( ! $ifp ) {
		return array(
			/* translators: %s: File name. */
			'error' =&gt; sprintf( __( 'Could not write file %s' ), $new_file ),
		);
	}

	fwrite( $ifp, $bits );
	fclose( $ifp );
	clearstatcache();

	// Set correct file permissions.
	$stat  = @ stat( dirname( $new_file ) );
	$perms = $stat['mode'] &amp; 0007777;
	$perms = $perms &amp; 0000666;
	chmod( $new_file, $perms );
	clearstatcache();

	// Compute the URL.
	$url = $upload['url'] . "/$filename";

	if ( is_multisite() ) {
		clean_dirsize_cache( $new_file );
	}

	/** This filter is documented in wp-admin/includes/file.php */
	return apply_filters(
		'wp_handle_upload',
		array(
			'file'  =&gt; $new_file,
			'url'   =&gt; $url,
			'type'  =&gt; $wp_filetype['type'],
			'error' =&gt; false,
		),
		'sideload'
	);
}</pre>  </section>  <section> <h2 id="related">Related</h2> <article class="uses"> <h3 id="uses">Uses</h3> <table id="uses-table">  <thead> <tr> <th>Uses</th> <th class="related-desc">Description</th> </tr> </thead> <tbody> <tr> <td> <span>wp-includes/functions.php:</span> <a href="clean_dirsize_cache">clean_dirsize_cache()</a> </td> <td class="related-desc"> <p>Cleans directory size cache used by <a href="recurse_dirsize">recurse_dirsize()</a>.</p> </td> </tr> <tr> <td> <span>wp-admin/includes/file.php:</span> <a href="../hooks/wp_handle_upload">wp_handle_upload</a> </td> <td class="related-desc"> <p>Filters the data array for the uploaded file.</p> </td> </tr> <tr> <td> <span>wp-includes/capabilities.php:</span> <a href="current_user_can">current_user_can()</a> </td> <td class="related-desc"> <p>Returns whether the current user has the specified capability.</p> </td> </tr> <tr> <td> <span>wp-includes/l10n.php:</span> <a href="__">__()</a> </td> <td class="related-desc"> <p>Retrieve the translation of $text.</p> </td> </tr> <tr> <td> <span>wp-includes/formatting.php:</span> <a href="wp_basename">wp_basename()</a> </td> <td class="related-desc"> <p>i18n-friendly version of basename().</p> </td> </tr> <tr> <td> <span>wp-includes/load.php:</span> <a href="is_multisite">is_multisite()</a> </td> <td class="related-desc"> <p>If Multisite is enabled.</p> </td> </tr> <tr> <td> <span>wp-includes/functions.php:</span> <a href="_deprecated_argument">_deprecated_argument()</a> </td> <td class="related-desc"> <p>Mark a function argument as deprecated and inform when it has been used.</p> </td> </tr> <tr> <td> <span>wp-includes/functions.php:</span> <a href="wp_check_filetype">wp_check_filetype()</a> </td> <td class="related-desc"> <p>Retrieve the file type from the file name.</p> </td> </tr> <tr> <td> <span>wp-includes/functions.php:</span> <a href="../hooks/wp_upload_bits">wp_upload_bits</a> </td> <td class="related-desc"> <p>Filters whether to treat the upload bits as an error.</p> </td> </tr> <tr> <td> <span>wp-includes/functions.php:</span> <a href="wp_upload_dir">wp_upload_dir()</a> </td> <td class="related-desc"> <p>Returns an array containing the current upload directory’s path and URL.</p> </td> </tr> <tr> <td> <span>wp-includes/functions.php:</span> <a href="wp_unique_filename">wp_unique_filename()</a> </td> <td class="related-desc"> <p>Get a filename that is sanitized and unique for the given directory.</p> </td> </tr> <tr> <td> <span>wp-includes/functions.php:</span> <a href="wp_mkdir_p">wp_mkdir_p()</a> </td> <td class="related-desc"> <p>Recursive directory creation based on full path.</p> </td> </tr> <tr> <td> <span>wp-includes/plugin.php:</span> <a href="apply_filters">apply_filters()</a> </td> <td class="related-desc"> <p>Calls the callback functions that have been added to a filter hook.</p> </td> </tr> </tbody>

</table>   </article>  <article class="used-by"> <h3 id="used-by">Used By</h3> <table id="used-by-table">  <thead> <tr> <th>Used By</th> <th class="related-desc">Description</th> </tr> </thead> <tbody> <tr> <td> <span>wp-admin/includes/image.php:</span> <a href="wp_generate_attachment_metadata">wp_generate_attachment_metadata()</a> </td> <td class="related-desc"> <p>Generate attachment meta data and create image sub-sizes for images.</p> </td> </tr> <tr> <td> <span>wp-includes/class-wp-xmlrpc-server.php:</span> <a href="../classes/wp_xmlrpc_server/mw_newmediaobject">wp_xmlrpc_server::mw_newMediaObject()</a> </td> <td class="related-desc"> <p>Uploads a file, following your settings.</p> </td> </tr> </tbody>

</table> </article> </section>  <section> <h2 id="changelog">Changelog</h2> <table>  <thead> <tr> <th class="changelog-version">Version</th> <th class="changelog-desc">Description</th> </tr> </thead> <tbody> <tr> <td><a href="https://developer.wordpress.org/reference/since/2.0.0/" alt="WordPress 2.0.0">2.0.0</a></td> <td>Introduced.</td> </tr> </tbody> </table> </section>    </div><div class="_attribution">
  <p class="_attribution-p">
    <a href="https://developer.wordpress.org/reference/functions/wp_upload_bits" class="_attribution-link" target="_blank">https://developer.wordpress.org/reference/functions/wp_upload_bits</a>
  </p>
</div>
