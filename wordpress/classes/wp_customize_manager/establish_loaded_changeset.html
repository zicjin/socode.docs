<h1>WP_Customize_Manager::establish_loaded_changeset()</h1>  <section> <p>Establishes the loaded changeset.</p> </section> <div class="content-toc">  <section> <h2 id="description">Description</h2> <p>This method runs right at after_setup_theme and applies the ‘customize_changeset_branching’ filter to determine whether concurrent changesets are allowed. Then if the Customizer is not initialized with a <code>changeset_uuid</code> param, this method will determine which UUID should be used. If changeset branching is disabled, then the most saved changeset will be loaded by default. Otherwise, if there are no existing saved changesets or if changeset branching is enabled, then a new UUID will be generated.</p> </section>  <section> <h2 id="source">Source</h2> <p> File: <a href="https://developer.wordpress.org/reference/files/wp-includes/class-wp-customize-manager.php/">wp-includes/class-wp-customize-manager.php</a> </p> <pre data-language="php">public function establish_loaded_changeset() {
		global $pagenow;

		if ( empty( $this-&gt;_changeset_uuid ) ) {
			$changeset_uuid = null;

			if ( ! $this-&gt;branching() &amp;&amp; $this-&gt;is_theme_active() ) {
				$unpublished_changeset_posts = $this-&gt;get_changeset_posts(
					array(
						'post_status'               =&gt; array_diff( get_post_stati(), array( 'auto-draft', 'publish', 'trash', 'inherit', 'private' ) ),
						'exclude_restore_dismissed' =&gt; false,
						'author'                    =&gt; 'any',
						'posts_per_page'            =&gt; 1,
						'order'                     =&gt; 'DESC',
						'orderby'                   =&gt; 'date',
					)
				);
				$unpublished_changeset_post  = array_shift( $unpublished_changeset_posts );
				if ( ! empty( $unpublished_changeset_post ) &amp;&amp; wp_is_uuid( $unpublished_changeset_post-&gt;post_name ) ) {
					$changeset_uuid = $unpublished_changeset_post-&gt;post_name;
				}
			}

			// If no changeset UUID has been set yet, then generate a new one.
			if ( empty( $changeset_uuid ) ) {
				$changeset_uuid = wp_generate_uuid4();
			}

			$this-&gt;_changeset_uuid = $changeset_uuid;
		}

		if ( is_admin() &amp;&amp; 'customize.php' === $pagenow ) {
			$this-&gt;set_changeset_lock( $this-&gt;changeset_post_id() );
		}
	}</pre>  </section>  <section> <h2 id="related">Related</h2> <article class="uses"> <h3 id="uses">Uses</h3> <table id="uses-table">  <thead> <tr> <th>Uses</th> <th class="related-desc">Description</th> </tr> </thead> <tbody> <tr> <td> <span>wp-includes/class-wp-customize-manager.php:</span> <a href="set_changeset_lock">WP_Customize_Manager::set_changeset_lock()</a> </td> <td class="related-desc"> <p>Marks the changeset post as being currently edited by the current user.</p> </td> </tr> <tr> <td> <span>wp-includes/class-wp-customize-manager.php:</span> <a href="get_changeset_posts">WP_Customize_Manager::get_changeset_posts()</a> </td> <td class="related-desc"> <p>Gets changeset posts.</p> </td> </tr> <tr> <td> <span>wp-includes/class-wp-customize-manager.php:</span> <a href="branching">WP_Customize_Manager::branching()</a> </td> <td class="related-desc"> <p>Whether the changeset branching is allowed.</p> </td> </tr> <tr> <td> <span>wp-includes/functions.php:</span> <a href="../../functions/wp_is_uuid">wp_is_uuid()</a> </td> <td class="related-desc"> <p>Validates that a UUID is valid.</p> </td> </tr> <tr> <td> <span>wp-includes/class-wp-customize-manager.php:</span> <a href="changeset_post_id">WP_Customize_Manager::changeset_post_id()</a> </td> <td class="related-desc"> <p>Gets the changeset post ID for the loaded changeset.</p> </td> </tr> <tr> <td> <span>wp-includes/functions.php:</span> <a href="../../functions/wp_generate_uuid4">wp_generate_uuid4()</a> </td> <td class="related-desc"> <p>Generate a random UUID (version 4).</p> </td> </tr> <tr> <td> <span>wp-includes/class-wp-customize-manager.php:</span> <a href="is_theme_active">WP_Customize_Manager::is_theme_active()</a> </td> <td class="related-desc"> <p>Checks if the current theme is active.</p> </td> </tr> <tr> <td> <span>wp-includes/load.php:</span> <a href="../../functions/is_admin">is_admin()</a> </td> <td class="related-desc"> <p>Determines whether the current request is for an administrative interface page.</p> </td> </tr> <tr> <td> <span>wp-includes/post.php:</span> <a href="../../functions/get_post_stati">get_post_stati()</a> </td> <td class="related-desc"> <p>Get a list of post statuses.</p> </td> </tr> </tbody>

</table>   </article>  <article class="used-by"> <h3 id="used-by">Used By</h3> <table id="used-by-table">  <thead> <tr> <th>Used By</th> <th class="related-desc">Description</th> </tr> </thead> <tbody> <tr> <td> <span>wp-includes/class-wp-customize-manager.php:</span> <a href="changeset_uuid">WP_Customize_Manager::changeset_uuid()</a> </td> <td class="related-desc"> <p>Gets the changeset UUID.</p> </td> </tr> </tbody>

</table> </article> </section>  <section> <h2 id="changelog">Changelog</h2> <table>  <thead> <tr> <th class="changelog-version">Version</th> <th class="changelog-desc">Description</th> </tr> </thead> <tbody> <tr> <td><a href="https://developer.wordpress.org/reference/since/4.9.0/" alt="WordPress 4.9.0">4.9.0</a></td> <td>Introduced.</td> </tr> </tbody> </table> </section>    </div><div class="_attribution">
  <p class="_attribution-p">
    <a href="https://developer.wordpress.org/reference/classes/wp_customize_manager/establish_loaded_changeset" class="_attribution-link" target="_blank">https://developer.wordpress.org/reference/classes/wp_customize_manager/establish_loaded_changeset</a>
  </p>
</div>
