<h1>WP_Debug_Data::get_sizes()</h1>  <section> <p>Fetch the sizes of the WordPress directories: <code>wordpress</code> (ABSPATH), <code>plugins</code>, <code>themes</code>, and <code>uploads</code>.</p> </section> <div class="content-toc">  <section> <h2 id="description">Description</h2> <p>Intended to supplement the array returned by <code>WP_Debug_Data::debug_data()</code>.</p> </section>  <section> <h2 id="return">Return</h2> <p><span class="return-type">(array)</span> The sizes of the directories, also the database size and total installation size.</p> </section>  <section> <h2 id="source">Source</h2> <p> File: <a href="https://developer.wordpress.org/reference/files/wp-admin/includes/class-wp-debug-data.php/">wp-admin/includes/class-wp-debug-data.php</a> </p> <pre data-language="php">public static function get_sizes() {
		$size_db    = self::get_database_size();
		$upload_dir = wp_get_upload_dir();

		/*
		 * We will be using the PHP max execution time to prevent the size calculations
		 * from causing a timeout. The default value is 30 seconds, and some
		 * hosts do not allow you to read configuration values.
		 */
		if ( function_exists( 'ini_get' ) ) {
			$max_execution_time = ini_get( 'max_execution_time' );
		}

		// The max_execution_time defaults to 0 when PHP runs from cli.
		// We still want to limit it below.
		if ( empty( $max_execution_time ) ) {
			$max_execution_time = 30;
		}

		if ( $max_execution_time &gt; 20 ) {
			// If the max_execution_time is set to lower than 20 seconds, reduce it a bit to prevent
			// edge-case timeouts that may happen after the size loop has finished running.
			$max_execution_time -= 2;
		}

		// Go through the various installation directories and calculate their sizes.
		// No trailing slashes.
		$paths = array(
			'wordpress_size' =&gt; untrailingslashit( ABSPATH ),
			'themes_size'    =&gt; get_theme_root(),
			'plugins_size'   =&gt; WP_PLUGIN_DIR,
			'uploads_size'   =&gt; $upload_dir['basedir'],
		);

		$exclude = $paths;
		unset( $exclude['wordpress_size'] );
		$exclude = array_values( $exclude );

		$size_total = 0;
		$all_sizes  = array();

		// Loop over all the directories we want to gather the sizes for.
		foreach ( $paths as $name =&gt; $path ) {
			$dir_size = null; // Default to timeout.
			$results  = array(
				'path' =&gt; $path,
				'raw'  =&gt; 0,
			);

			if ( microtime( true ) - WP_START_TIMESTAMP &lt; $max_execution_time ) {
				if ( 'wordpress_size' === $name ) {
					$dir_size = recurse_dirsize( $path, $exclude, $max_execution_time );
				} else {
					$dir_size = recurse_dirsize( $path, null, $max_execution_time );
				}
			}

			if ( false === $dir_size ) {
				// Error reading.
				$results['size']  = __( 'The size cannot be calculated. The directory is not accessible. Usually caused by invalid permissions.' );
				$results['debug'] = 'not accessible';

				// Stop total size calculation.
				$size_total = null;
			} elseif ( null === $dir_size ) {
				// Timeout.
				$results['size']  = __( 'The directory size calculation has timed out. Usually caused by a very large number of sub-directories and files.' );
				$results['debug'] = 'timeout while calculating size';

				// Stop total size calculation.
				$size_total = null;
			} else {
				if ( null !== $size_total ) {
					$size_total += $dir_size;
				}

				$results['raw']   = $dir_size;
				$results['size']  = size_format( $dir_size, 2 );
				$results['debug'] = $results['size'] . " ({$dir_size} bytes)";
			}

			$all_sizes[ $name ] = $results;
		}

		if ( $size_db &gt; 0 ) {
			$database_size = size_format( $size_db, 2 );

			$all_sizes['database_size'] = array(
				'raw'   =&gt; $size_db,
				'size'  =&gt; $database_size,
				'debug' =&gt; $database_size . " ({$size_db} bytes)",
			);
		} else {
			$all_sizes['database_size'] = array(
				'size'  =&gt; __( 'Not available' ),
				'debug' =&gt; 'not available',
			);
		}

		if ( null !== $size_total &amp;&amp; $size_db &gt; 0 ) {
			$total_size    = $size_total + $size_db;
			$total_size_mb = size_format( $total_size, 2 );

			$all_sizes['total_size'] = array(
				'raw'   =&gt; $total_size,
				'size'  =&gt; $total_size_mb,
				'debug' =&gt; $total_size_mb . " ({$total_size} bytes)",
			);
		} else {
			$all_sizes['total_size'] = array(
				'size'  =&gt; __( 'Total size is not available. Some errors were encountered when determining the size of your installation.' ),
				'debug' =&gt; 'not available',
			);
		}

		return $all_sizes;
	}</pre>  </section>  <section> <h2 id="related">Related</h2> <article class="uses"> <h3 id="uses">Uses</h3> <table id="uses-table">  <thead> <tr> <th>Uses</th> <th class="related-desc">Description</th> </tr> </thead> <tbody> <tr> <td> <span>wp-admin/includes/class-wp-debug-data.php:</span> <a href="get_database_size">WP_Debug_Data::get_database_size()</a> </td> <td class="related-desc"> <p>Fetch the total size of all the database tables for the active database user.</p> </td> </tr> <tr> <td> <span>wp-includes/functions.php:</span> <a href="../../functions/wp_get_upload_dir">wp_get_upload_dir()</a> </td> <td class="related-desc"> <p>Retrieves uploads directory information.</p> </td> </tr> <tr> <td> <span>wp-includes/theme.php:</span> <a href="../../functions/get_theme_root">get_theme_root()</a> </td> <td class="related-desc"> <p>Retrieves path to themes directory.</p> </td> </tr> <tr> <td> <span>wp-includes/l10n.php:</span> <a href="../../functions/__">__()</a> </td> <td class="related-desc"> <p>Retrieve the translation of $text.</p> </td> </tr> <tr> <td> <span>wp-includes/formatting.php:</span> <a href="../../functions/untrailingslashit">untrailingslashit()</a> </td> <td class="related-desc"> <p>Removes trailing forward slashes and backslashes if they exist.</p> </td> </tr> <tr> <td> <span>wp-includes/functions.php:</span> <a href="../../functions/size_format">size_format()</a> </td> <td class="related-desc"> <p>Converts a number of bytes to the largest unit the bytes will fit into.</p> </td> </tr> <tr> <td> <span>wp-includes/functions.php:</span> <a href="../../functions/recurse_dirsize">recurse_dirsize()</a> </td> <td class="related-desc"> <p>Get the size of a directory recursively.</p> </td> </tr> </tbody>

</table>   </article>  <article class="used-by"> <h3 id="used-by">Used By</h3> <table id="used-by-table">  <thead> <tr> <th>Used By</th> <th class="related-desc">Description</th> </tr> </thead> <tbody> <tr> <td> <span>wp-includes/rest-api/endpoints/class-wp-rest-site-health-controller.php:</span> <a href="../wp_rest_site_health_controller/get_directory_sizes">WP_REST_Site_Health_Controller::get_directory_sizes()</a> </td> <td class="related-desc"> <p>Gets the current directory sizes for this install.</p> </td> </tr> <tr> <td> <span>wp-admin/includes/ajax-actions.php:</span> <a href="../../functions/wp_ajax_health_check_get_sizes">wp_ajax_health_check_get_sizes()</a> </td> <td class="related-desc"> <p>Ajax handler for site health check to get directories and database sizes.</p> </td> </tr> </tbody>

</table> </article> </section>  <section> <h2 id="changelog">Changelog</h2> <table>  <thead> <tr> <th class="changelog-version">Version</th> <th class="changelog-desc">Description</th> </tr> </thead> <tbody> <tr> <td><a href="https://developer.wordpress.org/reference/since/5.2.0/" alt="WordPress 5.2.0">5.2.0</a></td> <td>Introduced.</td> </tr> </tbody> </table> </section>    </div><div class="_attribution">
  <p class="_attribution-p">
    <a href="https://developer.wordpress.org/reference/classes/wp_debug_data/get_sizes" class="_attribution-link" target="_blank">https://developer.wordpress.org/reference/classes/wp_debug_data/get_sizes</a>
  </p>
</div>
