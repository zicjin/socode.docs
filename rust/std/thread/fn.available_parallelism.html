<h1 class="fqn">Function std::thread::available_parallelism</h1>
<pre class="rust fn" data-language="rust">pub fn available_parallelism() -&gt; Result&lt;NonZeroUsize&gt;</pre>
<div class="item-info"><div class="stab unstable">
<span class="emoji">ðŸ”¬</span> This is a nightly-only experimental API. (<code>available_parallelism</code> <a href="https://github.com/rust-lang/rust/issues/74479">#74479</a>)</div></div>
<p>Returns an estimate of the default amount of parallelism a program should use.</p> <p>Parallelism is a resource. A given machine provides a certain capacity for parallelism, i.e., a bound on the number of computations it can perform simultaneously. This number often corresponds to the amount of CPUs or computer has, but it may diverge in various cases.</p> <p>Host environments such as VMs or container orchestrators may want to restrict the amount of parallelism made available to programs in them. This is often done to limit the potential impact of (unintentionally) resource-intensive programs on other programs running on the same machine.</p> <h3 id="limitations" class="section-header">Limitations</h3> <p>The purpose of this API is to provide an easy and portable way to query the default amount of parallelism the program should use. Among other things it does not expose information on NUMA regions, does not account for differences in (co)processor capabilities, and will not modify the programâ€™s global state in order to more accurately query the amount of available parallelism.</p> <p>Resource limits can be changed during the runtime of a program, therefore the value is not cached and instead recomputed every time this function is called. It should not be called from hot code.</p> <p>The value returned by this function should be considered a simplified approximation of the actual amount of parallelism available at any given time. To get a more detailed or precise overview of the amount of parallelism available to the program, you may wish to use platform-specific APIs as well. The following platform limitations currently apply to <code>available_parallelism</code>:</p> <p>On Windows:</p> <ul> <li>It may undercount the amount of parallelism available on systems with more than 64 logical CPUs. However, programs typically need specific support to take advantage of more than 64 logical CPUs, and in the absence of such support, the number returned by this function accurately reflects the number of logical CPUs the program can use by default.</li> <li>It may overcount the amount of parallelism available on systems limited by process-wide affinity masks, or job object limitations.</li> </ul> <p>On Linux:</p> <ul> <li>It may overcount the amount of parallelism available when limited by a process-wide affinity mask, or when affected by cgroup limits.</li> </ul> <p>On all targets:</p> <ul> <li>It may overcount the amount of parallelism available when running in a VM with CPU usage limits (e.g. an overcommitted host).</li> </ul> <h3 id="errors" class="section-header">Errors</h3> <p>This function will, but is not limited to, return errors in the following cases:</p> <ul> <li>If the amount of parallelism is not known for the target platform.</li> <li>If the program lacks permission to query the amount of parallelism made available to it.</li> </ul> <h3 id="examples" class="section-header">Examples</h3> <div class="example-wrap"><pre class="rust rust-example-rendered" data-language="rust">#![feature(available_parallelism)]
use std::{io, thread};

fn main() -&gt; io::Result&lt;()&gt; {
    let count = thread::available_parallelism()?.get();
    assert!(count &gt;= 1_usize);
    Ok(())
}</pre></div><div class="_attribution">
  <p class="_attribution-p">
    <a href="https://doc.rust-lang.org/std/thread/fn.available_parallelism.html" class="_attribution-link" target="_blank">https://doc.rust-lang.org/std/thread/fn.available_parallelism.html</a>
  </p>
</div>
