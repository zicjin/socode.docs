<h1 id="module-Net::HTTPHeader" class="module"> module Net::HTTPHeader </h1> <section class="description"> <p>The <a href="httpheader"><code>HTTPHeader</code></a> module defines methods for reading and writing <a href="http"><code>HTTP</code></a> headers.</p> <p>It is used as a mixin by other classes, to provide hash-like access to <a href="http"><code>HTTP</code></a> header values. Unlike raw hash access, <a href="httpheader"><code>HTTPHeader</code></a> provides access via case-insensitive keys. It also provides methods for accessing commonly-used <a href="http"><code>HTTP</code></a> header values in more convenient formats.</p> </section> <section id="5Buntitled-5D" class="documentation-section"> <section id="public-instance-5Buntitled-5D-method-details" class="method-section"> <header> <h3>Public Instance Methods</h3> </header> <div class="method-detail "> <div class="method-heading" id="method-i-5B-5D"> <span class="method-name">[]</span><span class="method-args">(key)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="5B-5D-source"> <pre class="ruby" data-language="ruby"># File lib/net/http/header.rb, line 38
def [](key)
  a = @header[key.downcase.to_s] or return nil
  a.join(', ')
end</pre> </div> <p>Returns the header field corresponding to the case-insensitive key. For example, a key of “Content-Type” might return “text/html”</p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-5B-5D-3D"> <span class="method-name">[]=</span><span class="method-args">(key, val)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="5B-5D-3D-source"> <pre class="ruby" data-language="ruby"># File lib/net/http/header.rb, line 44
def []=(key, val)
  unless val
    @header.delete key.downcase.to_s
    return val
  end
  set_field(key, val)
end</pre> </div> <p>Sets the header field corresponding to the case-insensitive key.</p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-add_field"> <span class="method-name">add_field</span><span class="method-args">(key, val)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="add_field-source"> <pre class="ruby" data-language="ruby"># File lib/net/http/header.rb, line 67
def add_field(key, val)
  stringified_downcased_key = key.downcase.to_s
  if @header.key?(stringified_downcased_key)
    append_field_value(@header[stringified_downcased_key], val)
  else
    set_field(key, val)
  end
end</pre> </div> <dl class="rdoc-list label-list">
<dt>Ruby 1.8.3 </dt>
<dd> <p>Adds a value to a named header field, instead of replacing its value. Second argument <code>val</code> must be a <a href="../string"><code>String</code></a>. See also <a href="httpheader#method-i-5B-5D-3D"><code>[]=</code></a>, <a href="httpheader#method-i-5B-5D"><code>[]</code></a> and <a href="httpheader#method-i-get_fields"><code>get_fields</code></a>.</p> <pre class="ruby" data-language="ruby">request.add_field 'X-My-Header', 'a'
p request['X-My-Header']              #=&gt; "a"
p request.get_fields('X-My-Header')   #=&gt; ["a"]
request.add_field 'X-My-Header', 'b'
p request['X-My-Header']              #=&gt; "a, b"
p request.get_fields('X-My-Header')   #=&gt; ["a", "b"]
request.add_field 'X-My-Header', 'c'
p request['X-My-Header']              #=&gt; "a, b, c"
p request.get_fields('X-My-Header')   #=&gt; ["a", "b", "c"]
</pre> </dd>
</dl>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-basic_auth"> <span class="method-name">basic_auth</span><span class="method-args">(account, password)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="basic_auth-source"> <pre class="ruby" data-language="ruby"># File lib/net/http/header.rb, line 488
def basic_auth(account, password)
  @header['authorization'] = [basic_encode(account, password)]
end</pre> </div> <p><a href="../set"><code>Set</code></a> the Authorization: header for “Basic” authorization.</p>  </div> </div> <div class="method-detail method-alias"> <div class="method-heading" id="method-i-canonical_each"> <span class="method-name">canonical_each</span><span class="method-args">()</span> </div>  <div class="aliases"> Alias for: <a href="httpheader#method-i-each_capitalized">each_capitalized</a> </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-chunked-3F"> <span class="method-name">chunked?</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="chunked-3F-source"> <pre class="ruby" data-language="ruby"># File lib/net/http/header.rb, line 329
def chunked?
  return false unless @header['transfer-encoding']
  field = self['Transfer-Encoding']
  (/(?:\A|[^\-\w])chunked(?![\-\w])/i =~ field) ? true : false
end</pre> </div> <p>Returns “true” if the “transfer-encoding” header is present and set to “chunked”. This is an HTTP/1.1 feature, allowing the content to be sent in “chunks” without at the outset stating the entire content length.</p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-connection_close-3F"> <span class="method-name">connection_close?</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="connection_close-3F-source"> <pre class="ruby" data-language="ruby"># File lib/net/http/header.rb, line 502
def connection_close?
  token = /(?:\A|,)\s*close\s*(?:\z|,)/i
  @header['connection']&amp;.grep(token) {return true}
  @header['proxy-connection']&amp;.grep(token) {return true}
  false
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-connection_keep_alive-3F"> <span class="method-name">connection_keep_alive?</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="connection_keep_alive-3F-source"> <pre class="ruby" data-language="ruby"># File lib/net/http/header.rb, line 509
def connection_keep_alive?
  token = /(?:\A|,)\s*keep-alive\s*(?:\z|,)/i
  @header['connection']&amp;.grep(token) {return true}
  @header['proxy-connection']&amp;.grep(token) {return true}
  false
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-content_length"> <span class="method-name">content_length</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="content_length-source"> <pre class="ruby" data-language="ruby"># File lib/net/http/header.rb, line 310
def content_length
  return nil unless key?('Content-Length')
  len = self['Content-Length'].slice(/\d+/) or
      raise Net::HTTPHeaderSyntaxError, 'wrong Content-Length format'
  len.to_i
end</pre> </div> <p>Returns an <a href="../integer"><code>Integer</code></a> object which represents the <a href="http"><code>HTTP</code></a> Content-Length: header field, or <code>nil</code> if that field was not provided.</p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-content_length-3D"> <span class="method-name">content_length=</span><span class="method-args">(len)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="content_length-3D-source"> <pre class="ruby" data-language="ruby"># File lib/net/http/header.rb, line 317
def content_length=(len)
  unless len
    @header.delete 'content-length'
    return nil
  end
  @header['content-length'] = [len.to_i.to_s]
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-content_range"> <span class="method-name">content_range</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="content_range-source"> <pre class="ruby" data-language="ruby"># File lib/net/http/header.rb, line 339
def content_range
  return nil unless @header['content-range']
  m = %r&lt;bytes\s+(\d+)-(\d+)/(\d+|\*)&gt;i.match(self['Content-Range']) or
      raise Net::HTTPHeaderSyntaxError, 'wrong Content-Range format'
  m[1].to_i .. m[2].to_i
end</pre> </div> <p>Returns a <a href="../range"><code>Range</code></a> object which represents the value of the Content-Range: header field. For a partial entity body, this indicates where this fragment fits inside the full entity body, as range of byte offsets.</p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-content_type"> <span class="method-name">content_type</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="content_type-source"> <pre class="ruby" data-language="ruby"># File lib/net/http/header.rb, line 354
def content_type
  return nil unless main_type()
  if sub_type()
  then "#{main_type()}/#{sub_type()}"
  else main_type()
  end
end</pre> </div> <p>Returns a content type string such as “text/html”. This method returns nil if Content-Type: header field does not exist.</p>  </div> </div> <div class="method-detail method-alias"> <div class="method-heading" id="method-i-content_type-3D"> <span class="method-name">content_type=</span><span class="method-args">(type, params = {})</span> </div>  <div class="aliases"> Alias for: <a href="httpheader#method-i-set_content_type">set_content_type</a> </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-delete"> <span class="method-name">delete</span><span class="method-args">(key)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="delete-source"> <pre class="ruby" data-language="ruby"># File lib/net/http/header.rb, line 186
def delete(key)
  @header.delete(key.downcase.to_s)
end</pre> </div> <p>Removes a header field, specified by case-insensitive key.</p>  </div> </div> <div class="method-detail method-alias"> <div class="method-heading" id="method-i-each"> <span class="method-name">each</span><span class="method-args">()</span> </div>  <div class="aliases"> Alias for: <a href="httpheader#method-i-each_header">each_header</a> </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-each_capitalized"> <span class="method-name">each_capitalized</span><span class="method-args">() { |capitalize(k), join(', ')| ... }</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="each_capitalized-source"> <pre class="ruby" data-language="ruby"># File lib/net/http/header.rb, line 211
def each_capitalized
  block_given? or return enum_for(__method__) { @header.size }
  @header.each do |k,v|
    yield capitalize(k), v.join(', ')
  end
end</pre> </div> <p>As for <a href="httpheader#method-i-each_header"><code>each_header</code></a>, except the keys are provided in capitalized form.</p> <p>Note that header names are capitalized systematically; capitalization may not match that used by the remote <a href="http"><code>HTTP</code></a> server in its response.</p> <p>Returns an enumerator if no block is given.</p>  </div> <div class="aliases"> Also aliased as: <a href="httpheader#method-i-canonical_each">canonical_each</a> </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-each_capitalized_name"> <span class="method-name">each_capitalized_name</span><span class="method-args">() { |key| ... }</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="each_capitalized_name-source"> <pre class="ruby" data-language="ruby"># File lib/net/http/header.rb, line 167
def each_capitalized_name  #:yield: +key+
  block_given? or return enum_for(__method__) { @header.size }
  @header.each_key do |k|
    yield capitalize(k)
  end
end</pre> </div> <p>Iterates through the header names in the header, passing capitalized header names to the code block.</p> <p>Note that header names are capitalized systematically; capitalization may not match that used by the remote <a href="http"><code>HTTP</code></a> server in its response.</p> <p>Returns an enumerator if no block is given.</p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-each_header"> <span class="method-name">each_header</span><span class="method-args">() { |key| ... }</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="each_header-source"> <pre class="ruby" data-language="ruby"># File lib/net/http/header.rb, line 139
def each_header   #:yield: +key+, +value+
  block_given? or return enum_for(__method__) { @header.size }
  @header.each do |k,va|
    yield k, va.join(', ')
  end
end</pre> </div> <p>Iterates through the header names and values, passing in the name and value to the code block supplied.</p> <p>Returns an enumerator if no block is given.</p> <p>Example:</p> <pre class="ruby" data-language="ruby">response.header.each_header {|key,value| puts "#{key} = #{value}" }
</pre>  </div> <div class="aliases"> Also aliased as: <a href="httpheader#method-i-each">each</a> </div> </div> <div class="method-detail method-alias"> <div class="method-heading" id="method-i-each_key"> <span class="method-name">each_key</span><span class="method-args">()</span> </div>  <div class="aliases"> Alias for: <a href="httpheader#method-i-each_name">each_name</a> </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-each_name"> <span class="method-name">each_name</span><span class="method-args">() { |key| ... }</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="each_name-source"> <pre class="ruby" data-language="ruby"># File lib/net/http/header.rb, line 152
def each_name(&amp;block)   #:yield: +key+
  block_given? or return enum_for(__method__) { @header.size }
  @header.each_key(&amp;block)
end</pre> </div> <p>Iterates through the header names in the header, passing each header name to the code block.</p> <p>Returns an enumerator if no block is given.</p>  </div> <div class="aliases"> Also aliased as: <a href="httpheader#method-i-each_key">each_key</a> </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-each_value"> <span class="method-name">each_value</span><span class="method-args">() { |value| ... }</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="each_value-source"> <pre class="ruby" data-language="ruby"># File lib/net/http/header.rb, line 178
def each_value   #:yield: +value+
  block_given? or return enum_for(__method__) { @header.size }
  @header.each_value do |va|
    yield va.join(', ')
  end
end</pre> </div> <p>Iterates through header values, passing each value to the code block.</p> <p>Returns an enumerator if no block is given.</p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-fetch"> <span class="method-name">fetch</span><span class="method-args">(key, *args) { |key| ... }</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="fetch-source"> <pre class="ruby" data-language="ruby"># File lib/net/http/header.rb, line 125
def fetch(key, *args, &amp;block)   #:yield: +key+
  a = @header.fetch(key.downcase.to_s, *args, &amp;block)
  a.kind_of?(Array) ? a.join(', ') : a
end</pre> </div> <p>Returns the header field corresponding to the case-insensitive key. Returns the default value <code>args</code>, or the result of the block, or raises an <a href="../indexerror"><code>IndexError</code></a> if there’s no header field named <code>key</code> See <a href="../hash#method-i-fetch"><code>Hash#fetch</code></a></p>  </div> </div> <div class="method-detail method-alias"> <div class="method-heading" id="method-i-form_data-3D"> <span class="method-name">form_data=</span><span class="method-args">(params, sep = '&amp;')</span> </div>  <div class="aliases"> Alias for: <a href="httpheader#method-i-set_form_data">set_form_data</a> </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-get_fields"> <span class="method-name">get_fields</span><span class="method-args">(key)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="get_fields-source"> <pre class="ruby" data-language="ruby"># File lib/net/http/header.rb, line 115
def get_fields(key)
  stringified_downcased_key = key.downcase.to_s
  return nil unless @header[stringified_downcased_key]
  @header[stringified_downcased_key].dup
end</pre> </div> <dl class="rdoc-list label-list">
<dt>Ruby 1.8.3 </dt>
<dd> <p>Returns an array of header field strings corresponding to the case-insensitive <code>key</code>. This method allows you to get duplicated header fields without any processing. See also <a href="httpheader#method-i-5B-5D"><code>[]</code></a>.</p> <pre>p response.get_fields('Set-Cookie')
  #=&gt; ["session=al98axx; expires=Fri, 31-Dec-1999 23:58:23",
       "query=rubyscript; expires=Fri, 31-Dec-1999 23:58:23"]
p response['Set-Cookie']
  #=&gt; "session=al98axx; expires=Fri, 31-Dec-1999 23:58:23, query=rubyscript; expires=Fri, 31-Dec-1999 23:58:23"</pre> </dd>
</dl>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-initialize_http_header"> <span class="method-name">initialize_http_header</span><span class="method-args">(initheader)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="initialize_http_header-source"> <pre class="ruby" data-language="ruby"># File lib/net/http/header.rb, line 13
def initialize_http_header(initheader)
  @header = {}
  return unless initheader
  initheader.each do |key, value|
    warn "net/http: duplicated HTTP header: #{key}", uplevel: 3 if key?(key) and $VERBOSE
    if value.nil?
      warn "net/http: nil HTTP header: #{key}", uplevel: 3 if $VERBOSE
    else
      value = value.strip # raise error for invalid byte sequences
      if value.count("\r\n") &gt; 0
        raise ArgumentError, "header #{key} has field value #{value.inspect}, this cannot include CR/LF"
      end
      @header[key.downcase.to_s] = [value]
    end
  end
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-key-3F"> <span class="method-name">key?</span><span class="method-args">(key)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="key-3F-source"> <pre class="ruby" data-language="ruby"># File lib/net/http/header.rb, line 191
def key?(key)
  @header.key?(key.downcase.to_s)
end</pre> </div> <p>true if <code>key</code> header exists.</p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-main_type"> <span class="method-name">main_type</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="main_type-source"> <pre class="ruby" data-language="ruby"># File lib/net/http/header.rb, line 364
def main_type
  return nil unless @header['content-type']
  self['Content-Type'].split(';').first.to_s.split('/')[0].to_s.strip
end</pre> </div> <p>Returns a content type string such as “text”. This method returns nil if Content-Type: header field does not exist.</p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-proxy_basic_auth"> <span class="method-name">proxy_basic_auth</span><span class="method-args">(account, password)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="proxy_basic_auth-source"> <pre class="ruby" data-language="ruby"># File lib/net/http/header.rb, line 493
def proxy_basic_auth(account, password)
  @header['proxy-authorization'] = [basic_encode(account, password)]
end</pre> </div> <p><a href="../set"><code>Set</code></a> Proxy-Authorization: header for “Basic” authorization.</p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-range"> <span class="method-name">range</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="range-source"> <pre class="ruby" data-language="ruby"># File lib/net/http/header.rb, line 227
def range
  return nil unless @header['range']

  value = self['Range']
  # byte-range-set = *( "," OWS ) ( byte-range-spec / suffix-byte-range-spec )
  #   *( OWS "," [ OWS ( byte-range-spec / suffix-byte-range-spec ) ] )
  # corrected collected ABNF
  # http://tools.ietf.org/html/draft-ietf-httpbis-p5-range-19#section-5.4.1
  # http://tools.ietf.org/html/draft-ietf-httpbis-p5-range-19#appendix-C
  # http://tools.ietf.org/html/draft-ietf-httpbis-p1-messaging-19#section-3.2.5
  unless /\Abytes=((?:,[ \t]*)*(?:\d+-\d*|-\d+)(?:[ \t]*,(?:[ \t]*\d+-\d*|-\d+)?)*)\z/ =~ value
    raise Net::HTTPHeaderSyntaxError, "invalid syntax for byte-ranges-specifier: '#{value}'"
  end

  byte_range_set = $1
  result = byte_range_set.split(/,/).map {|spec|
    m = /(\d+)?\s*-\s*(\d+)?/i.match(spec) or
            raise Net::HTTPHeaderSyntaxError, "invalid byte-range-spec: '#{spec}'"
    d1 = m[1].to_i
    d2 = m[2].to_i
    if m[1] and m[2]
      if d1 &gt; d2
        raise Net::HTTPHeaderSyntaxError, "last-byte-pos MUST greater than or equal to first-byte-pos but '#{spec}'"
      end
      d1..d2
    elsif m[1]
      d1..-1
    elsif m[2]
      -d2..-1
    else
      raise Net::HTTPHeaderSyntaxError, 'range is not specified'
    end
  }
  # if result.empty?
  # byte-range-set must include at least one byte-range-spec or suffix-byte-range-spec
  # but above regexp already denies it.
  if result.size == 1 &amp;&amp; result[0].begin == 0 &amp;&amp; result[0].end == -1
    raise Net::HTTPHeaderSyntaxError, 'only one suffix-byte-range-spec with zero suffix-length'
  end
  result
end</pre> </div> <p>Returns an <a href="../array"><code>Array</code></a> of <a href="../range"><code>Range</code></a> objects which represent the Range: <a href="http"><code>HTTP</code></a> header field, or <code>nil</code> if there is no such header.</p>  </div> </div> <div class="method-detail method-alias"> <div class="method-heading" id="method-i-range-3D"> <span class="method-name">range=</span><span class="method-args">(r, e = nil)</span> </div>  <div class="aliases"> Alias for: <a href="httpheader#method-i-set_range">set_range</a> </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-range_length"> <span class="method-name">range_length</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="range_length-source"> <pre class="ruby" data-language="ruby"># File lib/net/http/header.rb, line 347
def range_length
  r = content_range() or return nil
  r.end - r.begin + 1
end</pre> </div> <p>The length of the range represented in Content-Range: header.</p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-set_content_type"> <span class="method-name">set_content_type</span><span class="method-args">(type, params = {})</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="set_content_type-source"> <pre class="ruby" data-language="ruby"># File lib/net/http/header.rb, line 397
def set_content_type(type, params = {})
  @header['content-type'] = [type + params.map{|k,v|"; #{k}=#{v}"}.join('')]
end</pre> </div> <p>Sets the content type in an <a href="http"><code>HTTP</code></a> header. The <code>type</code> should be a full <a href="http"><code>HTTP</code></a> content type, e.g. “text/html”. The <code>params</code> are an optional <a href="../hash"><code>Hash</code></a> of parameters to add after the content type, e.g. {‘charset’ =&gt; ‘iso-8859-1’}</p>  </div> <div class="aliases"> Also aliased as: <a href="httpheader#method-i-content_type-3D">content_type=</a> </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-set_form"> <span class="method-name">set_form</span><span class="method-args">(params, enctype='application/x-www-form-urlencoded', formopt={})</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="set_form-source"> <pre class="ruby" data-language="ruby"># File lib/net/http/header.rb, line 473
def set_form(params, enctype='application/x-www-form-urlencoded', formopt={})
  @body_data = params
  @body = nil
  @body_stream = nil
  @form_option = formopt
  case enctype
  when /\Aapplication\/x-www-form-urlencoded\z/i,
    /\Amultipart\/form-data\z/i
    self.content_type = enctype
  else
    raise ArgumentError, "invalid enctype: #{enctype}"
  end
end</pre> </div> <p><a href="../set"><code>Set</code></a> an HTML form data set.</p> <dl class="rdoc-list note-list">
<dt>
<code>params</code> </dt>
<dd> <p>The form data to set, which should be an enumerable. See below for more details.</p> </dd>
<dt>
<code>enctype</code> </dt>
<dd> <p>The content type to use to encode the form submission, which should be application/x-www-form-urlencoded or multipart/form-data.</p> </dd>
<dt>
<code>formopt</code> </dt>
<dd> <p>An options hash, supporting the following options:</p> <dl class="rdoc-list note-list">
<dt>:boundary </dt>
<dd> <p>The boundary of the multipart message. If not given, a random boundary will be used.</p> </dd>
<dt>:charset </dt>
<dd> <p>The charset of the form submission. All field names and values of non-file fields should be encoded with this charset.</p> </dd>
</dl> </dd>
</dl> <p>Each item of params should respond to <code>each</code> and yield 2-3 arguments, or an array of 2-3 elements. The arguments yielded should be:</p> <pre>* The name of the field.
* The value of the field, it should be a String or a File or IO-like.
* An options hash, supporting the following options, only
  used for file uploads:
  :filename :: The name of the file to use.
  :content_type :: The content type of the uploaded file.</pre> <p>Each item is a file field or a normal field. If <code>value</code> is a <a href="../file"><code>File</code></a> object or the <code>opt</code> hash has a :filename key, the item is treated as a file field.</p> <p>If Transfer-Encoding is set as chunked, this sends the request using chunked encoding. Because chunked encoding is HTTP/1.1 feature, you should confirm that the server supports HTTP/1.1 before using chunked encoding.</p> <p>Example:</p> <pre class="ruby" data-language="ruby">req.set_form([["q", "ruby"], ["lang", "en"]])

req.set_form({"f"=&gt;File.open('/path/to/filename')},
             "multipart/form-data",
             charset: "UTF-8",
)

req.set_form([["f",
               File.open('/path/to/filename.bar'),
               {filename: "other-filename.foo"}
             ]],
             "multipart/form-data",
)
</pre> <p>See also RFC 2388, RFC 2616, HTML 4.01, and HTML5</p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-set_form_data"> <span class="method-name">set_form_data</span><span class="method-args">(params, sep = '&amp;')</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="set_form_data-source"> <pre class="ruby" data-language="ruby"># File lib/net/http/header.rb, line 416
def set_form_data(params, sep = '&amp;')
  query = URI.encode_www_form(params)
  query.gsub!(/&amp;/, sep) if sep != '&amp;'
  self.body = query
  self.content_type = 'application/x-www-form-urlencoded'
end</pre> </div> <p><a href="../set"><code>Set</code></a> header fields and a body from HTML form data. <code>params</code> should be an <a href="../array"><code>Array</code></a> of Arrays or a <a href="../hash"><code>Hash</code></a> containing HTML form data. Optional argument <code>sep</code> means data record separator.</p> <p>Values are URL encoded as necessary and the content-type is set to application/x-www-form-urlencoded</p> <p>Example:</p> <pre class="ruby" data-language="ruby">http.form_data = {"q" =&gt; "ruby", "lang" =&gt; "en"}
http.form_data = {"q" =&gt; ["ruby", "perl"], "lang" =&gt; "en"}
http.set_form_data({"q" =&gt; "ruby", "lang" =&gt; "en"}, ';')
</pre>  </div> <div class="aliases"> Also aliased as: <a href="httpheader#method-i-form_data-3D">form_data=</a> </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-set_range"> <span class="method-name">set_range</span><span class="method-args">(r, e = nil)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="set_range-source"> <pre class="ruby" data-language="ruby"># File lib/net/http/header.rb, line 277
def set_range(r, e = nil)
  unless r
    @header.delete 'range'
    return r
  end
  r = (r...r+e) if e
  case r
  when Numeric
    n = r.to_i
    rangestr = (n &gt; 0 ? "0-#{n-1}" : "-#{-n}")
  when Range
    first = r.first
    last = r.end
    last -= 1 if r.exclude_end?
    if last == -1
      rangestr = (first &gt; 0 ? "#{first}-" : "-#{-first}")
    else
      raise Net::HTTPHeaderSyntaxError, 'range.first is negative' if first &lt; 0
      raise Net::HTTPHeaderSyntaxError, 'range.last is negative' if last &lt; 0
      raise Net::HTTPHeaderSyntaxError, 'must be .first &lt; .last' if first &gt; last
      rangestr = "#{first}-#{last}"
    end
  else
    raise TypeError, 'Range/Integer is required'
  end
  @header['range'] = ["bytes=#{rangestr}"]
  r
end</pre> </div> <p>Sets the <a href="http"><code>HTTP</code></a> Range: header. Accepts either a <a href="../range"><code>Range</code></a> object as a single argument, or a beginning index and a length from that index. Example:</p> <pre class="ruby" data-language="ruby">req.range = (0..1023)
req.set_range 0, 1023
</pre>  </div> <div class="aliases"> Also aliased as: <a href="httpheader#method-i-range-3D">range=</a> </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-sub_type"> <span class="method-name">sub_type</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="sub_type-source"> <pre class="ruby" data-language="ruby"># File lib/net/http/header.rb, line 372
def sub_type
  return nil unless @header['content-type']
  _, sub = *self['Content-Type'].split(';').first.to_s.split('/')
  return nil unless sub
  sub.strip
end</pre> </div> <p>Returns a content type string such as “html”. This method returns nil if Content-Type: header field does not exist or sub-type is not given (e.g. “Content-Type: text”).</p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-to_hash"> <span class="method-name">to_hash</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="to_hash-source"> <pre class="ruby" data-language="ruby"># File lib/net/http/header.rb, line 200
def to_hash
  @header.dup
end</pre> </div> <p>Returns a <a href="../hash"><code>Hash</code></a> consisting of header names and array of values. e.g. {“cache-control” =&gt; [“private”],</p> <pre>"content-type" =&gt; ["text/html"],
"date" =&gt; ["Wed, 22 Jun 2005 22:11:50 GMT"]}</pre>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-type_params"> <span class="method-name">type_params</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="type_params-source"> <pre class="ruby" data-language="ruby"># File lib/net/http/header.rb, line 382
def type_params
  result = {}
  list = self['Content-Type'].to_s.split(';')
  list.shift
  list.each do |param|
    k, v = *param.split('=', 2)
    result[k.strip] = v.strip
  end
  result
end</pre> </div> <p>Any parameters specified for the content type, returned as a <a href="../hash"><code>Hash</code></a>. For example, a header of Content-Type: text/html; charset=EUC-JP would result in <a href="httpheader#method-i-type_params"><code>type_params</code></a> returning {‘charset’ =&gt; ‘EUC-JP’}</p>  </div> </div> </section> <section id="private-instance-5Buntitled-5D-method-details" class="method-section"> <header> <h3>Private Instance Methods</h3> </header> <div class="method-detail "> <div class="method-heading" id="method-i-append_field_value"> <span class="method-name">append_field_value</span><span class="method-args">(ary, val)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="append_field_value-source"> <pre class="ruby" data-language="ruby"># File lib/net/http/header.rb, line 91
        def append_field_value(ary, val)
  case val
  when Enumerable
    val.each{|x| append_field_value(ary, x)}
  else
    val = val.to_s
    if /[\r\n]/n.match?(val.b)
      raise ArgumentError, 'header field value cannot include CR/LF'
    end
    ary.push val
  end
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-basic_encode"> <span class="method-name">basic_encode</span><span class="method-args">(account, password)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="basic_encode-source"> <pre class="ruby" data-language="ruby"># File lib/net/http/header.rb, line 497
def basic_encode(account, password)
  'Basic ' + ["#{account}:#{password}"].pack('m0')
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-capitalize"> <span class="method-name">capitalize</span><span class="method-args">(name)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="capitalize-source"> <pre class="ruby" data-language="ruby"># File lib/net/http/header.rb, line 220
def capitalize(name)
  name.to_s.split(/-/).map {|s| s.capitalize }.join('-')
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-set_field"> <span class="method-name">set_field</span><span class="method-args">(key, val)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="set_field-source"> <pre class="ruby" data-language="ruby"># File lib/net/http/header.rb, line 76
        def set_field(key, val)
  case val
  when Enumerable
    ary = []
    append_field_value(ary, val)
    @header[key.downcase.to_s] = ary
  else
    val = val.to_s # for compatibility use to_s instead of to_str
    if val.b.count("\r\n") &gt; 0
      raise ArgumentError, 'header field value cannot include CR/LF'
    end
    @header[key.downcase.to_s] = [val]
  end
end</pre> </div>  </div> </div> </section> </section><div class="_attribution">
  <p class="_attribution-p">
    Ruby Core &copy; 1993&ndash;2022 Yukihiro Matsumoto<br>Licensed under the Ruby License.<br>Ruby Standard Library &copy; contributors<br>Licensed under their own licenses.<br>
    
  </p>
</div>
