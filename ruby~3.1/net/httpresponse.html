<h1 id="class-Net::HTTPResponse" class="class"> class Net::HTTPResponse </h1>
<dl class="meta">
<dt>Parent:</dt>
<dd class="meta-parent"><a href="../object">Object</a></dd>
<dt>Included modules:</dt>
<dd class="meta-includes"><a class="include" href="httpheader">Net::HTTPHeader</a></dd>
</dl> <section class="description"> <p>HTTP response class.</p> <p>This class wraps together the response header and the response body (the entity requested).</p> <p>It mixes in the HTTPHeader module, which provides access to response header values both via hash-like methods and via individual readers.</p> <p>Note that each possible HTTP response code defines its own <a href="httpresponse"><code>HTTPResponse</code></a> subclass. All classes are defined under the <a href="../net"><code>Net</code></a> module. Indentation indicates inheritance. For a list of the classes see <a href="http"><code>Net::HTTP</code></a>.</p> <p>Correspondence <code>HTTP code =&gt; class</code> is stored in <a href="httpresponse#CODE_TO_OBJ"><code>CODE_TO_OBJ</code></a> constant:</p> <pre class="ruby" data-language="ruby">Net::HTTPResponse::CODE_TO_OBJ['404'] #=&gt; Net::HTTPNotFound
</pre> </section> <section id="5Buntitled-5D" class="documentation-section"> <section class="constants-list"> <header> <h3>Constants</h3> </header> <dl> <dt id="CODE_CLASS_TO_OBJ">CODE_CLASS_TO_OBJ </dt>

<dt id="CODE_TO_OBJ">CODE_TO_OBJ </dt>

</dl> </section> <section class="attribute-method-details"> <header> <h3>Attributes</h3> </header> <div class="method-detail"> <div class="method-heading attribute-method-heading" id="attribute-i-code"> <span class="method-name">code</span><span class="attribute-access-type">[R]</span> </div> <div class="method-description"> <p>The HTTP result code string. For example, ‘302’. You can also determine the response type by examining which response subclass the response object is an instance of.</p> </div> </div> <div class="method-detail"> <div class="method-heading attribute-method-heading" id="attribute-i-decode_content"> <span class="method-name">decode_content</span><span class="attribute-access-type">[RW]</span> </div> <div class="method-description"> <p><a href="../set"><code>Set</code></a> to true automatically when the request did not contain an Accept-Encoding header from the user.</p> </div> </div> <div class="method-detail"> <div class="method-heading attribute-method-heading" id="attribute-i-http_version"> <span class="method-name">http_version</span><span class="attribute-access-type">[R]</span> </div> <div class="method-description"> <p>The HTTP version supported by the server.</p> </div> </div> <div class="method-detail"> <div class="method-heading attribute-method-heading" id="attribute-i-message"> <span class="method-name">message</span><span class="attribute-access-type">[R]</span> </div> <div class="method-description"> <p>The HTTP result message sent by the server. For example, ‘Not Found’.</p> </div> </div> <div class="method-detail"> <div class="method-heading attribute-method-heading" id="attribute-i-msg"> <span class="method-name">msg</span><span class="attribute-access-type">[R]</span> </div> <div class="method-description"> <p>The HTTP result message sent by the server. For example, ‘Not Found’.</p> </div> </div> <div class="method-detail"> <div class="method-heading attribute-method-heading" id="attribute-i-uri"> <span class="method-name">uri</span><span class="attribute-access-type">[R]</span> </div> <div class="method-description"> <p>The <a href="../uri"><code>URI</code></a> used to fetch this response. The response <a href="../uri"><code>URI</code></a> is only available if a <a href="../uri"><code>URI</code></a> was used to create the request.</p> </div> </div> </section> <section id="public-class-5Buntitled-5D-method-details" class="method-section"> <header> <h3>Public Class Methods</h3> </header> <div class="method-detail "> <div class="method-heading" id="method-c-body_permitted-3F"> <span class="method-name">body_permitted?</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="body_permitted-3F-source"> <pre class="ruby" data-language="ruby"># File lib/net/http/response.rb, line 22
def body_permitted?
  self::HAS_BODY
end</pre> </div> <p>true if the response has a body.</p>  </div> </div> </section> <section id="private-class-5Buntitled-5D-method-details" class="method-section"> <header> <h3>Private Class Methods</h3> </header> <div class="method-detail "> <div class="method-heading" id="method-c-each_response_header"> <span class="method-name">each_response_header</span><span class="method-args">(sock) { |key, value| ... }</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="each_response_header-source"> <pre class="ruby" data-language="ruby"># File lib/net/http/response.rb, line 54
def each_response_header(sock)
  key = value = nil
  while true
    line = sock.readuntil("\n", true).sub(/\s+\z/, '')
    break if line.empty?
    if line[0] == ?\s or line[0] == ?\t and value
      value &lt;&lt; ' ' unless value.empty?
      value &lt;&lt; line.strip
    else
      yield key, value if key
      key, value = line.strip.split(/\s*:\s*/, 2)
      raise Net::HTTPBadResponse, 'wrong header line format' if value.nil?
    end
  end
  yield key, value if key
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-c-read_status_line"> <span class="method-name">read_status_line</span><span class="method-args">(sock)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="read_status_line-source"> <pre class="ruby" data-language="ruby"># File lib/net/http/response.rb, line 41
def read_status_line(sock)
  str = sock.readline
  m = /\AHTTP(?:\/(\d+\.\d+))?\s+(\d\d\d)(?:\s+(.*))?\z/in.match(str) or
    raise Net::HTTPBadResponse, "wrong status line: #{str.dump}"
  m.captures
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-c-response_class"> <span class="method-name">response_class</span><span class="method-args">(code)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="response_class-source"> <pre class="ruby" data-language="ruby"># File lib/net/http/response.rb, line 48
def response_class(code)
  CODE_TO_OBJ[code] or
  CODE_CLASS_TO_OBJ[code[0,1]] or
  Net::HTTPUnknownResponse
end</pre> </div>  </div> </div> </section> <section id="public-instance-5Buntitled-5D-method-details" class="method-section"> <header> <h3>Public Instance Methods</h3> </header> <div class="method-detail "> <div class="method-heading" id="method-i-body"> <span class="method-name">body</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="body-source"> <pre class="ruby" data-language="ruby"># File lib/net/http/response.rb, line 234
def body
  read_body()
end</pre> </div> <p>Returns the full entity body.</p> <p>Calling this method a second or subsequent time will return the string already read.</p> <pre class="ruby" data-language="ruby">http.request_get('/index.html') {|res|
  puts res.body
}

http.request_get('/index.html') {|res|
  p res.body.object_id   # 538149362
  p res.body.object_id   # 538149362
}
</pre>  </div> <div class="aliases"> Also aliased as: <a href="httpresponse#method-i-entity">entity</a> </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-body-3D"> <span class="method-name">body=</span><span class="method-args">(value)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="body-3D-source"> <pre class="ruby" data-language="ruby"># File lib/net/http/response.rb, line 240
def body=(value)
  @body = value
end</pre> </div> <p>Because it may be necessary to modify the body, Eg, decompression this method facilitates that.</p>  </div> </div> <div class="method-detail method-alias"> <div class="method-heading" id="method-i-entity"> <span class="method-name">entity</span><span class="method-args">()</span> </div>  <div class="aliases"> Alias for: <a href="httpresponse#method-i-body">body</a> </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-inspect"> <span class="method-name">inspect</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="inspect-source"> <pre class="ruby" data-language="ruby"># File lib/net/http/response.rb, line 109
def inspect
  "#&lt;#{self.class} #{@code} #{@message} readbody=#{@read}&gt;"
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-read_body"> <span class="method-name">read_body</span><span class="method-args">(dest = nil, &amp;block)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="read_body-source"> <pre class="ruby" data-language="ruby"># File lib/net/http/response.rb, line 202
def read_body(dest = nil, &amp;block)
  if @read
    raise IOError, "#{self.class}\#read_body called twice" if dest or block
    return @body
  end
  to = procdest(dest, block)
  stream_check
  if @body_exist
    read_body_0 to
    @body = to
  else
    @body = nil
  end
  @read = true

  @body
end</pre> </div> <p>Gets the entity body returned by the remote HTTP server.</p> <p>If a block is given, the body is passed to the block, and the body is provided in fragments, as it is read in from the socket.</p> <p>If <code>dest</code> argument is given, response is read into that variable, with <code>dest#&lt;&lt;</code> method (it could be <a href="../string"><code>String</code></a> or <a href="../io"><code>IO</code></a>, or any other object responding to <code>&lt;&lt;</code>).</p> <p>Calling this method a second or subsequent time for the same <a href="httpresponse"><code>HTTPResponse</code></a> object will return the value already read.</p> <pre class="ruby" data-language="ruby">http.request_get('/index.html') {|res|
  puts res.read_body
}

http.request_get('/index.html') {|res|
  p res.read_body.object_id   # 538149362
  p res.read_body.object_id   # 538149362
}

# using iterator
http.request_get('/index.html') {|res|
  res.read_body do |segment|
    print segment
  end
}
</pre>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-value"> <span class="method-name">value</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="value-source"> <pre class="ruby" data-language="ruby"># File lib/net/http/response.rb, line 132
def value
  error! unless self.kind_of?(Net::HTTPSuccess)
end</pre> </div> <p>Raises an HTTP error if the response is not 2xx (success).</p>  </div> </div> </section> <section id="private-instance-5Buntitled-5D-method-details" class="method-section"> <header> <h3>Private Instance Methods</h3> </header> <div class="method-detail "> <div class="method-heading" id="method-i-procdest"> <span class="method-name">procdest</span><span class="method-args">(dest, block)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="procdest-source"> <pre class="ruby" data-language="ruby"># File lib/net/http/response.rb, line 343
def procdest(dest, block)
  raise ArgumentError, 'both arg and block given for HTTP method' if
    dest and block
  if block
    Net::ReadAdapter.new(block)
  else
    dest || ''
  end
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-read_body_0"> <span class="method-name">read_body_0</span><span class="method-args">(dest)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="read_body_0-source"> <pre class="ruby" data-language="ruby"># File lib/net/http/response.rb, line 289
def read_body_0(dest)
  inflater do |inflate_body_io|
    if chunked?
      read_chunked dest, inflate_body_io
      return
    end

    @socket = inflate_body_io

    clen = content_length()
    if clen
      @socket.read clen, dest, true   # ignore EOF
      return
    end
    clen = range_length()
    if clen
      @socket.read clen, dest
      return
    end
    @socket.read_all dest
  end
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-stream_check"> <span class="method-name">stream_check</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="stream_check-source"> <pre class="ruby" data-language="ruby"># File lib/net/http/response.rb, line 339
def stream_check
  raise IOError, 'attempt to read body out of block' if @socket.closed?
end</pre> </div>  </div> </div> </section> </section><div class="_attribution">
  <p class="_attribution-p">
    Ruby Core &copy; 1993&ndash;2022 Yukihiro Matsumoto<br>Licensed under the Ruby License.<br>Ruby Standard Library &copy; contributors<br>Licensed under their own licenses.<br>
    
  </p>
</div>
