<h1>   <span translate="no">Inspect</span> <small>protocol</small>  </h1> <section id="moduledoc"> <p>The <a href="inspect#content"><code class="inline">Inspect</code></a> protocol converts an Elixir data structure into an algebra document.</p>
<p>This documentation refers to implementing the <a href="inspect#content"><code class="inline">Inspect</code></a> protocol for your own data structures. To learn more about using inspect, see <a href="kernel#inspect/2"><code class="inline">Kernel.inspect/2</code></a> and <a href="io#inspect/2"><code class="inline">IO.inspect/2</code></a>.</p>
<p>The <a href="#inspect/2"><code class="inline">inspect/2</code></a> function receives the entity to be inspected followed by the inspecting options, represented by the struct <a href="inspect.opts"><code class="inline">Inspect.Opts</code></a>. Building of the algebra document is done with <a href="inspect.algebra"><code class="inline">Inspect.Algebra</code></a>.</p>
<h2 id="module-examples" class="section-heading">  Examples </h2> <p>Many times, inspecting a structure can be implemented in function of existing entities. For example, here is <a href="mapset"><code class="inline">MapSet</code></a>'s <a href="#inspect/2"><code class="inline">inspect/2</code></a> implementation:</p>
<pre data-language="elixir">defimpl Inspect, for: MapSet do
  import Inspect.Algebra

  def inspect(map_set, opts) do
    concat(["#MapSet&lt;", to_doc(MapSet.to_list(map_set), opts), "&gt;"])
  end
end</pre>
<p>The <a href="inspect.algebra#concat/1"><code class="inline">concat/1</code></a> function comes from <a href="inspect.algebra"><code class="inline">Inspect.Algebra</code></a> and it concatenates algebra documents together. In the example above it is concatenating the string <code class="inline">"#MapSet&lt;"</code>, the document returned by <a href="inspect.algebra#to_doc/2"><code class="inline">Inspect.Algebra.to_doc/2</code></a>, and the final string <code class="inline">"&gt;"</code>. We prefix the module name <code class="inline">#</code> to denote the inspect presentation is not actually valid Elixir syntax.</p>
<p>Finally, note strings themselves are valid algebra documents that keep their formatting when pretty printed. This means your <a href="inspect#content"><code class="inline">Inspect</code></a> implementation may simply return a string, although that will devoid it of any pretty-printing.</p>
<h2 id="module-error-handling" class="section-heading">  Error handling </h2> <p>In case there is an error while your structure is being inspected, Elixir will raise an <a href="argumenterror"><code class="inline">ArgumentError</code></a> error and will automatically fall back to a raw representation for printing the structure.</p>
<p>You can however access the underlying error by invoking the <a href="inspect#content"><code class="inline">Inspect</code></a> implementation directly. For example, to test <a href="inspect.mapset"><code class="inline">Inspect.MapSet</code></a> above, you can invoke it as:</p>
<pre data-language="elixir">Inspect.MapSet.inspect(MapSet.new(), %Inspect.Opts{})</pre>
<h2 id="module-deriving" class="section-heading">  Deriving </h2> <p>The <a href="inspect#content"><code class="inline">Inspect</code></a> protocol can be derived to hide certain fields from structs, so they don't show up in logs, inspects and similar. This is especially useful for fields containing private information.</p>
<p>The options <code class="inline">:only</code> and <code class="inline">:except</code> can be used with <code class="inline">@derive</code> to specify which fields should and should not appear in the algebra document:</p>
<pre data-language="elixir">defmodule User do
  @derive {Inspect, only: [:id, :name]}
  defstruct [:id, :name, :address]
end

inspect(%User{id: 1, name: "Homer", address: "742 Evergreen Terrace"})
#=&gt; #User&lt;id: 1, name: "Homer", ...&gt;</pre> </section> <section id="summary" class="details-list"> <h1 class="section-heading">  Summary </h1> <h2> Types </h2>
<dl class="summary-types summary">  <div class="summary-row"> <dt class="summary-signature"> <a href="#t:t/0" translate="no">t()</a> </dt> </div> </dl> <h2> Functions </h2>
<dl class="summary-functions summary">  <div class="summary-row"> <dt class="summary-signature"> <a href="#inspect/2" translate="no">inspect(term, opts)</a> </dt> <dd class="summary-synopsis"><p>Converts <code class="inline">term</code> into an algebra document.</p></dd> </div> </dl> </section> <section id="types" class="details-list"> <h1 class="section-heading">  Types </h1> <div class="types-list"> <section class="detail"> <h3 class="detail-header" id="t:t/0">t()<a href="https://github.com/elixir-lang/elixir/blob/v1.13.4/lib/elixir/lib/inspect.ex#L6" class="source">Source</a>
</h3> <section class="docstring"> <div class="specs"> <pre translate="no" data-language="elixir">@type t() :: term()</pre> </div> </section> </section> </div> </section> <section id="functions" class="details-list"> <h1 class="section-heading">  Functions </h1> <div class="functions-list"> <section class="detail"> <h3 class="detail-header" id="inspect/2">inspect(term, opts)<a href="https://github.com/elixir-lang/elixir/blob/v1.13.4/lib/elixir/lib/inspect.ex#L90" class="source">Source</a>
</h3> <section class="docstring"> <div class="specs"> <pre translate="no" data-language="elixir">@spec inspect(t(), Inspect.Opts.t()) :: Inspect.Algebra.t()</pre> </div> <p>Converts <code class="inline">term</code> into an algebra document.</p>
<p>This function shouldn't be invoked directly, unless when implementing a custom <code class="inline">inspect_fun</code> to be given to <a href="inspect.opts"><code class="inline">Inspect.Opts</code></a>. Everywhere else, <a href="inspect.algebra#to_doc/2"><code class="inline">Inspect.Algebra.to_doc/2</code></a> should be preferred as it handles structs and exceptions.</p> </section> </section> </div> </section><div class="_attribution">
  <p class="_attribution-p">
    <a href="https://hexdocs.pm/elixir/1.13.4/Inspect.html" class="_attribution-link" target="_blank">https://hexdocs.pm/elixir/1.13.4/Inspect.html</a>
  </p>
</div>
