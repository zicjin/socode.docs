<h1 id="torch-nn-utils-spectral-norm">torch.nn.utils.spectral_norm</h1> <dl class="function"> <dt id="torch.nn.utils.spectral_norm">
<code>torch.nn.utils.spectral_norm(module, name='weight', n_power_iterations=1, eps=1e-12, dim=None)</code> <a class="reference internal" href="https://pytorch.org/docs/1.8.0/_modules/torch/nn/utils/spectral_norm.html#spectral_norm"><span class="viewcode-link">[source]</span></a>
</dt> <dd>
<p>Applies spectral normalization to a parameter in the given module.</p> <div class="math"> <span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi mathvariant="bold">W</mi><mrow><mi>S</mi><mi>N</mi></mrow></msub><mo>=</mo><mfrac><mi mathvariant="bold">W</mi><mrow><mi>σ</mi><mo stretchy="false">(</mo><mi mathvariant="bold">W</mi><mo stretchy="false">)</mo></mrow></mfrac><mo separator="true">,</mo><mi>σ</mi><mo stretchy="false">(</mo><mi mathvariant="bold">W</mi><mo stretchy="false">)</mo><mo>=</mo><munder><mo><mi>max</mi><mo>⁡</mo></mo><mrow><mi mathvariant="bold">h</mi><mo>:</mo><mi mathvariant="bold">h</mi><mo mathvariant="normal">≠</mo><mn>0</mn></mrow></munder><mfrac><mrow><mi mathvariant="normal">∥</mi><mi mathvariant="bold">W</mi><mi mathvariant="bold">h</mi><msub><mi mathvariant="normal">∥</mi><mn>2</mn></msub></mrow><mrow><mi mathvariant="normal">∥</mi><mi mathvariant="bold">h</mi><msub><mi mathvariant="normal">∥</mi><mn>2</mn></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">\mathbf{W}_{SN} = \dfrac{\mathbf{W}}{\sigma(\mathbf{W})}, \sigma(\mathbf{W}) = \max_{\mathbf{h}: \mathbf{h} \ne 0} \dfrac{\|\mathbf{W} \mathbf{h}\|_2}{\|\mathbf{h}\|_2} </annotation></semantics></math></span></span></span> </div>
<p>Spectral normalization stabilizes the training of discriminators (critics) in Generative Adversarial Networks (GANs) by rescaling the weight tensor with spectral norm <span class="math"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>σ</mi></mrow><annotation encoding="application/x-tex">\sigma</annotation></semantics></math></span></span> </span> of the weight matrix calculated using power iteration method. If the dimension of the weight tensor is greater than 2, it is reshaped to 2D in power iteration method to get spectral norm. This is implemented via a hook that calculates spectral norm and rescales weight before every <code>forward()</code> call.</p> <p>See <a class="reference external" href="https://arxiv.org/abs/1802.05957">Spectral Normalization for Generative Adversarial Networks</a> .</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li>
<strong>module</strong> (<a class="reference internal" href="torch.nn.module#torch.nn.Module" title="torch.nn.Module">nn.Module</a>) – containing module</li> <li>
<strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)">str</a><em>, </em><em>optional</em>) – name of weight parameter</li> <li>
<strong>n_power_iterations</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)">int</a><em>, </em><em>optional</em>) – number of power iterations to calculate spectral norm</li> <li>
<strong>eps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)">float</a><em>, </em><em>optional</em>) – epsilon for numerical stability in calculating norms</li> <li>
<strong>dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)">int</a><em>, </em><em>optional</em>) – dimension corresponding to number of outputs, the default is <code>0</code>, except for modules that are instances of ConvTranspose{1,2,3}d, when it is <code>1</code>
</li> </ul> </dd> <dt class="field-even">Returns</dt> <dd class="field-even">
<p>The original module with the spectral norm hook</p> </dd> </dl> <p>Example:</p> <pre data-language="python">&gt;&gt;&gt; m = spectral_norm(nn.Linear(20, 40))
&gt;&gt;&gt; m
Linear(in_features=20, out_features=40, bias=True)
&gt;&gt;&gt; m.weight_u.size()
torch.Size([40])
</pre> </dd>
</dl><div class="_attribution">
  <p class="_attribution-p">
    <a href="https://pytorch.org/docs/1.8.0/generated/torch.nn.utils.spectral_norm.html" class="_attribution-link" target="_blank">https://pytorch.org/docs/1.8.0/generated/torch.nn.utils.spectral_norm.html</a>
  </p>
</div>
