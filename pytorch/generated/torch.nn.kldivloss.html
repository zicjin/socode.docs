<h1 id="kldivloss">KLDivLoss</h1> <dl class="class"> <dt id="torch.nn.KLDivLoss">
<code>class torch.nn.KLDivLoss(size_average=None, reduce=None, reduction='mean', log_target=False)</code> <a class="reference internal" href="https://pytorch.org/docs/1.8.0/_modules/torch/nn/modules/loss.html#KLDivLoss"><span class="viewcode-link">[source]</span></a>
</dt> <dd>
<p>The Kullback-Leibler divergence loss measure</p> <p><a class="reference external" href="https://en.wikipedia.org/wiki/Kullback-Leibler_divergence">Kullback-Leibler divergence</a> is a useful distance measure for continuous distributions and is often useful when performing direct regression over the space of (discretely sampled) continuous output distributions.</p> <p>As with <a class="reference internal" href="torch.nn.nllloss#torch.nn.NLLLoss" title="torch.nn.NLLLoss"><code>NLLLoss</code></a>, the <code>input</code> given is expected to contain <em>log-probabilities</em> and is not restricted to a 2D Tensor. The targets are interpreted as <em>probabilities</em> by default, but could be considered as <em>log-probabilities</em> with <code>log_target</code> set to <code>True</code>.</p> <p>This criterion expects a <code>target</code> <code>Tensor</code> of the same size as the <code>input</code> <code>Tensor</code>.</p> <p>The unreduced (i.e. with <code>reduction</code> set to <code>'none'</code>) loss can be described as:</p> <div class="math"> <span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>l</mi><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo><mo>=</mo><mi>L</mi><mo>=</mo><mo stretchy="false">{</mo><msub><mi>l</mi><mn>1</mn></msub><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><msub><mi>l</mi><mi>N</mi></msub><mo stretchy="false">}</mo><mo separator="true">,</mo><mspace width="1em"></mspace><msub><mi>l</mi><mi>n</mi></msub><mo>=</mo><msub><mi>y</mi><mi>n</mi></msub><mo>⋅</mo><mrow><mo fence="true">(</mo><mi>log</mi><mo>⁡</mo><msub><mi>y</mi><mi>n</mi></msub><mo>−</mo><msub><mi>x</mi><mi>n</mi></msub><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">l(x,y) = L = \{ l_1,\dots,l_N \}, \quad l_n = y_n \cdot \left( \log y_n - x_n \right) </annotation></semantics></math></span></span></span> </div>
<p>where the index <span class="math"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span></span> </span> spans all dimensions of <code>input</code> and <span class="math"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi></mrow><annotation encoding="application/x-tex">L</annotation></semantics></math></span></span> </span> has the same shape as <code>input</code>. If <code>reduction</code> is not <code>'none'</code> (default <code>'mean'</code>), then:</p> <div class="math"> <span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi mathvariant="normal">ℓ</mi><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo><mo>=</mo><mrow><mo fence="true">{</mo><mtable rowspacing="0.3599999999999999em" columnalign="left left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi mathvariant="normal">mean</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>L</mi><mo stretchy="false">)</mo><mo separator="true">,</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>if reduction</mtext><mo>=</mo><mtext>‘mean’;</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi mathvariant="normal">sum</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>L</mi><mo stretchy="false">)</mo><mo separator="true">,</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>if reduction</mtext><mo>=</mo><mtext>‘sum’.</mtext></mrow></mstyle></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">\ell(x, y) = \begin{cases} \operatorname{mean}(L), &amp; \text{if reduction} = \text{`mean';} \\ \operatorname{sum}(L), &amp; \text{if reduction} = \text{`sum'.} \end{cases} </annotation></semantics></math></span></span></span> </div>
<p>In default <code>reduction</code> mode <code>'mean'</code>, the losses are averaged for each minibatch over observations <strong>as well as</strong> over dimensions. <code>'batchmean'</code> mode gives the correct KL divergence where losses are averaged over batch dimension only. <code>'mean'</code> mode’s behavior will be changed to the same as <code>'batchmean'</code> in the next major release.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li>
<strong>size_average</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)">bool</a><em>, </em><em>optional</em>) – Deprecated (see <code>reduction</code>). By default, the losses are averaged over each loss element in the batch. Note that for some losses, there are multiple elements per sample. If the field <code>size_average</code> is set to <code>False</code>, the losses are instead summed for each minibatch. Ignored when <code>reduce</code> is <code>False</code>. Default: <code>True</code>
</li> <li>
<strong>reduce</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)">bool</a><em>, </em><em>optional</em>) – Deprecated (see <code>reduction</code>). By default, the losses are averaged or summed over observations for each minibatch depending on <code>size_average</code>. When <code>reduce</code> is <code>False</code>, returns a loss per batch element instead and ignores <code>size_average</code>. Default: <code>True</code>
</li> <li>
<strong>reduction</strong> (<em>string</em><em>, </em><em>optional</em>) – Specifies the reduction to apply to the output: <code>'none'</code> | <code>'batchmean'</code> | <code>'sum'</code> | <code>'mean'</code>. <code>'none'</code>: no reduction will be applied. <code>'batchmean'</code>: the sum of the output will be divided by batchsize. <code>'sum'</code>: the output will be summed. <code>'mean'</code>: the output will be divided by the number of elements in the output. Default: <code>'mean'</code>
</li> <li>
<strong>log_target</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)">bool</a><em>, </em><em>optional</em>) – Specifies whether <code>target</code> is passed in the log space. Default: <code>False</code>
</li> </ul> </dd> </dl> <div class="admonition note"> <p class="admonition-title">Note</p> <p><code>size_average</code> and <code>reduce</code> are in the process of being deprecated, and in the meantime, specifying either of those two args will override <code>reduction</code>.</p> </div> <div class="admonition note"> <p class="admonition-title">Note</p> <p><code>reduction</code> = <code>'mean'</code> doesn’t return the true kl divergence value, please use <code>reduction</code> = <code>'batchmean'</code> which aligns with KL math definition. In the next major release, <code>'mean'</code> will be changed to be the same as <code>'batchmean'</code>.</p> </div> <dl class="simple"> <dt>Shape:</dt>
<dd>
<ul class="simple"> <li>Input: <span class="math"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>N</mi><mo separator="true">,</mo><mo>∗</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(N, *)</annotation></semantics></math></span></span> </span> where <span class="math"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>∗</mo></mrow><annotation encoding="application/x-tex">*</annotation></semantics></math></span></span> </span> means, any number of additional dimensions</li> <li>Target: <span class="math"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>N</mi><mo separator="true">,</mo><mo>∗</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(N, *)</annotation></semantics></math></span></span> </span>, same shape as the input</li> <li>Output: scalar by default. If :attr:<code>reduction</code> is <code>'none'</code>, then <span class="math"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>N</mi><mo separator="true">,</mo><mo>∗</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(N, *)</annotation></semantics></math></span></span> </span>, the same shape as the input</li> </ul> </dd> </dl> </dd>
</dl><div class="_attribution">
  <p class="_attribution-p">
    <a href="https://pytorch.org/docs/1.8.0/generated/torch.nn.KLDivLoss.html" class="_attribution-link" target="_blank">https://pytorch.org/docs/1.8.0/generated/torch.nn.KLDivLoss.html</a>
  </p>
</div>
