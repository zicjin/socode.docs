<h1>The structured clone algorithm</h1>
<div class="section-content">
<p> The <strong>structured clone algorithm</strong> copies complex JavaScript objects. It is used internally when invoking <a href="../structuredclone"><code>structuredClone()</code></a>, to transfer data between <a href="../worker">Workers</a> via <a href="../worker/postmessage"><code>postMessage()</code></a>, storing objects with <a href="https://developer.mozilla.org/en-US/docs/Glossary/IndexedDB">IndexedDB</a>, or copying objects for <a href="#see_also">other APIs</a>. </p> <p>It clones by recursing through the input object while maintaining a map of previously visited references, to avoid infinitely traversing cycles.</p>
</div>
<h2 id="things_that_dont_work_with_structured_clone">Things that don't work with structured clone</h2>
<div class="section-content"><ul> <li>
<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function"><code>Function</code></a> objects cannot be duplicated by the structured clone algorithm; attempting to throws a <code>DataCloneError</code> exception.</li> <li>Cloning DOM nodes likewise throws a <code>DataCloneError</code> exception.</li> <li>Certain object properties are not preserved: <ul> <li>The <code>lastIndex</code> property of <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/RegExp"><code>RegExp</code></a> objects is not preserved.</li> <li> Property descriptors, setters, getters, and similar metadata-like features are not duplicated. For example, if an object is marked readonly with a <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/getOwnPropertyDescriptor">property descriptor</a>, it will be read/write in the duplicate, since that's the default. </li> <li>The prototype chain is not walked or duplicated.</li> </ul> </li> </ul></div>
<h2 id="supported_types">Supported types</h2>
<div class="section-content"><div class="table-scroll"><div class="_table"><table class="no-markdown"> <thead> <tr> <th scope="col">Object type</th> <th scope="col">Notes</th> </tr> </thead> <tbody> <tr> <td><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#primitive_values">All primitive types</a></td> <td>However, not symbols.</td> </tr> <tr> <td>
<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean"><code>Boolean</code></a> objects</td> <td></td> </tr> <tr> <td>
<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String"><code>String</code></a> objects</td> <td></td> </tr> <tr> <td><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date"><code>Date</code></a></td> <td></td> </tr> <tr> <td><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/RegExp"><code>RegExp</code></a></td> <td>
<code>lastIndex</code> is not preserved.</td> </tr> <tr> <td><a href="../blob"><code>Blob</code></a></td> <td></td> </tr> <tr> <td><a href="../file"><code>File</code></a></td> <td></td> </tr> <tr> <td><a href="../filelist"><code>FileList</code></a></td> <td></td> </tr> <tr> <td><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/ArrayBuffer"><code>ArrayBuffer</code></a></td> <td></td> </tr> <tr> <td><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/TypedArray"><code>TypedArray</code></a></td> <td></td> </tr> <tr> <td><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/DataView"><code>DataView</code></a></td> <td></td> </tr> <tr> <td><a href="../imagebitmap"><code>ImageBitmap</code></a></td> <td></td> </tr> <tr> <td><a href="../imagedata"><code>ImageData</code></a></td> <td></td> </tr> <tr> <td><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array"><code>Array</code></a></td> <td></td> </tr> <tr> <td><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object"><code>Object</code></a></td> <td>
<strong>Only</strong> plain objects (e.g. from object literals)</td> </tr> <tr> <td><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Map"><code>Map</code></a></td> <td></td> </tr> <tr> <td><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Set"><code>Set</code></a></td> <td></td> </tr> <tr> <td><a href="../domexception"><code>DOMException</code></a></td> <td> Browsers must serialize the properties <a href="../domexception/name"><code>name</code></a> and <a href="../domexception/message"><code>message</code></a>. Other attributes may also be serialized/cloned. </td> </tr> <tr> <td><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Error">Native <code>Error</code> types</a></td> <td> <p>The error name must be one of: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Error"><code>Error</code></a>, <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/EvalError"><code>EvalError</code></a>, <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/RangeError"><code>RangeError</code></a>, <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/ReferenceError"><code>ReferenceError</code></a>, <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/SyntaxError"><code>SyntaxError</code></a>, <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/TypeError"><code>TypeError</code></a>, <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/URIError"><code>URIError</code></a> (or will be set to "Error").</p> <p>Browsers must serialize the properties <code>name</code> and <code>message</code>, and are expected to serialize other "interesting" properties of the errors such as <code>stack</code>, <code>cause</code>, etc.</p> <p><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/AggregateError"><code>AggregateError</code></a> support is expected to be added to the specification in <a href="https://github.com/whatwg/html/pull/5749" rel=" noopener">whatwg/html#5749</a> (and is already supported in some browsers).</p> </td> </tr> </tbody> </table></div></div></div>
<h2 id="see_also">See also</h2>
<div class="section-content"><ul> <li><a href="https://html.spec.whatwg.org/multipage/infrastructure.html#safe-passing-of-structured-data" rel=" noopener">HTML Specification: Safe passing of structured data</a></li> <li><a href="https://developer.mozilla.org/en-US/docs/Glossary/Transferable_objects">Transferable objects</a></li> <li><a href="../structuredclone"><code>structuredClone()</code></a></li> <li><a href="../window/history"><code>window.history</code></a></li> <li><a href="../window/postmessage"><code>window.postMessage()</code></a></li> <li><a href="../web_workers_api">Web Workers</a></li> <li><a href="../indexeddb_api">IndexedDB</a></li> </ul></div>
<aside class="metadata"><div class="metadata-content-container">
<div id="on-github" class="on-github">
<h3>Found a problem with this page?</h3>
<ul>
<li><a href="https://github.com/mdn/content/edit/main/files/en-us/web/api/web_workers_api/structured_clone_algorithm/index.md" target="_blank" rel="noopener noreferrer">Edit on <b>GitHub</b></a></li>
<li><a href="https://github.com/mdn/content/blob/main/files/en-us/web/api/web_workers_api/structured_clone_algorithm/index.md?plain=1" target="_blank" rel="noopener noreferrer">Source on <b>GitHub</b></a></li>
<li><a href="https://github.com/mdn/content/issues/new?template=page-report.yml&amp;mdn-url=https%3A%2F%2Fdeveloper.mozilla.org%2Fen-US%2Fdocs%2FWeb%2FAPI%2FWeb_Workers_API%2FStructured_clone_algorithm&amp;metadata=%3C%21--+Do+not+make+changes+below+this+line+--%3E%0A%3Cdetails%3E%0A%3Csummary%3EPage+report+details%3C%2Fsummary%3E%0A%0A*+Folder%3A+%60en-us%2Fweb%2Fapi%2Fweb_workers_api%2Fstructured_clone_algorithm%60%0A*+MDN+URL%3A+https%3A%2F%2Fdeveloper.mozilla.org%2Fen-US%2Fdocs%2FWeb%2FAPI%2FWeb_Workers_API%2FStructured_clone_algorithm%0A*+GitHub+URL%3A+https%3A%2F%2Fgithub.com%2Fmdn%2Fcontent%2Fblob%2Fmain%2Ffiles%2Fen-us%2Fweb%2Fapi%2Fweb_workers_api%2Fstructured_clone_algorithm%2Findex.md%0A*+Last+commit%3A+https%3A%2F%2Fgithub.com%2Fmdn%2Fcontent%2Fcommit%2Fb9dd80d0bd63c35e0eb3b43daf2f60cf5a667036%0A*+Document+last+modified%3A+2022-08-01T04%3A14%3A33.000Z%0A%0A%3C%2Fdetails%3E" target="_blank" rel="noopener noreferrer">Report a problem with this content on <b>GitHub</b></a></li>
<li>Want to fix the problem yourself? See <a href="https://github.com/mdn/content/blob/main/README.md" target="_blank" rel="noopener noreferrer">our Contribution guide</a>.</li>
</ul>
</div>
<p class="last-modified-date"><b>Last modified:</b> <time datetime="2022-08-01T04:14:33.000Z">Aug 1, 2022</time>, <a href="structured_clone_algorithm/contributors.txt">by MDN contributors</a></p>
</div></aside><div class="_attribution">
  <p class="_attribution-p">
    <a href="https://developer.mozilla.org/en-US/docs/Web/API/Web_Workers_API/Structured_clone_algorithm" class="_attribution-link" target="_blank">https://developer.mozilla.org/en-US/docs/Web/API/Web_Workers_API/Structured_clone_algorithm</a>
  </p>
</div>
