<h1>Using textures in WebGL</h1>
<div class="section-content">
<ul class="prev-next"> <li><a class="button secondary" href="creating_3d_objects_using_webgl">« Previous</a></li> <li><a class="button secondary" href="lighting_in_webgl">Next »</a></li> </ul> <p>Now that our sample program has a rotating 3D cube, let's map a texture onto it instead of having its faces be solid colors.</p> <div class="notecard note" id="sect1"> <p><strong>Note:</strong> This example uses the <a href="https://glmatrix.net/" rel=" noopener">glMatrix</a> library to perform its matrix and vertex math. You'll need to include it if you create your own project based on this code. Our sample loads a copy from a CDN in our HTML's <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/head"><code>&lt;head&gt;</code></a>.</p> </div>
</div>
<h2 id="loading_textures">Loading textures</h2>
<div class="section-content">
<p>The first thing to do is add code to load the textures. In our case, we'll be using a single texture, mapped onto all six sides of our rotating cube, but the same technique can be used for any number of textures.</p> <div class="notecard note" id="sect2"> <p><strong>Note:</strong> It's important to note that the loading of textures follows <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS">cross-domain rules</a>; that is, you can only load textures from sites for which your content has CORS approval. See <a href="#cross-domain_textures">Cross-domain textures below</a> for details.</p> </div> <p>The code that loads the texture looks like this:</p> <div class="code-example"><pre data-language="js"><span class="token comment">//</span>
<span class="token comment">// Initialize a texture and load an image.</span>
<span class="token comment">// When the image finished loading copy it into the texture.</span>
<span class="token comment">//</span>
<span class="token keyword">function</span> <span class="token function">loadTexture</span><span class="token punctuation">(</span><span class="token parameter">gl<span class="token punctuation">,</span> url</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> texture <span class="token operator">=</span> gl<span class="token punctuation">.</span><span class="token function">createTexture</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  gl<span class="token punctuation">.</span><span class="token function">bindTexture</span><span class="token punctuation">(</span>gl<span class="token punctuation">.</span><span class="token constant">TEXTURE_2D</span><span class="token punctuation">,</span> texture<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// Because images have to be downloaded over the internet</span>
  <span class="token comment">// they might take a moment until they are ready.</span>
  <span class="token comment">// Until then put a single pixel in the texture so we can</span>
  <span class="token comment">// use it immediately. When the image has finished downloading</span>
  <span class="token comment">// we'll update the texture with the contents of the image.</span>
  <span class="token keyword">const</span> level <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> internalFormat <span class="token operator">=</span> gl<span class="token punctuation">.</span><span class="token constant">RGBA</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> width <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> height <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> border <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> srcFormat <span class="token operator">=</span> gl<span class="token punctuation">.</span><span class="token constant">RGBA</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> srcType <span class="token operator">=</span> gl<span class="token punctuation">.</span><span class="token constant">UNSIGNED_BYTE</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> pixel <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Uint8Array</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// opaque blue</span>
  gl<span class="token punctuation">.</span><span class="token function">texImage2D</span><span class="token punctuation">(</span>gl<span class="token punctuation">.</span><span class="token constant">TEXTURE_2D</span><span class="token punctuation">,</span> level<span class="token punctuation">,</span> internalFormat<span class="token punctuation">,</span>
                width<span class="token punctuation">,</span> height<span class="token punctuation">,</span> border<span class="token punctuation">,</span> srcFormat<span class="token punctuation">,</span> srcType<span class="token punctuation">,</span>
                pixel<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> image <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Image</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  image<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    gl<span class="token punctuation">.</span><span class="token function">bindTexture</span><span class="token punctuation">(</span>gl<span class="token punctuation">.</span><span class="token constant">TEXTURE_2D</span><span class="token punctuation">,</span> texture<span class="token punctuation">)</span><span class="token punctuation">;</span>
    gl<span class="token punctuation">.</span><span class="token function">texImage2D</span><span class="token punctuation">(</span>gl<span class="token punctuation">.</span><span class="token constant">TEXTURE_2D</span><span class="token punctuation">,</span> level<span class="token punctuation">,</span> internalFormat<span class="token punctuation">,</span>
                  srcFormat<span class="token punctuation">,</span> srcType<span class="token punctuation">,</span> image<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// WebGL1 has different requirements for power of 2 images</span>
    <span class="token comment">// vs non power of 2 images so check if the image is a</span>
    <span class="token comment">// power of 2 in both dimensions.</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isPowerOf2</span><span class="token punctuation">(</span>image<span class="token punctuation">.</span>width<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">isPowerOf2</span><span class="token punctuation">(</span>image<span class="token punctuation">.</span>height<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
       <span class="token comment">// Yes, it's a power of 2. Generate mips.</span>
       gl<span class="token punctuation">.</span><span class="token function">generateMipmap</span><span class="token punctuation">(</span>gl<span class="token punctuation">.</span><span class="token constant">TEXTURE_2D</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
       <span class="token comment">// No, it's not a power of 2. Turn off mips and set</span>
       <span class="token comment">// wrapping to clamp to edge</span>
       gl<span class="token punctuation">.</span><span class="token function">texParameteri</span><span class="token punctuation">(</span>gl<span class="token punctuation">.</span><span class="token constant">TEXTURE_2D</span><span class="token punctuation">,</span> gl<span class="token punctuation">.</span><span class="token constant">TEXTURE_WRAP_S</span><span class="token punctuation">,</span> gl<span class="token punctuation">.</span><span class="token constant">CLAMP_TO_EDGE</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
       gl<span class="token punctuation">.</span><span class="token function">texParameteri</span><span class="token punctuation">(</span>gl<span class="token punctuation">.</span><span class="token constant">TEXTURE_2D</span><span class="token punctuation">,</span> gl<span class="token punctuation">.</span><span class="token constant">TEXTURE_WRAP_T</span><span class="token punctuation">,</span> gl<span class="token punctuation">.</span><span class="token constant">CLAMP_TO_EDGE</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
       gl<span class="token punctuation">.</span><span class="token function">texParameteri</span><span class="token punctuation">(</span>gl<span class="token punctuation">.</span><span class="token constant">TEXTURE_2D</span><span class="token punctuation">,</span> gl<span class="token punctuation">.</span><span class="token constant">TEXTURE_MIN_FILTER</span><span class="token punctuation">,</span> gl<span class="token punctuation">.</span><span class="token constant">LINEAR</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
  image<span class="token punctuation">.</span>src <span class="token operator">=</span> url<span class="token punctuation">;</span>

  <span class="token keyword">return</span> texture<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">isPowerOf2</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> value <span class="token operator">&amp;</span> <span class="token punctuation">(</span>value <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</pre></div> <p>The <code>loadTexture()</code> routine starts by creating a WebGL texture object <code>texture</code> by calling the WebGL <a href="../../webglrenderingcontext/createtexture"><code>createTexture()</code></a> function. It then uploads a single blue pixel using <a href="../../webglrenderingcontext/teximage2d"><code>texImage2D()</code></a>. This makes the texture immediately usable as a solid blue color even though it may take a few moments for our image to download.</p> <p>To load the texture from the image file, it then creates an <code>Image</code> object and assigns the <code>src</code> to the URL for our image we wish to use as our texture. The function we assign to <code>image.onload</code> will be called once the image has finished downloading. At that point we again call <a href="../../webglrenderingcontext/teximage2d"><code>texImage2D()</code></a> this time using the image as the source for the texture. After that we setup filtering and wrapping for the texture based on whether or not the image we download was a power of 2 in both dimensions or not.</p> <p>WebGL1 can only use non power of 2 textures with filtering set to <code>NEAREST</code> or <code>LINEAR</code> and it can not generate a mipmap for them. Their wrapping mode must also be set to <code>CLAMP_TO_EDGE</code>. On the other hand if the texture is a power of 2 in both dimensions then WebGL can do higher quality filtering, it can use mipmap, and it can set the wrapping mode to <code>REPEAT</code> or <code>MIRRORED_REPEAT</code>.</p> <p>An example of a repeated texture is tiling an image of a few bricks to cover a brick wall.</p> <p>Mipmapping and UV repeating can be disabled with <a href="../../webglrenderingcontext/texparameter"><code>texParameteri()</code></a>. This will allow non-power-of-two (NPOT) textures at the expense of mipmapping, UV wrapping, UV tiling, and your control over how the device will handle your texture.</p> <div class="code-example"><pre data-language="js"><span class="token comment">// gl.NEAREST is also allowed, instead of gl.LINEAR, as neither mipmap.</span>
gl<span class="token punctuation">.</span><span class="token function">texParameteri</span><span class="token punctuation">(</span>gl<span class="token punctuation">.</span><span class="token constant">TEXTURE_2D</span><span class="token punctuation">,</span> gl<span class="token punctuation">.</span><span class="token constant">TEXTURE_MIN_FILTER</span><span class="token punctuation">,</span> gl<span class="token punctuation">.</span><span class="token constant">LINEAR</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Prevents s-coordinate wrapping (repeating).</span>
gl<span class="token punctuation">.</span><span class="token function">texParameteri</span><span class="token punctuation">(</span>gl<span class="token punctuation">.</span><span class="token constant">TEXTURE_2D</span><span class="token punctuation">,</span> gl<span class="token punctuation">.</span><span class="token constant">TEXTURE_WRAP_S</span><span class="token punctuation">,</span> gl<span class="token punctuation">.</span><span class="token constant">CLAMP_TO_EDGE</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Prevents t-coordinate wrapping (repeating).</span>
gl<span class="token punctuation">.</span><span class="token function">texParameteri</span><span class="token punctuation">(</span>gl<span class="token punctuation">.</span><span class="token constant">TEXTURE_2D</span><span class="token punctuation">,</span> gl<span class="token punctuation">.</span><span class="token constant">TEXTURE_WRAP_T</span><span class="token punctuation">,</span> gl<span class="token punctuation">.</span><span class="token constant">CLAMP_TO_EDGE</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre></div> <p>Again, with these parameters, compatible WebGL devices will automatically accept any resolution for that texture (up to their maximum dimensions). Without performing the above configuration, WebGL requires all samples of NPOT textures to fail by returning transparent black: <code>rgba(0,0,0,0)</code>.</p> <p>To load the image, add a call to our <code>loadTexture()</code> function within our <code>main()</code> function. This can be added after the <code>initBuffers(gl)</code> call.</p> <p>But also note: Browsers copy pixels from the loaded image in top-to-bottom order — from the top-left corner; but WebGL wants the pixels in bottom-to-top order — starting from the bottom-left corner. (For more details, see <a href="https://jameshfisher.com/2020/10/22/why-is-my-webgl-texture-upside-down/" rel=" noopener">Why is my WebGL texture upside-down?</a>.)</p> <p>So in order to prevent the resulting image texture from having the wrong orientation when rendered, we also need call <a href="../../webglrenderingcontext/pixelstorei"><code>pixelStorei()</code></a> with the <code>gl.UNPACK_FLIP_Y_WEBGL</code> parameter set to <code>true</code> — to cause the pixels to be flipped into the bottom-to-top order that WebGL expects.</p> <div class="code-example"><pre data-language="js"><span class="token comment">// Load texture</span>
<span class="token keyword">const</span> texture <span class="token operator">=</span> <span class="token function">loadTexture</span><span class="token punctuation">(</span>gl<span class="token punctuation">,</span> <span class="token string">'cubetexture.png'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Flip image pixels into the bottom-to-top order that WebGL expects.</span>
gl<span class="token punctuation">.</span><span class="token function">pixelStorei</span><span class="token punctuation">(</span>gl<span class="token punctuation">.</span><span class="token constant">UNPACK_FLIP_Y_WEBGL</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre></div>
</div>
<h2 id="mapping_the_texture_onto_the_faces">Mapping the texture onto the faces</h2>
<div class="section-content">
<p>At this point, the texture is loaded and ready to use. But before we can use it, we need to establish the mapping of the texture coordinates to the vertices of the faces of our cube. This replaces all the previously existing code for configuring colors for each of the cube's faces in <code>initBuffers()</code>.</p> <div class="code-example"><pre data-language="js">  <span class="token keyword">const</span> textureCoordBuffer <span class="token operator">=</span> gl<span class="token punctuation">.</span><span class="token function">createBuffer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  gl<span class="token punctuation">.</span><span class="token function">bindBuffer</span><span class="token punctuation">(</span>gl<span class="token punctuation">.</span><span class="token constant">ARRAY_BUFFER</span><span class="token punctuation">,</span> textureCoordBuffer<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> textureCoordinates <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token comment">// Front</span>
    <span class="token number">0.0</span><span class="token punctuation">,</span>  <span class="token number">0.0</span><span class="token punctuation">,</span>
    <span class="token number">1.0</span><span class="token punctuation">,</span>  <span class="token number">0.0</span><span class="token punctuation">,</span>
    <span class="token number">1.0</span><span class="token punctuation">,</span>  <span class="token number">1.0</span><span class="token punctuation">,</span>
    <span class="token number">0.0</span><span class="token punctuation">,</span>  <span class="token number">1.0</span><span class="token punctuation">,</span>
    <span class="token comment">// Back</span>
    <span class="token number">0.0</span><span class="token punctuation">,</span>  <span class="token number">0.0</span><span class="token punctuation">,</span>
    <span class="token number">1.0</span><span class="token punctuation">,</span>  <span class="token number">0.0</span><span class="token punctuation">,</span>
    <span class="token number">1.0</span><span class="token punctuation">,</span>  <span class="token number">1.0</span><span class="token punctuation">,</span>
    <span class="token number">0.0</span><span class="token punctuation">,</span>  <span class="token number">1.0</span><span class="token punctuation">,</span>
    <span class="token comment">// Top</span>
    <span class="token number">0.0</span><span class="token punctuation">,</span>  <span class="token number">0.0</span><span class="token punctuation">,</span>
    <span class="token number">1.0</span><span class="token punctuation">,</span>  <span class="token number">0.0</span><span class="token punctuation">,</span>
    <span class="token number">1.0</span><span class="token punctuation">,</span>  <span class="token number">1.0</span><span class="token punctuation">,</span>
    <span class="token number">0.0</span><span class="token punctuation">,</span>  <span class="token number">1.0</span><span class="token punctuation">,</span>
    <span class="token comment">// Bottom</span>
    <span class="token number">0.0</span><span class="token punctuation">,</span>  <span class="token number">0.0</span><span class="token punctuation">,</span>
    <span class="token number">1.0</span><span class="token punctuation">,</span>  <span class="token number">0.0</span><span class="token punctuation">,</span>
    <span class="token number">1.0</span><span class="token punctuation">,</span>  <span class="token number">1.0</span><span class="token punctuation">,</span>
    <span class="token number">0.0</span><span class="token punctuation">,</span>  <span class="token number">1.0</span><span class="token punctuation">,</span>
    <span class="token comment">// Right</span>
    <span class="token number">0.0</span><span class="token punctuation">,</span>  <span class="token number">0.0</span><span class="token punctuation">,</span>
    <span class="token number">1.0</span><span class="token punctuation">,</span>  <span class="token number">0.0</span><span class="token punctuation">,</span>
    <span class="token number">1.0</span><span class="token punctuation">,</span>  <span class="token number">1.0</span><span class="token punctuation">,</span>
    <span class="token number">0.0</span><span class="token punctuation">,</span>  <span class="token number">1.0</span><span class="token punctuation">,</span>
    <span class="token comment">// Left</span>
    <span class="token number">0.0</span><span class="token punctuation">,</span>  <span class="token number">0.0</span><span class="token punctuation">,</span>
    <span class="token number">1.0</span><span class="token punctuation">,</span>  <span class="token number">0.0</span><span class="token punctuation">,</span>
    <span class="token number">1.0</span><span class="token punctuation">,</span>  <span class="token number">1.0</span><span class="token punctuation">,</span>
    <span class="token number">0.0</span><span class="token punctuation">,</span>  <span class="token number">1.0</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">;</span>

  gl<span class="token punctuation">.</span><span class="token function">bufferData</span><span class="token punctuation">(</span>gl<span class="token punctuation">.</span><span class="token constant">ARRAY_BUFFER</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Float32Array</span><span class="token punctuation">(</span>textureCoordinates<span class="token punctuation">)</span><span class="token punctuation">,</span>
                gl<span class="token punctuation">.</span><span class="token constant">STATIC_DRAW</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// …</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">position</span><span class="token operator">:</span> positionBuffer<span class="token punctuation">,</span>
    <span class="token literal-property property">textureCoord</span><span class="token operator">:</span> textureCoordBuffer<span class="token punctuation">,</span>
    <span class="token literal-property property">indices</span><span class="token operator">:</span> indexBuffer<span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
</pre></div> <p>First, this code creates a WebGL buffer into which we'll store the texture coordinates for each face, then we bind that buffer as the array we'll be writing into.</p> <p>The <code>textureCoordinates</code> array defines the texture coordinates corresponding to each vertex of each face. Note that the texture coordinates range from 0.0 to 1.0; the dimensions of textures are normalized to a range of 0.0 to 1.0 regardless of their actual size, for the purpose of texture mapping.</p> <p>Once we've set up the texture mapping array, we pass the array into the buffer, so that WebGL has that data ready for its use.</p>
</div>
<h2 id="updating_the_shaders">Updating the shaders</h2>
<div class="section-content"><p>The shader program also needs to be updated to use the textures instead of solid colors.</p></div>
<h3 id="the_vertex_shader">The vertex shader</h3>
<div class="section-content">
<p>We need to replace the vertex shader so that instead of fetching color data, it instead fetches the texture coordinate data.</p> <div class="code-example"><pre data-language="js">  <span class="token keyword">const</span> vsSource <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
    attribute vec4 aVertexPosition;
    attribute vec2 aTextureCoord;

    uniform mat4 uModelViewMatrix;
    uniform mat4 uProjectionMatrix;

    varying highp vec2 vTextureCoord;

    void main(void) {
      gl_Position = uProjectionMatrix * uModelViewMatrix * aVertexPosition;
      vTextureCoord = aTextureCoord;
    }
  </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
</pre></div> <p>The key change here is that instead of fetching the vertex color, we're fetching the texture coordinates and passing them to the vertex shader; this will indicate the location within the texture corresponding to the vertex.</p>
</div>
<h3 id="the_fragment_shader">The fragment shader</h3>
<div class="section-content">
<p>The fragment shader likewise needs to be updated:</p> <div class="code-example"><pre data-language="js">  <span class="token keyword">const</span> fsSource <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
    varying highp vec2 vTextureCoord;

    uniform sampler2D uSampler;

    void main(void) {
      gl_FragColor = texture2D(uSampler, vTextureCoord);
    }
  </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
</pre></div> <p>Instead of assigning a color value to the fragment's color, the fragment's color is computed by fetching the <a href="https://developer.mozilla.org/en-US/docs/Glossary/Texel">texel</a> (that is, the pixel within the texture) based on the value of <code>vTextureCoord</code> which like the colors is interpolated between vertices.</p>
</div>
<h3 id="attribute_and_uniform_locations">Attribute and Uniform Locations</h3>
<div class="section-content">
<p>Because we changed an attribute and added a uniform we need to look up their locations</p> <div class="code-example"><pre data-language="js">  <span class="token keyword">const</span> programInfo <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">program</span><span class="token operator">:</span> shaderProgram<span class="token punctuation">,</span>
    <span class="token literal-property property">attribLocations</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">vertexPosition</span><span class="token operator">:</span> gl<span class="token punctuation">.</span><span class="token function">getAttribLocation</span><span class="token punctuation">(</span>shaderProgram<span class="token punctuation">,</span> <span class="token string">'aVertexPosition'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token literal-property property">textureCoord</span><span class="token operator">:</span> gl<span class="token punctuation">.</span><span class="token function">getAttribLocation</span><span class="token punctuation">(</span>shaderProgram<span class="token punctuation">,</span> <span class="token string">'aTextureCoord'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">uniformLocations</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">projectionMatrix</span><span class="token operator">:</span> gl<span class="token punctuation">.</span><span class="token function">getUniformLocation</span><span class="token punctuation">(</span>shaderProgram<span class="token punctuation">,</span> <span class="token string">'uProjectionMatrix'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token literal-property property">modelViewMatrix</span><span class="token operator">:</span> gl<span class="token punctuation">.</span><span class="token function">getUniformLocation</span><span class="token punctuation">(</span>shaderProgram<span class="token punctuation">,</span> <span class="token string">'uModelViewMatrix'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token literal-property property">uSampler</span><span class="token operator">:</span> gl<span class="token punctuation">.</span><span class="token function">getUniformLocation</span><span class="token punctuation">(</span>shaderProgram<span class="token punctuation">,</span> <span class="token string">'uSampler'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
</pre></div>
</div>
<h2 id="drawing_the_textured_cube">Drawing the textured cube</h2>
<div class="section-content">
<p>The changes to the <code>drawScene()</code> function are simple.</p> <p>First, the code to specify the colors buffer is gone, replaced with this:</p> <div class="code-example"><pre data-language="js"><span class="token comment">// tell webgl how to pull out the texture coordinates from buffer</span>
<span class="token punctuation">{</span>
    <span class="token keyword">const</span> num <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span> <span class="token comment">// every coordinate composed of 2 values</span>
    <span class="token keyword">const</span> type <span class="token operator">=</span> gl<span class="token punctuation">.</span><span class="token constant">FLOAT</span><span class="token punctuation">;</span> <span class="token comment">// the data in the buffer is 32-bit float</span>
    <span class="token keyword">const</span> normalize <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span> <span class="token comment">// don't normalize</span>
    <span class="token keyword">const</span> stride <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">// how many bytes to get from one set to the next</span>
    <span class="token keyword">const</span> offset <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">// how many bytes inside the buffer to start from</span>
    gl<span class="token punctuation">.</span><span class="token function">bindBuffer</span><span class="token punctuation">(</span>gl<span class="token punctuation">.</span><span class="token constant">ARRAY_BUFFER</span><span class="token punctuation">,</span> buffers<span class="token punctuation">.</span>textureCoord<span class="token punctuation">)</span><span class="token punctuation">;</span>
    gl<span class="token punctuation">.</span><span class="token function">vertexAttribPointer</span><span class="token punctuation">(</span>programInfo<span class="token punctuation">.</span>attribLocations<span class="token punctuation">.</span>textureCoord<span class="token punctuation">,</span> num<span class="token punctuation">,</span> type<span class="token punctuation">,</span> normalize<span class="token punctuation">,</span> stride<span class="token punctuation">,</span> offset<span class="token punctuation">)</span><span class="token punctuation">;</span>
    gl<span class="token punctuation">.</span><span class="token function">enableVertexAttribArray</span><span class="token punctuation">(</span>programInfo<span class="token punctuation">.</span>attribLocations<span class="token punctuation">.</span>textureCoord<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</pre></div> <p>Then add code to specify the texture to map onto the faces, just before draw:</p> <div class="code-example"><pre data-language="js">  <span class="token comment">// Tell WebGL we want to affect texture unit 0</span>
  gl<span class="token punctuation">.</span><span class="token function">activeTexture</span><span class="token punctuation">(</span>gl<span class="token punctuation">.</span><span class="token constant">TEXTURE0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// Bind the texture to texture unit 0</span>
  gl<span class="token punctuation">.</span><span class="token function">bindTexture</span><span class="token punctuation">(</span>gl<span class="token punctuation">.</span><span class="token constant">TEXTURE_2D</span><span class="token punctuation">,</span> texture<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// Tell the shader we bound the texture to texture unit 0</span>
  gl<span class="token punctuation">.</span><span class="token function">uniform1i</span><span class="token punctuation">(</span>programInfo<span class="token punctuation">.</span>uniformLocations<span class="token punctuation">.</span>uSampler<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre></div> <p>WebGL provides a minimum of 8 texture units; the first of these is <code>gl.TEXTURE0</code>. We tell WebGL we want to affect unit 0. We then call <a href="../../webglrenderingcontext/bindtexture"><code>bindTexture()</code></a> which binds the texture to the <code>TEXTURE_2D</code> bind point of texture unit 0. We then tell the shader that for the <code>uSampler</code> use texture unit 0.</p> <p>Lastly, add <code>texture</code> as a parameter to the <code>drawScene()</code> function, both where it is defined and where it is called.</p> <div class="code-example"><pre data-language="js"><span class="token function">drawScene</span><span class="token punctuation">(</span>gl<span class="token punctuation">,</span> programInfo<span class="token punctuation">,</span> buffers<span class="token punctuation">,</span> texture<span class="token punctuation">,</span> deltaTime<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// …</span>
<span class="token keyword">function</span> <span class="token function">drawScene</span><span class="token punctuation">(</span><span class="token parameter">gl<span class="token punctuation">,</span> programInfo<span class="token punctuation">,</span> buffers<span class="token punctuation">,</span> texture<span class="token punctuation">,</span> deltaTime</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// …</span>
<span class="token punctuation">}</span>
</pre></div> <p>At this point, the rotating cube should be good to go.</p>
<iframe width="670" height="510" src="https://mdn.github.io/dom-examples/webgl-examples/tutorial/sample6/index.html" loading="lazy"></iframe> <p><a href="https://github.com/mdn/dom-examples/tree/master/webgl-examples/tutorial/sample6" rel=" noopener">View the complete code</a> | <a href="https://mdn.github.io/dom-examples/webgl-examples/tutorial/sample6/" rel=" noopener">Open this demo on a new page</a></p>
</div>
<h2 id="cross-domain_textures">Cross-domain textures</h2>
<div class="section-content">
<p>Loading of WebGL textures is subject to cross-domain access controls. In order for your content to load a texture from another domain, CORS approval needs to be obtained. See <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS">HTTP access control</a> for details on CORS.</p> <p>Because WebGL now requires textures to be loaded from secure contexts, you can't use textures loaded from <code>file:///</code> URLs in WebGL. That means that you'll need a secure web server to test and deploy your code. For local testing, see our guide <a href="https://developer.mozilla.org/en-US/docs/Learn/Common_questions/set_up_a_local_testing_server">How do you set up a local testing server?</a> for help.</p> <p>See this <a href="https://hacks.mozilla.org/2011/11/using-cors-to-load-webgl-textures-from-cross-domain-images/" rel=" noopener">hacks.mozilla.org article</a> for an explanation of how to use CORS-approved images as WebGL textures.</p> <div class="notecard note" id="sect3"> <p><strong>Note:</strong> CORS support for WebGL textures and the <code>crossOrigin</code> attribute for image elements is implemented in <span>Gecko 8.0</span>.</p> </div> <p>Tainted (write-only) 2D canvases can't be used as WebGL textures. A 2D <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/canvas"><code>&lt;canvas&gt;</code></a> becomes tainted, for example, when a cross-domain image is drawn on it.</p> <div class="notecard note" id="sect4"> <p><strong>Note:</strong> CORS support for Canvas 2D <code>drawImage</code> is implemented in <span>Gecko 9.0</span>. This means that using a cross-domain image with CORS approval does no longer taint the 2D canvas, so the 2D canvas remains usable as the source of a WebGL texture.</p> </div> <div class="notecard note" id="sect5"> <p><strong>Note:</strong> CORS support for cross-domain videos and the <code>crossorigin</code> attribute for <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/video"><code>&lt;video&gt;</code></a> elements is implemented in <span>Gecko 12.0</span>.</p> </div>
<ul class="prev-next"> <li><a class="button secondary" href="creating_3d_objects_using_webgl">« Previous</a></li> <li><a class="button secondary" href="lighting_in_webgl">Next »</a></li> </ul>
</div>
<aside class="metadata"><div class="metadata-content-container">
<div id="on-github" class="on-github">
<h3>Found a problem with this page?</h3>
<ul>
<li><a href="https://github.com/mdn/content/edit/main/files/en-us/web/api/webgl_api/tutorial/using_textures_in_webgl/index.md" target="_blank" rel="noopener noreferrer">Edit on <b>GitHub</b></a></li>
<li><a href="https://github.com/mdn/content/blob/main/files/en-us/web/api/webgl_api/tutorial/using_textures_in_webgl/index.md?plain=1" target="_blank" rel="noopener noreferrer">Source on <b>GitHub</b></a></li>
<li><a href="https://github.com/mdn/content/issues/new?template=page-report.yml&amp;mdn-url=https%3A%2F%2Fdeveloper.mozilla.org%2Fen-US%2Fdocs%2FWeb%2FAPI%2FWebGL_API%2FTutorial%2FUsing_textures_in_WebGL&amp;metadata=%3C%21--+Do+not+make+changes+below+this+line+--%3E%0A%3Cdetails%3E%0A%3Csummary%3EPage+report+details%3C%2Fsummary%3E%0A%0A*+Folder%3A+%60en-us%2Fweb%2Fapi%2Fwebgl_api%2Ftutorial%2Fusing_textures_in_webgl%60%0A*+MDN+URL%3A+https%3A%2F%2Fdeveloper.mozilla.org%2Fen-US%2Fdocs%2FWeb%2FAPI%2FWebGL_API%2FTutorial%2FUsing_textures_in_WebGL%0A*+GitHub+URL%3A+https%3A%2F%2Fgithub.com%2Fmdn%2Fcontent%2Fblob%2Fmain%2Ffiles%2Fen-us%2Fweb%2Fapi%2Fwebgl_api%2Ftutorial%2Fusing_textures_in_webgl%2Findex.md%0A*+Last+commit%3A+https%3A%2F%2Fgithub.com%2Fmdn%2Fcontent%2Fcommit%2F869cc1c706cbfec913f42cbcbfafb215d1846086%0A*+Document+last+modified%3A+2022-08-05T08%3A36%3A58.000Z%0A%0A%3C%2Fdetails%3E" target="_blank" rel="noopener noreferrer">Report a problem with this content on <b>GitHub</b></a></li>
<li>Want to fix the problem yourself? See <a href="https://github.com/mdn/content/blob/main/README.md" target="_blank" rel="noopener noreferrer">our Contribution guide</a>.</li>
</ul>
</div>
<p class="last-modified-date"><b>Last modified:</b> <time datetime="2022-08-05T08:36:58.000Z">Aug 5, 2022</time>, <a href="using_textures_in_webgl/contributors.txt">by MDN contributors</a></p>
</div></aside><div class="_attribution">
  <p class="_attribution-p">
    <a href="https://developer.mozilla.org/en-US/docs/Web/API/WebGL_API/Tutorial/Using_textures_in_WebGL" class="_attribution-link" target="_blank">https://developer.mozilla.org/en-US/docs/Web/API/WebGL_API/Tutorial/Using_textures_in_WebGL</a>
  </p>
</div>
