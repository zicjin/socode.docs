<h1>TaskController</h1>
<div class="section-content">
<div class="notecard experimental" id="sect1"><p><strong>Experimental:</strong> <strong>This is an <a href="https://developer.mozilla.org/en-US/docs/MDN/Writing_guidelines/Experimental_deprecated_obsolete#experimental">experimental technology</a></strong><br>Check the <a href="#browser_compatibility">Browser compatibility table</a> carefully before using this in production.</p></div> <p> The <code>TaskController</code> interface of the <a href="prioritized_task_scheduling_api">Prioritized Task Scheduling API</a> represents a controller object that can be used to both abort and change the <a href="prioritized_task_scheduling_api#task_priorities">priority</a> of one or more prioritized tasks. If there is no need to change task priorities, then <a href="abortcontroller"><code>AbortController</code></a> can be used instead. </p> <p> A new <code>TaskController</code> instance is created using the <a href="taskcontroller/taskcontroller"><code>TaskController()</code></a> constructor, optionally specifying a <a href="prioritized_task_scheduling_api#task_priorities">priority</a> for its associated signal (a <a href="tasksignal"><code>TaskSignal</code></a>). If not specified, the signal will have a priority of <a href="prioritized_task_scheduling_api#user-visible"><code>"user-visible"</code></a> by default. </p> <p> The controller's signal can be passed as an argument to the <a href="scheduler/posttask"><code>Scheduler.postTask()</code></a> method for one or more tasks. For <a href="prioritized_task_scheduling_api#mutable_and_immutable_task_priority">mutable tasks</a> (only) the task is initialized with the signal priority, and can later be changed by calling <a href="taskcontroller/setpriority"><code>TaskController.setPriority()</code></a>. For immutable tasks, any priority initialized or set by the controller is ignored. </p> <p>Tasks can be aborted by calling <a href="abortcontroller/abort"><code>abort()</code></a> on the controller.</p>
<svg viewbox="-1 -1 650 42" preserveaspectratio="xMinYMin meet"> <a style="text-decoration: none;" xlink:href="/en-US/docs/Web/API/AbortController">  <text x="60" y="16" font-size="10px" fill="#4D4E53" text-anchor="middle"> AbortController </text> </a>   <a style="text-decoration: none;" xlink:href="/en-US/docs/Web/API/TaskController" aria-current="page">  <text x="206" y="16" font-size="10px" fill="#4D4E53" text-anchor="middle"> TaskController </text> </a></svg>
</div>
<h2 id="constructor">Constructor</h2>
<div class="section-content"><dl> <dt id="taskcontroller"><a href="taskcontroller/taskcontroller"><code>TaskController()</code></a></dt> <dd> <p>Creates a new <code>TaskController</code> object, optionally specifying the priority of its associated <a href="#taskcontroller.signal"><code>signal</code></a>.</p> </dd> </dl></div>
<h2 id="methods">Methods</h2>
<div class="section-content">
<p><em>This interface also inherits the methods of its parent, <a href="abortcontroller"><code>AbortController</code></a>.</em></p> <dl> <dt id="taskcontroller.setpriority"><a href="taskcontroller/setpriority"><code>TaskController.setPriority()</code></a></dt> <dd> <p> Sets the priority of the controller's <a href="#taskcontroller.signal"><code>signal</code></a>, and hence the priority of any tasks with which it is associated. This notifies observers of the priority change by dispatching a <a href="tasksignal/prioritychange_event"><code>prioritychange</code></a> event. </p> </dd> </dl>
</div>
<h2 id="properties">Properties</h2>
<div class="section-content">
<p><em>This interface also inherits the properties of its parent, <a href="abortcontroller"><code>AbortController</code></a>.</em></p> <dl> <dt id="taskcontroller.signal">
<code>TaskController.signal</code> <span class="badge inline readonly">Read only </span>
</dt> <dd> <p> Returns a <a href="tasksignal"><code>TaskSignal</code></a> object instance. The signal is passed to tasks so that they can be aborted or re-prioritized by the controller. The property is inherited from <a href="abortcontroller#abortcontroller.signal"><code>AbortController</code></a>. </p> </dd> </dl>
</div>
<h2 id="examples">Examples</h2>
<div class="section-content">
<div class="notecard note" id="sect2"> <p><strong>Note:</strong> Additional "live" examples can be found in: <a href="prioritized_task_scheduling_api#examples">Prioritized Task Scheduling API &gt; Examples</a>.</p> </div> <p>First we create a task controller, setting the priority of its associated signal to <code>user-blocking</code>.</p> <div class="code-example"><pre data-language="js"><span class="token comment">// Create a TaskController, setting its signal priority to 'user-blocking'</span>
<span class="token keyword">const</span> controller <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">TaskController</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">priority</span><span class="token operator">:</span> <span class="token string">'user-blocking'</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre></div> <p> We then add an event listener for <a href="tasksignal/prioritychange_event"><code>prioritychange</code></a> events (here <code>addEventListener()</code> is called, but we could instead assign a handler to <code>TaskSignal.onprioritychange</code>). The handler uses <a href="taskprioritychangeevent/previouspriority">previousPolicy</a> on the event to get the original priority and <a href="tasksignal/priority"><code>TaskSignal.priority</code></a> on the event target to get the new priority. </p> <div class="code-example"><pre data-language="js"><span class="token comment">// Listen for 'prioritychange' events on the controller's signal.</span>
controller<span class="token punctuation">.</span>signal<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'prioritychange'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> previousPriority <span class="token operator">=</span> event<span class="token punctuation">.</span>previousPriority<span class="token punctuation">;</span>
  <span class="token keyword">const</span> newPriority <span class="token operator">=</span> event<span class="token punctuation">.</span>target<span class="token punctuation">.</span>priority<span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Priority changed from </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>previousPriority<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> to </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>newPriority<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">.</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre></div> <p> We can also listen for <a href="abortsignal/abort_event"><code>abort</code></a> events as shown below. This same approach would be used if the controller was an <code>AbortController</code>. </p> <div class="code-example"><pre data-language="js">controller<span class="token punctuation">.</span>signal<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'abort'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Task aborted'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre></div> <p> Next we post the task, passing the controller signal in the optional argument. In this case the task is just an arrow function that resolves the promise by returning some text. We use <code>then</code> and <code>catch</code> to handle when the task resolves or is rejected, logging the return text or the error in each case. Note that in a later code block we abort the task, so only the <code>catch()</code> block will actually be run! </p> <div class="code-example"><pre data-language="js"><span class="token comment">// Post task using the controller's signal.</span>
<span class="token comment">// The signal priority sets the initial priority of the task</span>
scheduler<span class="token punctuation">.</span><span class="token function">postTask</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token string">'Task execute'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token literal-property property">signal</span><span class="token operator">:</span> controller<span class="token punctuation">.</span>signal<span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">taskResult</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>taskResult<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token comment">// Aborted (wont run)</span>
  <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">error</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Catch error: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>error<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// Log error</span>
</pre></div> <p> We can use the controller to manage the task. Here we can change the priority using <a href="taskcontroller/setpriority"><code>TaskController.setPriority()</code></a>. This will trigger the associated <code>prioritychange</code> event. </p> <div class="code-example"><pre data-language="js"><span class="token comment">// Change the priority to 'background' using the controller</span>
controller<span class="token punctuation">.</span><span class="token function">setPriority</span><span class="token punctuation">(</span><span class="token string">'background'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre></div> <p>Finally, the task can be aborted by calling <a href="abortcontroller/abort"><code>abort()</code></a> on the controller.</p> <div class="code-example"><pre data-language="js"><span class="token comment">// Abort the task</span>
controller<span class="token punctuation">.</span><span class="token function">abort</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre></div> <p>The console output of this example would be:</p> <pre class="notranslate">The priority changed from user-blocking to background.
Task aborted
Catch error: AbortError
</pre>
</div>
<h2 id="specifications">Specifications</h2>
<div class="_table"><table class="standard-table">
<thead><tr><th scope="col">Specification</th></tr></thead>
<tbody><tr><td><a href="https://wicg.github.io/scheduling-apis/#sec-task-controller">Prioritized Task Scheduling <br><small># sec-task-controller</small></a></td></tr></tbody>
</table></div>
<h2 id="browser_compatibility">Browser compatibility</h2>
<table>
<thead>
<tr id="bct-browser-type">
<th></th>
<th colspan="6">Desktop</th>
<th colspan="6">Mobile</th>
</tr>
<tr id="bct-browsers">
<th></th>
<th>Chrome</th>
<th>Edge</th>
<th>Firefox</th>
<th>Internet Explorer</th>
<th>Opera</th>
<th>Safari</th>
<th>WebView Android</th>
<th>Chrome Android</th>
<th>Firefox for Android</th>
<th>Opera Android</th>
<th>Safari on IOS</th>
<th>Samsung Internet</th>
</tr>
</thead>
<tbody>
<tr>
<th><code>TaskController</code></th>
<td class="bc-supports-yes"><div>94</div></td>
<td class="bc-supports-yes"><div>94</div></td>
<td class="bc-supports-yes">
<div>101</div>
<div>preview</div>
</td>
<td class="bc-supports-no"><div>No</div></td>
<td class="bc-supports-yes"><div>80</div></td>
<td class="bc-supports-no"><div>No</div></td>
<td class="bc-supports-yes"><div>94</div></td>
<td class="bc-supports-yes"><div>94</div></td>
<td class="bc-supports-no"><div>No</div></td>
<td class="bc-supports-yes"><div>66</div></td>
<td class="bc-supports-no"><div>No</div></td>
<td class="bc-supports-yes"><div>17.0</div></td>
</tr>
<tr>
<th><code>TaskController</code></th>
<td class="bc-supports-yes"><div>94</div></td>
<td class="bc-supports-yes"><div>94</div></td>
<td class="bc-supports-yes">
<div>101</div>
<div>preview</div>
</td>
<td class="bc-supports-no"><div>No</div></td>
<td class="bc-supports-yes"><div>80</div></td>
<td class="bc-supports-no"><div>No</div></td>
<td class="bc-supports-yes"><div>94</div></td>
<td class="bc-supports-yes"><div>94</div></td>
<td class="bc-supports-no"><div>No</div></td>
<td class="bc-supports-yes"><div>66</div></td>
<td class="bc-supports-no"><div>No</div></td>
<td class="bc-supports-yes"><div>17.0</div></td>
</tr>
<tr>
<th><code>setPriority</code></th>
<td class="bc-supports-yes"><div>94</div></td>
<td class="bc-supports-yes"><div>94</div></td>
<td class="bc-supports-yes">
<div>101</div>
<div>preview</div>
</td>
<td class="bc-supports-no"><div>No</div></td>
<td class="bc-supports-yes"><div>80</div></td>
<td class="bc-supports-no"><div>No</div></td>
<td class="bc-supports-yes"><div>94</div></td>
<td class="bc-supports-yes"><div>94</div></td>
<td class="bc-supports-no"><div>No</div></td>
<td class="bc-supports-yes"><div>66</div></td>
<td class="bc-supports-no"><div>No</div></td>
<td class="bc-supports-yes"><div>17.0</div></td>
</tr>
</tbody>
</table>
<aside class="metadata"><div class="metadata-content-container">
<div id="on-github" class="on-github">
<h3>Found a problem with this page?</h3>
<ul>
<li><a href="https://github.com/mdn/content/edit/main/files/en-us/web/api/taskcontroller/index.md" target="_blank" rel="noopener noreferrer">Edit on <b>GitHub</b></a></li>
<li><a href="https://github.com/mdn/content/blob/main/files/en-us/web/api/taskcontroller/index.md?plain=1" target="_blank" rel="noopener noreferrer">Source on <b>GitHub</b></a></li>
<li><a href="https://github.com/mdn/content/issues/new?template=page-report.yml&amp;mdn-url=https%3A%2F%2Fdeveloper.mozilla.org%2Fen-US%2Fdocs%2FWeb%2FAPI%2FTaskController&amp;metadata=%3C%21--+Do+not+make+changes+below+this+line+--%3E%0A%3Cdetails%3E%0A%3Csummary%3EPage+report+details%3C%2Fsummary%3E%0A%0A*+Folder%3A+%60en-us%2Fweb%2Fapi%2Ftaskcontroller%60%0A*+MDN+URL%3A+https%3A%2F%2Fdeveloper.mozilla.org%2Fen-US%2Fdocs%2FWeb%2FAPI%2FTaskController%0A*+GitHub+URL%3A+https%3A%2F%2Fgithub.com%2Fmdn%2Fcontent%2Fblob%2Fmain%2Ffiles%2Fen-us%2Fweb%2Fapi%2Ftaskcontroller%2Findex.md%0A*+Last+commit%3A+https%3A%2F%2Fgithub.com%2Fmdn%2Fcontent%2Fcommit%2F27e11bf5ee2425dc6b939d0d1825ac741414a688%0A*+Document+last+modified%3A+2022-07-23T09%3A11%3A31.000Z%0A%0A%3C%2Fdetails%3E" target="_blank" rel="noopener noreferrer">Report a problem with this content on <b>GitHub</b></a></li>
<li>Want to fix the problem yourself? See <a href="https://github.com/mdn/content/blob/main/README.md" target="_blank" rel="noopener noreferrer">our Contribution guide</a>.</li>
</ul>
</div>
<p class="last-modified-date"><b>Last modified:</b> <time datetime="2022-07-23T09:11:31.000Z">Jul 23, 2022</time>, <a href="taskcontroller/contributors.txt">by MDN contributors</a></p>
</div></aside><div class="_attribution">
  <p class="_attribution-p">
    <a href="https://developer.mozilla.org/en-US/docs/Web/API/TaskController" class="_attribution-link" target="_blank">https://developer.mozilla.org/en-US/docs/Web/API/TaskController</a>
  </p>
</div>
