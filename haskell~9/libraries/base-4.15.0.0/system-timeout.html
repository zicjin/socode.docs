<h1 class="caption">System.Timeout</h1>
<div class="_haskell-api">
<table class="info">
<tr>
<th valign="top">Copyright</th>
<td>(c) The University of Glasgow 2007</td>
</tr>
<tr>
<th>License</th>
<td>BSD-style (see the file libraries/base/LICENSE)</td>
</tr>
<tr>
<th>Maintainer</th>
<td>libraries@haskell.org</td>
</tr>
<tr>
<th>Stability</th>
<td>experimental</td>
</tr>
<tr>
<th>Portability</th>
<td>non-portable</td>
</tr>
<tr>
<th>Safe Haskell</th>
<td>Safe</td>
</tr>
<tr>
<th>Language</th>
<td>Haskell2010</td>
</tr>
</table>
<div id="description">
<h4 class="caption">Description</h4>
<p>Attach a timeout event to arbitrary <code><a href="system-io#t:IO" title="System.IO">IO</a></code> computations.</p>
</div>
<p class="src">data <a id="t:Timeout" class="def">Timeout</a> <a href="https://downloads.haskell.org/~ghc/9.0.1/docs/html/libraries/base-4.15.0.0/src/System-Timeout.html#Timeout" class="link">Source</a> </p>
<p>An exception thrown to a thread by <code><a href="system-timeout#v:timeout" title="System.Timeout">timeout</a></code> to interrupt a timed-out computation.</p>
<p><span class="version">Since: base-4.0</span></p>
<div class="subs instances">
<h5 class="instances details-toggle-control details-toggle" data-details-id="i:Timeout">Instances</h5>
<details id="i:Timeout" open="open"><summary class="hide-when-js-enabled">Instances details</summary><table>
<tr>
<td class="src clearfix">
 <a href="data-eq#t:Eq" title="Data.Eq">Eq</a> <a href="system-timeout#t:Timeout" title="System.Timeout">Timeout</a> </td>
<td class="doc empty"> </td>
</tr>
<tr><td colspan="2"><details id="i:id:Timeout:Eq:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="system-timeout">System.Timeout</a></p> <div class="subs methods">
<h4 class="caption">Methods</h4>
<p class="src"><a href="#v:-61--61-">(==)</a> :: <a href="system-timeout#t:Timeout" title="System.Timeout">Timeout</a> -&gt; <a href="system-timeout#t:Timeout" title="System.Timeout">Timeout</a> -&gt; <a href="data-bool#t:Bool" title="Data.Bool">Bool</a> <a href="https://downloads.haskell.org/~ghc/9.0.1/docs/html/libraries/ghc-prim-0.7.0/src/GHC-Classes.html#%3D%3D" class="link">Source</a> </p>
<p class="src"><a href="#v:-47--61-">(/=)</a> :: <a href="system-timeout#t:Timeout" title="System.Timeout">Timeout</a> -&gt; <a href="system-timeout#t:Timeout" title="System.Timeout">Timeout</a> -&gt; <a href="data-bool#t:Bool" title="Data.Bool">Bool</a> <a href="https://downloads.haskell.org/~ghc/9.0.1/docs/html/libraries/ghc-prim-0.7.0/src/GHC-Classes.html#%2F%3D" class="link">Source</a> </p>
</div></details></td></tr>
<tr>
<td class="src clearfix">
 <a href="text-show#t:Show" title="Text.Show">Show</a> <a href="system-timeout#t:Timeout" title="System.Timeout">Timeout</a> </td>
<td class="doc"><p><span class="version">Since: base-4.0</span></p></td>
</tr>
<tr><td colspan="2"><details id="i:id:Timeout:Show:2"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="system-timeout">System.Timeout</a></p> <div class="subs methods">
<h4 class="caption">Methods</h4>
<p class="src"><a href="#v:showsPrec">showsPrec</a> :: <a href="data-int#t:Int" title="Data.Int">Int</a> -&gt; <a href="system-timeout#t:Timeout" title="System.Timeout">Timeout</a> -&gt; <a href="text-show#t:ShowS" title="Text.Show">ShowS</a> <a href="https://downloads.haskell.org/~ghc/9.0.1/docs/html/libraries/base-4.15.0.0/src/GHC-Show.html#showsPrec" class="link">Source</a> </p>
<p class="src"><a href="#v:show">show</a> :: <a href="system-timeout#t:Timeout" title="System.Timeout">Timeout</a> -&gt; <a href="data-string#t:String" title="Data.String">String</a> <a href="https://downloads.haskell.org/~ghc/9.0.1/docs/html/libraries/base-4.15.0.0/src/GHC-Show.html#show" class="link">Source</a> </p>
<p class="src"><a href="#v:showList">showList</a> :: [<a href="system-timeout#t:Timeout" title="System.Timeout">Timeout</a>] -&gt; <a href="text-show#t:ShowS" title="Text.Show">ShowS</a> <a href="https://downloads.haskell.org/~ghc/9.0.1/docs/html/libraries/base-4.15.0.0/src/GHC-Show.html#showList" class="link">Source</a> </p>
</div></details></td></tr>
<tr>
<td class="src clearfix">
 <a href="https://downloads.haskell.org/~ghc/9.0.1/docs/html/libraries/base-4.15.0.0/Control-Exception-Base.html#t:Exception" title="Control.Exception.Base">Exception</a> <a href="system-timeout#t:Timeout" title="System.Timeout">Timeout</a> </td>
<td class="doc"><p><span class="version">Since: base-4.7.0.0</span></p></td>
</tr>
<tr><td colspan="2"><details id="i:id:Timeout:Exception:3"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="system-timeout">System.Timeout</a></p> <div class="subs methods">
<h4 class="caption">Methods</h4>
<p class="src"><a href="#v:toException">toException</a> :: <a href="system-timeout#t:Timeout" title="System.Timeout">Timeout</a> -&gt; <a href="https://downloads.haskell.org/~ghc/9.0.1/docs/html/libraries/base-4.15.0.0/Control-Exception-Base.html#t:SomeException" title="Control.Exception.Base">SomeException</a> <a href="https://downloads.haskell.org/~ghc/9.0.1/docs/html/libraries/base-4.15.0.0/src/GHC-Exception-Type.html#toException" class="link">Source</a> </p>
<p class="src"><a href="#v:fromException">fromException</a> :: <a href="https://downloads.haskell.org/~ghc/9.0.1/docs/html/libraries/base-4.15.0.0/Control-Exception-Base.html#t:SomeException" title="Control.Exception.Base">SomeException</a> -&gt; <a href="data-maybe#t:Maybe" title="Data.Maybe">Maybe</a> <a href="system-timeout#t:Timeout" title="System.Timeout">Timeout</a> <a href="https://downloads.haskell.org/~ghc/9.0.1/docs/html/libraries/base-4.15.0.0/src/GHC-Exception-Type.html#fromException" class="link">Source</a> </p>
<p class="src"><a href="#v:displayException">displayException</a> :: <a href="system-timeout#t:Timeout" title="System.Timeout">Timeout</a> -&gt; <a href="data-string#t:String" title="Data.String">String</a> <a href="https://downloads.haskell.org/~ghc/9.0.1/docs/html/libraries/base-4.15.0.0/src/GHC-Exception-Type.html#displayException" class="link">Source</a> </p>
</div></details></td></tr>
</table></details>
</div>
<p class="src"><a id="v:timeout" class="def">timeout</a> :: <a href="data-int#t:Int" title="Data.Int">Int</a> -&gt; <a href="system-io#t:IO" title="System.IO">IO</a> a -&gt; <a href="system-io#t:IO" title="System.IO">IO</a> (<a href="data-maybe#t:Maybe" title="Data.Maybe">Maybe</a> a) <a href="https://downloads.haskell.org/~ghc/9.0.1/docs/html/libraries/base-4.15.0.0/src/System-Timeout.html#timeout" class="link">Source</a> </p>
<p>Wrap an <code><a href="system-io#t:IO" title="System.IO">IO</a></code> computation to time out and return <code>Nothing</code> in case no result is available within <code>n</code> microseconds (<code>1/10^6</code> seconds). In case a result is available before the timeout expires, <code>Just a</code> is returned. A negative timeout interval means "wait indefinitely". When specifying long timeouts, be careful not to exceed <code>maxBound :: Int</code>.</p>
<pre class="screen">&gt;&gt;&gt; <strong class="userinput">timeout 1000000 (threadDelay 1000 *&gt; pure "finished on time")
</strong>Just "finished on time"
</pre>
<pre class="screen">&gt;&gt;&gt; <strong class="userinput">timeout 10000 (threadDelay 100000 *&gt; pure "finished on time")
</strong>Nothing
</pre>
<p>The design of this combinator was guided by the objective that <code>timeout n f</code> should behave exactly the same as <code>f</code> as long as <code>f</code> doesn't time out. This means that <code>f</code> has the same <code><a href="control-concurrent#v:myThreadId" title="Control.Concurrent">myThreadId</a></code> it would have without the timeout wrapper. Any exceptions <code>f</code> might throw cancel the timeout and propagate further up. It also possible for <code>f</code> to receive exceptions thrown to it by another thread.</p>
<p>A tricky implementation detail is the question of how to abort an <code>IO</code> computation. This combinator relies on asynchronous exceptions internally (namely throwing the computation the <code><a href="system-timeout#t:Timeout" title="System.Timeout">Timeout</a></code> exception). The technique works very well for computations executing inside of the Haskell runtime system, but it doesn't work at all for non-Haskell code. Foreign function calls, for example, cannot be timed out with this combinator simply because an arbitrary C function cannot receive asynchronous exceptions. When <code>timeout</code> is used to wrap an FFI call that blocks, no timeout event can be delivered until the FFI call returns, which pretty much negates the purpose of the combinator. In practice, however, this limitation is less severe than it may sound. Standard I/O functions like <code><a href="system-io#v:hGetBuf" title="System.IO">hGetBuf</a></code>, <code><a href="system-io#v:hPutBuf" title="System.IO">hPutBuf</a></code>, Network.Socket.accept, or <code><a href="system-io#v:hWaitForInput" title="System.IO">hWaitForInput</a></code> appear to be blocking, but they really don't because the runtime system uses scheduling mechanisms like <code>select(2)</code> to perform asynchronous I/O, so it is possible to interrupt standard socket I/O or file I/O using this combinator.</p>
</div><div class="_attribution">
  <p class="_attribution-p">
    <a href="https://downloads.haskell.org/~ghc/9.0.1/docs/html/libraries/base-4.15.0.0/System-Timeout.html" class="_attribution-link" target="_blank">https://downloads.haskell.org/~ghc/9.0.1/docs/html/libraries/base-4.15.0.0/System-Timeout.html</a>
  </p>
</div>
