<h1 class="postHeaderTitle">Building React Native from source</h1>
<p>You will need to build React Native from source if you want to work on a new feature/bug fix, try out the latest features which are not released yet, or maintain your own fork with patches that cannot be merged to the core.</p> <h2 id="android">
Android</h2> <h3 id="prerequisites">
Prerequisites</h3> <p>Assuming you have the Android SDK installed, run <code>android</code> to open the Android SDK Manager.</p> <p>Make sure you have the following installed:</p> <ol> <li>Android SDK version 26 (compileSdkVersion in <a href="https://github.com/facebook/react-native/blob/master/ReactAndroid/build.gradle"><code>build.gradle</code></a>)</li> <li>SDK build tools version 26.0.3 (buildToolsVersion in <a href="https://github.com/facebook/react-native/blob/master/ReactAndroid/build.gradle"><code>build.gradle</code></a>)</li> <li>Android Support Repository &gt;= 26 (for Android Support Library)</li> <li>Android NDK (download links and installation instructions below)</li> </ol> <h4 id="point-gradle-to-your-android-sdk">
Point Gradle to your Android SDK:</h4> <p><strong>Step 1:</strong> Set environment variables through your local shell.</p> <p>Note: Files may vary based on shell flavor. See below for examples from common shells.</p> <ul> <li>bash: <code>.bash_profile</code> or <code>.bashrc</code>
</li> <li>zsh: <code>.zprofile</code> or <code>.zshrc</code>
</li> <li>ksh: <code>.profile</code> or <code>$ENV</code>
</li> </ul> <p>Example:</p> <pre data-language="jsx"><span class="hljs-builtin-name">export</span> <span class="hljs-attribute">ANDROID_SDK</span>=/Users/your_unix_name/android-sdk-macosx
<span class="hljs-builtin-name">export</span> <span class="hljs-attribute">ANDROID_NDK</span>=/Users/your_unix_name/android-ndk/android-ndk-r10e
</pre> <p><strong>Step 2:</strong> Create a <code>local.properties</code> file in the <code>android</code> directory of your react-native app with the following contents:</p> <p>Example:</p> <pre data-language="jsx">sdk.<span class="hljs-attribute">dir</span>=/Users/your_unix_name/android-sdk-macosx
ndk.<span class="hljs-attribute">dir</span>=/Users/your_unix_name/android-ndk/android-ndk-r10e
</pre> <h4 id="download-links-for-android-ndk">
Download links for Android NDK</h4> <ol> <li>Mac OS (64-bit) - <a href="http://dl.google.com/android/repository/android-ndk-r10e-darwin-x86_64.zip">http://dl.google.com/android/repository/android-ndk-r10e-darwin-x86_64.zip</a>
</li> <li>Linux (64-bit) - <a href="http://dl.google.com/android/repository/android-ndk-r10e-linux-x86_64.zip">http://dl.google.com/android/repository/android-ndk-r10e-linux-x86_64.zip</a>
</li> <li>Windows (64-bit) - <a href="http://dl.google.com/android/repository/android-ndk-r10e-windows-x86_64.zip">http://dl.google.com/android/repository/android-ndk-r10e-windows-x86_64.zip</a>
</li> <li>Windows (32-bit) - <a href="http://dl.google.com/android/repository/android-ndk-r10e-windows-x86.zip">http://dl.google.com/android/repository/android-ndk-r10e-windows-x86.zip</a>
</li> </ol> <p>You can find further instructions on the <a href="https://developer.android.com/ndk/index.html">official page</a>.</p> <h3 id="building-the-source">
Building the source</h3> <h4 id="1-installing-the-fork">
1. Installing the fork</h4> <p>First, you need to install <code>react-native</code> from your fork. For example, to install the master branch from the official repo, run the following:</p> <pre data-language="jsx">npm install --save github:facebook/react-native<span class="hljs-comment">#master</span>
</pre> <p>Alternatively, you can clone the repo to your <code>node_modules</code> directory and run <code>npm install</code> inside the cloned repo.</p> <h4 id="2-adding-gradle-dependencies">
2. Adding gradle dependencies</h4> <p>Add <code>gradle-download-task</code> as dependency in <code>android/build.gradle</code>:</p> <pre data-language="jsx">...
    <span class="hljs-keyword">dependencies</span> {
        <span class="hljs-keyword">classpath</span> <span class="hljs-string">'com.android.tools.build:gradle:1.3.1'</span>
        <span class="hljs-keyword">classpath</span> <span class="hljs-string">'de.undercouch:gradle-download-task:3.1.2'</span>

        <span class="hljs-comment">// <span class="hljs-doctag">NOTE:</span> Do not place your application dependencies here; they belong</span>
        <span class="hljs-comment">// in the individual module build.gradle files</span>
    }
...
</pre> <h4 id="3-adding-the-reactandroid-project">
3. Adding the <code>:ReactAndroid</code> project</h4> <p>Add the <code>:ReactAndroid</code> project in <code>android/settings.gradle</code>:</p> <pre data-language="jsx">...
<span class="hljs-keyword">include</span> <span class="hljs-string">':ReactAndroid'</span>

<span class="hljs-keyword">project</span>(<span class="hljs-string">':ReactAndroid'</span>).projectDir = <span class="hljs-keyword">new</span> <span class="hljs-keyword">File</span>(
    rootProject.projectDir, <span class="hljs-string">'../node_modules/react-native/ReactAndroid'</span>)
...
</pre> <p>Modify your <code>android/app/build.gradle</code> to use the <code>:ReactAndroid</code> project instead of the pre-compiled library, e.g. - replace <code>compile 'com.facebook.react:react-native:+'</code> with <code>compile project(':ReactAndroid')</code>:</p> <pre data-language="jsx">...
<span class="hljs-keyword">dependencies</span> {
    <span class="hljs-keyword">compile</span> <span class="hljs-keyword">fileTree</span>(dir: <span class="hljs-string">'libs'</span>, <span class="hljs-keyword">include</span>: [<span class="hljs-string">'*.jar'</span>])
    <span class="hljs-keyword">compile</span> <span class="hljs-string">'com.android.support:appcompat-v7:26.0.2'</span>

    <span class="hljs-keyword">compile</span> <span class="hljs-keyword">project</span>(<span class="hljs-string">':ReactAndroid'</span>)

    ...
}
...
</pre> <h4 id="4-making-3rd-party-modules-use-your-fork">
4. Making 3rd-party modules use your fork</h4> <p>If you use 3rd-party React Native modules, you need to override their dependencies so that they don't bundle the pre-compiled library. Otherwise you'll get an error while compiling - <code>Error: more than one library with package name 'com.facebook.react'</code>.</p> <p>Modify your <code>android/app/build.gradle</code>, and add:</p> <pre data-language="jsx"><span class="hljs-keyword">configurations</span>.all {
    <span class="hljs-keyword">exclude</span> <span class="hljs-keyword">group</span>: <span class="hljs-string">'com.facebook.react'</span>, module: <span class="hljs-string">'react-native'</span>
}
</pre> <h3 id="building-from-android-studio">
Building from Android Studio</h3> <p>From the Welcome screen of Android Studio choose "Import project" and select the <code>android</code> folder of your app.</p> <p>You should be able to use the <em>Run</em> button to run your app on a device. Android Studio won't start the packager automatically, you'll need to start it by running <code>npm start</code> on the command line.</p> <h3 id="additional-notes">
Additional notes</h3> <p>Building from source can take a long time, especially for the first build, as it needs to download ~200 MB of artifacts and compile the native code. Every time you update the <code>react-native</code> version from your repo, the build directory may get deleted, and all the files are re-downloaded. To avoid this, you might want to change your build directory path by editing the <code>~/.gradle/init.gradle</code> file:</p> <pre data-language="jsx">gradle.projectsLoaded {
    rootProject.<span class="hljs-keyword">allprojects</span> {
        buildDir = <span class="hljs-string">"/path/to/build/directory/${rootProject.name}/${project.name}"</span>
    }
}
</pre> <h3 id="building-for-maven-nexus-deployment">
Building for Maven/Nexus deployment</h3> <p>If you find that you need to push up a locally compiled React Native .aar and related files to a remote Nexus repository, you can.</p> <p>Start by following the <code>Point Gradle to your Android SDK</code> section of this page. Once you do this, assuming you have Gradle configured properly, you can then run the following command from the root of your React Native checkout to build and package all required files:</p> <pre data-language="jsx">./gradlew <span class="hljs-string">ReactAndroid:</span>installArchives
</pre> <p>This will package everything that would typically be included in the <code>android</code> directory of your <code>node_modules/react-native/</code> installation in the root directory of your React Native checkout.</p> <h3 id="troubleshooting">
Troubleshooting</h3> <p>Gradle build fails in <code>ndk-build</code>. See the section about <code>local.properties</code> file above.</p> <h2 id="testing-your-changes">
Testing your Changes</h2> <p>If you made changes to React Native and submit a pull request, all tests will run on your pull request automatically. To run the tests locally, see <a href="testing">Testing your Changes</a>.</p><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2015&ndash;2018 Facebook Inc.<br>Licensed under the Creative Commons Attribution 4.0 International Public License.<br>
    <a href="https://facebook.github.io/react-native/docs/building-from-source.html" class="_attribution-link">https://facebook.github.io/react-native/docs/building-from-source.html</a>
  </p>
</div>
