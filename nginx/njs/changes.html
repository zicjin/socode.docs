<h1>Changes</h1>
<h4 id="njs0.7.2">Changes with njs 0.7.2</h4>
<p> Release Date: 25 January 2022 </p>
<p> Core: </p> <ul class="compact"> <li> <p> Bugfix: fixed <code>Array.prototype.join()</code> when array is changed while iterating. </p> </li> <li> <p> Bugfix: fixed <code>Array.prototype.slice()</code> when array is changed while iterating. </p> </li> <li> <p> Bugfix: fixed <code>Array.prototype.concat()</code> when array is changed while iterating. </p> </li> <li> <p> Bugfix: fixed <code>Array.prototype.reverse()</code> when array is changed while iterating. </p> </li> <li> <p> Bugfix: fixed <code>Buffer.concat()</code> with subarrays. Thanks to Sylvain Etienne. </p> </li> <li> <p> Bugfix: fixed type confusion bug while resolving promises. </p> </li> <li> <p> Bugfix: fixed <code>Function.prototype.apply()</code> with large array arguments. </p> </li> <li> <p> Bugfix: fixed recursive <code>async</code> function calls. </p> </li> <li> <p> Bugfix: fixed function redeclaration. The bug was introduced in <a href="#njs0.7.0">0.7.0</a>. </p> </li> </ul>

<h4 id="njs0.7.1">Changes with njs 0.7.1</h4>
<p> Release Date: 28 December 2021 </p>
<p> nginx modules: </p> <ul class="compact"> <li> <p> Change: the <a href="../http/ngx_http_js_module#js_include">js_include</a> directive deprecated since <a href="#njs0.4.0">0.4.0</a> was removed. </p> </li> <li> <p> Change: PCRE/PCRE2-specific code was moved to the modules. This ensures that njs uses the same RegExp library as nginx. </p> </li> </ul>

<p> Core: </p> <ul class="compact"> <li> <p> Bugfix: fixed <code>decodeURI()</code> and <code>decodeURIComponent()</code> with invalid byte strings. The bug was introduced in <a href="#njs0.4.3">0.4.3</a>. </p> </li> <li> <p> Bugfix: fixed heap-use-after-free in <code>await</code> frame. The bug was introduced in <a href="#njs0.7.0">0.7.0</a>. </p> </li> <li> <p> Bugfix: fixed WebCrypto <code>sign()</code> and <code>verify()</code> methods with OpenSSL 3.0. </p> </li> <li> <p> Bugfix: fixed exception throwing when RegExp match fails. The bug was introduced in <a href="#njs0.1.15">0.1.15</a>. </p> </li> <li> <p> Bugfix: fixed catching of exception thrown in <code>try</code> block of <code>async</code> function. The bug was introduced in <a href="#njs0.7.0">0.7.0</a>. </p> </li> <li> <p> Bugfix: fixed execution of <code>async</code> function in synchronous context. The bug was introduced in <a href="#njs0.7.0">0.7.0</a>. </p> </li> <li> <p> Bugfix: fixed function redeclaration in CLI when interactive mode is on. The bug was introduced in <a href="#njs0.6.2">0.6.2</a>. </p> </li> <li> <p> Bugfix: fixed <code>typeof</code> operator with <code>DataView</code> object. </p> </li> <li> <p> Bugfix: eliminated information leak in <code>Buffer.from()</code>. </p> </li> </ul>

<h4 id="njs0.7.0">Changes with njs 0.7.0</h4>
<p> Release Date: 19 October 2021 </p>
<p> nginx modules: </p> <ul class="compact"> <li> <p> Feature: Added <a href="../http/ngx_http_js_module#js_fetch_protocols">HTTPS</a> support for <a href="reference#ngx_fetch">Fetch API</a>. </p> </li> <li> <p> Feature: Added <code>setReturnValue()</code> method for <a href="reference#r_set_return_value">http</a> and <a href="reference#s_set_return_value">stream</a>. </p> </li> </ul>

<p> Core: </p> <ul class="compact"> <li> <p> Feature: introduced <code>Async/Await</code> implementation. </p> </li> <li> <p> Feature: added <a href="reference#builtin_crypto">WebCrypto API</a> implementation. </p> </li> <li> <p> Bugfix: fixed copying of closures for declared functions. The bug was introduced in <a href="#njs0.6.0">0.6.0</a>. </p> </li> <li> <p> Bugfix: fixed unhandled <code>promise</code> rejection in handle events. </p> </li> <li> <p> Bugfix: fixed Response.headers getter in Fetch API. </p> </li> </ul>

<h4 id="njs0.6.2">Changes with njs 0.6.2</h4>
<p> Release Date: 31 August 2021 </p>
<p> nginx modules: </p> <ul class="compact"> <li> <p> Bugfix: fixed CPU hog when <code>js_filter</code> is registered in both directions. </p> </li> </ul>

<p> Core: </p> <ul class="compact"> <li> <p> Feature: introduced <code>AggregateError</code> implementation. </p> </li> <li> <p> Feature: added remaining <code>Promise</code> constructor methods. The following methods were added: <code>Promise.all()</code> , <code>Promise.allSettled()</code> , <code>Promise.any()</code> , <code>Promise.race()</code> . </p> </li> <li> <p> Improvement: removed recursion from code generator. </p> </li> <li> <p> Bugfix: fixed rest parameter parsing without binding identifier. </p> </li> <li> <p> Bugfix: fixed resolve/reject callback for <code> Promise.prototype.finally()</code> . </p> </li> <li> <p> Bugfix: fixed <code> %TypedArray%.prototype.join()</code> with detached buffer. </p> </li> <li> <p> Bugfix: fixed memory leak in interactive shell. </p> </li> </ul>

<h4 id="njs0.6.1">Changes with njs 0.6.1</h4>
<p> Release Date: 29 June 2021 </p>
 <ul class="compact"> <li> <p> Bugfix: fixed <code>RegExpBuiltinExec()</code> with UTF-8 only regexps. The bug was introduced in <a href="#njs0.4.2">0.4.2</a>. </p> </li> <li> <p> Bugfix: fixed parsing of export default declaration with non-assignment expressions. Thanks to Artem S. Povalyukhin. </p> </li> </ul>

<h4 id="njs0.6.0">Changes with njs 0.6.0</h4>
<p> Release Date: 15 June 2021 </p>
<p> Core: </p> <ul class="compact"> <li> <p> Feature: added <code>let</code> and <code>const</code> declaration support. </p> </li> <li> <p> Feature: added <code>RegExp.prototype[Symbol.split]</code>. </p> </li> <li> <p> Feature: added sticky flag support for RegExp. </p> </li> <li> <p> Bugfix: fixed heap-buffer-overflow in <code>String.prototype.lastIndexOf()</code>. </p> </li> <li> <p> Bugfix: fixed <code>RegExp.prototype.test()</code> according to the specification. </p> </li> <li> <p> Bugfix: fixed <code>String.prototype.split()</code> according to the specification. </p> </li> <li> <p> Bugfix: fixed use-of-uninitialized-value while tracking rejected promises. </p> </li> <li> <p> Bugfix: fixed <code>njs.dump()</code> for objects with circular references. </p> </li> </ul>

<h4 id="njs0.5.3">Changes with njs 0.5.3</h4>
<p> Release Date: 30 March 2021 </p>
<p> nginx modules: </p> <ul class="compact"> <li> <p> Feature: added the <code>js_var</code> directive for <a href="../http/ngx_http_js_module#js_var">http</a> and <a href="../stream/ngx_stream_js_module#js_var">stream</a>. </p> </li> </ul>

<h4 id="njs0.5.2">Changes with njs 0.5.2</h4>
<p> Release Date: 09 March 2021 </p>
<p> nginx modules: </p> <ul class="compact"> <li> <p> Feature: added the <a href="../http/ngx_http_js_module#js_body_filter"><code>js_body_filter</code></a> directive. </p> </li> <li> <p> Feature: introduced the <a href="reference#s_status"><code>s.status</code></a> property for <a href="reference#stream">Stream Session</a> object. </p> </li> </ul>

<p> Core: </p> <ul class="compact"> <li> <p> Feature: added <a href="reference#njs_on"><code>njs.on</code></a> (<code>exit</code>) callback support. </p> </li> <li> <p> Bugfix: fixed property descriptor reuse for not extensible objects. Thanks to Artem S. Povalyukhin. </p> </li> <li> <p> Bugfix: fixed <code>Object.freeze()</code> and friends according to the specification. Thanks to Artem S. Povalyukhin. </p> </li> <li> <p> Bugfix: fixed <code>Function()</code> in CLI mode. </p> </li> <li> <p> Bugfix: fixed for-in iteration of typed array values. Thanks to Artem S. Povalyukhin. </p> </li> </ul>

<h4 id="njs0.5.1">Changes with njs 0.5.1</h4>
<p> Release Date: 16 February 2021 </p>
<p> nginx modules: </p> <ul class="compact"> <li> <p> Feature: introduced <a href="reference#ngx_fetch"><code>ngx.fetch()</code></a> method implementing Fetch API. </p> <p> The following properties and methods of <a href="reference#response"><code>Response</code></a> object are implemented: <a href="reference#response_arraybuffer"><code>arrayBuffer()</code></a>, <a href="reference#response_bodyused"><code>bodyUsed</code></a>, <a href="reference#response_json"><code>json()</code></a>, <a href="reference#response_headers"><code>headers</code></a>, <a href="reference#response_ok"><code>ok</code></a>, <a href="reference#response_redirect"><code>redirect</code></a>, <a href="reference#response_status"><code>status</code></a>, <a href="reference#response_statustext"><code>statusText</code></a>, <a href="reference#response_text"><code>text()</code></a>, <a href="reference#response_type"><code>type</code></a>, <a href="reference#response_url"><code>url</code></a>. </p> <p> Notable limitations: only the <code>http://</code> scheme is supported, redirects are not handled. </p> <p> In collaboration with 洪志道 (Hong Zhi Dao). </p> </li> <li> <p> Feature: added the <a href="../http/ngx_http_js_module#js_header_filter"><code>js_header_filter</code></a> directive. </p> </li> <li> <p> Bugfix: fixed processing buffered data in body filter in <a href="../stream/ngx_stream_js_module">stream</a> module. </p> </li> </ul>

<p> Core: </p> <ul class="compact"> <li> <p> Bugfix: fixed safe mode bypass in <code>Function</code> constructor. </p> </li> <li> <p> Bugfix: fixed <code>Date.prototype.toISOString()</code> with invalid date values. </p> </li> </ul>

<h4 id="njs0.5.0">Changes with njs 0.5.0</h4>
<p> Release Date: 01 December 2020 </p>
<p> nginx modules: </p> <ul class="compact"> <li> <p> Feature: introduced global <a href="reference#ngx"><code>ngx</code></a> object. </p> <p> The following methods were added: </p> <ul class="compact"> <li> <p> <a href="reference#ngx_log"><code>ngx.log(level,
message)</code></a> </p> </li> </ul>
 <p> The following properties were added: </p> <ul class="compact"> <li> <p> <code>ngx.INFO</code>, <code>ngx.WARN</code>, <code>ngx.ERR</code>. </p> </li> </ul>
 </li> <li> <p> Feature: added support for <code>Buffer</code> object where string is expected. </p> </li> <li> <p> Feature: added Buffer version of existing properties. </p> <p> The following properties were added: </p> <ul class="compact"> <li> <p> <a href="reference#r_request_buffer"><code>r.requestBuffer</code></a> (<a href="reference#r_request_body"><code>r.requestBody</code></a>), <a href="reference#r_response_buffer"><code>r.responseBuffer</code></a> (<a href="reference#r_response_body"><code>r.responseBody</code></a>), <a href="reference#r_raw_variables"><code>r.rawVariables</code></a> (<a href="reference#r_variables"><code>r.variables</code></a>), <a href="reference#s_raw_variables"><code>s.rawVariables</code></a> (<a href="reference#s_variables"><code>s.variables</code></a>). </p> </li> </ul>
 <p> The following events were added in the stream module: </p> <ul class="compact"> <li> <p> <a href="reference#s_on"><code>upstream</code></a> (upload), <a href="reference#s_on"><code>downstream</code></a> (download). </p> </li> </ul>
 </li> <li> <p> Improvement: added aliases to existing properties. </p> <p> The following properties were added: </p> <ul class="compact"> <li> <p> <a href="reference#r_request_text"><code>r.requestText</code></a> (<a href="reference#r_request_body"><code>r.requestBody</code></a>), <a href="reference#r_response_text"><code>r.responseText</code></a> (<a href="reference#r_response_body"><code>r.responseBody</code></a>). </p> </li> </ul>
 </li> <li> <p> Improvement: throwing an exception in <a href="reference#r_internal_redirect"><code>r.internalRedirect()</code></a> for a subrequest. </p> </li> <li> <p> Bugfix: fixed promise <a href="reference#r_subrequest"><code>r.subrequest()</code></a> with <a href="../http/ngx_http_core_module#error_page"><code>error_page</code></a> redirect. </p> </li> <li> <p> Bugfix: fixed <code>promise</code> events handling. </p> </li> </ul>

<p> Core: </p> <ul class="compact"> <li> <p> Feature: added <code>TypeScript</code> definitions for built-in modules. Thanks to Jakub Jirutka. </p> </li> <li> <p> Feature: tracking unhandled <code>promise</code> rejection. </p> </li> <li> <p> Feature: added initial iterator support. Thanks to Artem S. Povalyukhin. </p> </li> <li> <p> Improvement: <code>TypeScript</code> definitions are refactored. Thanks to Jakub Jirutka. </p> </li> <li> <p> Improvement: added forgotten support for <code>Object.prototype.valueOf()</code> in <code>Buffer.from()</code>. </p> </li> <li> <p> Bugfix: fixed heap-use-after-free in <code>JSON.parse()</code>. </p> </li> <li> <p> Bugfix: fixed heap-use-after-free in <code>JSON.stringify()</code>. </p> </li> <li> <p> Bugfix: fixed <code>JSON.stringify()</code> for arrays resizable via getters. </p> </li> <li> <p> Bugfix: fixed heap-buffer-overflow for <code>RegExp.prototype[Symbol.replace]</code>. </p> </li> <li> <p> Bugfix: fixed returned value for <code>Buffer.prototype.write*</code> functions. </p> </li> <li> <p> Bugfix: fixed <a href="reference#querystring_stringify"><code>querystring.stringify()</code></a>. Thanks to Artem S. Povalyukhin. </p> </li> <li> <p> Bugfix: fixed the catch handler for <code>Promise.prototype.finally()</code>. </p> </li> <li> <p> Bugfix: fixed <a href="reference#querystring_parse"><code>querystring.parse()</code></a>. </p> </li> </ul>

<h4 id="njs0.4.4">Changes with njs 0.4.4</h4>
<p> Release Date: 29 September 2020 </p>
<p> nginx modules: </p> <ul class="compact"> <li> <p> Bugfix: fixed location merge. </p> </li> <li> <p> Bugfix: fixed <a href="reference#r_http_version"><code>r.httpVersion</code></a> for HTTP/2. </p> </li> </ul>

<p> Core: </p> <ul class="compact"> <li> <p> Feature: added support for numeric separators (ES12). </p> </li> <li> <p> Feature: added remaining methods for <code>%TypedArray%.prototype</code>. The following methods were added: <code>every()</code>, <code>filter()</code>, <code>find()</code>, <code>findIndex()</code>, <code>forEach()</code>, <code>includes()</code>, <code>indexOf()</code>, <code>lastIndexOf()</code>, <code>map()</code>, <code>reduce()</code>, <code>reduceRight()</code>, <code>reverse()</code>, <code>some()</code>. </p> </li> <li> <p> Feature: added <code>%TypedArray%</code> remaining methods. The following methods were added: <code>from()</code>, <code>of()</code>. </p> </li> <li> <p> Feature: added <code>DataView</code> object. </p> </li> <li> <p> Feature: added <code>Buffer</code> object implementation. </p> </li> <li> <p> Feature: added support for <code>ArrayBuffer</code> in <a href="reference#textdecoder_decode"><code>TextDecoder.prototype.decode()</code></a> </p> </li> <li> <p> Feature: added support for <code>Buffer</code> object in <a href="reference#crypto"><code>crypto</code></a> methods. </p> </li> <li> <p> Feature: added support for <code>Buffer</code> object in <a href="reference#njs_api_fs"><code>fs</code></a> methods. </p> </li> <li> <p> Change: <a href="reference#crypto_hash_digest"><code>Hash.prototype.digest()</code></a> and <a href="reference#crypto_hmac_digest"><code>Hmac.prototype.digest()</code></a> now return a <code>Buffer</code> instance instead of a byte string when encoding is not provided. </p> </li> <li> <p> Change: <a href="reference#readfilesync"><code>fs.readFile()</code></a> and friends now return a <code>Buffer</code> instance instead of a byte string when encoding is not provided. </p> </li> <li> <p> Bugfix: fixed function <code>prototype</code> property handler while setting. </p> </li> <li> <p> Bugfix: fixed function <code>constructor</code> property handler while setting. </p> </li> <li> <p> Bugfix: fixed <code>String.prototype.indexOf()</code> for byte strings. </p> </li> <li> <p> Bugfix: fixed <code>RegExpBuiltinExec()</code> with a global flag and byte strings. </p> </li> <li> <p> Bugfix: fixed <code>RegExp.prototype[Symbol.replace]</code> the when replacement value is a function. </p> </li> <li> <p> Bugfix: fixed <a href="reference#textdecoder_decode"><code>TextDecoder.prototype.decode()</code></a> with non-zero <code>TypedArray</code> offset. </p> </li> </ul>

<h4 id="njs0.4.3">Changes with njs 0.4.3</h4>
<p> Release Date: 11 August 2020 </p>
<p> Core: </p> <ul class="compact"> <li> <p> Feature: added <a href="reference#querystring"><code>Query String</code></a> module. </p> </li> <li> <p> Feature: improved <a href="reference#fs_mkdirsync"><code>fs.mkdir()</code></a> to support recursive directory creation. Thanks to Artem S. Povalyukhin. </p> </li> <li> <p> Feature: improved <a href="reference#fs_rmdirsync"><code>fs.rmdir()</code></a> to support recursive directory removal. Thanks to Artem S. Povalyukhin. </p> </li> <li> <p> Feature: introduced UTF-8 decoder according to <a href="https://encoding.spec.whatwg.org/">WHATWG</a> encoding spec. </p> </li> <li> <p> Feature: added <a href="reference#textdecoder"><code>TextDecoder()</code></a> and <a href="reference#textencoder"><code>TextEncoder()</code></a> implementation. </p> </li> <li> <p> Bugfix: fixed parsing return statement without semicolon. </p> </li> <li> <p> Bugfix: fixed <code>njs_number_to_int32()</code> for big-endian platforms. </p> </li> <li> <p> Bugfix: fixed unit test on big-endian platforms. </p> </li> <li> <p> Bugfix: fixed regexp-literals parsing with “<code>=</code>” characters. </p> </li> <li> <p> Bugfix: fixed pre/post increment/decrement in assignment operations. </p> </li> </ul>

<h4 id="njs0.4.2">Changes with njs 0.4.2</h4>
<p> Release Date: 07 July 2020 </p>
<p> Core: </p> <ul class="compact"> <li> <p> Feature: added <code>RegExp.prototype[Symbol.replace]</code>. </p> </li> <li> <p> Feature: introduced line level backtrace. </p> </li> <li> <p> Feature: added <code>%TypedArray%.prototype.sort()</code>. </p> </li> <li> <p> Feature: extended <a href="reference#njs_api_fs"><code>fs</code></a> module. Added <a href="reference#fs_mkdirsync"><code>mkdir()</code></a>, <a href="reference#fs_readdirsync"><code>readdir()</code></a>, <a href="reference#fs_rmdirsync"><code>rmdir()</code></a>, and friends. </p> </li> <li> <p> Improvement: parser refactoring. </p> </li> <li> <p> Bugfix: fixed TypedScript API description for HTTP headers. </p> </li> <li> <p> Bugfix: fixed TypedScript API description for <code>NjsByteString</code> type. </p> </li> <li> <p> Bugfix: fixed <code>String.prototype.repeat()</code> according to the specification. </p> </li> <li> <p> Bugfix: fixed <code>String.prototype.replace()</code> according to the specification. </p> </li> <li> <p> Bugfix: fixed parsing of flags for regexp literals. </p> </li> <li> <p> Bugfix: fixed index generation for global objects in generator. </p> </li> <li> <p> Bugfix: fixed <code>%TypedArray%.prototype.copyWithin()</code> with nonzero byte offset. </p> </li> <li> <p> Bugfix: fixed <code>Array.prototype.splice()</code> for sparse arrays. </p> </li> <li> <p> Bugfix: fixed <code>Array.prototype.reverse()</code> for sparse arrays. </p> </li> <li> <p> Bugfix: fixed <code>Array.prototype.sort()</code> for sparse arrays. </p> </li> </ul>

<h4 id="njs0.4.1">Changes with njs 0.4.1</h4>
<p> Release Date: 19 May 2020 </p>
<p> nginx modules: </p> <ul class="compact"> <li> <p> Feature: added support for multi-value headers in <a href="reference#r_headers_in"><code>r.headersIn{}</code></a>. </p> </li> <li> <p> Feature: introduced <code>raw headers</code> API: <a href="reference#r_raw_headers_in"><code>r.rawHeadersIn{}</code></a> and <a href="reference#r_raw_headers_out"><code>r.rawHeadersOut{}</code></a>. </p> </li> <li> <p> Feature: added <a href="typescript">TypeScript</a> API description. </p> </li> </ul>

<p> Core: </p> <ul class="compact"> <li> <p> Bugfix: fixed <code>Array.prototype.slice()</code> for sparse arrays. </p> </li> </ul>

<h4 id="njs0.4.0">Changes with njs 0.4.0</h4>
<p> Release Date: 23 April 2020 </p>
<p> nginx modules: </p> <ul class="compact"> <li> <p> Feature: added support for multi-value headers in <a href="reference#r_headers_out"><code>r.headersOut{}</code></a>. </p> </li> <li> <p> Feature: added <code>js_import</code> directive for <a href="../http/ngx_http_js_module#js_import">http</a> and <a href="../stream/ngx_stream_js_module#js_import">stream</a>. </p> </li> <li> <p> Improvement: improved iteration over <a href="reference#r_headers_out"><code>r.headersOut{}</code></a> with special headers. </p> </li> <li> <p> Improvement: improved iteration over <a href="reference#r_headers_out"><code>r.headersOut{}</code></a> with duplicates. </p> </li> <li> <p> Change: <a href="reference#r_response_body"><code>r.responseBody</code></a> property handler now returns <code>undefined</code> instead of throwing an exception if the response body is not available. </p> </li> </ul>

<p> Core: </p> <ul class="compact"> <li> <p> Feature: added script arguments support in CLI. </p> </li> <li> <p> Feature: converting externals values to native js objects. </p> </li> <li> <p> Bugfix: fixed NULL-pointer dereference in <code>__proto__</code> property handler. </p> </li> <li> <p> Bugfix: fixed handling of no-newline at the end of the script. </p> </li> <li> <p> Bugfix: fixed <code>RegExp()</code> constructor with empty pattern and non-empty flags. </p> </li> <li> <p> Bugfix: fixed <code>String.prototype.replace()</code> when function returns non-string. </p> </li> <li> <p> Bugfix: fixed reading of pseudofiles in <a href="reference#njs_api_fs"><code>fs</code></a>. </p> </li> </ul>

<h4 id="njs0.3.9">Changes with njs 0.3.9</h4>
<p> Release Date: 03 March 2020 </p>
<p> nginx modules: </p> <ul class="compact"> <li> <p> Feature: added detached mode for <a href="reference#r_subrequest"><code>r.subrequest()</code></a>. Responses to detached subrequests are ignored. Unlike ordinary subrequests, a detached subrequest can be created inside a variable handler. </p> </li> </ul>

<p> Core: </p> <ul class="compact"> <li> <p> Feature: added <code>promises</code> API for <a href="reference#njs_api_fs"><code>fs</code></a> module. Thanks to Artem S. Povalyukhin. </p> </li> <li> <p> Feature: extended <a href="reference#njs_api_fs"><code>fs</code></a> module. Added <a href="reference#fs_accesssync"><code>access()</code></a>, <a href="reference#fs_symlinksync"><code>symlink()</code></a>, <a href="reference#fs_unlinksync"><code>unlink()</code></a>, <a href="reference#fs_realpathsync"><code>realpath()</code></a>, and friends. Thanks to Artem S. Povalyukhin. </p> </li> <li> <p> Improvement: introduced memory-efficient ordinary arrays. </p> </li> <li> <p> Improvement: lexer refactoring. </p> </li> <li> <p> Bugfix: fixed matching of native functions in backtraces. </p> </li> <li> <p> Bugfix: fixed callback invocations in <a href="reference#njs_api_fs"><code>fs</code></a> module. Thanks to Artem S. Povalyukhin. </p> </li> <li> <p> Bugfix: fixed <code>Object.getOwnPropertySymbols()</code>. </p> </li> <li> <p> Bugfix: fixed heap-buffer-overflow in <code>njs_json_append_string()</code>. </p> </li> <li> <p> Bugfix: fixed <code>encodeURI()</code> and <code>decodeURI()</code> according to the specification. </p> </li> <li> <p> Bugfix: fixed <code>Number.prototype.toPrecision()</code>. </p> </li> <li> <p> Bugfix: fixed handling of space argument in <code>JSON.stringify()</code>. </p> </li> <li> <p> Bugfix: fixed <code>JSON.stringify()</code> with <code>Number()</code> and <code>String()</code> objects. </p> </li> <li> <p> Bugfix: fixed Unicode Escaping in <code>JSON.stringify()</code> according to specification. </p> </li> <li> <p> Bugfix: fixed non-native module importing. Thanks to 洪志道 (Hong Zhi Dao). </p> </li> <li> <p> Bugfix: fixed <code>njs.dump()</code> with the <code>Date()</code> instance in a container. </p> </li> </ul>

<h4 id="njs0.3.8">Changes with njs 0.3.8</h4>
<p> Release Date: 21 January 2020 </p>
<p> nginx modules: </p> <ul class="compact"> <li> <p> Feature: added <code>Promise</code> support for <a href="reference#r_subrequest"><code>r.subrequest()</code></a>. If a callback is not provided, <a href="reference#r_subrequest"><code>r.subrequest()</code></a> returns an ordinary <code>Promise</code> object that resolves to a subrequest response object. </p> </li> <li> <p> Change: <a href="reference#r_parent"><code>r.parent</code></a> property handler now returns <code>undefined</code> instead of throwing an exception if a parent object is not available. </p> </li> </ul>

<p> Core: </p> <ul class="compact"> <li> <p> Feature: added <code>Promise</code> support. Implemented according to the specification without: <code>Promise.all()</code>, <code>Promise.allSettled()</code>, <code>Promise.race()</code>. </p> </li> <li> <p> Feature: added initial Typed-arrays support. Thanks to Tiago Natel de Moura. </p> </li> <li> <p> Feature: added <code>ArrayBuffer</code> support. Thanks to Tiago Natel de Moura. </p> </li> <li> <p> Feature: added initial <code>Symbol</code> support. Thanks to Artem S. Povalyukhin. </p> </li> <li> <p> Feature: added externals support for <code>JSON.stringify()</code>. </p> </li> <li> <p> Feature: added <code>Object.is()</code>. Thanks to Artem S. Povalyukhin. </p> </li> <li> <p> Feature: added <code>Object.setPrototypeOf()</code>. Thanks to Artem S. Povalyukhin. </p> </li> <li> <p> Feature: introduced nullish coalescing operator. </p> </li> <li> <p> Bugfix: fixed <code>Object.getPrototypeOf()</code> according to the specification. </p> </li> <li> <p> Bugfix: fixed <code>Object.prototype.valueOf()</code> according to the specification. </p> </li> <li> <p> Bugfix: fixed <code>JSON.stringify()</code> with unprintable values and replacer function. </p> </li> <li> <p> Bugfix: fixed operator <code>in</code> according to the specification. </p> </li> <li> <p> Bugfix: fixed <code>Object.defineProperties()</code> according to the specification. </p> </li> <li> <p> Bugfix: fixed <code>Object.create()</code> according to the specification. Thanks to Artem S. Povalyukhin. </p> </li> <li> <p> Bugfix: fixed <code>Number.prototype.toString(radix)</code> when fast-math is enabled. </p> </li> <li> <p> Bugfix: fixed <code>RegExp()</code> instance properties. </p> </li> <li> <p> Bugfix: fixed import segfault. Thanks to 洪志道 (Hong Zhi Dao). </p> </li> </ul>

<h4 id="njs0.3.7">Changes with njs 0.3.7</h4>
<p> Release Date: 19 November 2019 </p>
<p> nginx modules: </p> <ul class="compact"> <li> <p> Improvement: refactored iteration over external objects. </p> </li> </ul>

<p> Core: </p> <ul class="compact"> <li> <p> Feature: added <code>Object.assign()</code>. </p> </li> <li> <p> Feature: added <code>Array.prototype.copyWithin()</code>. </p> </li> <li> <p> Feature: added support for labels in <code>console.time()</code>. </p> </li> <li> <p> Change: removed <code>console.help()</code> from CLI. </p> </li> <li> <p> Improvement: moved constructors and top-level objects to global object. </p> </li> <li> <p> Improvement: arguments validation for configure script. </p> </li> <li> <p> Improvement: refactored JSON methods. </p> </li> <li> <p> Bugfix: fixed heap-buffer-overflow in <code>njs_array_reverse_iterator()</code> function. The following functions were affected: <code>Array.prototype.lastIndexOf()</code>, <code>Array.prototype.reduceRight()</code>. </p> </li> <li> <p> Bugfix: fixed <code>[[Prototype]]</code> slot of <code>NativeErrors</code>. </p> </li> <li> <p> Bugfix: fixed <code>NativeError.prototype.message</code> properties. </p> </li> <li> <p> Bugfix: added conversion of <code>this</code> value to object in <code>Array.prototype functions</code>. </p> </li> <li> <p> Bugfix: fixed iterator for <code>Array.prototype.find()</code> and <code>Array.prototype.findIndex()</code> functions. </p> </li> <li> <p> Bugfix: fixed <code>Array.prototype.includes()</code> and <code>Array.prototype.join()</code> with <code>undefined</code> argument. </p> </li> <li> <p> Bugfix: fixed <code>constructor</code> property of <code>Hash</code> and <code>Hmac</code> objects. </p> </li> <li> <p> Bugfix: fixed <code>__proto__</code> property of getters and setters. </p> </li> <li> <p> Bugfix: fixed <code>Date</code> object string formatting. </p> </li> <li> <p> Bugfix: fixed handling of <code>NaN</code> and <code>-0</code> arguments in <code>Math.min()</code> and <code>Math.max()</code>. </p> </li> <li> <p> Bugfix: fixed <code>Math.round()</code> according to the specification. </p> </li> <li> <p> Bugfix: reimplemented <code>bound</code> functions according to the specification. </p> </li> </ul>

<h4 id="njs0.3.6">Changes with njs 0.3.6</h4>
<p> Release Date: 22 October 2019 </p>
<p> nginx modules: </p> <ul class="compact"> <li> <p> Improvement: getting special headers from <a href="reference#r_headers_in"><code>r.headersIn{}</code></a>. </p> </li> </ul>

<p> Core: </p> <ul class="compact"> <li> <p> Feature: added new <code>Function()</code> support. </p> </li> <li> <p> Feature: added <code>Number.prototype.toFixed()</code>. </p> </li> <li> <p> Feature: added <code>Number.prototype.toPrecision()</code>. </p> </li> <li> <p> Feature: added <code>Number.prototype.toExponential()</code>. </p> </li> <li> <p> Improvement: making <code>prototype</code> property of function instances writable. </p> </li> <li> <p> Improvement: limiting recursion depth while compiling. </p> </li> <li> <p> Improvement: moving global functions to the global object. </p> </li> <li> <p> Bugfix: fixed prototype mutation for object literals. </p> </li> <li> <p> Bugfix: fixed heap-buffer-overflow while parsing regexp literals. </p> </li> <li> <p> Bugfix: fixed integer-overflow while parsing exponent of number literals. </p> </li> <li> <p> Bugfix: fixed <code>parseFloat()</code>. </p> </li> <li> <p> Bugfix: fixed <code>Array.prototype</code> functions according to the specification. The following functions were fixed: <code>every</code>, <code>includes</code>, <code>indexOf</code>, <code>filter</code>, <code>find</code>, <code>findIndex</code>, <code>forEach</code>, <code>lastIndexOf</code>, <code>map</code>, <code>pop</code>, <code>push</code>, <code>reduce</code>, <code>reduceRight</code>, <code>shift</code>, <code>some</code>, <code>unshift</code>. </p> </li> <li> <p> Bugfix: fixed handing of accessor descriptors in <code>Object.freeze()</code>. </p> </li> <li> <p> Bugfix: fixed <code>String.prototype.replace()</code> when first argument is not a string. </p> </li> <li> <p> Bugfix: fixed stack-use-after-scope in <code>Array.prototype.map()</code>. </p> </li> <li> <p> Bugfix: <code>Date.prototype.toUTCString()</code> format was aligned to ES9. </p> </li> <li> <p> Bugfix: fixed buffer overflow in <code>Number.prototype.toString(radix)</code>. </p> </li> <li> <p> Bugfix: fixed <code>Regexp.prototype.test()</code> for regexps with backreferences. </p> </li> <li> <p> Bugfix: fixed <code>Array.prototype.map()</code> for objects with nonexistent values. </p> </li> <li> <p> Bugfix: fixed <code>Array.prototype.pop()</code> and <code>shift()</code> for sparse objects. </p> </li> <li> <p> Bugfix: fixed <code>Date.UTC()</code> according to the specification. </p> </li> <li> <p> Bugfix: fixed <code>Date()</code> constructor according to the specification. </p> </li> <li> <p> Bugfix: fixed type of <code>Date.prototype</code>. Thanks to Artem S. Povalyukhin. </p> </li> <li> <p> Bugfix: fixed <code>Date.prototype.setTime()</code>. Thanks to Artem S. Povalyukhin. </p> </li> <li> <p> Bugfix: fixed default number of arguments expected by built-in functions. </p> </li> <li> <p> Bugfix: fixed <code>caller</code> and <code>arguments</code> properties of a function instance. Thanks to Artem S. Povalyukhin. </p> </li> </ul>

<h4 id="njs0.3.5">Changes with njs 0.3.5</h4>
<p> Release Date: 15 August 2019 </p>
<p> Core: </p> <ul class="compact"> <li> <p> Bugfix: fixed module importing using <code>require()</code>. The bug was introduced in <a href="#0.3.4">0.3.4</a>. </p> </li> <li> <p> Bugfix: fixed <code>[[SetPrototypeOf]]</code>. </p> </li> </ul>

<h4 id="njs0.3.4">Changes with njs 0.3.4</h4>
<p> Release Date: 13 August 2019 </p>
<p> Core: </p> <ul class="compact"> <li> <p> Feature: added <code>Object</code> shorthand methods and computed property names. Thanks to 洪志道 (Hong Zhi Dao) and Artem S. Povalyukhin. </p> </li> <li> <p> Feature: added getter/setter literal support. Thanks to 洪志道 (Hong Zhi Dao) and Artem S. Povalyukhin. </p> </li> <li> <p> Feature: added <a href="reference#fs_renamesync"><code>fs.renameSync()</code></a>. </p> </li> <li> <p> Feature: added <code>String.prototype.trimEnd()</code> and <code>String.prototype.trimStart()</code>. </p> </li> <li> <p> Improvement: added memory-sanitizer support. </p> </li> <li> <p> Improvement: Unicode case tables updated to version 12.1. </p> </li> <li> <p> Improvement: added UTF8 validation for string literals. </p> </li> <li> <p> Bugfix: fixed reading files with zero size in <a href="reference#readfilesync"><code>fs.readFileSync()</code></a>. </p> </li> <li> <p> Bugfix: extended the list of space separators in <code>String.prototype.trim()</code>. </p> </li> <li> <p> Bugfix: fixed using of uninitialized value in <code>String.prototype.padStart()</code>. </p> </li> <li> <p> Bugfix: fixed <code>String.prototype.replace()</code> for <code>$0</code> and <code>$&amp;</code> replacement string. </p> </li> <li> <p> Bugfix: fixed <code>String.prototype.replace()</code> for byte strings with regex argument. </p> </li> <li> <p> Bugfix: fixed global match in <code>String.prototype.replace()</code> with regexp argument. </p> </li> <li> <p> Bugfix: fixed <code>Array.prototype.slice()</code> for primitive types. </p> </li> <li> <p> Bugfix: fixed heap-buffer-overflow while importing module. </p> </li> <li> <p> Bugfix: fixed UTF-8 character escaping. </p> </li> <li> <p> Bugfix: fixed <code>Object.values()</code> and <code>Object.entries()</code> for shared objects. </p> </li> <li> <p> Bugfix: fixed uninitialized memory access in <code>String.prototype.match()</code>. </p> </li> <li> <p> Bugfix: fixed <code>String.prototype.match()</code> for byte strings with regex argument. </p> </li> <li> <p> Bugfix: fixed <code>Array.prototype.lastIndexOf()</code> with undefined arguments. </p> </li> <li> <p> Bugfix: fixed <code>String.prototype.substring()</code> with empty substring. </p> </li> <li> <p> Bugfix: fixed invalid memory access in <code>String.prototype.substring()</code>. </p> </li> <li> <p> Bugfix: fixed <code>String.fromCharCode()</code> for code points more than <code>65535</code> and <code>NaN</code>. </p> </li> <li> <p> Bugfix: fixed <code>String.prototype.toLowerCase()</code> and <code>String.prototype.toUpperCase()</code>. </p> </li> <li> <p> Bugfix: fixed <code>Error()</code> constructor with no arguments. </p> </li> <li> <p> Bugfix: fixed <code>in</code> operator for values with accessor descriptors. </p> </li> <li> <p> Bugfix: fixed <code>Object.defineProperty()</code> for non-boolean descriptor props. </p> </li> <li> <p> Bugfix: fixed <code>Error.prototype.toString()</code> with UTF8 string properties. </p> </li> <li> <p> Bugfix: fixed <code>Error.prototype.toString()</code> with non-string values for <code>name</code> and <code>message</code>. </p> </li> </ul>

<h4 id="njs0.3.3">Changes with njs 0.3.3</h4>
<p> Release Date: 25 June 2019 </p>
<p> nginx modules: </p> <ul class="compact"> <li> <p> Improvement: getting of special response headers in <a href="reference#r_headers_out"><code>r.headersOut{}</code></a>. </p> </li> <li> <p> Improvement: working with unknown methods in <a href="reference#r_subrequest"><code>r.subrequest()</code></a>. </p> </li> <li> <p> Improvement: added support for null as a second argument of <a href="reference#r_subrequest"><code>r.subrequest()</code></a>. </p> </li> <li> <p> Bugfix: fixed processing empty output chain in stream body filter. </p> </li> </ul>

<p> Core: </p> <ul class="compact"> <li> <p> Feature: added runtime support for property getter/setter. Thanks to 洪志道 (Hong Zhi Dao) and Artem S. Povalyukhin. </p> </li> <li> <p> Feature: added <a href="reference#process"><code>process</code></a> global object. </p> </li> <li> <p> Feature: writable most of built-in properties and methods. </p> </li> <li> <p> Feature: added generic implementation of <code>Array.prototype.fill()</code>. </p> </li> <li> <p> Bugfix: fixed integer-overflow in <code>String.prototype.concat()</code>. </p> </li> <li> <p> Bugfix: fixed setting of object properties. </p> </li> <li> <p> Bugfix: fixed <code>Array.prototype.toString()</code>. </p> </li> <li> <p> Bugfix: fixed <code>Date.prototype.toJSON()</code>. </p> </li> <li> <p> Bugfix: fixed overwriting “constructor” property of built-in prototypes. </p> </li> <li> <p> Bugfix: fixed processing of invalid surrogate pairs in strings. </p> </li> <li> <p> Bugfix: fixed processing of invalid surrogate pairs in JSON strings. </p> </li> <li> <p> Bugfix: fixed heap-buffer-overflow in <code>toUpperCase()</code> and <code>toLowerCase()</code>. </p> </li> <li> <p> Bugfix: fixed escaping lone closing square brackets in <code>RegExp()</code> constructor. </p> </li> <li> <p> Bugfix: fixed handling zero byte characters inside RegExp pattern strings. </p> </li> <li> <p> Bugfix: fixed <code>String.prototype.toBytes()</code> for ASCII strings. </p> </li> <li> <p> Bugfix: fixed truth value of JSON numbers in <code>JSON.parse()</code>. </p> </li> <li> <p> Bugfix: fixed use-of-uninitialized-value in <code>njs_string_replace_join()</code>. </p> </li> <li> <p> Bugfix: fixed <code>parseInt('-0')</code>. Thanks to Artem S. Povalyukhin. </p> </li> </ul>

<h4 id="njs0.3.2">Changes with njs 0.3.2</h4>
<p> Release Date: 21 May 2019 </p>
<p> Core: </p> <ul class="compact"> <li> <p> Feature: added support for template literals. Thanks to 洪志道 (Hong Zhi Dao) and Artem S. Povalyukhin. </p> </li> <li> <p> Feature: executing command from command line arguments. </p> </li> <li> <p> Feature: added support for RegExp <code>groups</code> object (ES9). </p> </li> <li> <p> Feature: added block scoped function definitions support. </p> </li> <li> <p> Feature: added support for building with GNU Readline library. </p> </li> <li> <p> Feature: made configurable <code>length</code>, <code>name</code>, and most of built-in methods. </p> </li> <li> <p> Feature: made all constructor properties configurable. </p> </li> <li> <p> Bugfix: fixed <code>Regexp.prototype.exec()</code> for Unicode-only regexps. </p> </li> <li> <p> Bugfix: fixed <code>njs_vm_value_dump()</code> for empty string values. </p> </li> <li> <p> Bugfix: fixed RegExp constructor for regexp value arguments. </p> </li> <li> <p> Bugfix: fixed walking over prototypes chain during iteration over an object. </p> </li> <li> <p> Bugfix: fixed overflow in <code>Array.prototype.concat()</code>. </p> </li> <li> <p> Bugfix: fixed length calculation for UTF-8 string with escape characters. </p> </li> <li> <p> Bugfix: fixed parsing surrogate pair presents as UTF-16 escape sequences. </p> </li> <li> <p> Bugfix: fixed processing the “*” quantifier for <code>String.prototype.match()</code>. </p> </li> <li> <p> Bugfix: fixed <code>Date()</code> constructor with one argument. </p> </li> <li> <p> Bugfix: fixed arrays expansion. </p> </li> <li> <p> Bugfix: fixed heap-buffer-overflow in <code>String.prototype.replace()</code>. </p> </li> <li> <p> Bugfix: fixed heap-buffer-overflow in <code>String.prototype.lastIndexOf()</code>. </p> </li> <li> <p> Bugfix: fixed regexp literals parsing with escaped backslash and backslash in square brackets. </p> </li> <li> <p> Bugfix: fixed regexp literals with lone closing brackets. </p> </li> <li> <p> Bugfix: fixed uninitialized-memory-access in <code>Object.defineProperties()</code>. </p> </li> <li> <p> Bugfix: fixed processing the “*” quantifier for <code>String.prototype.replace()</code>. </p> </li> <li> <p> Bugfix: fixed <code>Array.prototype.slice()</code> for UTF8-invalid byte strings. </p> </li> <li> <p> Bugfix: fixed <code>String.prototype.split()</code> for UTF8-invalid byte strings. </p> </li> <li> <p> Bugfix: fixed handling of empty block statements. </p> </li> </ul>

<h4 id="njs0.3.1">Changes with njs 0.3.1</h4>
<p> Release Date: 16 April 2019 </p>
<p> Core: </p> <ul class="compact"> <li> <p> Feature: added arrow functions support. Thanks to 洪志道 (Hong Zhi Dao) and Artem S. Povalyukhin. </p> </li> <li> <p> Feature: added <code>Object.getOwnPropertyNames()</code>. Thanks to Artem S. Povalyukhin. </p> </li> <li> <p> Feature: added <code>Object.getOwnPropertyDescriptors()</code>. Thanks to Artem S. Povalyukhin. </p> </li> <li> <p> Feature: making <code>__proto__</code> accessor descriptor of <code>Object</code> instances mutable. </p> </li> <li> <p> Feature: added shebang support in CLI. </p> </li> <li> <p> Feature: added support for module mode execution in CLI. In module mode global, this is unavailable. </p> </li> <li> <p> Bugfix: fixed editline detection. </p> </li> <li> <p> Bugfix: fixed <code>Function.prototype.bind()</code>. Thanks to 洪志道 (Hong Zhi Dao). </p> </li> <li> <p> Bugfix: fixed checking of duplication of parameters for functions. Thanks to 洪志道 (Hong Zhi Dao). </p> </li> <li> <p> Bugfix: fixed function declaration with the same name as a variable. Thanks to 洪志道 (Hong Zhi Dao). </p> </li> <li> <p> Improvement: code related to parsing of objects, variables and functions is refactored. Thanks to 洪志道 (Hong Zhi Dao). </p> </li> <li> <p> Improvement: large-value output improved in <code>console.log()</code>. </p> </li> <li> <p> Improvement: string output improved in <code>console.log()</code> in a compliant way (without escaping and quotes). </p> </li> <li> <p> Improvement: using ES6 version of <code>ToInt32()</code>, <code>ToUint32()</code>, <code>ToLength()</code>. </p> </li> </ul>

<h4 id="njs0.3.0">Changes with njs 0.3.0</h4>
<p> Release Date: 26 March 2019 </p>
<p> nginx modules: </p> <ul class="compact"> <li> <p> Feature: added the <code>js_path</code> directive for <a href="../http/ngx_http_js_module#js_path">http</a> and <a href="../stream/ngx_stream_js_module#js_path">stream</a>. </p> </li> <li> <p> Change: returning undefined value instead of empty strings for absent properties in the following objects: <a href="reference#r_args"><code>r.args{}</code></a>, <a href="reference#r_headers_in"><code>r.headersIn{}</code></a>, <a href="reference#r_headers_out"><code>r.headersOut{}</code></a>, <a href="reference#r_variables"><code>r.variables{}</code></a>, <a href="reference#s_variables"><code>s.variables{}</code></a>. </p> </li> <li> <p> Change: returning undefined value instead of throwing an exception for <a href="reference#r_request_body"><code>r.requestBody</code></a> when request body is unavailable. </p> </li> <li> <p> Bugfix: fixed crash while iterating over <a href="reference#r_args"><code>r.args{}</code></a> when a value is absent in a key-value pair. </p> </li> </ul>

<p> Core: </p> <ul class="compact"> <li> <p> Feature: added initial ES6 modules support. Default import and default export statements are supported. Thanks to 洪志道 (Hong Zhi Dao). </p> </li> <li> <p> Feature: added <code>Object.prototype.propertyIsEnumerable()</code>. </p> </li> <li> <p> Feature: reporting file name and function name in disassembler output. </p> </li> <li> <p> Bugfix: fixed function redeclarations in interactive shell. Thanks to 洪志道 (Hong Zhi Dao). </p> </li> <li> <p> Bugfix: fixed RegExp literals parsing. </p> </li> <li> <p> Bugfix: fixed setting length of UTF8 string in <a href="reference#readfilesync"><code>fs.readFileSync()</code></a>. </p> </li> <li> <p> Bugfix: fixed <code>nxt_file_dirname()</code> for paths with no dir component. </p> </li> </ul>

<h4 id="njs0.2.8">Changes with njs 0.2.8</h4>
<p> Release Date: 26 February 2019 </p>
<p> nginx modules: </p> <ul class="compact"> <li> <p> Change: properties of HTTP request deprecated in <a href="#njs0.2.2">0.2.2</a> are removed. </p> </li> <li> <p> Feature: added support for delete operation in <a href="reference#r_headers_out"><code>r.headersOut{}</code></a>. </p> </li> <li> <p> Feature: added support for setting nginx variables. </p> </li> <li> <p> Bugfix: fixed <a href="reference#r_subrequest"><code>r.subrequest()</code></a> for empty body value. </p> </li> <li> <p> Improvement: setting special response headers in <a href="reference#r_headers_out"><code>r.headersOut{}</code></a>. </p> </li> </ul>

<p> Core: </p> <ul class="compact"> <li> <p> Feature: added labels support. </p> </li> <li> <p> Feature: added <code>setImmediate()</code> method. </p> </li> <li> <p> Feature: added support for shorthand property names for Object literals. </p> </li> <li> <p> Bugfix: fixed <code>Function.prototype.bind()</code>. </p> </li> <li> <p> Bugfix: fixed parsing of string literals containing newline characters. </p> </li> <li> <p> Bugfix: fixed line number in reporting variable reference errors. </p> </li> <li> <p> Bugfix: fixed creation of long UTF8 strings. </p> </li> <li> <p> Bugfix: fixed setting special response headers in <code>String.prototype.split()</code> for Unicode strings. </p> </li> <li> <p> Bugfix: fixed heap-buffer-overflow in <code>String.prototype.split()</code>. </p> </li> <li> <p> Bugfix: fixed <code>Array.prototype.fill()</code>. Thanks to Artem S. Povalyukhin. </p> </li> <li> <p> Improvement: code related to function invocation is refactored. Thanks to 洪志道 (Hong Zhi Dao). </p> </li> <li> <p> Improvement: code related to variables is refactored. Thanks to 洪志道 (Hong Zhi Dao). </p> </li> <li> <p> Improvement: parser is refactored. Thanks to 洪志道 (Hong Zhi Dao). </p> </li> <li> <p> Improvement: reporting filenames in exceptions. </p> </li> </ul>

<h4 id="njs0.2.7">Changes with njs 0.2.7</h4>
<p> Release Date: 25 December 2018 </p>
<p> Core: </p> <ul class="compact"> <li> <p> Feature: rest parameters syntax (destructuring is not supported). Thanks to Alexander Pyshchev. </p> </li> <li> <p> Feature: added <code>Object.entries()</code> method. </p> </li> <li> <p> Feature: added <code>Object.values()</code> method. </p> </li> <li> <p> Improvement: code generator refactored and simplified. </p> </li> <li> <p> Bugfix: fixed automatic semicolon insertion. </p> </li> <li> <p> Bugfix: fixed assignment expression from compound assignment. </p> </li> <li> <p> Bugfix: fixed comparison of Byte and UTF8 strings. </p> </li> <li> <p> Bugfix: fixed type of iteration variable in for-in with array values. </p> </li> <li> <p> Bugfix: fixed building on platforms without librt. </p> </li> <li> <p> Bugfix: miscellaneous bugs have been fixed. </p> </li> </ul>

<h4 id="njs0.2.6">Changes with njs 0.2.6</h4>
<p> Release Date: 27 November 2018 </p>
<p> Core: </p> <ul class="compact"> <li> <p> Feature: making built-in prototypes mutable. </p> </li> <li> <p> Feature: making global object mutable. </p> </li> <li> <p> Feature: <code>console.time()</code> and <code>console.timeEnd()</code> methods. </p> </li> <li> <p> Feature: allowing variables and functions to be redeclared. </p> </li> <li> <p> Feature: extending <code>Object.defineProperty()</code> spec conformance. </p> </li> <li> <p> Feature: introduced quiet mode for CLI to handle simple expressions from stdin. </p> </li> <li> <p> Feature: introduced compact form of backtraces to handle stack overflows. </p> </li> <li> <p> Improvement: improved wording for various exceptions. </p> </li> <li> <p> Bugfix: fixed closure values handling. </p> </li> <li> <p> Bugfix: fixed equality operator for various value types. </p> </li> <li> <p> Bugfix: fixed handling of “this” keyword in various scopes. </p> </li> <li> <p> Bugfix: fixed handling non-object values in <code>Object.keys()</code>. </p> </li> <li> <p> Bugfix: fixed parsing of throw statement inside <code>if</code> statement. </p> </li> <li> <p> Bugfix: fixed parsing of newline after throw statement. </p> </li> <li> <p> Bugfix: fixed parsing of statements in if statement without newline. </p> </li> <li> <p> Bugfix: fixed size <code>uint32_t</code> overflow in <code>njs_array_expand()</code>. </p> </li> <li> <p> Bugfix: fixed <code>typeof</code> operator for <code>object_value</code> type. </p> </li> <li> <p> Bugfix: miscellaneous bugs have been fixed. </p> </li> </ul>

<h4 id="njs0.2.5">Changes with njs 0.2.5</h4>
<p> Release Date: 30 October 2018 </p>
<p> nginx modules: </p> <ul class="compact"> <li> <p> Bugfix: fixed counting pending events in stream module. </p> </li> <li> <p> Bugfix: fixed <code>s.off()</code> in stream module. </p> </li> <li> <p> Bugfix: fixed processing of data chunks in <code>js_filter</code> in stream module. </p> </li> <li> <p> Bugfix: fixed http <code>status</code> and <code>contentType</code> getter in http module. </p> </li> <li> <p> Bugfix: fixed http response and parent getters in http module. </p> </li> </ul>

<p> Core: </p> <ul class="compact"> <li> <p> Feature: arguments object support. </p> </li> <li> <p> Feature: non-integer fractions support. </p> </li> <li> <p> Improvement: handling non-array values in <code>Array.prototype.slice()</code>. </p> </li> <li> <p> Bugfix: fixed <code>Array.prototype.length</code> setter </p> </li> <li> <p> Bugfix: fixed <code>njs_array_alloc()</code> for length &gt; 2**31. </p> </li> <li> <p> Bugfix: handling int overflow in <code>njs_array_alloc()</code> on 32bit archs. </p> </li> <li> <p> Bugfix: fixed code size mismatch error message. </p> </li> <li> <p> Bugfix: fixed delete operator in a loop. </p> </li> <li> <p> Bugfix: fixed <code>Object.getOwnPropertyDescriptor()</code> for complex object (inherited from <code>Array</code> and <code>string</code> values). </p> </li> <li> <p> Bugfix: fixed <code>Object.prototype.hasOwnProperty()</code> for non-object properties </p> </li> <li> <p> Bugfix: miscellaneous bugs have been fixed. </p> </li> </ul>

<h4 id="njs0.2.4">Changes with njs 0.2.4</h4>
<p> Release Date: 18 September 2018 </p>
<p> nginx modules: </p> <ul class="compact"> <li> <p> Change: stream module handlers refactored. </p> <p> New methods and properties: <a href="reference#s_on"><code>s.on()</code></a>, <a href="reference#s_off"><code>s.off()</code></a>, <a href="reference#s_allow"><code>s.allow()</code></a>, <a href="reference#s_done"><code>s.done()</code></a>, <a href="reference#s_decline"><code>s.decline()</code></a>, <a href="reference#s_deny"><code>s.deny()</code></a>. </p> <p> Removed properties of the <a href="reference#stream">Stream</a> object: <code>s.OK</code>, <code>s.ABORT</code>, <code>s.AGAIN</code>, <code>s.DECLINED</code>, <code>s.ERROR</code> (replaced with <a href="reference#s_allow"><code>s.allow()</code></a>, <a href="reference#s_done"><code>s.done()</code></a>, <a href="reference#s_deny"><code>s.deny()</code></a>). </p> <p> <code>s.buffer</code> (for reading replaced with data argument of the corresponding callback, for writing use <a href="reference#s_send"><code>s.send()</code></a>). </p> <p> <code>s.fromUpstream</code> (replaced with a callback for a corresponding event). </p> <p> <code>s.eof</code> (replaced with  <a href="reference#s_on_callback_last"><code>flags.last</code></a>). </p> </li> </ul>

<p> Core: </p> <ul class="compact"> <li> <p> Feature: added <code>Function.prototype.length</code>. </p> </li> <li> <p> Feature: introduced sandboxing mode. </p> </li> <li> <p> Improvement: added exception strings where appropriate. </p> </li> <li> <p> Improvement: improved wording for primitive type conversion exception. </p> </li> <li> <p> Bugfix: throwing <code>TypeError</code> for attempts to change frozen properties. </p> </li> <li> <p> Bugfix: fixed <code>Object.defineProperty()</code> for existing properties. </p> </li> <li> <p> Bugfix: respecting the enumerable attribute while iterating by for in. </p> </li> <li> <p> Bugfix: respecting writable attribute for property handlers. </p> </li> <li> <p> Bugfix: fixed exception handling in arguments of a function. </p> </li> <li> <p> Bugfix: fixed <code>Object.prototype.toString</code> for different value types. </p> </li> <li> <p> Bugfix: fixed <code>Object()</code> constructor for object types arguments. </p> </li> <li> <p> Bugfix: fixed comparison of objects and strings. </p> </li> <li> <p> Bugfix: fixed <code>String.slice()</code> for undefined arguments. </p> </li> <li> <p> Bugfix: miscellaneous bugs have been fixed. </p> </li> </ul>

<h4 id="njs0.2.3">Changes with njs 0.2.3</h4>
<p> Release Date: 31 July 2018 </p>
<p> nginx modules: </p> <ul class="compact"> <li> <p> Bugfix: making a subrequest from a <code>Reply</code> object caused a segmentation fault. </p> </li> <li> <p> Bugfix: getting the parent property of the main <a href="reference#http">HTTP Request</a> object caused a segmentation fault. </p> </li> </ul>

<p> Core: </p> <ul class="compact"> <li> <p> Feature: added the pretty string representation for values. </p> </li> <li> <p> Feature: correctly printing floating point numbers. </p> </li> <li> <p> Feature: correctly parsing floating point numbers. </p> </li> <li> <p> Feature: <a href="reference#string_bytesfrom"><code>String.bytesFrom()</code></a> method (decoding <code>hex</code>, <code>base64</code>, <code>base64url</code> into a byte string). </p> </li> <li> <p> Feature: <code>String.padStart()</code> and <code>String.padEnd()</code> methods. </p> </li> <li> <p> Feature: added support of binary literals. </p> </li> <li> <p> Improvement: added information about illegal token in number parsing. </p> </li> <li> <p> Improvement: allowed uppercased <code>O</code> in octal literal values. </p> </li> <li> <p> Improvement: added support for multiple arguments in <code>console.log()</code>. </p> </li> <li> <p> Bugfix: fixed applying <code>call()</code> to methods of external values. </p> </li> <li> <p> Bugfix: fixed addition operator applied to an object. </p> </li> <li> <p> Bugfix: fixed exception handling in <code>njs_vm_value_to_ext_string()</code>. </p> </li> <li> <p> Bugfix: fixed <code>Number()</code> with boolean, null and undefined arguments. </p> </li> <li> <p> Bugfix: fixed error handling of setting non-numeric <code>Array.length</code>. </p> </li> <li> <p> Bugfix: fixed autocompletion for global objects. </p> </li> <li> <p> Bugfix: miscellaneous bugs have been fixed. </p> </li> </ul>

<h4 id="njs0.2.2">Changes with njs 0.2.2</h4>
<p> Release Date: 19 June 2018 </p>
<p> nginx modules: </p> <ul class="compact"> <li> <p> Change: merged HTTP <code>Response</code> and <code>Reply</code> into <a href="reference#http">HTTP Request</a>. New members of <code>Request</code>: </p> <ul class="compact"> <li> <p> <code>req.status</code> (<code>res.status</code>) </p> </li> <li> <p> <code>req.parent</code> (<code>reply.parent</code>) </p> </li> <li> <p> <code>req.requestBody</code> (<code>req.body</code>) </p> </li> <li> <p> <code>req.responseBody</code> (<code>reply.body</code>) </p> </li> <li> <p> <code>req.headersIn</code> (<code>req.headers</code>) </p> </li> <li> <p> <code>req.headersOut</code> (<code>res.headers</code>) </p> </li> <li> <p> <code>req.sendHeader()</code> (<code>res.sendHeader()</code>) </p> </li> <li> <p> <code>req.send()</code> (<code>res.send()</code>) </p> </li> <li> <p> <code>req.finish()</code> (<code>res.finish()</code>) </p> </li> <li> <p> <code>req.return()</code> (<code>res.return()</code>) </p> </li> </ul>
<p> Deprecated members of <code>Request</code>: </p> <ul class="compact"> <li> <p> <code>req.body</code> (use <code>req.requestBody</code> or <code>req.responseBody</code>) </p> </li> <li> <p> <code>req.headers</code> (use <code>req.headersIn</code> or <code>req.headersOut</code>) </p> </li> <li> <p> <code>req.response</code> </p> </li> </ul>
<p> Deprecated members of <code>Response</code>: </p> <ul class="compact"> <li> <p> <code>res.contentLength</code> (use <a href="reference#r_headers_out"><code>req.headersOut</code></a><code>['Content-Length']</code>) </p> </li> <li> <p> <code>res.contentType</code> (use <a href="reference#r_headers_out"><code>req.headersOut</code></a><code>['Content-Type']</code>) </p> </li> </ul>
<p> The deprecated properties will be removed in <a href="#njs0.2.8">next</a> releases. </p> </li> <li> <p> Feature: HTTP <a href="reference#r_internal_redirect">internalRedirect()</a> method. </p> </li> </ul>

<p> Core: </p> <ul class="compact"> <li> <p> Bugfix: fixed heap-buffer-overflow in <code>crypto.createHmac()</code>. </p> </li> </ul>

<h4 id="njs0.2.1">Changes with njs 0.2.1</h4>
<p> Release Date: 31 May 2018 </p>
<p> nginx modules: </p> <ul class="compact"> <li> <p> Feature: HTTP request body getter. </p> </li> <li> <p> Improvement: moved njs vm to the <code>main</code> configuration. </p> </li> <li> <p> Improvement: improved logging for <a href="../http/ngx_http_js_module#js_set">js_set</a> and <a href="../http/ngx_http_js_module#js_content">js_content</a> directives. </p> </li> <li> <p> Improvement: setting status code to 500 by default in the <a href="../http/ngx_http_js_module#js_content">js_content</a> handler </p> </li> <li> <p> Improvement: added the debug for the returned status code in <a href="../http/ngx_http_js_module#js_content">js_content</a> handler </p> </li> <li> <p> Bugfix: fixed error logging in <a href="../http/ngx_http_js_module#js_include">js_include</a>. </p> </li> </ul>

<p> Core: </p> <ul class="compact"> <li> <p> Feature: added array length setter. </p> </li> <li> <p> Improvement: public header <code>cleanup. njscript.h</code> is renamed to <code>njs.h</code>. </p> </li> <li> <p> Bugfix: fixed crypto <code>update()</code> method after <code>digest()</code> is called. </p> </li> <li> <p> Bugfix: fixed <code>crypto.createHmac()</code> for keys with size &lt;= alg size and &gt; 64. </p> </li> <li> <p> Bugfix: fixed <code>JSON.stringify()</code> for arrays with empty cells. </p> </li> <li> <p> Bugfix: fixed exception type for unsupported types in <code>JSON.stringify()</code>. </p> </li> <li> <p> Bugfix: fixed handling of undefined arguments of functions. </p> </li> <li> <p> Bugfix: fixed handling of missing <code>arg</code> of <code>Object.getOwnPropertyDescriptor()</code>. </p> </li> <li> <p> Bugfix: fixed handling of properties in <code>Object.getOwnPropertyDescriptor()</code>. </p> </li> <li> <p> Bugfix: fixed the writeable flag of <code>Array.length</code> property. </p> </li> <li> <p> Bugfix: fixed return value type of <code>clearTimeout()</code>. </p> </li> <li> <p> Bugfix: fixed <code>njs_vm_external_bind()</code>. </p> </li> <li> <p> Bugfix: miscellaneous bugs have been fixed. </p> </li> </ul>

<h4 id="njs0.2.0">Changes with njs 0.2.0</h4>
<p> Release Date: 03 April 2018 </p>
 <ul class="compact"> <li> <p> Feature: reporting njs version by CLI. </p> </li> <li> <p> Feature: textual description for type converting exceptions. </p> </li> <li> Feature: <code>setTimeout()</code> and <code>clearTimeout()</code> methods. </li> <li> <p> Feature: Byte string to <code>hex</code>, <code>base64</code>, <code>base64url</code> encodings. </p> </li> <li> <p> Feature: <a href="https://nodejs.org/api/crypto.html#crypto_class_hash">Node.js style</a> <code>Crypto</code> methods. </p> </li> <li> <p> Feature: HTTP and stream <code>warn()</code> and <code>error()</code> methods. </p> </li> <li> <p> Feature: HTTP <code>subrequest()</code> method. </p> </li> <li> <p> Feature: HTTP <code>return()</code> method. </p> </li> <li> <p> Bugfix: miscellaneous bugs have been fixed in the core and interactive shell. </p> </li> </ul>

<h4 id="njs0.1.15">Changes with njs 0.1.15</h4>
<p> Release Date: 20 November 2017 </p>
 <ul class="compact"> <li> <p> Feature: <code>Error</code>, <code>EvalError</code>, <code>InternalError</code>, <code>RangeError</code>, <code>ReferenceError</code>, <code>SyntaxError</code>, <code>TypeError</code>, <code>URIError</code> objects. </p> </li> <li> <p> Feature: octal literals support. </p> </li> <li> <p> Feature: <a href="https://nodejs.org/api/fs.html#fs_file_system">Node.js style</a> <code>File system</code> access methods: <code>fs.readFile()</code>, <code>fs.readFileSync()</code>, <code>fs.appendFile()</code>, <code>fs.appendFileSync()</code>, <code>fs.writeFile()</code>, <code>fs.writeFileSync()</code>. </p> </li> <li> <p> Feature: nginx modules print backtrace on exception. </p> </li> <li> <p> Bugfix: miscellaneous bugs have been fixed. </p> </li> </ul>

<h4 id="njs0.1.14">Changes with njs 0.1.14</h4>
<p> Release Date: 09 October 2017 </p>
 <ul class="compact"> <li> <p> Feature: JSON object. </p> </li> <li> <p> Feature: object level completions in interactive shell. </p> </li> <li> <p> Feature: various configure improvements. </p> </li> <li> <p> Bugfix: miscellaneous bugs have been fixed in the core and interactive shell. </p> </li> </ul>

<h4 id="njs0.1.13">Changes with njs 0.1.13</h4>
<p> Release Date: 31 August 2017 </p>
 <ul class="compact"> <li> <p> Feature: <code>console.log()</code> and <code>console.help()</code> methods in interactive shell. </p> </li> <li> <p> Feature: interactive shell prints backtrace on exception. </p> </li> <li> <p> Feature: interactive shell by default if <code>libedit</code> is available. </p> </li> <li> <p> Bugfix: processing of large files from <code>stdin</code> in command line mode. </p> </li> <li> <p> Bugfix: improved <code>editline</code> detection. </p> </li> </ul>

<h4 id="njs0.1.12">Changes with njs 0.1.12</h4>
<p> Release Date: 08 August 2017 </p>
 <ul class="compact"> <li> <p> Feature: Interactive shell. </p> </li> <li> <p> Bugfix: in <code>Object.isSealed()</code>. </p> </li> </ul>

<h4 id="njs0.1.11">Changes with njs 0.1.11</h4>
<p> Release Date: 27 June 2017 </p>
 <ul class="compact"> <li> <p> Feature: <code>Object.keys()</code>, <code>Object.prototype.hasOwnProperty()</code> methods. </p> </li> <li> <p> Feature: <code>Object.defineProperty()</code>, <code>Object.defineProperties()</code>, <code>Object.getOwnPropertyDescriptor()</code> methods. </p> </li> <li> <p> Feature: <code>Object.getPrototypeOf()</code>, <code>Object.prototype.isPrototypeOf()</code> methods. </p> </li> <li> <p> Feature: <code>Object.preventExtensions()</code>, <code>Object.isExtensible()</code>, <code>Object.freeze()</code>, <code>Object.isFrozen()</code>, <code>Object.seal()</code>, <code>Object.isSealed()</code> methods. </p> </li> <li> <p> Feature: scientific notation (<code>3.35e10</code>) literals support. </p> </li> <li> <p> Feature: hexadecimal (<code>0x1123</code>) literals support. </p> </li> <li> <p> Bugfix: processing of large array indexes. </p> </li> <li> <p> Bugfix: in <code>parseInt()</code> and <code>Date.parse()</code>. </p> </li> </ul>

<h4 id="njs0.1.10">Changes with njs 0.1.10</h4>
<p> Release Date: 04 April 2017 </p>
 <ul class="compact"> <li> <p> Feature: nested functions and function closures. </p> </li> <li> <p> Feature: <code>Array.of()</code>, <code>Array.prototype.fill()</code>, <code>Array.prototype.find()</code>, <code>Array.prototype.findIndex()</code> methods. </p> </li> <li> <p> Bugfix: miscellaneous bugs and segmentation faults have been fixed. </p> </li> </ul>

<h4 id="njs0.1.9">Changes with njs 0.1.9</h4>
<p> Release Date: 01 February 2017 </p>
 <ul class="compact"> <li> <p> Bugfix: global variables were not initialized when njs was used in nginx. </p> </li> </ul>

<h4 id="njs0.1.8">Changes with njs 0.1.8</h4>
<p> Release Date: 24 January 2017 </p>
 <ul class="compact"> <li> <p> Change: the <code>strict</code> mode is enforced, variables must be explicitly declared. </p> </li> <li> <p> Feature: <code>for</code> and <code>for-in</code> loops support variable declaration. </p> </li> <li> <p> Bugfix: global and function scopes have been fixed. </p> </li> <li> <p> Bugfix: now <code>for-in</code> loop does not discard the last value of property variable. </p> </li> <li> <p> Bugfix: miscellaneous bugs and segmentation faults have been fixed. </p> </li> </ul>

<h4 id="njs0.1.7">Changes with njs 0.1.7</h4>
<p> Release Date: 27 December 2016 </p>
 <ul class="compact"> <li> <p> Change: the <a href="../http/ngx_http_js_module#js_include">js_include</a> directive has been disabled at server and location levels. </p> </li> <li> <p> Feature: exponentiation operators. </p> </li> <li> <p> Bugfix: miscellaneous bugs and segmentation faults have been fixed. </p> </li> </ul>

<h4 id="njs0.1.6">Changes with njs 0.1.6</h4>
<p> Release Date: 13 December 2016 </p>
 <ul class="compact"> <li> <p> Change: the <a href="../http/ngx_http_js_module#js_set">js_set</a> directive has been disabled at server and location levels. </p> </li> <li> <p> Feature: ES6 <code>Math</code> methods. </p> </li> <li> <p> Bugfix: miscellaneous bugs and segmentation faults have been fixed. </p> </li> </ul>
<div class="_attribution">
  <p class="_attribution-p">
    <a href="https://nginx.org/en/docs/njs/changes.html" class="_attribution-link" target="_blank">https://nginx.org/en/docs/njs/changes.html</a>
  </p>
</div>
