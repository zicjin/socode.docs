  <h1 id="update-angular">Update Angular</h1> <p>This guide contains information to update to Angular version 13.</p> <h2 id="update-angular-cli-applications">Update Angular CLI applications</h2> <p>For step-by-step instructions on how to update to the latest Angular release and leverage the Angular automated migration tools, use the interactive update guide at <a href="https://update.angular.io" title=" Angular Update Guide">update.angular.io</a>.</p> <h2 id="changes-and-deprecations-in-version-13">Changes and deprecations in version 13</h2> <blockquote class="alert is-helpful"> <p>For information about the deprecation and removal practices of Angular, see <a href="releases#deprecation-practices" title="Deprecation practices - Angular versioning and releases | Angular">Angular Release Practices</a>.</p> </blockquote> <ul> <li> <p><strong>Removal of View Engine</strong></p> <p>Requires all applications and libraries to build using Ivy. See the <a href="https://blog.angular.io/76c02f782aa4" title="Upcoming improvements to Angular library distribution | Angular Blog">Upcoming improvements to Angular library distribution</a> blog.</p> </li> <li> <p><strong>Modernization of the Angular Package Format (APF)</strong></p> <p>Removed older output formats, including View Engine specific metadata.</p> </li> <li> <p><strong>Removal of IE11 Support</strong></p> <p>Removes all support for Microsoft Internet Explorer 11 (IE11). See <a href="https://github.com/angular/angular/issues/41840" title="RFC: Internet Explorer 11 support deprecation and removal #41840 | angular/angular | GitHub">Issue #41840</a>.</p> </li> <li> <p><strong>Testbed module teardown</strong></p> <p>Adds the option in <code>initTestEnvironment</code> to completely remove test environments from an application. See the <a href="https://dev.to/this-is-angular/improving-angular-tests-by-enabling-angular-testing-module-teardown-38kh" title="Improving Angular tests by enabling Angular testing module teardown | This is Angular | DEV Community">Improving Angular tests by enabling Angular testing module teardown</a> article.</p> </li> <li> <p><strong><code><a href="../api/localize/init/%24localize" class="code-anchor">$localize</a></code> tagged message strings</strong></p> <p>Adds documentation for the Angular <code><a href="../api/localize/init/%24localize" class="code-anchor">$localize</a></code> API and tagged message strings.</p> </li> <li> <p><strong>Disk Cache</strong></p> <p>Enables the persistent build cache by default for all applications. See <a href="https://github.com/angular/angular-cli/issues/21545" title="[RFC] Persistent build cache by default #21545 | angular/angular-cli | GitHub">Issue #21545</a>.</p> </li> </ul> <h3 id="breaking-changes-in-angular-version-13">Breaking changes in Angular version 13</h3>  <table> <thead> <tr> <th align="left"></th> <th align="left">Details</th> </tr> </thead> <tbody> <tr> <td align="left"><a href="https://github.com/angular/angular/pull/43642" title="feat(core): drop support for TypeScript 4.2 and 4.3 #43642 | angular/angular | GitHub"><strong>PR #43642</strong></a></td> <td align="left">TypeScript versions older than <code>4.4.2</code> are no longer supported.</td> </tr> <tr> <td align="left"><a href="https://github.com/angular/angular/pull/43740" title="feat(bazel): expose esm2020 and es2020 conditions in APF package exports #43740 | angular/angular | GitHub"><strong>PR #43740</strong></a></td> <td align="left">NodeJS versions older than <code>v12.20.0</code> are no longer supported. The Angular packages now use the NodeJS package exports feature with subpath patterns and requires a NodeJS version above <code>14.15.0</code> or <code>16.10.0</code>.</td> </tr> <tr> <td align="left"><a href="https://github.com/angular/angular/pull/31187" title="fix(router): Allow question marks in query param values #31187 | angular/angular | GitHub">PR #31187</a></td> <td align="left">Previously, the default url serializer dropped everything after and including a question mark in query parameters. That is, for a navigation to <code>/path?q=hello?&amp;other=123</code>, the query parameters parsed to just <code>{q: 'hello'}</code>. This is incorrect, because the URI spec allows for question mark characers in query data. This change now correctly parses the query parameters for <code>/path?q=hello?&amp;other=123</code> as <code>{q: 'hello?', other: '123'}</code>.</td> </tr> <tr> <td align="left"><a href="https://github.com/angular/angular/pull/41730" title="fix(common): synchronise location mock behavior with the navigators #41730 | angular/angular | GitHub">PR #41730</a></td> <td align="left">The behavior of the <code><a href="../api/common/testing/spylocation" class="code-anchor">SpyLocation</a></code> used by the <code><a href="../api/router/testing/routertestingmodule" class="code-anchor">RouterTestingModule</a></code> has changed to match the behavior of browsers. It no longer emits a <code>popstate</code> event when <code>Location.go</code> is called. In addition, <code>simulateHashChange</code> now triggers <em>both</em> a <code>hashchange</code> event and a <code>popstate</code> event. Tests that use <code>location.go</code> and expect the changes to be picked up by the <code><a href="../api/router/router" class="code-anchor">Router</a></code> should migrate to <code>simulateHashChange</code>. Each test is different in what it attempts to assert, so there is no single change that works for all tests. Each test that uses the <code><a href="../api/common/testing/spylocation" class="code-anchor">SpyLocation</a></code> to simulate changes in the browser URL should be evaluated on a case-by-case basis.</td> </tr> <tr> <td align="left"><a href="https://github.com/angular/angular/pull/42952" title="feat(forms): Give form statuses a more specific type #42952 | angular/angular | GitHub">PR #42952</a></td> <td align="left">A new type called <code><a href="../api/forms/formcontrolstatus" class="code-anchor">FormControlStatus</a></code> has been introduced, which is a union of all possible status strings for form controls. <code><a href="../api/forms/abstractcontrol#status" class="code-anchor">AbstractControl.status</a></code> has been narrowed from <code>string</code> to <code><a href="../api/forms/formcontrolstatus" class="code-anchor">FormControlStatus</a></code>, and <code>statusChanges</code> has been narrowed from <code>Observable&lt;any&gt;</code> to <code>Observable&lt;<a href="../api/forms/formcontrolstatus" class="code-anchor">FormControlStatus</a>&gt;</code>. Most applications should consume the new types seamlessly. Any breakage caused by this change is likely due to one of the following two problems: <ol>
<li>The app is comparing <code><a href="../api/forms/abstractcontrol#status" class="code-anchor">AbstractControl.status</a></code> against a string which is not a valid status.</li>
<li>The app is using <code>statusChanges</code> events as if they were something other than strings.</li>
</ol>
</td> </tr> <tr> <td align="left"><a href="https://github.com/angular/angular/pull/43087" title="fix(router): null/undefined routerLink should disable navigation #43087 | angular/angular | GitHub">PR #43087</a></td> <td align="left">Previously ,<code>null</code> and <code>undefined</code> inputs for <code><a href="../api/router/routerlink" class="code-anchor">routerLink</a></code> were equivalent to empty string and there was no way to disable the navigation of the link. In addition, the <code>href</code> is changed from a property <code><a href="../api/core/hostbinding" class="code-anchor">HostBinding</a>()</code> to an attribute binding (<code><a href="../api/core/hostbinding" class="code-anchor">HostBinding</a>('attr.href')</code>). The effect of this change is that <code><a href="../api/core/debugelement#properties" class="code-anchor">DebugElement.properties</a>['href']</code> now returns the <code>href</code> value returned by the native element which is the full URL rather than the internal value of the <code><a href="../api/router/routerlink" class="code-anchor">RouterLink</a></code> <code>href</code> property.</td> </tr> <tr> <td align="left"><a href="https://github.com/angular/angular/pull/43496" title="fix(router): Prevent URL flicker when new navigations cancel ongoing ... #43496 | angular/angular | GitHub">PR #43496</a></td> <td align="left">The router no longer replaces the browser URL when a new navigation cancels an ongoing navigation. The replacement of the browser URL often caused URL flicker and was only in place to support some AngularJS hybrid applications. Hybrid applications which rely on the presence of <code>navigationId</code> on each initial navigation handled by the Angular router should instead subscribe to <code><a href="../api/router/navigationcancel" class="code-anchor">NavigationCancel</a></code> events and manually perform the <code>location.replaceState</code> to add <code>navigationId</code> to the Router state.In addition, tests that assert <code>urlChanges</code> on the <code><a href="../api/common/testing/spylocation" class="code-anchor">SpyLocation</a></code> should be adjusted to account for the lack of the <code>replaceState</code> trigger.</td> </tr> <tr> <td align="left"><a href="https://github.com/angular/angular/pull/43507" title="perf(core): remove support for the deprecated WrappedValue #43507 | angular/angular | GitHub">PR #43507</a></td> <td align="left">The <code>WrappedValue</code> class is no longer imported from <code>@angular/core</code>. This change may result in compile errors or failures at runtime, if outdated libraries are used that rely on <code>WrappedValue</code>. Dependancy on <code>WrappedValue</code> should be removed since no replacement is available.</td> </tr> <tr> <td align="left"><a href="https://github.com/angular/angular/pull/43591" title="refactor(router): remove support for loadChildren string syntax #43591 | angular/angular | GitHub">PR #43591</a></td> <td align="left">It is no longer possible to use <code><a href="../api/router/route#loadChildren" class="code-anchor">Route.loadChildren</a></code> with a string value. The following supporting classes were removed from <code>@angular/core</code>: <ul>
<li><code>NgModuleFactoryLoader</code></li>
<li><code>SystemJsNgModuleFactoryLoader</code></li>
</ul> The <code>@angular/router</code> package no longer exports the following symbols: <ul>
<li><code>SpyNgModuleFactoryLoader</code></li>
<li><code>DeprecatedLoadChildren</code></li>
</ul> The signature of the <code><a href="../api/router/testing/setuptestingrouter" class="code-anchor">setupTestingRouter</a></code> function from <code>@angular/core/testing</code> was changed to drop the <code>NgModuleFactoryLoader</code> parameter, since an value for that parameter can not be created.</td> </tr> <tr> <td align="left"><a href="https://github.com/angular/angular/pull/43668" title="feat(service-worker): improve ergonomics of the SwUpdate APIs #43668 | angular/angular | GitHub">PR #43668</a></td> <td align="left">The return type of <code><a href="../api/service-worker/swupdate" class="code-anchor">SwUpdate</a>#activateUpdate</code> and <code><a href="../api/service-worker/swupdate" class="code-anchor">SwUpdate</a>#checkForUpdate</code> changed to <code>Promise&lt;boolean&gt;</code>.Although unlikely, this change may cause TypeScript type-checking to fail in some cases. If necessary, update your types to account for the new return type.</td> </tr> <tr> <td align="left"><a href="https://github.com/angular/angular/pull/43791" title="fix(router): reuse route strategy fix #43791 | angular/angular | GitHub">PR #43791</a></td> <td align="left">When storing and retrieving a <code><a href="../api/router/detachedroutehandle" class="code-anchor">DetachedRouteHandle</a></code>, the Router traverses the <code><a href="../api/router/route" class="code-anchor">Route</a></code> children in order to correctly allow storing a parent route when there are several possible child <code><a href="../api/router/route" class="code-anchor">Route</a></code> configs that can be stored. This allows a <code><a href="../api/router/routereusestrategy" class="code-anchor">RouteReuseStrategy</a></code> to store a parent <code><a href="../api/router/route" class="code-anchor">Route</a></code> <em>and</em> a child, while preserving the ability to change the child route while restoring the parent. Some implementations of <code><a href="../api/router/routereusestrategy" class="code-anchor">RouteReuseStrategy</a></code> will need to be updated to correctly store and retrieve the <code><a href="../api/router/detachedroutehandle" class="code-anchor">DetachedRouteHandle</a></code> of descendants as well as the stored parent <code><a href="../api/router/activatedroutesnapshot" class="code-anchor">ActivatedRouteSnapshot</a></code>.  Previously, the <code><a href="../api/router/router" class="code-anchor">Router</a></code> would only store the parent, making it impossible to change descendant paths when a parent stored was retrieved. See <a href="https://github.com/angular/angular/issues/20114" title="RouteReuseStrategy impossible to store/retrieve siblings AND ALSO a non-sibling #20114 | angular/angular | GitHub"><strong>Issue #20114</strong></a>
</td> </tr> <tr> <td align="left"><a href="https://github.com/angular/angular-cli/issues/22159" title="Script imports are modules by default #22159 | angular/angular-cli | GitHub">Issue #22159</a></td> <td align="left">Scripts that load via dynamic <code>import()</code> are now treated as ES modules (meaning they must be strict mode-compatible).</td> </tr> </tbody> </table> <h3 id="new-deprecations">New deprecations</h3>  <table> <thead> <tr> <th align="left">Removed</th> <th align="left">Replacement</th> <th align="left">Details</th> </tr> </thead> <tbody> <tr> <td align="left"><a href="../api/core/getmodulefactory" title="getModuleFactory | Core - API | Angular"><code>getModuleFactory</code></a></td> <td align="left"><a href="../api/core/getngmodulebyid" title="getNgModuleById | Core - API | Angular"><code>getNgModuleById</code></a></td> <td align="left"></td> </tr> <tr> <td align="left">Factory-based signature of <a href="../api/core/applicationref#bootstrap" title="bootstrap - ApplicationRef | Core - API | Angular"><code>ApplicationRef.bootstrap</code></a>
</td> <td align="left">Type-based signature of <a href="../api/core/applicationref#bootstrap" title="bootstrap - ApplicationRef | Core - API | Angular"><code>ApplicationRef.bootstrap</code></a>
</td> <td align="left">Use the Type-based signature in place of the Factory-based signature.</td> </tr> <tr> <td align="left"><a href="../api/core/platformref#bootstrapModuleFactory" title="bootstrapModuleFactory - PlatformRef | Core - API | Angular"><code>PlatformRef.bootstrapModuleFactory</code></a></td> <td align="left"><a href="../api/core/platformref#bootstrapModule" title="bootstrapModule - PlatformRef | Core - API | Angular"><code>PlatformRef.bootstrapModule</code></a></td> <td align="left"></td> </tr> <tr> <td align="left"><a href="../api/core/modulewithcomponentfactories" title="ModuleWithComponentFactories | Core - API | Angular"><code>ModuleWithComponentFactories</code></a></td> <td align="left">none</td> <td align="left"></td> </tr> <tr> <td align="left"><a href="../api/core/compiler" title="Compiler | Core - API | Angular"><code>Compiler</code></a></td> <td align="left">none</td> <td align="left"></td> </tr> <tr> <td align="left"><a href="../api/core/compilerfactory" title="CompilerFactory | Core - API | Angular"><code>CompilerFactory</code></a></td> <td align="left">none</td> <td align="left"></td> </tr> <tr> <td align="left"><a href="../api/core/ngmodulefactory" title="NgModuleFactory | Core - API | Angular"><code>NgModuleFactory</code></a></td> <td align="left">Non-factory based framework APIs</td> <td align="left">Use the non-factory based framework APIs, such as <a href="../api/core/platformref#bootstrapModule" title="bootstrapModule - PlatformRef | Core - API | Angular"><code>PlatformRef.bootstrapModule</code></a> and <a href="../api/core/createngmoduleref" title="createNgModuleRef | Core - API | Angular"><code>createNgModuleRef</code></a>.</td> </tr> <tr> <td align="left">Factory-based signature of <a href="../api/core/viewcontainerref#createComponent" title="createComponent - ViewContainerRef | Core - API | Angular"><code>ViewContainerRef.createComponent</code></a>
</td> <td align="left">Type-based signature of <a href="../api/core/viewcontainerref#createComponent" title="createComponent - ViewContainerRef | Core - API | Angular"><code>ViewContainerRef.createComponent</code></a>
</td> <td align="left">Use the Type-based signature in place of the Factory-based signature.</td> </tr> <tr> <td align="left">
<code>aotSummaries</code> parameter of the <a href="../api/core/testing/testbed#inittestenvironment" title="inittestenvironment - TestBed | Testing - Core - API | Angular"><code>TestBed.initTestEnvironment</code> method</a>
</td> <td align="left">none</td> <td align="left"></td> </tr> <tr> <td align="left">
<code>aotSummaries</code> parameter of the <a href="../api/core/testing/testmodulemetadata" title="TestModuleMetadata | Testing - Core - API | Angular"><code>TestModuleMetadata</code> type</a>
</td> <td align="left">none</td> <td align="left"></td> </tr> <tr> <td align="left"><a href="../api/platform-server/rendermodulefactory" title="renderModuleFactory | Platform server - API | Angular"><code>renderModuleFactory</code></a></td> <td align="left"><a href="../api/platform-server/rendermodule" title="renderModule | Platform server - API | Angular"><code>renderModule</code></a></td> <td align="left"></td> </tr> <tr> <td align="left"><a href="../api/service-worker/swupdate#activated" title="activated - SwUpdate | Service worker - API | Angular"><code>SwUpdate#activated</code></a></td> <td align="left"><a href="../api/service-worker/swupdate#activateUpdate" title="activateUpdate - SwUpdate | Service worker - API | Angular"><code>SwUpdate#activateUpdate()</code></a></td> <td align="left">Use the return value of <a href="../api/service-worker/swupdate#activateUpdate" title="activateUpdate - SwUpdate | Service worker - API | Angular"><code>SwUpdate#activateUpdate()</code></a>.</td> </tr> <tr> <td align="left"><a href="../api/service-worker/swupdate#available" title="available - SwUpdate | Service worker - API | Angular"><code>SwUpdate#available</code></a></td> <td align="left"><a href="../api/service-worker/swupdate#versionUpdates" title="versionUpdates - SwUpdate | Service worker - API | Angular"><code>SwUpdate#versionUpdates</code></a></td> <td align="left"></td> </tr> <tr> <td align="left"><code>bind-input="value"</code></td> <td align="left"><code>[input]="value"</code></td> <td align="left"></td> </tr> <tr> <td align="left"><code>bind-animate-trigger="value"</code></td> <td align="left"><code>[@<a href="../api/animations/trigger" class="code-anchor">trigger</a>]="value"</code></td> <td align="left"></td> </tr> <tr> <td align="left"><code>on-click="onClick()"</code></td> <td align="left"><code>(click)="onClick()"</code></td> <td align="left"></td> </tr> <tr> <td align="left"><code>bindon-ngModel="value"</code></td> <td align="left"><code>[(<a href="../api/forms/ngmodel" class="code-anchor">ngModel</a>)]="value"</code></td> <td align="left"></td> </tr> <tr> <td align="left"><code>ref-templateRef</code></td> <td align="left"><code>#templateRef</code></td> <td align="left"></td> </tr> </tbody> </table>    <div class="reviewed">Last reviewed on Mon Nov 01 2021</div><div class="_attribution">
  <p class="_attribution-p">
    <a href="https://angular.io/guide/update-to-latest-version" class="_attribution-link" target="_blank">https://angular.io/guide/update-to-latest-version</a>
  </p>
</div>
