<h1 data-toc="ant" id="ant.md">Ant</h1>
<section class="chapter"><h2 id="getting-the-ant-tasks" data-toc="ant#getting-the-ant-tasks">Getting the Ant tasks</h2>
<p id="e3a74b42">Kotlin provides three tasks for Ant:</p>
<ul class="list _ul" id="8137b27f">
<li class="list__item" id="6a661698"><p><code class="code ">kotlinc</code>: Kotlin compiler targeting the JVM</p></li>
<li class="list__item" id="34aab5f9"><p><code class="code ">kotlin2js</code>: Kotlin compiler targeting JavaScript</p></li>
<li class="list__item" id="eb8375a3"><p><code class="code ">withKotlin</code>: Task to compile Kotlin files when using the standard <em id="5d74fb60" class="">javac</em> Ant task</p></li>
</ul>
<p id="62e7c6c8">These tasks are defined in the <em id="60cb33f" class="">kotlin-ant.jar</em> library which is located in the <code class="code ">lib</code> folder in the <a href="https://github.com/JetBrains/kotlin/releases/tag/v1.6.10" id="b541858b" data-external="true" rel="noopener noreferrer">Kotlin Compiler</a> archive. Ant version 1.8.2+ is required.</p></section><section class="chapter"><h2 id="targeting-jvm-with-kotlin-only-source" data-toc="ant#targeting-jvm-with-kotlin-only-source">Targeting JVM with Kotlin-only source</h2>
<p id="a5f63ee6">When the project consists of exclusively Kotlin source code, the easiest way to compile the project is to use the <code class="code ">kotlinc</code> task:</p>
<pre class="code-block" data-lang="markup" data-language="markup">&lt;project name="Ant Task Test" default="build"&gt; &lt;typedef resource="org/jetbrains/kotlin/ant/antlib.xml" classpath="${kotlin.lib}/kotlin-ant.jar"/&gt; &lt;target name="build"&gt; &lt;kotlinc src="hello.kt" output="hello.jar"/&gt; &lt;/target&gt; &lt;/project&gt; </pre>
<p id="fba8c78a">where <code class="code ">${kotlin.lib}</code> points to the folder where the Kotlin standalone compiler was unzipped.</p></section><section class="chapter"><h2 id="targeting-jvm-with-kotlin-only-source-and-multiple-roots" data-toc="ant#targeting-jvm-with-kotlin-only-source-and-multiple-roots">Targeting JVM with Kotlin-only source and multiple roots</h2>
<p id="6431141a">If a project consists of multiple source roots, use <code class="code ">src</code> as elements to define paths:</p>
<pre class="code-block" data-lang="markup" data-language="markup">&lt;project name="Ant Task Test" default="build"&gt; &lt;typedef resource="org/jetbrains/kotlin/ant/antlib.xml" classpath="${kotlin.lib}/kotlin-ant.jar"/&gt; &lt;target name="build"&gt; &lt;kotlinc output="hello.jar"&gt; &lt;src path="root1"/&gt; &lt;src path="root2"/&gt; &lt;/kotlinc&gt; &lt;/target&gt; &lt;/project&gt; </pre></section><section class="chapter"><h2 id="targeting-jvm-with-kotlin-and-java-source" data-toc="ant#targeting-jvm-with-kotlin-and-java-source">Targeting JVM with Kotlin and Java source</h2>
<p id="85d5fca7">If a project consists of both Kotlin and Java source code, while it is possible to use <code class="code ">kotlinc</code>, to avoid repetition of task parameters, it is recommended to use <code class="code ">withKotlin</code> task:</p>
<pre class="code-block" data-lang="markup" data-language="markup">&lt;project name="Ant Task Test" default="build"&gt; &lt;typedef resource="org/jetbrains/kotlin/ant/antlib.xml" classpath="${kotlin.lib}/kotlin-ant.jar"/&gt; &lt;target name="build"&gt; &lt;delete dir="classes" failonerror="false"/&gt; &lt;mkdir dir="classes"/&gt; &lt;javac destdir="classes" includeAntRuntime="false" srcdir="src"&gt; &lt;withKotlin/&gt; &lt;/javac&gt; &lt;jar destfile="hello.jar"&gt; &lt;fileset dir="classes"/&gt; &lt;/jar&gt; &lt;/target&gt; &lt;/project&gt; </pre>
<p id="3cedc113">You can also specify the name of the module being compiled as the <code class="code ">moduleName</code> attribute:</p>
<pre class="code-block" data-lang="markup" data-language="markup">&lt;withKotlin moduleName="myModule"/&gt; </pre></section><section class="chapter"><h2 id="targeting-javascript-with-single-source-folder" data-toc="ant#targeting-javascript-with-single-source-folder">Targeting JavaScript with single source folder</h2>
<pre class="code-block" data-lang="markup" data-language="markup">&lt;project name="Ant Task Test" default="build"&gt; &lt;typedef resource="org/jetbrains/kotlin/ant/antlib.xml" classpath="${kotlin.lib}/kotlin-ant.jar"/&gt; &lt;target name="build"&gt; &lt;kotlin2js src="root1" output="out.js"/&gt; &lt;/target&gt; &lt;/project&gt; </pre></section><section class="chapter"><h2 id="targeting-javascript-with-prefix-postfix-and-sourcemap-options" data-toc="ant#targeting-javascript-with-prefix-postfix-and-sourcemap-options">Targeting JavaScript with Prefix, PostFix and sourcemap options</h2>
<pre class="code-block" data-lang="markup" data-language="markup">&lt;project name="Ant Task Test" default="build"&gt; &lt;taskdef resource="org/jetbrains/kotlin/ant/antlib.xml" classpath="${kotlin.lib}/kotlin-ant.jar"/&gt; &lt;target name="build"&gt; &lt;kotlin2js src="root1" output="out.js" outputPrefix="prefix" outputPostfix="postfix" sourcemap="true"/&gt; &lt;/target&gt; &lt;/project&gt; </pre></section><section class="chapter"><h2 id="targeting-javascript-with-single-source-folder-and-metainfo-option" data-toc="ant#targeting-javascript-with-single-source-folder-and-metainfo-option">Targeting JavaScript with single source folder and metaInfo option</h2>
<p id="add7298e">The <code class="code ">metaInfo</code> option is useful, if you want to distribute the result of translation as a Kotlin/JavaScript library. If <code class="code ">metaInfo</code> was set to <code class="code ">true</code>, then during compilation additional JS file with binary metadata will be created. This file should be distributed together with the result of translation:</p>
<pre class="code-block" data-lang="markup" data-language="markup">&lt;project name="Ant Task Test" default="build"&gt; &lt;typedef resource="org/jetbrains/kotlin/ant/antlib.xml" classpath="${kotlin.lib}/kotlin-ant.jar"/&gt; &lt;target name="build"&gt; &lt;!-- out.meta.js will be created, which contains binary metadata --&gt; &lt;kotlin2js src="root1" output="out.js" metaInfo="true"/&gt; &lt;/target&gt; &lt;/project&gt; </pre></section><section class="chapter"><h2 id="references" data-toc="ant#references">References</h2>
<p id="666a411f">Complete list of elements and attributes are listed below:</p>
<section class="chapter"><h3 id="attributes-common-for-kotlinc-and-kotlin2js" data-toc="ant#attributes-common-for-kotlinc-and-kotlin2js">Attributes common for kotlinc and kotlin2js</h3>
<div class="table-wrapper"><table class=" wide" id="eca52045">
<thead><tr class="ijRowHead" id="ee6aff0c">
<th id="93d49bd0"><p>Name</p></th>
<th id="c489c65e"><p>Description</p></th>
<th id="b60971cc"><p>Required</p></th>
<th id="863297c8"><p>Default Value</p></th>
</tr></thead>
<tbody>
<tr class="" id="d67cf8c5">
<td id="7a195e"><p><code class="code ">src</code></p></td>
<td id="72661511"><p>Kotlin source file or directory to compile</p></td>
<td id="7532ae92"><p>Yes</p></td>
<td id="aa8c3c3e"></td>
</tr>
<tr class="" id="8a57d9ba">
<td id="4a6fe505"><p><code class="code ">nowarn</code></p></td>
<td id="fa561512"><p>Suppresses all compilation warnings</p></td>
<td id="bb948ab5"><p>No</p></td>
<td id="5b05b9b9"><p>false</p></td>
</tr>
<tr class="" id="5ea6153d">
<td id="ac8bf39e"><p><code class="code ">noStdlib</code></p></td>
<td id="e0cf6c39"><p>Does not include the Kotlin standard library into the classpath</p></td>
<td id="e9f2f054"><p>No</p></td>
<td id="87d1d5f7"><p>false</p></td>
</tr>
<tr class="" id="1694f2b6">
<td id="bc6a8bcc"><p><code class="code ">failOnError</code></p></td>
<td id="df49d369"><p>Fails the build if errors are detected during the compilation</p></td>
<td id="22bec474"><p>No</p></td>
<td id="f4811d7c"><p>true</p></td>
</tr>
</tbody>
</table></div></section><section class="chapter"><h3 id="kotlinc-attributes" data-toc="ant#kotlinc-attributes">kotlinc attributes</h3>
<div class="table-wrapper"><table class=" wide" id="6c293387">
<thead><tr class="ijRowHead" id="72e3d19b">
<th id="17e85427"><p>Name</p></th>
<th id="110e4fd4"><p>Description</p></th>
<th id="f5d010e4"><p>Required</p></th>
<th id="c710e7f1"><p>Default Value</p></th>
</tr></thead>
<tbody>
<tr class="" id="8880f966">
<td id="ab5426eb"><p><code class="code ">output</code></p></td>
<td id="1abf1531"><p>Destination directory or .jar file name</p></td>
<td id="681bd61d"><p>Yes</p></td>
<td id="94b164a1"></td>
</tr>
<tr class="" id="90bdc8cc">
<td id="99a82b68"><p><code class="code ">classpath</code></p></td>
<td id="53b73128"><p>Compilation class path</p></td>
<td id="9a388d08"><p>No</p></td>
<td id="8449160e"></td>
</tr>
<tr class="" id="bf734f06">
<td id="ced247c6"><p><code class="code ">classpathref</code></p></td>
<td id="6484de68"><p>Compilation class path reference</p></td>
<td id="5ba9e1ad"><p>No</p></td>
<td id="36d3abd8"></td>
</tr>
<tr class="" id="3e616be">
<td id="4849122d"><p><code class="code ">includeRuntime</code></p></td>
<td id="4de12a19"><p>If <code class="code ">output</code> is a .jar file, whether Kotlin runtime library is included in the jar</p></td>
<td id="88bf706c"><p>No</p></td>
<td id="49c1bf22"><p>true</p></td>
</tr>
<tr class="" id="31162a24">
<td id="b3c17060"><p><code class="code ">moduleName</code></p></td>
<td id="c3c5c301"><p>Name of the module being compiled</p></td>
<td id="c8a19437"><p>No</p></td>
<td id="d2b968f0"><p>The name of the target (if specified) or the project</p></td>
</tr>
</tbody>
</table></div></section><section class="chapter"><h3 id="kotlin2js-attributes" data-toc="ant#kotlin2js-attributes">kotlin2js attributes</h3>
<div class="table-wrapper"><table class=" wide" id="ec8cf854">
<thead><tr class="ijRowHead" id="20f6512d">
<th id="ebb5cf39"><p>Name</p></th>
<th id="6f389ee5"><p>Description</p></th>
<th id="9ab0124d"><p>Required</p></th>
</tr></thead>
<tbody>
<tr class="" id="11b9320e">
<td id="576c1afd"><p><code class="code ">output</code></p></td>
<td id="b83f3ce5"><p>Destination file</p></td>
<td id="753aee11"><p>Yes</p></td>
</tr>
<tr class="" id="920ccac8">
<td id="e3949376"><p><code class="code ">libraries</code></p></td>
<td id="15753d03"><p>Paths to Kotlin libraries</p></td>
<td id="3b422410"><p>No</p></td>
</tr>
<tr class="" id="760afc80">
<td id="730d4d47"><p><code class="code ">outputPrefix</code></p></td>
<td id="a5d3e586"><p>Prefix to use for generated JavaScript files</p></td>
<td id="98efdf3"><p>No</p></td>
</tr>
<tr class="" id="7cc47531">
<td id="8ffdb871"><p><code class="code ">outputSuffix</code></p></td>
<td id="e3e0eebe"><p>Suffix to use for generated JavaScript files</p></td>
<td id="da26a985"><p>No</p></td>
</tr>
<tr class="" id="4a8d34cc">
<td id="25931dad"><p><code class="code ">sourcemap</code></p></td>
<td id="2bcaacad"><p>Whether sourcemap file should be generated</p></td>
<td id="b0f85f3b"><p>No</p></td>
</tr>
<tr class="" id="c267727b">
<td id="8bb6209e"><p><code class="code ">metaInfo</code></p></td>
<td id="ada82a0a"><p>Whether metadata file with binary descriptors should be generated</p></td>
<td id="90d9537a"><p>No</p></td>
</tr>
<tr class="" id="afed4cad">
<td id="6321c4bb"><p><code class="code ">main</code></p></td>
<td id="35dc5f6d"><p>Should compiler generated code call the main function</p></td>
<td id="41b7f8b1"><p>No</p></td>
</tr>
</tbody>
</table></div></section><section class="chapter"><h3 id="passing-raw-compiler-arguments" data-toc="ant#passing-raw-compiler-arguments">Passing raw compiler arguments</h3>
<p id="aea05d3d">To pass custom raw compiler arguments, you can use <code class="code ">&lt;compilerarg&gt;</code> elements with either <code class="code ">value</code> or <code class="code ">line</code> attributes. This can be done within the <code class="code ">&lt;kotlinc&gt;</code>, <code class="code ">&lt;kotlin2js&gt;</code>, and <code class="code ">&lt;withKotlin&gt;</code> task elements, as follows:</p>
<pre class="code-block" data-lang="markup" data-language="markup">&lt;kotlinc src="${test.data}/hello.kt" output="${temp}/hello.jar"&gt; &lt;compilerarg value="-Xno-inline"/&gt; &lt;compilerarg line="-Xno-call-assertions -Xno-param-assertions"/&gt; &lt;compilerarg value="-Xno-optimize"/&gt; &lt;/kotlinc&gt; </pre>
<p id="36e235c2">The full list of arguments that can be used is shown when you run <code class="code ">kotlinc -help</code>.</p></section></section><div class="last-modified"> Last modified: 11 February 2021</div>

<div class="navigation-links _bottom"> <a class="navigation-links__prev" href="maven">Maven</a> <a class="navigation-links__next" href="run-code-snippets">Run code snippets – tutorial</a> </div><div class="_attribution">
  <p class="_attribution-p">
    <a href="https://kotlinlang.org/docs/ant.html" class="_attribution-link" target="_blank">https://kotlinlang.org/docs/ant.html</a>
  </p>
</div>
