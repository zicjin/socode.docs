<h1 data-toc="gradle" id="gradle.md">Gradle</h1>
<p id="669df210">In order to build a Kotlin project with Gradle, you should <a href="#plugin-and-versions" id="acf54da4">apply the Kotlin Gradle plugin to your project</a> and <a href="#configuring-dependencies" id="f1a80d3">configure the dependencies</a>.</p>
<section class="chapter"><h2 id="plugin-and-versions" data-toc="gradle#plugin-and-versions">Plugin and versions</h2>
<p id="fa434527">Apply the Kotlin Gradle plugin by using the <a href="https://docs.gradle.org/current/userguide/plugins.html#sec:plugins_block" id="62dcc24" data-external="true" rel="noopener noreferrer">Gradle plugins DSL</a>.</p>
<p id="820b3bea">The Kotlin Gradle plugin and the <code class="code ">kotlin-multiplatform</code> plugin 1.6.10 require Gradle 6.1 or later.</p>
<div class="tabs" id="fbcde6aa" data-group="build-script">
<div class="tabs__content" data-gtm="tab" id="a96557a" data-sync-tabs="kotlin" data-title="Kotlin"><pre class="code-block" data-lang="kotlin" data-title="Kotlin" data-language="kotlin">plugins { kotlin("&lt;...&gt;") version "1.6.10" } </pre></div>
<div class="tabs__content" data-gtm="tab" id="3704bd6" data-sync-tabs="groovy" data-title="Groovy"><pre class="code-block" data-lang="groovy" data-title="Groovy" data-language="groovy">plugins { id 'org.jetbrains.kotlin.&lt;...&gt;' version '1.6.10' } </pre></div>
</div>
<p id="fec48c33">The placeholder <code class="code ">&lt;...&gt;</code> should be replaced with the name of one of the plugins that will be discussed in subsequent sections.</p></section><section class="chapter"><h2 id="targeting-multiple-platforms" data-toc="gradle#targeting-multiple-platforms">Targeting multiple platforms</h2>
<p id="ffba04c3">Projects targeting <a href="mpp-supported-platforms" id="6ef12516">multiple platforms</a>, called <a href="mpp-intro" id="e44d51d">multiplatform projects</a>, require the <code class="code ">kotlin-multiplatform</code> plugin. <a href="mpp-discover-project#multiplatform-plugin" id="700e43b8">Learn more about the plugin</a>.</p>
<aside data-type="note" class="prompt" data-title="" id="2c0e569d"><p id="7452c983">The <code class="code ">kotlin-multiplatform</code> plugin works with Gradle 6.1 or later.</p></aside><div class="tabs" id="a2605071" data-group="build-script">
<div class="tabs__content" data-gtm="tab" id="aca6ce57" data-sync-tabs="kotlin" data-title="Kotlin"><pre class="code-block" data-lang="kotlin" data-title="Kotlin" data-language="kotlin">plugins { kotlin("multiplatform") version "1.6.10" } </pre></div>
<div class="tabs__content" data-gtm="tab" id="44096b4b" data-sync-tabs="groovy" data-title="Groovy"><pre class="code-block" data-lang="groovy" data-title="Groovy" data-language="groovy">plugins { id 'org.jetbrains.kotlin.multiplatform' version '1.6.10' } </pre></div>
</div></section><section class="chapter"><h2 id="targeting-the-jvm" data-toc="gradle#targeting-the-jvm">Targeting the JVM</h2>
<p id="b25a7f90">To target the JVM, apply the Kotlin JVM plugin.</p>
<div class="tabs" id="603d3f9b" data-group="build-script">
<div class="tabs__content" data-gtm="tab" id="fa2b992c" data-sync-tabs="kotlin" data-title="Kotlin"><pre class="code-block" data-lang="kotlin" data-title="Kotlin" data-language="kotlin">plugins { kotlin("jvm") version "1.6.10" } </pre></div>
<div class="tabs__content" data-gtm="tab" id="38f00ccc" data-sync-tabs="groovy" data-title="Groovy"><pre class="code-block" data-lang="groovy" data-title="Groovy" data-language="groovy">plugins { id "org.jetbrains.kotlin.jvm" version "1.6.10" } </pre></div>
</div>
<p id="cf2eec48">The <code class="code ">version</code> should be literal in this block, and it cannot be applied from another build script.</p>
<p id="19d3b2e9">Alternatively, you can use the older <code class="code ">apply plugin</code> approach:</p>
<pre class="code-block" data-lang="groovy" data-language="groovy">apply plugin: 'kotlin' </pre>
<p id="1f93dca">Applying Kotlin plugins with <code class="code ">apply</code> in the Kotlin Gradle DSL is not recommended – <a href="#using-the-gradle-kotlin-dsl" id="3553f02d">see why</a>.</p>
<section class="chapter"><h3 id="kotlin-and-java-sources" data-toc="gradle#kotlin-and-java-sources">Kotlin and Java sources</h3>
<p id="a9d1ce5b">Kotlin sources and Java sources can be stored in the same folder, or they can be placed in different folders. The default convention is to use different folders:</p>
<pre class="code-block" data-lang="groovy" data-language="groovy">project - src - main (root) - kotlin - java </pre>
<p id="d685aaf2">The corresponding <code class="code ">sourceSets</code> property should be updated if you are not using the default convention:</p>
<div class="tabs" id="25fd151" data-group="build-script">
<div class="tabs__content" data-gtm="tab" id="fa409c3b" data-sync-tabs="kotlin" data-title="Kotlin"><pre class="code-block" data-lang="kotlin" data-title="Kotlin" data-language="kotlin">sourceSets.main { java.srcDirs("src/main/myJava", "src/main/myKotlin") } </pre></div>
<div class="tabs__content" data-gtm="tab" id="edd5a634" data-sync-tabs="groovy" data-title="Groovy"><pre class="code-block" data-lang="groovy" data-title="Groovy" data-language="groovy">sourceSets { main.kotlin.srcDirs += 'src/main/myKotlin' main.java.srcDirs += 'src/main/myJava' } </pre></div>
</div></section><section class="chapter"><h3 id="check-for-jvm-target-compatibility-of-related-compile-tasks" data-toc="gradle#check-for-jvm-target-compatibility-of-related-compile-tasks">Check for JVM target compatibility of related compile tasks</h3>
<p id="7d77cfa6">In the build module, you may have related compile tasks, for example:</p>
<ul class="list _ul" id="53ec758">
<li class="list__item" id="b3396289"><p><code class="code ">compileKotlin</code> and <code class="code ">compileJava</code></p></li>
<li class="list__item" id="ebef7e13"><p><code class="code ">compileTestKotlin</code> and <code class="code ">compileTestJava</code></p></li>
</ul>
<aside data-type="note" class="prompt" data-title="" id="b0746f20"><p id="4b6bf236"><code class="code ">main</code> and <code class="code ">test</code> source set compile tasks are not related.</p></aside><p id="fc730d6c">For such related tasks, the Kotlin Gradle plugin checks for JVM target compatibility. Different values of <code class="code ">jvmTarget</code> in the <code class="code ">kotlin</code> extension and <a href="https://docs.gradle.org/current/userguide/java_plugin.html#sec:java-extension" id="31c22ec6" data-external="true" rel="noopener noreferrer"><code class="code ">targetCompatibility</code></a> in the <code class="code ">java</code> extension cause incompatibility. For example: the <code class="code ">compileKotlin</code> task has <code class="code ">jvmTarget=1.8</code>, and the <code class="code ">compileJava</code> task has (or <a href="https://docs.gradle.org/current/userguide/java_plugin.html#sec:java-extension" id="dd3d3892" data-external="true" rel="noopener noreferrer">inherits</a>) <code class="code ">targetCompatibility=15</code>.</p>
<p id="7b0b3ff6">Control the behavior of this check by setting the <code class="code ">kotlin.jvm.target.validation.mode</code> property in the <code class="code ">build.gradle</code> file equal to:</p>
<ul class="list _ul" id="ad83b1ff">
<li class="list__item" id="f404014a"><p><code class="code ">warning</code> – the default value; the Kotlin Gradle plugin will print a warning message.</p></li>
<li class="list__item" id="b4dbeaf4"><p><code class="code ">error</code> – the plugin will fail the build.</p></li>
<li class="list__item" id="e72033bb"><p><code class="code ">ignore</code> – the plugin will skip the check and won't produce any messages.</p></li>
</ul></section><section class="chapter"><h3 id="set-custom-jdk-home" data-toc="gradle#set-custom-jdk-home">Set custom JDK home</h3>
<p id="ff3fc4b4">By default, Kotlin compile tasks use the current Gradle JDK. If you need to change the JDK by some reason, you can set the JDK home in the following ways:</p>
<ul class="list _ul" id="9ac1d6a6">
<li class="list__item" id="26f32fbe"><p>For Gradle 6.7 and later – with <a href="#gradle-java-toolchains-support" id="e3c0cbd8">Java toolchains</a> or the <a href="#setting-jdk-version-with-the-task-dsl" id="cab4b74d">Task DSL</a> to set a local JDK.</p></li>
<li class="list__item" id="cce1af46"><p>For earlier Gradle versions without Java toolchains (up to 6.6) – with the <a href="#setting-jdk-version-with-the-task-dsl" id="a6355b2b"><code class="code ">UsesKotlinJavaToolchain</code> interface and the Task DSL</a>.</p></li>
</ul>
<aside data-type="warning" class="prompt" data-title="" id="e8aa7fab"><p id="76d0014">The <code class="code ">jdkHome</code> compiler option is deprecated since Kotlin 1.5.30.</p></aside><p id="fdbf4e89">When you use a custom JDK, note that <a href="kapt#running-kapt-tasks-in-parallel" id="7e63df00">kapt task workers</a> use <a href="https://docs.gradle.org/current/userguide/worker_api.html#changing_the_isolation_mode" id="ebd25fc7" data-external="true" rel="noopener noreferrer">process isolation mode</a> only, and ignore the <code class="code ">kapt.workers.isolation</code> property.</p></section><section class="chapter"><h3 id="gradle-java-toolchains-support" data-toc="gradle#gradle-java-toolchains-support">Gradle Java toolchains support</h3>
<p id="dd0d8e79">Gradle 6.7 introduced <a href="https://docs.gradle.org/current/userguide/toolchains.html" id="1a150e1d" data-external="true" rel="noopener noreferrer">Java toolchains support</a>. Using this feature, you can:</p>
<ul class="list _ul" id="9e3e9a8b">
<li class="list__item" id="a896d5ff"><p>Use a JDK and a JRE that are different from the Gradle ones to run compilations, tests, and executables.</p></li>
<li class="list__item" id="e718ea8f"><p>Compile and test code with a not-yet-released language version.</p></li>
</ul>
<p id="45259202">With toolchains support, Gradle can autodetect local JDKs and install missing JDKs that Gradle requires for the build. Now Gradle itself can run on any JDK and still reuse the <a href="#gradle-build-cache-support" id="81112d04">remote build cache feature</a> for tasks that depend on a major JDK version.</p>
<p id="adcd6ceb">The Kotlin Gradle plugin supports Java toolchains for Kotlin/JVM compilation tasks. JS and Native tasks don't use toolchains. The Kotlin compiler always uses the JDK the Gradle daemon is running on. A Java toolchain:</p>
<ul class="list _ul" id="c03b6a37">
<li class="list__item" id="fde245b7"><p>Sets the <a href="#attributes-specific-to-jvm" id="e1eeeb92"><code class="code ">jdkHome</code> option</a> available for JVM targets.</p></li>
<li class="list__item" id="85456b96"><p>Sets the <a href="#attributes-specific-to-jvm" id="1a65ad5d"><code class="code ">kotlinOptions.jvmTarget</code></a> to the toolchain's JDK version if the user doesn't set the <code class="code ">jvmTarget</code> option explicitly. If the user doesn't configure the toolchain, the <code class="code ">jvmTarget</code> field will use the default value. Learn more about <a href="#check-for-jvm-target-compatibility-of-related-compile-tasks" id="a449e67f">JVM target compatibility</a>.</p></li>
<li class="list__item" id="18d57675"><p>Affects which JDK <a href="kapt#running-kapt-tasks-in-parallel" id="d3795b31"><code class="code ">kapt</code> workers</a> are running on.</p></li>
</ul>
<p id="5218c9ad">Use the following code to set a toolchain. Replace the placeholder <code class="code ">&lt;MAJOR_JDK_VERSION&gt;</code> with the JDK version you would like to use:</p>
<div class="tabs" id="73eebefb" data-group="build-script">
<div class="tabs__content" data-gtm="tab" id="66d737c5" data-sync-tabs="kotlin" data-title="Kotlin"><pre class="code-block" data-lang="kotlin" data-title="Kotlin" data-language="kotlin">kotlin { jvmToolchain { (this as JavaToolchainSpec).languageVersion.set(JavaLanguageVersion.of(&lt;MAJOR_JDK_VERSION&gt;)) // "8" } } </pre></div>
<div class="tabs__content" data-gtm="tab" id="518170c3" data-sync-tabs="groovy" data-title="Groovy"><pre class="code-block" data-lang="groovy" data-title="Groovy" data-language="groovy">kotlin { jvmToolchain { languageVersion.set(JavaLanguageVersion.of(&lt;MAJOR_JDK_VERSION&gt;)) // "8" } } </pre></div>
</div>
<p id="242d06d0">Note that setting a toolchain via the <code class="code ">kotlin</code> extension will update the toolchain for Java compile tasks as well.</p>
<p id="79484834">You can set a toolchain via the <code class="code ">java</code> extension, and Kotlin compilation tasks will use it:</p>
<pre class="code-block" data-lang="kotlin" data-language="kotlin">java { toolchain { languageVersion.set(JavaLanguageVersion.of(&lt;MAJOR_JDK_VERSION&gt;)) // "8" } } </pre>
<p id="8d3d0e47">To set any JDK (even local) for the specific task, use the Task DSL.</p></section><section class="chapter"><h3 id="setting-jdk-version-with-the-task-dsl" data-toc="gradle#setting-jdk-version-with-the-task-dsl">Setting JDK version with the Task DSL</h3>
<p id="13c46ce">If you use the a Gradle version earlier than 6.7, there is no <a href="#gradle-java-toolchains-support" id="55dbee0a">Java toolchains support</a>. You can use the Task DSL that allows setting any JDK version for any task implementing the <code class="code ">UsesKotlinJavaToolchain</code> interface. At the moment, these tasks are <code class="code ">KotlinCompile</code> and <code class="code ">KaptTask</code>. If you want Gradle to search for the major JDK version, replace the <code class="code ">&lt;MAJOR_JDK_VERSION&gt;</code> placeholder in your build script:</p>
<div class="tabs" id="d30b80ee" data-group="build-script">
<div class="tabs__content" data-gtm="tab" id="776b6373" data-sync-tabs="kotlin" data-title="Kotlin"><pre class="code-block" data-lang="kotlin" data-title="Kotlin" data-language="kotlin">val service = project.extensions.getByType&lt;JavaToolchainService&gt;() val customLauncher = service.launcherFor { it.languageVersion.set(JavaLanguageVersion.of(&lt;MAJOR_JDK_VERSION&gt;)) // "8" } project.tasks.withType&lt;UsesKotlinJavaToolchain&gt;().configureEach { kotlinJavaToolchain.toolchain.use(customLauncher) } </pre></div>
<div class="tabs__content" data-gtm="tab" id="dc341c58" data-sync-tabs="groovy" data-title="Groovy"><pre class="code-block" data-lang="groovy" data-title="Groovy" data-language="groovy">JavaToolchainService service = project.getExtensions().getByType(JavaToolchainService.class) Provider&lt;JavaLauncher&gt; customLauncher = service.launcherFor { it.languageVersion.set(JavaLanguageVersion.of(&lt;MAJOR_JDK_VERSION&gt;)) // "8" } tasks.withType(UsesKotlinJavaToolchain::class).configureEach { task -&gt; task.kotlinJavaToolchain.toolchain.use(customLauncher) } </pre></div>
</div>
<p id="c8b008b9">Or you can specify the path to your local JDK and replace the placeholder <code class="code ">&lt;LOCAL_JDK_VERSION&gt;</code> with this JDK version:</p>
<pre class="code-block" data-lang="kotlin" data-language="kotlin">tasks.withType&lt;UsesKotlinJavaToolchain&gt;().configureEach { kotlinJavaToolchain.jdk.use( "/path/to/local/jdk", // Put a path to your JDK JavaVersion.&lt;LOCAL_JDK_VERSION&gt; // For example, JavaVersion.17 ) } </pre></section></section><section class="chapter"><h2 id="targeting-javascript" data-toc="gradle#targeting-javascript">Targeting JavaScript</h2>
<p id="a72adf9d">When targeting only JavaScript, use the <code class="code ">kotlin-js</code> plugin. <a href="js-project-setup" id="6ae23b23">Learn more</a></p>
<div class="tabs" id="3b2c31e8" data-group="build-script">
<div class="tabs__content" data-gtm="tab" id="a6ecd43e" data-sync-tabs="kotlin" data-title="Kotlin"><pre class="code-block" data-lang="kotlin" data-title="Kotlin" data-language="kotlin">plugins { kotlin("js") version "1.6.10" } </pre></div>
<div class="tabs__content" data-gtm="tab" id="3c2719b8" data-sync-tabs="groovy" data-title="Groovy"><pre class="code-block" data-lang="groovy" data-title="Groovy" data-language="groovy">plugins { id 'org.jetbrains.kotlin.js' version '1.6.10' } </pre></div>
</div>
<section class="chapter"><h3 id="kotlin-and-java-sources-for-javascript" data-toc="gradle#kotlin-and-java-sources-for-javascript">Kotlin and Java sources for JavaScript</h3>
<p id="8fb2787c">This plugin only works for Kotlin files, so it is recommended that you keep Kotlin and Java files separate (if the project contains Java files). If you don't store them separately, specify the source folder in the <code class="code ">sourceSets</code> block:</p>
<div class="tabs" id="4b63b112" data-group="build-script">
<div class="tabs__content" data-gtm="tab" id="7a7a1a7d" data-sync-tabs="kotlin" data-title="Kotlin"><pre class="code-block" data-lang="kotlin" data-title="Kotlin" data-language="kotlin">kotlin { sourceSets["main"].apply { kotlin.srcDir("src/main/myKotlin") } } </pre></div>
<div class="tabs__content" data-gtm="tab" id="aca43ffa" data-sync-tabs="groovy" data-title="Groovy"><pre class="code-block" data-lang="groovy" data-title="Groovy" data-language="groovy">kotlin { sourceSets { main.kotlin.srcDirs += 'src/main/myKotlin' } } </pre></div>
</div></section></section><section class="chapter"><h2 id="targeting-android" data-toc="gradle#targeting-android">Targeting Android</h2>
<p id="c2eacfff">It's recommended to use Android Studio for creating Android applications. <a href="https://developer.android.com/studio/releases/gradle-plugin" id="e56650b2" data-external="true" rel="noopener noreferrer">Learn how to use Android Gradle plugin</a>.</p></section><section class="chapter"><h2 id="configuring-dependencies" data-toc="gradle#configuring-dependencies">Configuring dependencies</h2>
<p id="19ec975b">To add a dependency on a library, set the dependency of the required <a href="#dependency-types" id="24043a7f">type</a> (for example, <code class="code ">implementation</code>) in the <code class="code ">dependencies</code> block of the source sets DSL.</p>
<div class="tabs" id="bc18f61d" data-group="build-script">
<div class="tabs__content" data-gtm="tab" id="69e9e7fe" data-sync-tabs="kotlin" data-title="Kotlin"><pre class="code-block" data-lang="kotlin" data-title="Kotlin" data-language="kotlin">kotlin { sourceSets { val commonMain by getting { dependencies { implementation("com.example:my-library:1.0") } } } } </pre></div>
<div class="tabs__content" data-gtm="tab" id="b7fbbbc2" data-sync-tabs="groovy" data-title="Groovy"><pre class="code-block" data-lang="groovy" data-title="Groovy" data-language="groovy">kotlin { sourceSets { commonMain { dependencies { implementation 'com.example:my-library:1.0' } } } } </pre></div>
</div>
<p id="51e81d51">Alternatively, you can <a href="#set-dependencies-at-the-top-level" id="92b0e317">set dependencies at the top level</a>.</p>
<section class="chapter"><h3 id="dependency-types" data-toc="gradle#dependency-types">Dependency types</h3>
<p id="af693477">Choose the dependency type based on your requirements.</p>
<div class="table-wrapper"><table class=" wide" id="c744b181">
<thead><tr class="ijRowHead" id="d810cdd3">
<th id="252a41f6"><p>Type</p></th>
<th id="37a8751a"><p>Description</p></th>
<th id="f63752be"><p>When to use</p></th>
</tr></thead>
<tbody>
<tr class="" id="8b537aac">
<td id="a25b88f0"><p><code class="code ">api</code></p></td>
<td id="a4d9aeba"><p>Used both during compilation and at runtime and is exported to library consumers.</p></td>
<td id="9cd5eace"><p>If any type from a dependency is used in the public API of the current module, use an <code class="code ">api</code> dependency.</p></td>
</tr>
<tr class="" id="22df464a">
<td id="8322084b"><p><code class="code ">implementation</code></p></td>
<td id="cc08417d"><p>Used during compilation and at runtime for the current module, but is not exposed for compilation of other modules depending on the one with the `implementation` dependency.</p></td>
<td id="6e0b8e30">
<p id="e67b3786">Use for dependencies needed for the internal logic of a module.</p>
<p id="dc848711">If a module is an endpoint application which is not published, use <code class="code ">implementation</code> dependencies instead of <code class="code ">api</code> dependencies.</p>
</td>
</tr>
<tr class="" id="ec0f2b9">
<td id="d424a2fe"><p><code class="code ">compileOnly</code></p></td>
<td id="f8183a6e"><p>Used for compilation of the current module and is not available at runtime nor during compilation of other modules.</p></td>
<td id="5003329f"><p>Use for APIs which have a third-party implementation available at runtime.</p></td>
</tr>
<tr class="" id="6afb0bd3">
<td id="d18d67aa"><p><code class="code ">runtimeOnly</code></p></td>
<td id="bf9f25ce"><p>Available at runtime but is not visible during compilation of any module.</p></td>
<td id="deb480b1"></td>
</tr>
</tbody>
</table></div></section><section class="chapter"><h3 id="dependency-on-the-standard-library" data-toc="gradle#dependency-on-the-standard-library">Dependency on the standard library</h3>
<p id="b0889c8b">A dependency on the standard library (<code class="code ">stdlib</code>) is added automatically to each source set. The version of the standard library used is the same as the version of the Kotlin Gradle plugin.</p>
<p id="b92f6774">For platform-specific source sets, the corresponding platform-specific variant of the library is used, while a common standard library is added to the rest. The Kotlin Gradle plugin will select the appropriate JVM standard library depending on the <code class="code ">kotlinOptions.jvmTarget</code><a href="#compiler-options" id="27c6d2a6">compiler option</a> of your Gradle build script.</p>
<p id="9234f39e">If you declare a standard library dependency explicitly (for example, if you need a different version), the Kotlin Gradle plugin won't override it or add a second standard library.</p>
<p id="e9bc6d42">If you do not need a standard library at all, you can add the opt-out option to the <code class="code ">gradle.properties</code>:</p>
<pre class="code-block" data-lang="kotlin" data-language="kotlin">kotlin.stdlib.default.dependency=false </pre></section><section class="chapter"><h3 id="set-dependencies-on-test-libraries" data-toc="gradle#set-dependencies-on-test-libraries">Set dependencies on test libraries</h3>
<p id="a09944cb">The <a href="https://kotlinlang.org/api/latest/kotlin.test/" id="58b160a7" data-external="true" rel="noopener noreferrer"><code class="code ">kotlin.test</code></a> API is available for testing Kotlin projects on all supported platforms. Add the dependency <code class="code ">kotlin-test</code> to the <code class="code ">commonTest</code> source set, and the Gradle plugin will infer the corresponding test dependencies for each test source set:</p>
<ul class="list _ul" id="5da8d741">
<li class="list__item" id="f0c55a7b"><p><code class="code ">kotlin-test-common</code> and <code class="code ">kotlin-test-annotations-common</code> for common source sets</p></li>
<li class="list__item" id="8b681e90"><p><code class="code ">kotlin-test-junit</code> for JVM source sets</p></li>
<li class="list__item" id="f0d88538"><p><code class="code ">kotlin-test-js</code> for Kotlin/JS source sets</p></li>
</ul>
<p id="3a970eec">Kotlin/Native targets do not require additional test dependencies, and the <code class="code ">kotlin.test</code> API implementations are built-in.</p>
<div class="tabs" id="61e31fa2" data-group="build-script">
<div class="tabs__content" data-gtm="tab" id="c30bcfcb" data-sync-tabs="kotlin" data-title="Kotlin"><pre class="code-block" data-lang="kotlin" data-title="Kotlin" data-language="kotlin">kotlin { sourceSets { val commonTest by getting { dependencies { implementation(kotlin("test")) // This brings all the platform dependencies automatically } } } } </pre></div>
<div class="tabs__content" data-gtm="tab" id="51ee58f2" data-sync-tabs="groovy" data-title="Groovy"><pre class="code-block" data-lang="groovy" data-title="Groovy" data-language="groovy">kotlin { sourceSets { commonTest { dependencies { implementation kotlin("test") // This brings all the platform dependencies automatically } } } } </pre></div>
</div>
<aside data-type="note" class="prompt" data-title="" id="315b946c"><p id="fd6f86d8">You can use shorthand for a dependency on a Kotlin module, for example, kotlin("test") for "org.jetbrains.kotlin:kotlin-test".</p></aside><p id="3f1ae066">You can use the <code class="code ">kotlin-test</code> dependency in any shared or platform-specific source set as well.</p>
<p id="e95d9cc6">For Kotlin/JVM, Gradle uses JUnit 4 by default. Therefore, the <code class="code ">kotlin("test")</code> dependency resolves to the variant for JUnit 4, namely <code class="code ">kotlin-test-junit</code>.</p>
<p id="a005daed">You can choose JUnit 5 or TestNG by calling <a href="https://docs.gradle.org/current/javadoc/org/gradle/api/tasks/testing/Test.html#useJUnitPlatform" id="22512902" data-external="true" rel="noopener noreferrer"><code class="code ">useJUnitPlatform()</code></a> or <a href="https://docs.gradle.org/current/javadoc/org/gradle/api/tasks/testing/Test.html#useTestNG" id="9039adbb" data-external="true" rel="noopener noreferrer"><code class="code ">useTestNG()</code></a> in the test task of your build script. The following example is for an MPP project:</p>
<div class="tabs" id="2ac01d09" data-group="build-script">
<div class="tabs__content" data-gtm="tab" id="89f41f8" data-sync-tabs="kotlin" data-title="Kotlin"><pre class="code-block" data-lang="kotlin" data-title="Kotlin" data-language="kotlin">kotlin { jvm { testRuns["test"].executionTask.configure { useJUnitPlatform() } } sourceSets { val commonTest by getting { dependencies { implementation(kotlin("test")) } } } } </pre></div>
<div class="tabs__content" data-gtm="tab" id="3494e630" data-sync-tabs="groovy" data-title="Groovy"><pre class="code-block" data-lang="groovy" data-title="Groovy" data-language="groovy">kotlin { jvm { testRuns["test"].executionTask.configure { useJUnitPlatform() } } sourceSets { commonTest { dependencies { implementation kotlin("test") } } } } </pre></div>
</div>
<p id="ac169608">The following example is for a JVM project:</p>
<div class="tabs" id="7930af45" data-group="build-script">
<div class="tabs__content" data-gtm="tab" id="3153cc2" data-sync-tabs="kotlin" data-title="Kotlin"><pre class="code-block" data-lang="kotlin" data-title="Kotlin" data-language="kotlin">dependencies { testImplementation(kotlin("test")) } tasks { test { useTestNG() } } </pre></div>
<div class="tabs__content" data-gtm="tab" id="ce3d2fa7" data-sync-tabs="groovy" data-title="Groovy"><pre class="code-block" data-lang="groovy" data-title="Groovy" data-language="groovy">dependencies { testImplementation 'org.jetbrains.kotlin:kotlin-test' } test { useTestNG() } </pre></div>
</div>
<p id="fea8f192"><a href="jvm-test-using-junit" id="f7551407">Learn how to test code using JUnit on the JVM</a>.</p>
<p id="a082d639">If you need to use a different JVM test framework, disable automatic testing framework selection by adding the line <code class="code ">kotlin.test.infer.jvm.variant=false</code> to the project's <code class="code ">gradle.properties</code> file. After doing this, add the framework as a Gradle dependency.</p>
<p id="30ee065d">If you had used a variant of <code class="code ">kotlin("test")</code> in your build script explicitly and project build stopped working with a compatibility conflict, see <a href="compatibility-guide-15#do-not-mix-several-jvm-variants-of-kotlin-test-in-a-single-project" id="2233d776">this issue in the Compatibility Guide</a>.</p></section><section class="chapter"><h3 id="set-a-dependency-on-a-kotlinx-library" data-toc="gradle#set-a-dependency-on-a-kotlinx-library">Set a dependency on a kotlinx library</h3>
<p id="aaf92e7d">If you use a kotlinx library and need a platform-specific dependency, you can use platform-specific variants of libraries with suffixes such as <code class="code ">-jvm</code> or <code class="code ">-js</code>, for example, <code class="code ">kotlinx-coroutines-core-jvm</code>. You can also use the library's base artifact name instead – <code class="code ">kotlinx-coroutines-core</code>.</p>
<div class="tabs" id="420005b4" data-group="build-script">
<div class="tabs__content" data-gtm="tab" id="c31dcc6d" data-sync-tabs="kotlin" data-title="Kotlin"><pre class="code-block" data-lang="kotlin" data-title="Kotlin" data-language="kotlin">kotlin { sourceSets { val jvmMain by getting { dependencies { implementation("org.jetbrains.kotlinx:kotlinx-coroutines-core-jvm:1.6.0") } } } } </pre></div>
<div class="tabs__content" data-gtm="tab" id="41c2f432" data-sync-tabs="groovy" data-title="Groovy"><pre class="code-block" data-lang="groovy" data-title="Groovy" data-language="groovy">kotlin { sourceSets { jvmMain { dependencies { implementation 'org.jetbrains.kotlinx:kotlinx-coroutines-core-jvm:1.6.0' } } } } </pre></div>
</div>
<p id="339d6146">If you use a multiplatform library and need to depend on the shared code, set the dependency only once, in the shared source set. Use the library's base artifact name, such as <code class="code ">kotlinx-coroutines-core</code> or <code class="code ">ktor-client-core</code>.</p>
<div class="tabs" id="2cb8de0" data-group="build-script">
<div class="tabs__content" data-gtm="tab" id="fcf660d4" data-sync-tabs="kotlin" data-title="Kotlin"><pre class="code-block" data-lang="kotlin" data-title="Kotlin" data-language="kotlin">kotlin { sourceSets { val commonMain by getting { dependencies { implementation("org.jetbrains.kotlinx:kotlinx-coroutines-core:1.6.0") } } } } </pre></div>
<div class="tabs__content" data-gtm="tab" id="cb12645" data-sync-tabs="groovy" data-title="Groovy"><pre class="code-block" data-lang="groovy" data-title="Groovy" data-language="groovy">kotlin { sourceSets { commonMain { dependencies { implementation 'org.jetbrains.kotlinx:kotlinx-coroutines-core:1.6.0' } } } } </pre></div>
</div></section><section class="chapter"><h3 id="set-dependencies-at-the-top-level" data-toc="gradle#set-dependencies-at-the-top-level">Set dependencies at the top level</h3>
<p id="15100d47">Alternatively, you can specify the dependencies at the top level, using the following pattern for the configuration names: <code class="code ">&lt;sourceSetName&gt;&lt;DependencyType&gt;</code>. This can be helpful for some Gradle built-in dependencies, like <code class="code ">gradleApi()</code>, <code class="code ">localGroovy()</code>, or <code class="code ">gradleTestKit()</code>, which are not available in the source sets' dependency DSL.</p>
<div class="tabs" id="d753b986" data-group="build-script">
<div class="tabs__content" data-gtm="tab" id="42d9eb1d" data-sync-tabs="kotlin" data-title="Kotlin"><pre class="code-block" data-lang="kotlin" data-title="Kotlin" data-language="kotlin">dependencies { "commonMainImplementation"("com.example:my-library:1.0") } </pre></div>
<div class="tabs__content" data-gtm="tab" id="6caa7e49" data-sync-tabs="groovy" data-title="Groovy"><pre class="code-block" data-lang="groovy" data-title="Groovy" data-language="groovy">dependencies { commonMainImplementation 'com.example:my-library:1.0' } </pre></div>
</div></section></section><section class="chapter"><h2 id="annotation-processing" data-toc="gradle#annotation-processing">Annotation processing</h2>
<p id="4bff299c">Kotlin supports annotation processing via the Kotlin annotation processing tool <a href="kapt" id="73deb0f"><code class="code ">kapt</code></a>.</p></section><section class="chapter"><h2 id="incremental-compilation" data-toc="gradle#incremental-compilation">Incremental compilation</h2>
<p id="4fc25b0f">The Kotlin Gradle plugin supports incremental compilation. Incremental compilation tracks changes to source files between builds so only files affected by these changes are compiled.</p>
<p id="d9cf7185">Incremental compilation is supported for Kotlin/JVM and Kotlin/JS projects and is enabled by default.</p>
<p id="af7d7f72">There are several ways to switch off incremental compilation:</p>
<ul class="list _ul" id="4724b435">
<li class="list__item" id="dc867ffb"><p id="998c5064"><code class="code ">kotlin.incremental=false</code> for Kotlin/JVM.</p></li>
<li class="list__item" id="5d51f01"><p id="7afadc81"><code class="code ">kotlin.incremental.js=false</code> for Kotlin/JS projects.</p></li>
<li class="list__item" id="2da3bb6f">
<p id="f2103c32">Use <code class="code ">-Pkotlin.incremental=false</code> or <code class="code ">-Pkotlin.incremental.js=false</code> as a command line parameter.</p>
<p id="ebea8bde">The parameter should be added to each subsequent build, and any build with incremental compilation disabled invalidates incremental caches.</p>
</li>
</ul>
<p id="d9615d5d">The first build is never incremental.</p></section><section class="chapter"><h2 id="gradle-build-cache-support" data-toc="gradle#gradle-build-cache-support">Gradle build cache support</h2>
<p id="5c964c88">The Kotlin plugin uses the <a href="https://docs.gradle.org/current/userguide/build_cache.html" id="b8aa018b" data-external="true" rel="noopener noreferrer">Gradle build cache</a>, which stores the build outputs for reuse in future builds.</p>
<p id="3b7adae">To disable caching for all Kotlin tasks, set the system property flag <code class="code ">kotlin.caching.enabled</code> to <code class="code ">false</code> (run the build with the argument <code class="code ">-Dkotlin.caching.enabled=false</code>).</p>
<p id="d2dfb3b5">If you use <a href="kapt" id="6347a918">kapt</a>, note that kapt annotation processing tasks are not cached by default. However, you can <a href="kapt#gradle-build-cache-support" id="cfb3ff64">enable caching for them manually</a>.</p></section><section class="chapter"><h2 id="gradle-configuration-cache-support" data-toc="gradle#gradle-configuration-cache-support">Gradle configuration cache support</h2>
<aside data-type="note" class="prompt" data-title="" id="ee72f3b9"><p id="ecd34b6f">The configuration cache is available in Gradle 6.5 and later as an experimental feature. You can check the <a href="https://gradle.org/releases/" id="6f82cd3b" data-external="true" rel="noopener noreferrer">Gradle releases page</a> to see whether it has been promoted to stable.</p></aside><p id="8740ebd">The Kotlin plugin uses the <a href="https://docs.gradle.org/current/userguide/configuration_cache.html" id="ddef62ab" data-external="true" rel="noopener noreferrer">Gradle configuration cache</a>, which speeds up the build process by reusing the results of the configuration phase.</p>
<p id="bcabf5b">See the <a href="https://docs.gradle.org/current/userguide/configuration_cache.html#config_cache:usage" id="c4d379a8" data-external="true" rel="noopener noreferrer">Gradle documentation</a> to learn how to enable the configuration cache. After you enable this feature, the Kotlin Gradle plugin will automatically start using it.</p></section><section class="chapter"><h2 id="compiler-options" data-toc="gradle#compiler-options">Compiler options</h2>
<p id="7c153f5e">Use the <code class="code ">kotlinOptions</code> property of a Kotlin compilation task to specify additional compilation options.</p>
<p id="3f83a019">When targeting the JVM, the tasks are called <code class="code ">compileKotlin</code> for production code and <code class="code ">compileTestKotlin</code> for test code. The tasks for custom source sets are named according to their <code class="code ">compile&lt;Name&gt;Kotlin</code> patterns.</p>
<p id="b1df6bda">The names of the tasks in Android Projects contain <a href="https://developer.android.com/studio/build/build-variants.html" id="6abfba9a" data-external="true" rel="noopener noreferrer">build variant</a> names and follow the <code class="code ">compile&lt;BuildVariant&gt;Kotlin</code> pattern, for example, <code class="code ">compileDebugKotlin</code> or <code class="code ">compileReleaseUnitTestKotlin</code>.</p>
<p id="d6ed0eed">When targeting JavaScript, the tasks are called <code class="code ">compileKotlinJs</code> for production code and <code class="code ">compileTestKotlinJs</code> for test code, and <code class="code ">compile&lt;Name&gt;KotlinJs</code> for custom source sets.</p>
<p id="a29d9623">To configure a single task, use its name. Examples:</p>
<div class="tabs" id="d58470b4" data-group="build-script">
<div class="tabs__content" data-gtm="tab" id="39fa0374" data-sync-tabs="kotlin" data-title="Kotlin"><pre class="code-block" data-lang="kotlin" data-title="Kotlin" data-language="kotlin">import org.jetbrains.kotlin.gradle.tasks.KotlinCompile // ... val compileKotlin: KotlinCompile by tasks compileKotlin.kotlinOptions.suppressWarnings = true </pre></div>
<div class="tabs__content" data-gtm="tab" id="a6215602" data-sync-tabs="groovy" data-title="Groovy"><pre class="code-block" data-lang="groovy" data-title="Groovy" data-language="groovy">compileKotlin { kotlinOptions.suppressWarnings = true } //or compileKotlin { kotlinOptions { suppressWarnings = true } } </pre></div>
</div>
<p id="e48f2222">Note that with the Gradle Kotlin DSL, you should get the task from the project's <code class="code ">tasks</code> first.</p>
<p id="39a52953">Use the <code class="code ">Kotlin2JsCompile</code> and <code class="code ">KotlinCompileCommon</code> types for JS and common targets, respectively.</p>
<p id="feb6e436">It is also possible to configure all of the Kotlin compilation tasks in the project:</p>
<div class="tabs" id="7d9c180c" data-group="build-script">
<div class="tabs__content" data-gtm="tab" id="d4960506" data-sync-tabs="kotlin" data-title="Kotlin"><pre class="code-block" data-lang="kotlin" data-title="Kotlin" data-language="kotlin">tasks.withType&lt;org.jetbrains.kotlin.gradle.tasks.KotlinCompile&gt;().configureEach { kotlinOptions { /*...*/ } } </pre></div>
<div class="tabs__content" data-gtm="tab" id="25e88a0e" data-sync-tabs="groovy" data-title="Groovy"><pre class="code-block" data-lang="groovy" data-title="Groovy" data-language="groovy">tasks.withType(org.jetbrains.kotlin.gradle.tasks.KotlinCompile).configureEach { kotlinOptions { /*...*/ } } </pre></div>
</div>
<p id="42c4cc1c">Here is a complete list of options for Gradle tasks:</p>
<section class="chapter"><h3 id="attributes-common-to-jvm-js-and-js-dce" data-toc="gradle#attributes-common-to-jvm-js-and-js-dce">Attributes common to JVM, JS, and JS DCE</h3>
<div class="table-wrapper"><table class=" wide" id="57a6f33f">
<thead><tr class="ijRowHead" id="c326a5a6">
<th id="88e10294"><p>Name</p></th>
<th id="e3f6cb97"><p>Description</p></th>
<th id="455047a"><p>Possible values</p></th>
<th id="b1a993d0"><p>Default value</p></th>
</tr></thead>
<tbody>
<tr class="" id="3939ffae">
<td id="90e178"><p><code class="code ">allWarningsAsErrors</code></p></td>
<td id="9b028bd1"><p>Report an error if there are any warnings</p></td>
<td id="835925a6"></td>
<td id="df701e81"><p>false</p></td>
</tr>
<tr class="" id="9830ece7">
<td id="b9392d2"><p><code class="code ">suppressWarnings</code></p></td>
<td id="f6cfb76b"><p>Don't generate warnings</p></td>
<td id="a56b661d"></td>
<td id="c0740b52"><p>false</p></td>
</tr>
<tr class="" id="29e0de09">
<td id="26ab9238"><p><code class="code ">verbose</code></p></td>
<td id="5a28eb5d"><p>Enable verbose logging output. Works only when the <a href="https://docs.gradle.org/current/userguide/logging.html" id="ee6109a5" data-external="true" rel="noopener noreferrer">Gradle debug log level enabled</a></p></td>
<td id="1bec898b"></td>
<td id="1bae35ae"><p>false</p></td>
</tr>
<tr class="" id="13eda1fd">
<td id="6d084706"><p><code class="code ">freeCompilerArgs</code></p></td>
<td id="e10328f9"><p>A list of additional compiler arguments</p></td>
<td id="58a15ff1"></td>
<td id="a1a2b6ac"><p>[]</p></td>
</tr>
</tbody>
</table></div></section><section class="chapter"><h3 id="attributes-common-to-jvm-and-js" data-toc="gradle#attributes-common-to-jvm-and-js">Attributes common to JVM and JS</h3>
<div class="table-wrapper"><table class=" wide" id="5f5b1008">
<thead><tr class="ijRowHead" id="639838f3">
<th id="df73b79c"><p>Name</p></th>
<th id="8da150c9"><p>Description</p></th>
<th id="c45502fa"><p>Possible values</p></th>
<th id="b43ab9cc"><p>Default value</p></th>
</tr></thead>
<tbody>
<tr class="" id="8ca6c840">
<td id="4987026d"><p><code class="code ">apiVersion</code></p></td>
<td id="547df3b8"><p>Restrict the use of declarations to those from the specified version of bundled libraries</p></td>
<td id="56c686b"><p>"1.3" (DEPRECATED), "1.4" (DEPRECATED), "1.5", "1.6", "1.7" (EXPERIMENTAL)</p></td>
<td id="6927f8e2"></td>
</tr>
<tr class="" id="ae935aab">
<td id="6322f6f5"><p><code class="code ">languageVersion</code></p></td>
<td id="9207bf59"><p>Provide source compatibility with the specified version of Kotlin</p></td>
<td id="584b34fd"><p>"1.4" (DEPRECATED), "1.5", "1.6", "1.7" (EXPERIMENTAL)</p></td>
<td id="635b2c0c"></td>
</tr>
</tbody>
</table></div></section><section class="chapter"><h3 id="attributes-specific-to-jvm" data-toc="gradle#attributes-specific-to-jvm">Attributes specific to JVM</h3>
<div class="table-wrapper"><table class=" wide" id="dcae1f9a">
<thead><tr class="ijRowHead" id="b8c912c5">
<th id="115df578"><p>Name</p></th>
<th id="936d2456"><p>Description</p></th>
<th id="5441bbde"><p>Possible values</p></th>
<th id="1c6c9006"><p>Default value</p></th>
</tr></thead>
<tbody>
<tr class="" id="cec1178">
<td id="9b76ec1"><p><code class="code ">javaParameters</code></p></td>
<td id="e249a04a"><p>Generate metadata for Java 1.8 reflection on method parameters</p></td>
<td id="3c4927"></td>
<td id="5c8574d4"><p>false</p></td>
</tr>
<tr class="" id="905bf716">
<td id="ee7f47b0"><p><code class="code ">jdkHome</code></p></td>
<td id="9de6a3f0"><p>Include a custom JDK from the specified location into the classpath instead of the default JAVA_HOME. Direct setting is deprecated sinсe 1.5.30, use <a href="#set-custom-jdk-home" id="953727a1">other ways to set this option</a>.</p></td>
<td id="e050ba2d"></td>
<td id="e5ba6291"></td>
</tr>
<tr class="" id="a0f866d7">
<td id="82a37adc"><p><code class="code ">jvmTarget</code></p></td>
<td id="8f310f6d"><p>Target version of the generated JVM bytecode</p></td>
<td id="4617b372"><p>"1.6" (DEPRECATED), "1.8", "9", "10", "11", "12", "13", "14", "15", "16", "17"</p></td>
<td id="7d7a81e"><p>"1.8"</p></td>
</tr>
<tr class="" id="35d6088f">
<td id="7fb53423"><p><code class="code ">noJdk</code></p></td>
<td id="a9cbfe65"><p>Don't automatically include the Java runtime into the classpath</p></td>
<td id="675ddf12"></td>
<td id="c1889562"><p>false</p></td>
</tr>
<tr class="" id="abe33967">
<td id="a9687346"><p><code class="code ">useOldBackend</code></p></td>
<td id="a2723460"><p>Use the <a href="whatsnew15#stable-jvm-ir-backend" id="424d3da9">old JVM backend</a></p></td>
<td id="62102d1e"></td>
<td id="746d9cf3"><p>false</p></td>
</tr>
</tbody>
</table></div></section><section class="chapter"><h3 id="attributes-specific-to-js" data-toc="gradle#attributes-specific-to-js">Attributes specific to JS</h3>
<div class="table-wrapper"><table class=" wide" id="51e00631">
<thead><tr class="ijRowHead" id="5a4c4ab3">
<th id="461efc8d"><p>Name</p></th>
<th id="6db37342"><p>Description</p></th>
<th id="729c4c5c"><p>Possible values</p></th>
<th id="1c58b95d"><p>Default value</p></th>
</tr></thead>
<tbody>
<tr class="" id="ff407925">
<td id="c32eaf21"><p><code class="code ">friendModulesDisabled</code></p></td>
<td id="3c65497c"><p>Disable internal declaration export</p></td>
<td id="82cfb55d"></td>
<td id="6e57c948"><p>false</p></td>
</tr>
<tr class="" id="ef801643">
<td id="d2d82d64"><p><code class="code ">main</code></p></td>
<td id="3b923389"><p>Define whether the <code class="code ">main</code> function should be called upon execution</p></td>
<td id="870ac9ae"><p>"call", "noCall"</p></td>
<td id="f0cc5792"><p>"call"</p></td>
</tr>
<tr class="" id="ef8fa834">
<td id="b8216bd0"><p><code class="code ">metaInfo</code></p></td>
<td id="9cbdb218"><p>Generate .meta.js and .kjsm files with metadata. Use to create a library</p></td>
<td id="be8e8bbd"></td>
<td id="905c001"><p>true</p></td>
</tr>
<tr class="" id="74668577">
<td id="f250fffc"><p><code class="code ">moduleKind</code></p></td>
<td id="ef0444d6"><p>The kind of JS module generated by the compiler</p></td>
<td id="d78412e1"><p>"umd", "commonjs", "amd", "plain"</p></td>
<td id="9aa72b47"><p>"umd"</p></td>
</tr>
<tr class="" id="2e7ead74">
<td id="cdc4d41f"><p><code class="code ">noStdlib</code></p></td>
<td id="448a18e0"><p>Don't automatically include the default Kotlin/JS stdlib in compilation dependencies</p></td>
<td id="d2ce0577"></td>
<td id="1c2e5bb"><p>true</p></td>
</tr>
<tr class="" id="5918cb5e">
<td id="59342f45"><p><code class="code ">outputFile</code></p></td>
<td id="e4e6d76e"><p>Destination *.js file for the compilation result</p></td>
<td id="5fc382e1"></td>
<td id="db7d1478"><p>"&lt;buildDir&gt;/js/packages/&lt;project.name&gt;/kotlin/&lt;project.name&gt;.js"</p></td>
</tr>
<tr class="" id="941eeca1">
<td id="e2cb5df8"><p><code class="code ">sourceMap</code></p></td>
<td id="e63fd736"><p>Generate source map</p></td>
<td id="cf5ddbf6"></td>
<td id="51c07362"><p>true</p></td>
</tr>
<tr class="" id="d5cd70b3">
<td id="3b5df76e"><p><code class="code ">sourceMapEmbedSources</code></p></td>
<td id="f4de569a"><p>Embed source files into the source map</p></td>
<td id="c1758301"><p>"never", "always", "inlining"</p></td>
<td id="430601f1"></td>
</tr>
<tr class="" id="f256d62">
<td id="65907042"><p><code class="code ">sourceMapPrefix</code></p></td>
<td id="a21bb365"><p>Add the specified prefix to paths in the source map</p></td>
<td id="b7649ec7"></td>
<td id="812930c4"></td>
</tr>
<tr class="" id="56cd4bc6">
<td id="4a0ad67f"><p><code class="code ">target</code></p></td>
<td id="68d3ba9"><p>Generate JS files for specific ECMA version</p></td>
<td id="80711051"><p>"v5"</p></td>
<td id="232d5170"><p>"v5"</p></td>
</tr>
<tr class="" id="ed9b0070">
<td id="1215742b"><p><code class="code ">typedArrays</code></p></td>
<td id="7880169f"><p>Translate primitive arrays to JS typed arrays</p></td>
<td id="c519fd6c"></td>
<td id="2facbf08"><p>true</p></td>
</tr>
</tbody>
</table></div></section></section><section class="chapter"><h2 id="generating-documentation" data-toc="gradle#generating-documentation">Generating documentation</h2>
<p id="2fccfa1">To generate documentation for Kotlin projects, use <a href="https://github.com/Kotlin/dokka" id="aafeed65" data-external="true" rel="noopener noreferrer">Dokka</a>; please refer to the <a href="https://github.com/Kotlin/dokka/blob/master/README.md#using-the-gradle-plugin" id="4ee9ec99" data-external="true" rel="noopener noreferrer">Dokka README</a> for configuration instructions. Dokka supports mixed-language projects and can generate output in multiple formats, including standard JavaDoc.</p></section><section class="chapter"><h2 id="osgi" data-toc="gradle#osgi">OSGi</h2>
<p id="d6664dde">For OSGi support see the <a href="kotlin-osgi" id="aed076c0">Kotlin OSGi page</a>.</p></section><section class="chapter"><h2 id="using-the-gradle-kotlin-dsl" data-toc="gradle#using-the-gradle-kotlin-dsl">Using the Gradle Kotlin DSL</h2>
<p id="86a3012e">When using <a href="https://github.com/gradle/kotlin-dsl" id="76278d98" data-external="true" rel="noopener noreferrer">Gradle Kotlin DSL</a>, apply Kotlin plugins using the <code class="code ">plugins { ... }</code> block. If you apply them with <code class="code ">apply { plugin(...) }</code> instead, you may encounter unresolved references to the extensions generated by Gradle Kotlin DSL. To resolve that, you can comment out the erroneous usages, run the Gradle task <code class="code ">kotlinDslAccessorsSnapshot</code>, then uncomment the usages back and rerun the build or reimport the project into the IDE.</p></section><section class="chapter"><h2 id="kotlin-daemon-and-using-it-with-gradle" data-toc="gradle#kotlin-daemon-and-using-it-with-gradle">Kotlin daemon and using it with Gradle</h2>
<p id="54069985">The Kotlin daemon:</p>
<ul class="list _ul" id="f6afeeee">
<li class="list__item" id="8208621"><p>Runs along with the Gradle daemon to compile the project.</p></li>
<li class="list__item" id="2d28a6cb"><p>Runs separately when you compile the project with an IntelliJ IDEA built-in build system.</p></li>
</ul>
<p id="f45e538e">The Kotlin daemon starts at the Gradle <a href="https://docs.gradle.org/current/userguide/build_lifecycle.html#sec:build_phases" id="1df57c5c" data-external="true" rel="noopener noreferrer">execution stage</a> when one of Kotlin compile tasks starts compiling the sources. The Kotlin daemon stops along with the Gradle daemon or after two idle hours with no Kotlin compilation.</p>
<p id="7995e438">The Kotlin daemon uses the same JDK that the Gradle daemon does.</p>
<section class="chapter"><h3 id="setting-kotlin-daemon-s-jvm-arguments" data-toc="gradle#setting-kotlin-daemon-s-jvm-arguments">Setting Kotlin daemon's JVM arguments</h3>
<p id="82d2d989">Each of the options in the following list overrides the ones that came before it:</p>
<ul class="list _ul" id="7f86dd6a"><li class="list__item" id="830fcceb"><p>If nothing is specified, the Kotlin daemon inherits arguments from the Gradle daemon. For example, in the <code class="code ">gradle.properties</code> file:</p></li></ul>
<pre class="code-block" data-lang="none" data-disable-link-processing="true" data-language="none"> org.gradle.jvmargs=-Xmx1500m -Xms=500m </pre>
<ul class="list _ul" id="16c0358d"><li class="list__item" id="87270ad2"><p>If the Gradle daemon's JVM arguments have the <code class="code ">kotlin.daemon.jvm.options</code> system property – use it in the <code class="code ">gradle.properties</code> file:</p></li></ul>
<pre class="code-block" data-lang="none" data-disable-link-processing="true" data-language="none"> org.gradle.jvmargs=-Dkotlin.daemon.jvm.options=-Xmx1500m -Xms=500m </pre>
<ul class="list _ul" id="6efc1420"><li class="list__item" id="65da82ef"><p>You can add the<code class="code ">kotlin.daemon.jvmargs</code> property in the <code class="code ">gradle.properties</code> file:</p></li></ul>
<pre class="code-block" data-lang="none" data-disable-link-processing="true" data-language="none"> kotlin.daemon.jvmargs=-Xmx1500m -Xms=500m </pre>
<ul class="list _ul" id="60b814e5">
<li class="list__item" id="ff1771b6">
<p id="12daea94">You can specify arguments in the <code class="code ">kotlin</code> extension:</p>
<div class="tabs" id="fdbae05c" data-group="build-script">
<div class="tabs__content" data-gtm="tab" id="4beefc56" data-sync-tabs="kotlin" data-title="Kotlin"><pre class="code-block" data-lang="kotlin" data-title="Kotlin" data-language="kotlin">kotlin { kotlinDaemonJvmArgs = listOf("-Xmx486m", "-Xms256m", "-XX:+UseParallelGC") } </pre></div>
<div class="tabs__content" data-gtm="tab" id="7bd56a52" data-sync-tabs="groovy" data-title="Groovy"><pre class="code-block" data-lang="groovy" data-title="Groovy" data-language="groovy">kotlin { kotlinDaemonJvmArgs = ["-Xmx486m", "-Xms256m", "-XX:+UseParallelGC"] } </pre></div>
</div>
</li>
<li class="list__item" id="b71a9e2e">
<p id="46200d0c">You can specify arguments for a specific task:</p>
<div class="tabs" id="8e8127e0" data-group="build-script">
<div class="tabs__content" data-gtm="tab" id="129daa20" data-sync-tabs="kotlin" data-title="Kotlin"><pre class="code-block" data-lang="kotlin" data-title="Kotlin" data-language="kotlin">tasks.withType&lt;CompileUsingKotlinDaemon&gt;().configureEach { kotlinDaemonJvmArguments.set(listOf("-Xmx486m", "-Xms256m", "-XX:+UseParallelGC")) } </pre></div>
<div class="tabs__content" data-gtm="tab" id="29031099" data-sync-tabs="groovy" data-title="Groovy"><pre class="code-block" data-lang="groovy" data-title="Groovy" data-language="groovy">tasks.withType(CompileUsingKotlinDaemon::class).configureEach { task -&gt; task.kotlinDaemonJvmArguments.set(["-Xmx1g", "-Xms512m"]) } </pre></div>
</div>
<aside data-type="note" class="prompt" data-title="" id="461b4f02"><p id="a9b70648">In this case a new Kotlin daemon instance can start on task execution. Learn more about <a href="#kotlin-daemon-s-behavior-with-jvm-arguments" id="38247d27">Kotlin daemon's behavior with JVM arguments</a>.</p></aside>
</li>
</ul>
<section class="chapter"><h4 id="kotlin-daemon-s-behavior-with-jvm-arguments" data-toc="gradle#kotlin-daemon-s-behavior-with-jvm-arguments">Kotlin daemon's behavior with JVM arguments</h4>
<p id="6090a9c1">When configuring the Kotlin daemon's JVM arguments, note that:</p>
<ul class="list _ul" id="14786b3">
<li class="list__item" id="81a5a3b7"><p id="d270734b">It is expected to have multiple instances of the Kotlin daemon running at the same time when different subprojects or tasks have different sets of JVM arguments.</p></li>
<li class="list__item" id="d13c86ae">
<p id="7d8108ef">A new Kotlin daemon instance starts only when Gradle runs a related compilation task and existing Kotlin daemons do not have the same set of JVM arguments. Imagine that your project has a lot of subprojects. Most of them require some heap memory for a Kotlin daemon, but one module requires a lot (though it is rarely compiled). In this case, you should provide a different set of JVM arguments for such a module, so a Kotlin daemon with a larger heap size would start only for developers who touch this specific module.</p>
<aside data-type="note" class="prompt" data-title="" id="1d82ec46"><p id="c0f926a6">If you are already running a Kotlin daemon that has enough heap size to handle the compilation request, even if other requested JVM arguments are different, this daemon will be reused instead of starting a new one.</p></aside>
</li>
<li class="list__item" id="100d1bb8"><p id="9efab8bf">If the <code class="code ">Xmx</code> is not specified, the Kotlin daemon will inherit it from the Gradle daemon.</p></li>
</ul></section></section></section><div class="last-modified"> Last modified: 22 November 2021</div>

<div class="navigation-links _bottom"> <a class="navigation-links__prev" href="keyword-reference">Keywords and operators</a> <a class="navigation-links__next" href="maven">Maven</a> </div><div class="_attribution">
  <p class="_attribution-p">
    <a href="https://kotlinlang.org/docs/gradle.html" class="_attribution-link" target="_blank">https://kotlinlang.org/docs/gradle.html</a>
  </p>
</div>
