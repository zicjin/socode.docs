<h1 id="class-ActiveRecord::DatabaseConfigurations" class="class"> class ActiveRecord::DatabaseConfigurations </h1>
<dl class="meta">
<dt>Parent:</dt>
<dd class="meta-parent"><a href="../object">Object</a></dd>
</dl> <section class="description"> <p><a href="databaseconfigurations"><code>ActiveRecord::DatabaseConfigurations</code></a> returns an array of DatabaseConfig objects (either a <a href="databaseconfigurations/hashconfig"><code>HashConfig</code></a> or <a href="databaseconfigurations/urlconfig"><code>UrlConfig</code></a>) that are constructed from the application's database configuration hash or URL string.</p> </section> <section id="5Buntitled-5D" class="documentation-section"> <section class="attribute-method-details"> <header> <h3>Attributes</h3> </header> <div class="method-detail"> <div class="method-heading attribute-method-heading" id="attribute-i-configurations"> <span class="method-name">configurations</span><span class="attribute-access-type">[R]</span> </div>  </div> </section> <section id="public-class-5Buntitled-5D-method-details" class="method-section"> <header> <h3>Public Class Methods</h3> </header> <div class="method-detail "> <div class="method-heading" id="method-c-new"> <span class="method-name">new</span><span class="method-args">(configurations = {})</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="new-source"> <pre class="ruby" data-language="ruby"># File activerecord/lib/active_record/database_configurations.rb, line 18
def initialize(configurations = {})
  @configurations = build_configs(configurations)
end</pre> </div>  </div> </div> </section> <section id="public-instance-5Buntitled-5D-method-details" class="method-section"> <header> <h3>Public Instance Methods</h3> </header> <div class="method-detail method-alias"> <div class="method-heading" id="method-i-5B-5D"> <span class="method-name">[]</span><span class="method-args">(env = default_env)</span> </div>  <div class="aliases"> Alias for: <a href="databaseconfigurations#method-i-default_hash">default_hash</a> </div> </div> <div class="method-detail method-alias"> <div class="method-heading" id="method-i-blank-3F"> <span class="method-name">blank?</span><span class="method-args">()</span> </div>  <div class="aliases"> Alias for: <a href="databaseconfigurations#method-i-empty-3F">empty?</a> </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-configs_for"> <span class="method-name">configs_for</span><span class="method-args">(env_name: nil, spec_name: nil, name: nil, include_replicas: false)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="configs_for-source"> <pre class="ruby" data-language="ruby"># File activerecord/lib/active_record/database_configurations.rb, line 40
def configs_for(env_name: nil, spec_name: nil, name: nil, include_replicas: false)
  if spec_name
    name = spec_name
    ActiveSupport::Deprecation.warn("The kwarg `spec_name` is deprecated in favor of `name`. `spec_name` will be removed in Rails 6.2")
  end

  env_name ||= default_env if name
  configs = env_with_configs(env_name)

  unless include_replicas
    configs = configs.select do |db_config|
      !db_config.replica?
    end
  end

  if name
    configs.find do |db_config|
      db_config.name == name
    end
  else
    configs
  end
end</pre> </div> <p>Collects the configs for the environment and optionally the specification name passed in. To include replica configurations pass <code>include_replicas: true</code>.</p> <p>If a name is provided a single DatabaseConfig object will be returned, otherwise an array of DatabaseConfig objects will be returned that corresponds with the environment and type requested.</p> <h4 id="method-i-configs_for-label-Options">Options</h4> <ul>
<li> <p><code>env_name:</code> The environment name. Defaults to <code>nil</code> which will collect configs for all environments.</p> </li>
<li> <p><code>name:</code> The db config name (i.e. primary, animals, etc.). Defaults to <code>nil</code>. If no <code>env_name</code> is specified the config for the default env and the passed <code>name</code> will be returned.</p> </li>
<li> <p><code>include_replicas:</code> Determines whether to include replicas in the returned list. Most of the time we're only iterating over the write connection (i.e. migrations don't need to run for the write and read connection). Defaults to <code>false</code>.</p> </li>
</ul>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-default_hash"> <span class="method-name">default_hash</span><span class="method-args">(env = default_env)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="default_hash-source"> <pre class="ruby" data-language="ruby"># File activerecord/lib/active_record/database_configurations.rb, line 70
def default_hash(env = default_env)
  default = find_db_config(env)
  default.configuration_hash if default
end</pre> </div> <p>Returns the config hash that corresponds with the environment</p> <p>If the application has multiple databases <code>default_hash</code> will return the first config hash for the environment.</p> <pre class="ruby" data-language="ruby">{ database: "my_db", adapter: "mysql2" }
</pre>  </div> <div class="aliases"> Also aliased as: <a href="databaseconfigurations#method-i-5B-5D">[]</a> </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-empty-3F"> <span class="method-name">empty?</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="empty-3F-source"> <pre class="ruby" data-language="ruby"># File activerecord/lib/active_record/database_configurations.rb, line 114
def empty?
  configurations.empty?
end</pre> </div> <p>Checks if the application's configurations are empty.</p> <p>Aliased to blank?</p>  </div> <div class="aliases"> Also aliased as: <a href="databaseconfigurations#method-i-blank-3F">blank?</a> </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-find_db_config"> <span class="method-name">find_db_config</span><span class="method-args">(env)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="find_db_config-source"> <pre class="ruby" data-language="ruby"># File activerecord/lib/active_record/database_configurations.rb, line 81
def find_db_config(env)
  configurations
    .sort_by.with_index { |db_config, i| db_config.for_current_env? ? [0, i] : [1, i] }
    .find do |db_config|
      db_config.env_name == env.to_s ||
        (db_config.for_current_env? &amp;&amp; db_config.name == env.to_s)
    end
end</pre> </div> <p>Returns a single DatabaseConfig object based on the requested environment.</p> <p>If the application has multiple databases <code>find_db_config</code> will return the first DatabaseConfig for the environment.</p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-to_h"> <span class="method-name">to_h</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="to_h-source"> <pre class="ruby" data-language="ruby"># File activerecord/lib/active_record/database_configurations.rb, line 104
def to_h
  configurations.inject({}) do |memo, db_config|
    memo.merge(db_config.env_name =&gt; db_config.configuration_hash.stringify_keys)
  end
end</pre> </div> <p>Returns the <a href="databaseconfigurations"><code>DatabaseConfigurations</code></a> object as a <a href="../hash"><code>Hash</code></a>.</p>  </div> </div> </section> </section><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2004&ndash;2020 David Heinemeier Hansson<br>Licensed under the MIT License.<br>
    
  </p>
</div>
