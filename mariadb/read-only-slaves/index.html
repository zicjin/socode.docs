<h1>Read-Only Slaves</h1> <div> <div class="node creole"> <div class="answer formatted"> <p> A common <a href="../standard-replication/index">replication</a> setup is to have the <a href="../server-system-variables/index#read_only">slaves read-only</a> to ensure that no one accidentally updates them. If the slave has <a href="../setting-up-replication/index">binary logging enabled</a> and <a href="../gtid/index#gtid_strict_mode">gtid_strict_mode</a> is used, then any update that causes changes to the <a href="../binary-log/index">binary log</a> will stop replication.</p> <p>When the variable <code>read_only</code> is set to 1, no updates are permitted except from users with the SUPER privilege or slave servers updating from a master. Inserting rows to log tables, updates to temporary tables and <a href="../optimize-table/index">OPTIMIZE TABLE</a> or <a href="../analyze-table/index">ANALYZE TABLE</a> statements are excluded from this limitation.</p> <p>If read_only is set to 1, then the <a href="../set-password/index">SET PASSWORD</a> statement is limited only to users with the SUPER privilege.</p> <p>Attempting to set the <code>read_only</code> variable to 1 will fail if the current session has table locks or transactions pending.</p> <p>The statement will wait for other sessions that hold table locks. While the attempt to set read_only is waiting, other requests for table locks or transactions will also wait until read_only has been set.</p> <p>Starting with <a href="https://mariadb.com/kb/en/mariadb-10320-release-notes/">MariaDB 10.3.20</a> we have fixed some issues related to read only slaves:</p> <ul start="1">
<li>
<a href="../create-table/index">CREATE</a>, <a href="../drop-table/index">DROP</a>, <a href="../alter-table/index">ALTER</a>, <a href="../insert/index">INSERT</a> and <a href="../delete/index">DELETE</a> of temporary tables are not logged to binary log, even in <a href="../binary-log-formats/index#statement-based-logging">statement</a> or <a href="../binary-log-formats/index#mixed-logging">mixed</a> mode. With earlier MariaDB versions, one can avoid the problem with temporary tables by using <a href="../binary-log-formats/index#row-based-logging">binlog_format=ROW</a> in which cases temporary tables are never logged. </li>
<li>Changes to temporary tables created during <code>read_only</code> will not be logged even after <code>read_only</code> mode is disabled (for example if the slave is promoted to a master). </li>
<li>The Admin statements <a href="../analyze-table/index">ANALYZE</a>, <a href="../check-table/index">CHECK</a> and <a href="../repair-table/index">REPAIR</a> will not be logged to the binary log under read-only. </li>
</ul> <h3 class="anchored_heading" id="older-mariadb-versions">Older MariaDB Versions</h3> <p>If you are using an older MariaDB version with read-only slaves and binary logging enabled on the slave, and you need to do some changes but don't want to have them logged to the binary log, the easiest way to avoid the logging is to <a href="../activating-the-binary-log/index">disable binary logging</a> while running as root during maintenance:</p> <pre class="fixed" data-language="sql">set sql_log_bin=0;
alter table test engine=rocksdb;
</pre>
<p>The above changes the test table on the slave to rocksdb without registering the change in the binary log.</p> </div>     </div> <div id="content_disclaimer" class="graybox"> Content reproduced on this site is the property of its respective owners, and this content is not reviewed in advance by MariaDB. The views, information and opinions expressed by this content do not necessarily represent those of MariaDB or any other party. </div> </div><div class="_attribution">
  <p class="_attribution-p">
    <a href="https://mariadb.com/kb/en/read-only-slaves/" class="_attribution-link" target="_blank">https://mariadb.com/kb/en/read-only-slaves/</a>
  </p>
</div>
