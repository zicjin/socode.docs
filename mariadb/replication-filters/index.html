<h1>Replication Filters</h1> <div> <div class="node creole"> <div class="answer formatted">  <p>Replication filters allow users to configure <a href="../replication-overview/index">replication slaves</a> to intentionally skip certain events.</p> <h2 class="anchored_heading" id="binary-log-filters-for-replication-masters">Binary Log Filters for Replication Masters</h2> <p>MariaDB provides options that can be used on a <a href="../replication/index">replication master</a> to restrict local changes to specific databases from getting written to the <a href="../binary-log/index">binary log</a>, which also determines whether any replication slaves replicate those changes.</p> <h3 class="anchored_heading" id="binary-log-filter-options">Binary Log Filter Options</h3> <p>The following options are available, and they are evaluated in the order that they are listed below:</p> <h4 class="anchored_heading" id="binlog_do_db"><code>binlog_do_db</code></h4> <p>The <code><a href="../mysqld-options/index#-binlog-do-db">binlog_do_db</a></code> option allows you to configure a <a href="../replication/index">replication master</a> to write statements and transactions affecting databases that match a specified name into its <a href="../binary-log/index">binary log</a>. Since the filtered statements or transactions will not be present in the <a href="../binary-log/index">binary log</a>, its replication slaves will not be able to replicate them.</p> <p>This option will <strong>not</strong> work with cross-database updates with <a href="../binary-log-formats/index#statement-based-logging">statement-based logging</a>. See the <a href="#statement-based-logging">Statement-Based Logging</a> section for more information.</p> <p>This option can <strong>not</strong> be set dynamically.</p> <p>When setting it on the command-line or in a server <a href="../configuring-mariadb-with-option-files/index#option-groups">option group</a> in an <a href="../configuring-mariadb-with-option-files/index">option file</a>, the option does not accept a comma-separated list. If you would like to specify multiple filters, then you need to specify the option multiple times. For example:</p> <pre class="fixed" data-language="sql">[mariadb]
...
binlog_do_db=db1
binlog_do_db=db2
</pre>
<p>This will tell the master to do the following:</p> <ul start="1">
<li>Write statements and transactions affecting the database named <em>db1</em> into the <a href="../binary-log/index">binary log</a>. </li>
<li>Write statements and transactions affecting the database named <em>db2</em> into the <a href="../binary-log/index">binary log</a>. </li>
<li>Don't write statements and transactions affecting any other databases into the <a href="../binary-log/index">binary log</a>. </li>
</ul> <h4 class="anchored_heading" id="binlog_ignore_db"><code>binlog_ignore_db</code></h4> <p>The <code><a href="../mysqld-options/index#-binlog-ignore-db">binlog_ignore_db</a></code> option allows you to configure a <a href="../replication/index">replication master</a> to <strong>not</strong> write statements and transactions affecting databases that match a specified name into its <a href="../binary-log/index">binary log</a>. Since the filtered statements or transactions will not be present in the <a href="../binary-log/index">binary log</a>, its replication slaves will not be able to replicate them.</p> <p>This option will <strong>not</strong> work with cross-database updates with <a href="../binary-log-formats/index#statement-based-logging">statement-based logging</a>. See the <a href="#statement-based-logging">Statement-Based Logging</a> section for more information.</p> <p>This option can <strong>not</strong> be set dynamically.</p> <p>When setting it on the command-line or in a server <a href="../configuring-mariadb-with-option-files/index#option-groups">option group</a> in an <a href="../configuring-mariadb-with-option-files/index">option file</a>, the option does not accept a comma-separated list. If you would like to specify multiple filters, then you need to specify the option multiple times. For example:</p> <pre class="fixed" data-language="sql">[mariadb]
...
binlog_ignore_db=db1
binlog_ignore_db=db2
</pre>
<p>This will tell the master to do the following:</p> <ul start="1">
<li>Don't write statements and transactions affecting the database named <em>db1</em> into the <a href="../binary-log/index">binary log</a>. </li>
<li>Don't write statements and transactions affecting the database named <em>db2</em> into the <a href="../binary-log/index">binary log</a>. </li>
<li>Write statements and transactions affecting any other databases into the <a href="../binary-log/index">binary log</a>. </li>
</ul> <div class="cstm-style greenbox">
<p>The <code><a href="#binlog_ignore_db">binlog_ignore_db</a></code> option is effectively ignored if the <code><a href="#binlog_do_db">binlog_do_db</a></code> option is set, so those two options should not be set together.</p> </div>
<h2 class="anchored_heading" id="replication-filters-for-replication-slaves">Replication Filters for Replication Slaves</h2> <p>MariaDB provides options and system variables that can be used on used on a <a href="../replication/index">replication slave</a> to filter events replicated in the <a href="../binary-log/index">binary log</a>.</p> <h3 class="anchored_heading" id="replication-filter-options">Replication Filter Options</h3> <p>The following options and system variables are available, and they are evaluated in the order that they are listed below:</p> <h4 class="anchored_heading" id="replicate_rewrite_db"><code>replicate_rewrite_db</code></h4> <p>The <code><a href="../mysqld-options/index#-replicate-rewrite-db">replicate_rewrite_db</a></code> option allows you to configure a <a href="../replication/index">replication slave</a> to rewrite database names. It uses the format <code>master_database-&gt;slave_database</code>. If a slave encounters a <a href="../binary-log/index">binary log</a> event in which the default database (i.e. the one selected by the <code><a href="../use/index">USE</a></code> statement) is <code>master_database</code>, then the slave will apply the event in <code>slave_database</code> instead.</p> <p>This option will <strong>not</strong> work with cross-database updates with <a href="../binary-log-formats/index#statement-based-logging">statement-based logging</a>. See the <a href="#statement-based-logging">Statement-Based Logging</a> section for more information.</p> <p>This option only affects statements that involve tables. This option does not affect statements involving the database itself, such as <code><a href="../create-database/index">CREATE DATABASE</a></code>, <code><a href="../alter-database/index">ALTER DATABASE</a></code>, and <code><a href="../drop-database/index">DROP DATABASE</a></code>. </p> <p>This option's rewrites are evaluated <em>before</em> any other replication filters configured by the <code>replicate_*</code> system variables.</p> <p>Statements that use table names qualified with database names do not work with other replication filters such as <code><a href="#replicate_do_table">replicate_do_table</a>.</code></p> <p>This option can <strong>not</strong> be set dynamically.</p> <p>When setting it on the command-line or in a server <a href="../configuring-mariadb-with-option-files/index#option-groups">option group</a> in an <a href="../configuring-mariadb-with-option-files/index">option file</a>, the option does not accept a comma-separated list. If you would like to specify multiple filters, then you need to specify the option multiple times. For example:</p> <pre class="fixed" data-language="sql">[mariadb]
...
replicate_rewrite_db=db1-&gt;db3
replicate_rewrite_db=db2-&gt;db4
</pre>
<p>This will tell the slave to do the following:</p> <ul start="1">
<li>If a <a href="../binary-log/index">binary log</a> event is encountered in which the default database was <em>db1</em>, then apply the event in <em>db3</em> instead. </li>
<li>If a <a href="../binary-log/index">binary log</a> event is encountered in which the default database was <em>db2</em>, then apply the event in <em>db4</em> instead. </li>
</ul> <p>See <a href="#configuring-replication-filter-options-with-multi-source-replication">Configuring Replication Filter Options with Multi-Source Replication</a> for how to configure this system variable with <a href="../multi-source-replication/index">multi-source replication</a>.</p> <h4 class="anchored_heading" id="replicate_do_db"><code>replicate_do_db</code></h4> <p>The <code><a href="../replication-and-binary-log-server-system-variables/index#replicate_do_db">replicate_do_db</a></code> system variable allows you to configure a <a href="../replication/index">replication slave</a> to apply statements and transactions affecting databases that match a specified name.</p> <p>This system variable will <strong>not</strong> work with cross-database updates with <a href="../binary-log-formats/index#statement-based-logging">statement-based logging</a> or when using <a href="../binary-log-formats/index#statement-based-logging">mixed-based logging</a> and the statement is logged statement based. For statement-based replication, only the default database (that is, the one selected by USE) is considered, not any explicitly mentioned tables in the query. See the <a href="#statement-based-logging">Statement-Based Logging</a> section for more information.</p> <p>When setting it dynamically with <code><a href="../set/index#global-session">SET GLOBAL</a></code>, the system variable accepts a comma-separated list of filters.</p> <p>When setting it dynamically, it is not possible to specify database names that contain commas. If you need to specify database names that contain commas, then you will need to specify them by either providing the command-line options or configuring them in a server <a href="../configuring-mariadb-with-option-files/index#option-groups">option group</a> in an <a href="../configuring-mariadb-with-option-files/index">option file</a> when the server is <a href="../starting-and-stopping-mariadb-starting-and-stopping-mariadb/index">started</a>. </p> <p>When setting it dynamically, the <a href="../replication-threads/index#threads-on-the-slave">slave threads</a> must be stopped. For example:</p> <pre class="fixed" data-language="sql">STOP SLAVE;
SET GLOBAL replicate_do_db='db1,db2';
START SLAVE;
</pre>
<p>When setting it on the command-line or in a server <a href="../configuring-mariadb-with-option-files/index#option-groups">option group</a> in an <a href="../configuring-mariadb-with-option-files/index">option file</a>, the system variable does not accept a comma-separated list. If you would like to specify multiple filters, then you need to specify the system variable multiple times. For example:</p> <pre class="fixed" data-language="sql">[mariadb]
...
replicate_do_db=db1
replicate_do_db=db2
</pre>
<p>This will tell the slave to do the following:</p> <ul start="1">
<li>Replicate statements and transactions affecting the database named <em>db1</em>. </li>
<li>Replicate statements and transactions affecting the database named <em>db2</em>. </li>
<li>Ignore statements and transactions affecting any other databases. </li>
</ul> <p>See <a href="#configuring-replication-filter-options-with-multi-source-replication">Configuring Replication Filter Options with Multi-Source Replication</a> for how to configure this system variable with <a href="../multi-source-replication/index">multi-source replication</a>.</p> <h4 class="anchored_heading" id="replicate_ignore_db"><code>replicate_ignore_db</code></h4> <p>The <code><a href="../replication-and-binary-log-server-system-variables/index#replicate_ignore_db">replicate_ignore_db</a></code> system variable allows you to configure a <a href="../replication/index">replication slave</a> to ignore statements and transactions affecting databases that match a specified name.</p> <p>This system variable will <strong>not</strong> work with cross-database updates with <a href="../binary-log-formats/index#statement-based-logging">statement-based logging</a> or when using <a href="../binary-log-formats/index#statement-based-logging">mixed-based logging</a> and the statement is logged statement based. For statement-based replication, only the default database (that is, the one selected by USE) is considered, not any explicitly mentioned tables in the query. See the <a href="#statement-based-logging">Statement-Based Logging</a> section for more information.</p> <p>When setting it dynamically with <code><a href="../set/index#global-session">SET GLOBAL</a></code>, the system variable accepts a comma-separated list of filters.</p> <p>When setting it dynamically, it is not possible to specify database names that contain commas. If you need to specify names or patterns that contain commas, then you will need to specify them by either providing the command-line options or configuring them in a server <a href="../configuring-mariadb-with-option-files/index#option-groups">option group</a> in an <a href="../configuring-mariadb-with-option-files/index">option file</a> when the server is <a href="../starting-and-stopping-mariadb-starting-and-stopping-mariadb/index">started</a>. </p> <p>When setting it dynamically, the <a href="../replication-threads/index#threads-on-the-slave">slave threads</a> must be stopped. For example:</p> <pre class="fixed" data-language="sql">STOP SLAVE;
SET GLOBAL replicate_ignore_db='db1,db2';
START SLAVE;
</pre>
<p>When setting it on the command-line or in a server <a href="../configuring-mariadb-with-option-files/index#option-groups">option group</a> in an <a href="../configuring-mariadb-with-option-files/index">option file</a>, the system variable does not accept a comma-separated list. If you would like to specify multiple filters, then you need to specify the system variable multiple times. For example:</p> <pre class="fixed" data-language="sql">[mariadb]
...
replicate_ignore_db=db1
replicate_ignore_db=db2
</pre>
<p>This will tell the slave to do the following:</p> <ul start="1">
<li>Ignore statements and transactions affecting databases named <em>db1</em>. </li>
<li>Ignore statements and transactions affecting databases named <em>db2</em>. </li>
<li>Replicate statements and transactions affecting any other databases. </li>
</ul> <div class="cstm-style greenbox">
<p>The <code><a href="#replicate_ignore_db">replicate_ignore_db</a></code> system variable is effectively ignored if the <code><a href="#replicate_do_db">replicate_do_db</a></code> system variable is set, so those two system variables should not be set together.</p> </div>
<p>See <a href="#configuring-replication-filter-options-with-multi-source-replication">Configuring Replication Filter Options with Multi-Source Replication</a> for how to configure this system variable with <a href="../multi-source-replication/index">multi-source replication</a>.</p> <h4 class="anchored_heading" id="replicate_do_table"><code>replicate_do_table</code></h4> <p>The <code><a href="../replication-and-binary-log-server-system-variables/index#replicate_do_table">replicate_do_table</a></code> system variable allows you to configure a <a href="../replication/index">replication slave</a> to apply statements and transactions that affect tables that match a specified name. The table name is specified in the format: <code>dbname.tablename</code>. </p> <p>This system variable will <strong>not</strong> work with cross-database updates with <a href="../binary-log-formats/index#statement-based-logging">statement-based logging</a>. See the <a href="#statement-based-logging">Statement-Based Logging</a> section for more information.</p> <p>When setting it dynamically with <code><a href="../set/index#global-session">SET GLOBAL</a></code>, the system variable accepts a comma-separated list of filters.</p> <p>When setting it dynamically, it is not possible to specify database or table names or patterns that contain commas. If you need to specify database or table names that contain commas, then you will need to specify them by either providing the command-line options or configuring them in a server <a href="../configuring-mariadb-with-option-files/index#option-groups">option group</a> in an <a href="../configuring-mariadb-with-option-files/index">option file</a> when the server is <a href="../starting-and-stopping-mariadb-starting-and-stopping-mariadb/index">started</a>. </p> <p>When setting it dynamically, the <a href="../replication-threads/index#threads-on-the-slave">slave threads</a> must be stopped. For example:</p> <pre class="fixed" data-language="sql">STOP SLAVE;
SET GLOBAL replicate_do_table='db1.tab,db2.tab';
START SLAVE;
</pre>
<p>When setting it on the command-line or in a server <a href="../configuring-mariadb-with-option-files/index#option-groups">option group</a> in an <a href="../configuring-mariadb-with-option-files/index">option file</a>, the system variable does not accept a comma-separated list. If you would like to specify multiple filters, then you need to specify the system variable multiple times. For example:</p> <pre class="fixed" data-language="sql">[mariadb]
...
replicate_do_table=db1.tab
replicate_do_table=db2.tab
</pre>
<p>This will tell the slave to do the following:</p> <ul start="1">
<li>Replicate statements and transactions affecting tables in databases named <em>db1</em> and which are named <em>tab</em>. </li>
<li>Replicate statements and transactions affecting tables in databases named <em>db2</em> and which are named <em>tab</em>. </li>
<li>Ignore statements and transactions affecting any other tables. </li>
</ul> <p>See <a href="#configuring-replication-filter-options-with-multi-source-replication">Configuring Replication Filter Options with Multi-Source Replication</a> for how to configure this system variable with <a href="../multi-source-replication/index">multi-source replication</a>.</p> <h4 class="anchored_heading" id="replicate_ignore_table"><code>replicate_ignore_table</code></h4> <p>The <code><a href="../replication-and-binary-log-server-system-variables/index#replicate_ignore_table">replicate_ignore_table</a></code> system variable allows you to configure a <a href="../replication/index">replication slave</a> to ignore statements and transactions that affect tables that match a specified name. The table name is specified in the format: <code>dbname.tablename</code>. </p> <p>This system variable will <strong>not</strong> work with cross-database updates with <a href="../binary-log-formats/index#statement-based-logging">statement-based logging</a>. See the <a href="#statement-based-logging">Statement-Based Logging</a> section for more information.</p> <p>When setting it dynamically with <code><a href="../set/index#global-session">SET GLOBAL</a></code>, the system variable accepts a comma-separated list of filters.</p> <p>When setting it dynamically, it is not possible to specify database or table names that contain commas. If you need to specify database or table names that contain commas, then you will need to specify them by either providing the command-line options or configuring them in a server <a href="../configuring-mariadb-with-option-files/index#option-groups">option group</a> in an <a href="../configuring-mariadb-with-option-files/index">option file</a> when the server is <a href="../starting-and-stopping-mariadb-starting-and-stopping-mariadb/index">started</a>. </p> <p>When setting it dynamically, the <a href="../replication-threads/index#threads-on-the-slave">slave threads</a> must be stopped. For example:</p> <pre class="fixed" data-language="sql">STOP SLAVE;
SET GLOBAL replicate_ignore_table='db1.tab,db2.tab';
START SLAVE;
</pre>
<p>When setting it on the command-line or in a server <a href="../configuring-mariadb-with-option-files/index#option-groups">option group</a> in an <a href="../configuring-mariadb-with-option-files/index">option file</a>, the system variable does not accept a comma-separated list. If you would like to specify multiple filters, then you need to specify the system variable multiple times. For example:</p> <pre class="fixed" data-language="sql">[mariadb]
...
replicate_ignore_table=db1.tab
replicate_ignore_table=db2.tab
</pre>
<p>This will tell the slave to do the following:</p> <ul start="1">
<li>Ignore statements and transactions affecting tables in databases named <em>db1</em> and which are named <em>tab</em>. </li>
<li>Ignore statements and transactions affecting tables in databases named <em>db2</em> and which are named <em>tab</em>. </li>
<li>Replicate statements and transactions affecting any other tables. </li>
</ul> <div class="cstm-style greenbox">
<p>The <code><a href="#replicate_ignore_table">replicate_ignore_table</a></code> system variable is effectively ignored if either the <code><a href="#replicate_do_table">replicate_do_table</a></code> system variable or the <code><a href="#replicate_wild_do_table">replicate_wild_do_table</a></code> system variable is set, so the <code><a href="#replicate_ignore_table">replicate_ignore_table</a></code> system variable should not be used with those two system variables.</p> </div>
<p>See <a href="#configuring-replication-filter-options-with-multi-source-replication">Configuring Replication Filter Options with Multi-Source Replication</a> for how to configure this system variable with <a href="../multi-source-replication/index">multi-source replication</a>.</p> <h4 class="anchored_heading" id="replicate_wild_do_table"><code>replicate_wild_do_table</code></h4> <p>The <code><a href="../replication-and-binary-log-server-system-variables/index#replicate_wild_do_table">replicate_wild_do_table</a></code> system variable allows you to configure a <a href="../replication/index">replication slave</a> to apply statements and transactions that affect tables that match a specified wildcard pattern.</p> <p>The wildcard pattern uses the same semantics as the <code><a href="../like/index">LIKE</a></code> operator. This means that the the following characters have a special meaning:</p> <ul start="1">
<li>
<code>_</code> - The <code>_</code> character matches any single character. </li>
<li>
<code>%</code> - The <code>%</code> character matches zero or more characters. </li>
<li>
<code>\</code> - The <code>\</code> character is used to escape the other special characters in cases where you need the literal character. </li>
</ul> <p>This system variable will work with cross-database updates with <a href="../binary-log-formats/index#statement-based-logging">statement-based logging</a>. See the <a href="#statement-based-logging">Statement-Based Logging</a> section for more information.</p> <p>The system variable does filter databases, tables, <a href="../views/index">views</a> and <a href="../triggers/index">triggers</a>.</p> <p>The system variable does not filter <a href="../stored-procedures/index">stored procedures</a>, <a href="../stored-functions/index">stored functions</a>, and <a href="../stored-programs-and-views-events/index">events</a>. The <code><a href="../replication-and-binary-log-server-system-variables/index#replicate_do_db">replicate_do_db</a></code> system variable will need to be used to filter those.</p> <p>If the table name pattern for a filter is just specified as <code>%</code>, then all tables in the database will be matched. In this case, the filter will also affect certain database-level statements, such as <code><a href="../create-database/index">CREATE DATABASE</a></code>, <code><a href="../alter-database/index">ALTER DATABASE</a></code> and <a href="../drop-database/index">DROP DATABASE</a><code>.</code></p> <p>When setting it dynamically with <code><a href="../set/index#global-session">SET GLOBAL</a></code>, the system variable accepts a comma-separated list of filters.</p> <p>When setting it dynamically, it is not possible to specify database or table names or patterns that contain commas. If you need to specify database or table names or patterns that contain commas, then you will need to specify them by either providing the command-line options or configuring them in a server <a href="../configuring-mariadb-with-option-files/index#option-groups">option group</a> in an <a href="../configuring-mariadb-with-option-files/index">option file</a> when the server is <a href="../starting-and-stopping-mariadb-starting-and-stopping-mariadb/index">started</a>. </p> <p>When setting it dynamically, the <a href="../replication-threads/index#threads-on-the-slave">slave threads</a> must be stopped. For example:</p> <pre class="fixed" data-language="sql">STOP SLAVE;
SET GLOBAL replicate_wild_do_table='db%.tab%,app1.%';
START SLAVE;
</pre>
<p>When setting it on the command-line or in a server <a href="../configuring-mariadb-with-option-files/index#option-groups">option group</a> in an <a href="../configuring-mariadb-with-option-files/index">option file</a>, the system variable does not accept a comma-separated list. If you would like to specify multiple filters, then you need to specify the system variable multiple times. For example:</p> <pre class="fixed" data-language="sql">[mariadb]
...
replicate_wild_do_table=db%.tab%
replicate_wild_do_table=app1.%
</pre>
<p>This will tell the slave to do the following:</p> <ul start="1">
<li>Replicate statements and transactions affecting tables in databases that start with <em>db</em> and whose table names start with <em>tab</em>. </li>
<li>Replicate statements and transactions affecting the database named <em>app1</em>. </li>
<li>Ignore statements and transactions affecting any other tables and databases. </li>
</ul> <p>See <a href="#configuring-replication-filter-options-with-multi-source-replication">Configuring Replication Filter Options with Multi-Source Replication</a> for how to configure this system variable with <a href="../multi-source-replication/index">multi-source replication</a>.</p> <h4 class="anchored_heading" id="replicate_wild_ignore_table"><code>replicate_wild_ignore_table</code></h4> <p>The <code><a href="../replication-and-binary-log-server-system-variables/index#replicate_wild_ignore_table">replicate_wild_ignore_table</a></code> system variable allows you to configure a <a href="../replication/index">replication slave</a> to ignore statements and transactions that affect tables that match a specified wildcard pattern.</p> <p>The wildcard pattern uses the same semantics as the <code><a href="../like/index">LIKE</a></code> operator. This means that the the following characters have a special meaning:</p> <ul start="1">
<li>
<code>_</code> - The <code>_</code> character matches any single character. </li>
<li>
<code>%</code> - The <code>%</code> character matches zero or more characters. </li>
<li>
<code>\</code> - The <code>\</code> character is used to escape the other special characters in cases where you need the literal character. </li>
</ul> <p>This system variable will work with cross-database updates with <a href="../binary-log-formats/index#statement-based-logging">statement-based logging</a>. See the <a href="#statement-based-logging">Statement-Based Logging</a> section for more information.</p> <p>The system variable does filter databases, tables, <a href="../views/index">views</a> and <a href="../triggers/index">triggers</a>.</p> <p>The system variable does not filter <a href="../stored-procedures/index">stored procedures</a>, <a href="../stored-functions/index">stored functions</a>, and <a href="../stored-programs-and-views-events/index">events</a>. The <code><a href="../replication-and-binary-log-server-system-variables/index#replicate_ignore_db">replicate_ignore_db</a></code> system variable will need to be used to filter those.</p> <p>If the table name pattern for a filter is just specified as <code>%</code>, then all tables in the database will be matched. In this case, the filter will also affect certain database-level statements, such as <code><a href="../create-database/index">CREATE DATABASE</a></code>, <code><a href="../alter-database/index">ALTER DATABASE</a></code> and <a href="../drop-database/index">DROP DATABASE</a><code>.</code></p> <p>When setting it dynamically with <code><a href="../set/index#global-session">SET GLOBAL</a></code>, the system variable accepts a comma-separated list of filters.</p> <p>When setting it dynamically, it is not possible to specify database or table names or patterns that contain commas. If you need to specify database or table names or patterns that contain commas, then you will need to specify them by either providing the command-line options or configuring them in a server <a href="../configuring-mariadb-with-option-files/index#option-groups">option group</a> in an <a href="../configuring-mariadb-with-option-files/index">option file</a> when the server is <a href="../starting-and-stopping-mariadb-starting-and-stopping-mariadb/index">started</a>. </p> <p>When setting it dynamically, the <a href="../replication-threads/index#threads-on-the-slave">slave threads</a> must be stopped. For example:</p> <pre class="fixed" data-language="sql">STOP SLAVE;
SET GLOBAL replicate_wild_ignore_table='db%.tab%,app1.%';
START SLAVE;
</pre>
<p>When setting it on the command-line or in a server <a href="../configuring-mariadb-with-option-files/index#option-groups">option group</a> in an <a href="../configuring-mariadb-with-option-files/index">option file</a>, the system variable does not accept a comma-separated list. If you would like to specify multiple filters, then you need to specify the system variable multiple times. For example:</p> <pre class="fixed" data-language="sql">[mariadb]
...
replicate_wild_ignore_table=db%.tab%
replicate_wild_ignore_table=app1.%
</pre>
<p>This will tell the slave to do the following:</p> <ul start="1">
<li>Ignore statements and transactions affecting tables in databases that start with <em>db</em> and whose table names start with <em>tab</em>. </li>
<li>Ignore statements and transactions affecting the database named <em>app1</em>. </li>
<li>Replicate statements and transactions affecting any other tables and databases. </li>
</ul> <div class="cstm-style greenbox">
<p>The <code><a href="#replicate_wild_ignore_table">replicate_ignore_table</a></code> system variable is effectively ignored if either the <code><a href="#replicate_do_table">replicate_do_table</a></code> system variable or the <code><a href="#replicate_wild_do_table">replicate_wild_do_table</a></code> system variable is set, so the <code><a href="#replicate_wild_ignore_table">replicate_ignore_table</a></code> system variable should not be used with those two system variables.</p> </div>
<p>See <a href="#configuring-replication-filter-options-with-multi-source-replication">Configuring Replication Filter Options with Multi-Source Replication</a> for how to configure this system variable with <a href="../multi-source-replication/index">multi-source replication</a>.</p> <h4 class="anchored_heading" id="configuring-replication-filter-options-with-multi-source-replication">Configuring Replication Filter Options with Multi-Source Replication</h4> <p>How you configure replication filters with <a href="../multi-source-replication/index">multi-source replication</a> depends on whether you are configuring them dynamically or whether you are configuring them in a server <a href="../configuring-mariadb-with-option-files/index#option-groups">option group</a> in an <a href="../configuring-mariadb-with-option-files/index">option file</a>.</p> <h5 class="anchored_heading" id="setting-replication-filter-options-dynamically-with-multi-source-replication">Setting Replication Filter Options Dynamically with Multi-Source Replication</h5> <p>The usage of dynamic replication filters changes somewhat when <a href="../multi-source-replication/index">multi-source replication</a> is in use. By default, the variables are addressed to the default connection, so in a multi-source environment, the required connection needs to be specified. There are two ways to do this.</p> <h6 class="anchored_heading" id="prefixing-the-replication-filter-option-with-the-connection-name">Prefixing the Replication Filter Option with the Connection Name</h6> <p>One way to change a replication filter for a multi-source connection is to explicitly specify the name when changing the filter. For example:</p> <pre class="fixed" data-language="sql">STOP SLAVE 'gandalf';
SET GLOBAL gandalf.replicate_do_table='database1.table1,database1.table2,database1.table3';
START SLAVE 'gandalf';
</pre>
<h6 class="anchored_heading" id="changing-the-default-connection">Changing the Default Connection</h6> <p>Alternatively, the default connection can be changed by setting the <code><a href="../replication-and-binary-log-server-system-variables/index#default_master_connection">default_master_connection</a></code> system variable, and then the replication filter can be changed in the usual fashion. For example:</p> <pre class="fixed" data-language="sql">SET default_master_connection = 'gandalf';
STOP SLAVE; 
SET GLOBAL replicate_do_table='database1.table1,database1.table2,database1.table3';
START SLAVE;
</pre>
<h5 class="anchored_heading" id="setting-replication-filter-options-in-option-files-with-multi-source-replication">Setting Replication Filter Options in Option Files with Multi-Source Replication</h5> <p>If you are using <a href="../multi-source-replication/index">multi-source replication</a> and if you would like to make this filter persist server restarts by adding it to a server <a href="../configuring-mariadb-with-option-files/index#option-groups">option group</a> in an <a href="../configuring-mariadb-with-option-files/index">option file</a>, then the option file can also include the connection name that each filter would apply to. For example:</p> <pre class="fixed" data-language="sql">[mariadb]
...
gandalf.replicate_do_db=database1
saruman.replicate_do_db=database2
</pre>
<h3 class="anchored_heading" id="change-master-options">CHANGE MASTER Options</h3> <p>The <code><a href="../change-master-to/index">CHANGE MASTER</a></code> statement has a few options that can be used to filter certain types of <a href="../binary-log/index">binary log</a> events.</p> <h4 class="anchored_heading" id="ignore_server_ids"><code>IGNORE_SERVER_IDS</code></h4> <p>The <code><a href="../change-master-to/index#ignore_server_ids">IGNORE_SERVER_IDS</a></code> option for <code>CHANGE MASTER</code> can be used to configure a <a href="../replication/index">replication slave</a> to ignore <a href="binary_log">binary log</a> events that originated from certain servers. Filtered <a href="binary_log">binary log</a> events will not get logged to the slave’s <a href="../relay-log/index">relay log</a>, and they will not be applied by the slave.</p> <h4 class="anchored_heading" id="do_domain_ids"><code>DO_DOMAIN_IDS</code></h4> <p>The <code><a href="../change-master-to/index#do_domain_ids">DO_DOMAIN_IDS</a></code> option for <code>CHANGE MASTER</code> can be used to configure a <a href="../replication/index">replication slave</a> to only apply <a href="binary_log">binary log</a> events if the transaction's <a href="../global-transaction-id/index">GTID</a> is in a specific <code><a href="../gtid/index#gtid_domain_id">gtid_domain_id</a></code> value. Filtered <a href="binary_log">binary log</a> events will not get logged to the slave’s <a href="../relay-log/index">relay log</a>, and they will not be applied by the slave.</p> <h4 class="anchored_heading" id="ignore_domain_ids"><code>IGNORE_DOMAIN_IDS</code></h4> <p>The <code><a href="../change-master-to/index#ignore_domain_ids">IGNORE_DOMAIN_IDS</a></code> option for <code>CHANGE MASTER</code> can be used to configure a <a href="../replication/index">replication slave</a> to ignore <a href="binary_log">binary log</a> events if the transaction's <a href="../global-transaction-id/index">GTID</a> is in a specific <code><a href="../gtid/index#gtid_domain_id">gtid_domain_id</a></code> value. Filtered <a href="binary_log">binary log</a> events will not get logged to the slave’s <a href="../relay-log/index">relay log</a>, and they will not be applied by the slave.</p> <h2 class="anchored_heading" id="replication-filters-and-binary-log-formats">Replication Filters and Binary Log Formats</h2> <p>The way that a replication filter is interpreted can depend on the <a href="../binary-log-formats/index">binary log format</a>.</p> <h3 class="anchored_heading" id="statement-based-logging">Statement-Based Logging</h3> <p>When an event is logged in its statement-based format, many replication filters that affect a database will test the filter against the default database (i.e. the one selected by the <code><a href="../use/index">USE</a></code> statement). This applies to the following replication filters:</p> <ul start="1">
<li>
<code><a href="#binlog_do_db">binlog_do_db</a></code> </li>
<li>
<code><a href="#binlog_ignore_db">binlog_ignore_db</a></code> </li>
<li>
<code><a href="#replicate_rewrite_db">replicate_rewrite_db</a></code> </li>
<li>
<code><a href="#replicate_do_db">replicate_do_db</a></code> </li>
<li>
<code><a href="#replicate_ignore_db">replicate_ignore_db</a></code> </li>
</ul> <p>When an event is logged in its statement-based format, many replication filters that affect a table will test the filter against the table in the default database (i.e. the one selected by the <code><a href="../use/index">USE</a></code> statement). This applies to the following replication filters:</p> <ul start="1">
<li>
<code><a href="#replicate_do_table">replicate_do_table</a></code> </li>
<li>
<code><a href="#replicate_ignore_table">replicate_ignore_table</a></code> </li>
</ul> <p>This means that cross-database updates <strong>not</strong> work with replication filters and statement-based binary logging. For example, if <code><a href="replicate_do_table%3ddb2.tab">replicate_do_table=db2.tab</a></code> were set, then the following would not replicate with statement-based binary logging:</p> <pre class="fixed" data-language="sql">USE db1;
INSERT INTO db2.tab VALUES (1);
</pre>
<p>If you need to be able to support cross-database updates with replication filters and statement-based binary logging, then you should use the following replication filters:</p> <ul start="1">
<li>
<code><a href="#replicate_wild_do_table">replicate_wild_do_table</a></code> </li>
<li>
<code><a href="#replicate_wild_ignore_table">replicate_wild_ignore_table</a></code> </li>
</ul> <h3 class="anchored_heading" id="row-based-logging">Row-Based Logging</h3> <p>When an event is logged in its row-based format, many replication filters that affect a database will test the filter against the database that is actually affected by the event.</p> <p>Similarly, when an event is logged in its row-based format, many replication filters that affect a table will test the filter against the table in the the database that is actually affected by the event.</p> <p>This means that cross-database updates work with replication filters and statement-based binary logging.</p> <div class="cstm-style greenbox">
<p>Keep in mind that DDL statements are always logged to the <a href="../binary-log/index">binary log</a> in statement-based format, even when the <code><a href="../replication-and-binary-log-system-variables/index#binlog_format">binlog_format</a></code> system variable is set to <code>ROW</code>. This means that the notes mentioned in <a href="#statement-based-logging">Statement-Based Logging</a> always apply to DDL.</p> </div>
<h2 class="anchored_heading" id="replication-filters-and-galera-cluster">Replication Filters and Galera Cluster</h2> <p>When using Galera cluster, replication filters should be used with caution. See <a href="../configuring-mariadb-galera-cluster/index#replication-filters">Configuring MariaDB Galera Cluster: Replication Filters</a> for more details.</p> <h2 class="anchored_heading" id="see-also">See Also</h2> <ul start="1"><li><a href="https://mariadb.org/dynamic-replication-filters-our-wheel-will-be-square/">Dynamic replication filters — our wheel will be square!</a></li></ul> </div>     </div> <div id="content_disclaimer" class="graybox"> Content reproduced on this site is the property of its respective owners, and this content is not reviewed in advance by MariaDB. The views, information and opinions expressed by this content do not necessarily represent those of MariaDB or any other party. </div> </div><div class="_attribution">
  <p class="_attribution-p">
    <a href="https://mariadb.com/kb/en/replication-filters/" class="_attribution-link" target="_blank">https://mariadb.com/kb/en/replication-filters/</a>
  </p>
</div>
