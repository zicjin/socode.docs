<h1>InnoDB Temporary Tablespaces</h1> <div> <div class="node creole"> <div class="answer formatted"> <div class="mariadb_from_10_2 mariadb from_10_2 product">
<strong class="product_title">MariaDB starting with <a href="../what-is-mariadb-102/index">10.2</a></strong><p>The use of the temporary tablespaces in InnoDB was introduced in <a href="../what-is-mariadb-102/index">MariaDB 10.2</a>. In earlier versions, temporary tablespaces exist as part of the InnoDB <a href="../innodb-system-tablespaces/index">system</a> tablespace or were file-per-table depending on the configuration of the <code><a href="../innodb-system-variables/index#innodb_file_per_table">innodb_file_per_table</a></code> system variable.</p> </div>
<p>When the user creates a temporary table using the <code><a href="../create-table/index">CREATE TEMPORARY TABLE</a></code> statement and the engine is set as InnoDB, MariaDB creates a temporary tablespace file. When the table is not compressed, MariaDB writes to a shared temporary tablespace as defined by the <code><a href="../innodb-system-variables/index#innodb_temp_data_file_path">innodb_temp_data_file_path</a></code> system variable. When compressed, the temporary table is written to a dedicated temporary tablespace for that table. MariaDB deletes temporary tablespaces when the server shuts down gracefully and is recreated when it starts again. It cannot be placed on a raw device.</p> <p>Internal temporary tablespaces, (that is, temporary tables that cannot be kept in memory) use either Aria or MyISAM, depending on the <code><a href="../aria-system-variables/index#aria_used_for_temp_tables">aria_used_for_temp_tables</a></code> system variable. You can set the default storage engine for user-created temporary tables using the <code><a href="../server-system-variables/index#default_tmp_storage_engine">default_tmp_storage_engine</a></code> system variable.</p> <h2 class="anchored_heading" id="sizing-temporary-tablespaces">Sizing Temporary Tablespaces</h2> <p>In order to size temporary tablespaces, use the <code><a href="../innodb-system-variables/index#innodb_temp_data_file_path">innodb_temp_data_file_path</a></code> system variable. This system variable can be specified as a command-line argument to <code><a href="../mysqld-options/index">mysqld</a></code> or it can be specified in a relevant server <a href="../configuring-mariadb-with-option-files/index#option-groups">option group</a> in an <a href="../configuring-mariadb-with-option-files/index">option file</a>. For example:</p> <pre class="fixed" data-language="sql">[mariadb]
...
innodb_temp_data_file_path=ibtmp1:32M:autoextend
</pre>
<p>This system variable's syntax is the same as the <code><a href="../innodb-system-variables/index#innodb_data-_file_path">innodb_data_file_path</a></code> system variable. That is, a file name, size and option. By default, it writes a 12MB autoextending file to <code>ibtmp1</code> in the data directory.</p> <p>To see the current size of the temporary tablespace from MariaDB, query the Information Schema:</p> <pre class="fixed" data-language="sql">SELECT FILE_NAME AS "File Name"
   INITIAL_SIZE AS "Initial Size",
   DATA_FREE AS "Free Space",
   TOTAL_EXTENTS * EXTENT_SIZE AS "Total Size",
   MAXIMUM_SIZE AS "Max"
FROM information_Schema.FILES
WHERE TABLESPACE_NAME = "innodb_temporary";

+-----------+--------------+------------+------------+------+
| File Name | Initial Size | Free Space | Total Size | Max  |
+-----------+--------------+------------+------------+------+
| ./ibtmp1  |     12582912 |     621456 |   12592912 | NULL |
+-----------+--------------+------------+------------+------+
</pre>
<p>To increase the size of the temporary tablespace, you can add a path to an additional tablespace file to the value of the the <code><a href="../innodb-system-variables/index#innodb_temp_data_file_path">innodb_temp_data_file_path</a></code> system variable. Providing additional paths allows you to spread the temporary tablespace between multiple tablespace files. The last file can have the <code>autoextend</code> attribute, which ensures that you won't run out of space. For example:</p> <pre class="fixed" data-language="sql">[mariadb]
...
innodb_temp_data_file_path=ibtmp1:32M;ibtmp2:32M:autoextend
</pre>
<p>Unlike normal tablespaces, temporary tablespaces are deleted when you stop MariaDB. To shrink temporary tablespaces to their minimum sizes, restart the server.</p> </div>     </div> <div id="content_disclaimer" class="graybox"> Content reproduced on this site is the property of its respective owners, and this content is not reviewed in advance by MariaDB. The views, information and opinions expressed by this content do not necessarily represent those of MariaDB or any other party. </div> </div><div class="_attribution">
  <p class="_attribution-p">
    <a href="https://mariadb.com/kb/en/innodb-temporary-tablespaces/" class="_attribution-link" target="_blank">https://mariadb.com/kb/en/innodb-temporary-tablespaces/</a>
  </p>
</div>
