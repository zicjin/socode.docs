<h1>START TRANSACTION</h1> <div> <div class="node creole"> <div class="answer formatted"> <h2 class="anchored_heading" id="syntax">Syntax</h2> <pre class="fixed" data-language="sql">START TRANSACTION [transaction_property [, transaction_property] ...] | BEGIN [WORK]
COMMIT [WORK] [AND [NO] CHAIN] [[NO] RELEASE]
ROLLBACK [WORK] [AND [NO] CHAIN] [[NO] RELEASE]
SET autocommit = {0 | 1}

transaction_property:
    WITH CONSISTENT SNAPSHOT
  | READ WRITE
  | READ ONLY
</pre> <h2 class="anchored_heading" id="description">Description</h2> <p>The <code class="highlight fixed" style="white-space:pre-wrap">START TRANSACTION</code> or <code class="highlight fixed" style="white-space:pre-wrap">BEGIN</code> statement begins a new transaction. <a href="../transactions-commit-statement/index">COMMIT</a> commits the current transaction, making its changes permanent. <a href="../rollback-statement/index">ROLLBACK</a> rolls back the current transaction, canceling its changes. The <a href="../set-variable/index">SET</a> <a href="../server-system-variables/index#autocommit">autocommit</a> statement disables or enables the default autocommit mode for the current session.</p> <p>START TRANSACTION and SET autocommit = 1 implicitly commit the current transaction, if any.</p> <p>The optional <code class="highlight fixed" style="white-space:pre-wrap">WORK</code> keyword is supported for <code class="highlight fixed" style="white-space:pre-wrap">COMMIT</code> and <code class="highlight fixed" style="white-space:pre-wrap">ROLLBACK</code>, as are the <code class="highlight fixed" style="white-space:pre-wrap">CHAIN</code> and <code class="highlight fixed" style="white-space:pre-wrap">RELEASE</code> clauses. <code class="highlight fixed" style="white-space:pre-wrap">CHAIN</code> and <code class="highlight fixed" style="white-space:pre-wrap">RELEASE</code> can be used for additional control over transaction completion. The value of the <a href="../server-system-variables/index#completion_type">completion_type</a> system variable determines the default completion behavior.</p> <p>The <code class="highlight fixed" style="white-space:pre-wrap">AND CHAIN</code> clause causes a new transaction to begin as soon as the current one ends, and the new transaction has the same isolation level as the just-terminated transaction. The <code class="highlight fixed" style="white-space:pre-wrap">RELEASE</code> clause causes the server to disconnect the current client session after terminating the current transaction. Including the <code class="highlight fixed" style="white-space:pre-wrap">NO</code> keyword suppresses <code class="highlight fixed" style="white-space:pre-wrap">CHAIN</code> or <code class="highlight fixed" style="white-space:pre-wrap">RELEASE</code> completion, which can be useful if the <a href="../server-system-variables/index#completion_type">completion_type</a> system variable is set to cause chaining or release completion by default.</p> <h3 class="anchored_heading" id="access-mode">Access Mode</h3> <div class="mariadb_from_10_0 mariadb from_10_0 product">
<strong class="product_title">MariaDB starting with <a href="../what-is-mariadb-100/index">10.0</a></strong><p>These clauses appeared in <a href="../what-is-mariadb-100/index">MariaDB 10.0</a>.</p> </div>
<p>The access mode specifies whether the transaction is allowed to write data or not. By default, transactions are in <code>READ WRITE</code> mode (see the <a href="../server-system-variables/index#tx_read_only">tx_read_only</a> system variable). <code>READ ONLY</code> mode allows the storage engine to apply optimizations that cannot be used for transactions which write data. The only exception to this rule is that read only transactions can perform DDL statements on temporary tables.</p> <p>It is not permitted to specify both <code>READ WRITE</code> and <code>READ ONLY</code> in the same statement.</p> <p><code>READ WRITE</code> and <code>READ ONLY</code> can also be specified in the <code><a href="../set-transaction/index">SET TRANSACTION</a></code> statement, in which case the specified mode is valid for all sessions, or for all subsequent transaction used by the current session.</p> <h3 class="anchored_heading" id="autocommit">autocommit</h3> <p>By default, MariaDB runs with <a href="../server-system-variables/index#autocommit">autocommit</a> mode enabled. This means that as soon as you execute a statement that updates (modifies) a table, MariaDB stores the update on disk to make it permanent. To disable autocommit mode, use the following statement:</p> <pre class="fixed" data-language="sql">SET autocommit=0;
</pre>
<p>After disabling autocommit mode by setting the autocommit variable to zero, changes to transaction-safe tables (such as those for InnoDB or <code class="highlight fixed" style="white-space:pre-wrap">NDBCLUSTER</code>) are not made permanent immediately. You must use <code class="highlight fixed" style="white-space:pre-wrap">COMMIT</code> to store your changes to disk or ROLLBACK to ignore the changes.</p> <p>To disable autocommit mode for a single series of statements, use the <code class="highlight fixed" style="white-space:pre-wrap">START TRANSACTION</code> statement.</p> <h3 class="anchored_heading" id="ddl-statements">DDL Statements</h3> <p>DDL statements (CREATE, ALTER, DROP) and administrative statements (<code>FLUSH</code>, <code>RESET</code>, <code>OPTIMIZE</code>, <code>ANALYZE</code>, <code>CHECK</code>, <code>REPAIR</code>, <code>CACHE INDEX</code>), and <code>LOAD DATA INFILE</code>, cause an implicit <code>COMMIT</code> and start a new transaction. An exception to this rule are the DDL that operate on temporary tables: you can <code>CREATE</code>, <code>ALTER</code> and <code>DROP</code> them without causing any <code>COMMIT</code>, but those actions cannot be rolled back. This means that if you call <code>ROLLBACK</code>, the temporary tables you created in the transaction will remain, while the rest of the transaction will be rolled back.</p> <p>Transactions cannot be used in Stored Functions or Triggers. In Stored Procedures and Events BEGIN is not allowed, so you should use START TRANSACTION instead.</p> <p>A transaction acquires a <a href="../metadata-locking/index">metadata lock</a> on every table it accesses to prevent other connections from altering their structure. The lock is released at the end of the transaction. This happens even with non-transactional storage engines (like <a href="../memory-storage-engine/index">MEMORY</a> or <a href="../connect/index">CONNECT</a>), so it makes sense to use transactions with non-transactional tables.</p> <h3 class="anchored_heading" id="in_transaction">in_transaction</h3> <div class="mariadb_from_5_3 mariadb from_5_3 product">
<strong class="product_title">MariaDB starting with <a href="../what-is-mariadb-53/index">5.3</a></strong><p>The <a href="../server-system-variables/index#in_transaction">in_transaction</a> system variable appeared in <a href="../what-is-mariadb-53/index">MariaDB 5.3</a>.</p> </div>
<p>It is a session-only, read-only variable that returns <code>1</code> inside a transaction, and <code>0</code> if not in a transaction.</p> <h3 class="anchored_heading" id="with-consistent-snapshot">WITH CONSISTENT SNAPSHOT</h3> <p>The <code>WITH CONSISTENT SNAPSHOT</code> option starts a consistent read for storage engines such as <a href="../innodb/index">XtraDB and InnoDB</a> that can do so, the same as if a START TRANSACTION followed by a SELECT from any InnoDB table was issued. </p> <div class="mariadb_from_5_3 mariadb from_5_3 product">
<strong class="product_title">MariaDB starting with <a href="../what-is-mariadb-53/index">5.3</a></strong><p><a href="../what-is-mariadb-53/index">MariaDB 5.3</a> introduced enhancements to this feature. See <a href="../enhancements-for-start-transaction-with-consistent-snapshot/index">Enhancements for START TRANSACTION WITH CONSISTENT SNAPSHOT</a>.</p> </div>
<h2 class="anchored_heading" id="examples">Examples</h2> <pre class="fixed" data-language="sql">START TRANSACTION;
SELECT @A:=SUM(salary) FROM table1 WHERE type=1;
UPDATE table2 SET summary=@A WHERE type=1;
COMMIT;
</pre>
<h2 class="anchored_heading" id="see-also">See Also</h2> <ul start="1">
<li>
<a href="../enhancements-for-start-transaction-with-consistent-snapshot/index">Enhancements for START TRANSACTION WITH CONSISTENT SNAPSHOT</a> </li>
<li><a href="../myrocks-and-start-transaction-with-consistent-snapshot/index">MyRocks and START TRANSACTION WITH CONSISTENT SNAPSHOT</a></li>
</ul> </div>     </div> <div id="content_disclaimer" class="graybox"> Content reproduced on this site is the property of its respective owners, and this content is not reviewed in advance by MariaDB. The views, information and opinions expressed by this content do not necessarily represent those of MariaDB or any other party. </div> </div><div class="_attribution">
  <p class="_attribution-p">
    <a href="https://mariadb.com/kb/en/start-transaction/" class="_attribution-link" target="_blank">https://mariadb.com/kb/en/start-transaction/</a>
  </p>
</div>
