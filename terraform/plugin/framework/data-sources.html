 <h1 id="data-sources">  Data Sources </h1> <p><a href="../../language/data-sources/index">Data sources</a> are an abstraction that allow Terraform to reference external data. Unlike with resources, Terraform does not manage data sources and makes no attempt to modify the API.</p> <p>Providers have data sources that tell Terraform how to request external data and how to convert the response into a format that practitioners can interpolate. To create data sources for your provider, you need to define both the data source archetype and actions on specific data source instances.</p> <h2 id="define-data-source-archetype">  Define Data Source Archetype </h2> <p>Implement the <a href="https://pkg.go.dev/github.com/hashicorp/terraform-plugin-framework/tfsdk#DataSourceType"><code>tfsdk.DataSourceType</code> interface</a> for every type of data source you want to support, such as disk images, compute instance groups, access policies, etc. It allows you to describe the data source archetype, which is the functionality related to all instances of that data source type. <code>DataSourceType</code> has the following methods.</p> <h3 id="getschema">  GetSchema </h3> <p><code>GetSchema</code> returns a <a href="schemas">schema</a> describing what fields are available in the data source's configuration and state.</p> <h3 id="newdatasource">  NewDataSource </h3> <p><code>NewDataSource</code> returns a new instance of that data source type. It needs to instantiate a new <a href="https://pkg.go.dev/github.com/hashicorp/terraform-plugin-framework/tfsdk#DataSource"><code>tfsdk.DataSource</code> implementation</a> that expects to operate on data with the structure defined in <code>GetSchema</code>.</p> <p>The <code>NewDataSource</code> method is passed a <a href="https://pkg.go.dev/github.com/hashicorp/terraform-plugin-framework/tfsdk#Provider"><code>tfsdk.Provider</code> implementation</a>. This is the <a href="providers">provider type</a> after its <code>Configure</code> method was called. The <code>NewDataSource</code> method can type-assert on this and inject it into the <code>DataSource</code>, allowing the <code>DataSource</code> to have strongly-typed access to the configured API client or other provider configuration data.</p> <p><br></p> <p><strong>Example</strong></p> <pre>type computeImageDataSourceType struct{}

func (c computeImageDataSourceType) GetSchema(_ context.Context) (schema.Schema,
    []*tfprotov6.Diagnostic) {
    return schema.Schema{
        Attributes: map[string]tfsdk.Attribute{
            "name": {
                Type: types.StringType,
                Required: true,
            },
        },
    }, nil
}

func (c computeImageDataSourceType) NewDataSource(_ context.Context,
    p tfsdk.Provider) (tfsdk.DataSource, []*tfprotov6.Diagnostic) {
    return computeImageDataSource{
        client: p.(*provider).client,
    }, nil
}
</pre>
<h2 id="define-data-source">  Define Data Source </h2> <p>Data sources are scoped to a single instance of the data source type. They modify that specific data source in the state, given that data source's config values. They do this through their <code>Read</code> method.</p> <h3 id="read">  Read </h3> <p><code>Read</code> updates Terraform's state to reflect the API data described in the configuration. There is no plan or state to work with in <code>Read</code>. Data sources should <a href="accessing-values">retrieve the data they need</a> from the configuration included in the <a href="https://pkg.go.dev/github.com/hashicorp/terraform-plugin-framework/tfsdk#ReadDataSourceRequest"><code>tfsdk.ReadDataSourceRequest</code></a>. They can then use the configured API client injected into the data source by the data source type's <code>NewDataSource</code> method, and <a href="writing-state">write the results to the state</a>.</p> <p>Terraform does not manage data sources, so there is no plan to follow and the provider can set any value in state. "Drift" describes instances when the API's state has deviated from the source of truth defined in the configuration file. Drift doesn't apply to data sources because Terraform is not the source of truth for these values.</p> <h2 id="add-data-source-to-provider">  Add Data Source to Provider </h2> <p>To make new data sources available to practitioners, add them to the <code>GetDataSources</code> method on the <a href="providers">provider</a>. The key must be the name of the data source, including the provider prefix, and the value must be an instance of the data source type.</p> <p><strong>Example</strong></p> <pre>func (p *provider) GetDataSources(_ context.Context) (map[string]tfsdk.DataSourceType,
    []*tfprotov6.Diagnostic) {
    return map[string]tfsdk.DataSourceType{
        "example_compute_image": computeImageDataSourceType{},
    }, nil
}
</pre><div class="_attribution">
  <p class="_attribution-p">
    <a href="https://www.terraform.io/docs/plugin/framework/data-sources.html" class="_attribution-link" target="_blank">https://www.terraform.io/docs/plugin/framework/data-sources.html</a>
  </p>
</div>
