 <h1 id="puppet-provisioner">  Puppet Provisioner </h1> <p>The <code>puppet</code> provisioner installs, configures and runs the Puppet agent on a remote resource. The <code>puppet</code> provisioner supports both <code>ssh</code> and <code>winrm</code> type <a href="connection">connections</a>.</p> <blockquote class="alert alert-danger" role="alert"> <p><strong>Note:</strong> This provisioner was removed in the 0.15.0 version of Terraform after being deprecated as of Terraform 0.13.4. For most common situations there are better alternatives to using provisioners. For more information, see <a href="index">the main Provisioners page</a>.</p> </blockquote> <h2 id="requirements">  Requirements </h2> <p>The <code>puppet</code> provisioner has some prerequisites for specific connection types:</p> <ul> <li>For <code>ssh</code> type connections, <code>cURL</code> must be available on the remote host. </li> <li>For <code>winrm</code> connections, <code>PowerShell 2.0</code> must be available on the remote host. </li> </ul> <p>Without these prerequisites, your provisioning execution will fail.</p> <p>Additionally, the <code>puppet</code> provisioner requires <a href="https://puppet.com/docs/bolt/latest/bolt.html">Bolt</a> to be installed on your workstation with the following <a href="https://puppet.com/docs/bolt/latest/bolt_installing_modules.html#install-modules">modules installed</a></p> <ul> <li>
<a href="#danieldreier-autosign"><code>danieldreier/autosign</code></a> </li> <li>
<a href="#puppetlabs-puppet_agent"><code>puppetlabs/puppet_agent</code></a> </li> </ul> <h2 id="example-usage">  Example usage </h2> <pre data-language="ruby">resource "aws_instance" "web" {
  # ...

  provisioner "puppet" {
    server             = aws_instance.puppetmaster.public_dns
    server_user        = "ubuntu"
    extension_requests = {
      pp_role = "webserver"
    }
  }
}
</pre>
<h2 id="argument-reference">  Argument Reference </h2> <p>The following arguments are supported:</p> <ul> <li>
<p><a href="#server-string-"><code>server (string)</code></a> - (Required) The FQDN of the Puppet master that the agent is to connect to.</p> </li> <li>
<p><a href="#server_user-string-"><code>server_user (string)</code></a> - (Optional) The user that Bolt should connect to the server as (defaults to <code>root</code>).</p> </li> <li>
<p><a href="#os_type-string-"><code>os_type (string)</code></a> - (Optional) The OS type of the resource. Valid options are: <code>linux</code> and <code>windows</code>. If not supplied, the connection type will be used to determine the OS type (<code>ssh</code> will assume <code>linux</code> and <code>winrm</code> will assume <code>windows</code>).</p> </li> <li>
<p><a href="#use_sudo-boolean-"><code>use_sudo (boolean)</code></a> - (Optional) If <code>true</code>, commands run on the resource will have their privileges elevated with sudo (defaults to <code>true</code> when the OS type is <code>linux</code> and <code>false</code> when the OS type is <code>windows</code>).</p> </li> <li>
<p><a href="#autosign-boolean-"><code>autosign (boolean)</code></a> - (Optional) Set to <code>true</code> if the Puppet master is using an autosigner such as <a href="https://danieldreier.github.io/autosign">Daniel Dreier's policy-based autosigning tool</a>. If <code>false</code> new agent certificate requests will have to be signed manually (defaults to <code>true</code>).</p> </li> <li>
<p><a href="#open_source-boolean-"><code>open_source (boolean)</code></a> - (Optional) If <code>true</code> the provisioner uses an open source Puppet compatible agent install method (push via the Bolt agent install task). If <code>false</code> the simplified Puppet Enterprise installer will pull the agent from the Puppet master (defaults to <code>true</code>).</p> </li> <li>
<p><a href="#certname-string-"><code>certname (string)</code></a> - (Optional) The Subject CN used when requesting a certificate from the Puppet master CA (defaults to the FQDN of the resource).</p> </li> <li>
<p><a href="#extension_requests-map-"><code>extension_requests (map)</code></a> - (Optional) A map of <a href="https://puppet.com/docs/puppet/latest/ssl_attributes_extensions.html#concept-932">extension requests</a> to be embedded in the certificate signing request before it is sent to the Puppet master CA and then transferred to the final certificate when the CSR is signed. These become available during Puppet agent runs as <a href="https://puppet.com/docs/puppet/latest/lang_facts_and_builtin_vars.html#trusted-facts">trusted facts</a>. Friendly names for common extensions such as pp_role and pp_environment have <a href="https://puppet.com/docs/puppet/latest/ssl_attributes_extensions.html#recommended-oids-for-extensions">been predefined</a>.</p> </li> <li>
<p><a href="#custom_attributes-map-"><code>custom_attributes (map)</code></a> - (Optional) A map of <a href="https://puppet.com/docs/puppet/latest/ssl_attributes_extensions.html#concept-5488">custom attributes</a> to be embedded in the certificate signing request before it is sent to the Puppet master CA.</p> </li> <li>
<p><a href="#environment-string-"><code>environment (string)</code></a> - (Optional) The name of the Puppet environment that the Puppet agent will be running in (defaults to <code>production</code>).</p> </li> <li>
<p><a href="#bolt_timeout-string-"><code>bolt_timeout (string)</code></a> - (Optional) The timeout to wait for Bolt tasks to complete. This should be specified as a string like <code>30s</code> or <code>5m</code> (defaults to <code>5m</code> - 5 minutes).</p> </li> </ul><div class="_attribution">
  <p class="_attribution-p">
    <a href="https://www.terraform.io/docs/language/resources/provisioners/puppet.html" class="_attribution-link" target="_blank">https://www.terraform.io/docs/language/resources/provisioners/puppet.html</a>
  </p>
</div>
