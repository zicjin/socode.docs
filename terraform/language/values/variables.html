 <h1 id="input-variables">  Input Variables </h1> <blockquote> <p><strong>Hands-on:</strong> Try the <a href="https://learn.hashicorp.com/tutorials/terraform/variables?in=terraform/configuration-language&amp;utm_source=WEBSITE&amp;utm_medium=WEB_IO&amp;utm_offer=ARTICLE_PAGE&amp;utm_content=DOCS">Customize Terraform Configuration with Variables</a> tutorial on HashiCorp Learn.</p> </blockquote> <p>Input variables serve as parameters for a Terraform module, allowing aspects of the module to be customized without altering the module's own source code, and allowing modules to be shared between different configurations.</p> <p>When you declare variables in the root module of your configuration, you can set their values using CLI options and environment variables. When you declare them in <a href="../modules/index">child modules</a>, the calling module should pass values in the <code>module</code> block.</p> <p>If you're familiar with traditional programming languages, it can be useful to compare Terraform modules to function definitions:</p> <ul> <li>Input variables are like function arguments. </li> <li>
<a href="outputs">Output values</a> are like function return values. </li> <li>
<a href="locals">Local values</a> are like a function's temporary local variables. </li> </ul> <blockquote class="alert alert-info" role="alert"> <p><strong>Note:</strong> For brevity, input variables are often referred to as just "variables" or "Terraform variables" when it is clear from context what sort of variable is being discussed. Other kinds of variables in Terraform include <em>environment variables</em> (set by the shell where Terraform runs) and <em>expression variables</em> (used to indirectly represent a value in an <a href="../expressions/index">expression</a>).</p> </blockquote> <h2 id="declaring-an-input-variable">  Declaring an Input Variable </h2> <p>Each input variable accepted by a module must be declared using a <code>variable</code> block:</p> <pre data-language="ruby">variable "image_id" {
  type = string
}

variable "availability_zone_names" {
  type    = list(string)
  default = ["us-west-1a"]
}

variable "docker_ports" {
  type = list(object({
    internal = number
    external = number
    protocol = string
  }))
  default = [
    {
      internal = 8300
      external = 8300
      protocol = "tcp"
    }
  ]
}
</pre>
<p>The label after the <code>variable</code> keyword is a name for the variable, which must be unique among all variables in the same module. This name is used to assign a value to the variable from outside and to reference the variable's value from within the module.</p> <p>The name of a variable can be any valid <a href="../syntax/configuration#identifiers">identifier</a> <em>except</em> the following: <code>source</code>, <code>version</code>, <code>providers</code>, <code>count</code>, <code>for_each</code>, <code>lifecycle</code>, <code>depends_on</code>, <code>locals</code>.</p> <p>These names are reserved for meta-arguments in <a href="../modules/syntax">module configuration blocks</a>, and cannot be declared as variable names.</p> <h2 id="arguments">  Arguments </h2> <p>Terraform CLI defines the following optional arguments for variable declarations:</p> <ul> <li>
<a href="#default-values"><code>default</code></a> - A default value which then makes the variable optional. </li> <li>
<a href="#type-constraints"><code>type</code></a> - This argument specifies what value types are accepted for the variable. </li> <li>
<a href="#input-variable-documentation"><code>description</code></a> - This specifies the input variable's documentation. </li> <li>
<a href="#custom-validation-rules"><code>validation</code></a> - A block to define validation rules, usually in addition to type constraints. </li> <li>
<a href="#suppressing-values-in-cli-output"><code>sensitive</code></a> - Limits Terraform UI output when the variable is used in configuration. </li> </ul> <h3 id="default-values">  Default values </h3> <p>The variable declaration can also include a <code>default</code> argument. If present, the variable is considered to be <em>optional</em> and the default value will be used if no value is set when calling the module or running Terraform. The <code>default</code> argument requires a literal value and cannot reference other objects in the configuration.</p> <h3 id="type-constraints">  Type Constraints </h3> <p>The <code>type</code> argument in a <code>variable</code> block allows you to restrict the <a href="../expressions/types">type of value</a> that will be accepted as the value for a variable. If no type constraint is set then a value of any type is accepted.</p> <p>While type constraints are optional, we recommend specifying them; they can serve as helpful reminders for users of the module, and they allow Terraform to return a helpful error message if the wrong type is used.</p> <p>Type constraints are created from a mixture of type keywords and type constructors. The supported type keywords are:</p> <ul> <li>
<a href="#string"><code>string</code></a> </li> <li>
<a href="#number"><code>number</code></a> </li> <li>
<a href="#bool"><code>bool</code></a> </li> </ul> <p>The type constructors allow you to specify complex types such as collections:</p> <ul> <li>
<a href="#list-lt-type-gt-"><code>list(&lt;TYPE&gt;)</code></a> </li> <li>
<a href="#set-lt-type-gt-"><code>set(&lt;TYPE&gt;)</code></a> </li> <li>
<a href="#map-lt-type-gt-"><code>map(&lt;TYPE&gt;)</code></a> </li> <li>
<a href="#object-lt-attr-name-gt-lt-type-gt-"><code>object({&lt;ATTR NAME&gt; = &lt;TYPE&gt;, ... })</code></a> </li> <li>
<a href="#tuple-lt-type-gt-"><code>tuple([&lt;TYPE&gt;, ...])</code></a> </li> </ul> <p>The keyword <code>any</code> may be used to indicate that any type is acceptable. For more information on the meaning and behavior of these different types, as well as detailed information about automatic conversion of complex types, see <a href="../expressions/types">Type Constraints</a>.</p> <p>If both the <code>type</code> and <code>default</code> arguments are specified, the given default value must be convertible to the specified type.</p> <h3 id="input-variable-documentation">  Input Variable Documentation </h3> <p>Because the input variables of a module are part of its user interface, you can briefly describe the purpose of each variable using the optional <code>description</code> argument:</p> <pre data-language="ruby">variable "image_id" {
  type        = string
  description = "The id of the machine image (AMI) to use for the server."
}
</pre>
<p>The description should concisely explain the purpose of the variable and what kind of value is expected. This description string might be included in documentation about the module, and so it should be written from the perspective of the user of the module rather than its maintainer. For commentary for module maintainers, use comments.</p> <h3 id="custom-validation-rules">  Custom Validation Rules </h3> <blockquote class="alert alert-info" role="alert"> <p>This feature was introduced in Terraform CLI v0.13.0.</p> </blockquote> <p>In addition to Type Constraints as described above, a module author can specify arbitrary custom validation rules for a particular variable using a <code>validation</code> block nested within the corresponding <code>variable</code> block:</p> <pre data-language="ruby">variable "image_id" {
  type        = string
  description = "The id of the machine image (AMI) to use for the server."

  validation {
    condition     = length(var.image_id) &gt; 4 &amp;&amp; substr(var.image_id, 0, 4) == "ami-"
    error_message = "The image_id value must be a valid AMI id, starting with \"ami-\"."
  }
}
</pre>
<p>The <code>condition</code> argument is an expression that must use the value of the variable to return <code>true</code> if the value is valid, or <code>false</code> if it is invalid. The expression can refer only to the variable that the condition applies to, and <em>must not</em> produce errors.</p> <p>If the failure of an expression is the basis of the validation decision, use <a href="../functions/can">the <code>can</code> function</a> to detect such errors. For example:</p> <pre data-language="ruby">variable "image_id" {
  type        = string
  description = "The id of the machine image (AMI) to use for the server."

  validation {
    # regex(...) fails if it cannot find a match
    condition     = can(regex("^ami-", var.image_id))
    error_message = "The image_id value must be a valid AMI id, starting with \"ami-\"."
  }
}
</pre>
<p>If <code>condition</code> evaluates to <code>false</code>, Terraform will produce an error message that includes the sentences given in <code>error_message</code>. The error message string should be at least one full sentence explaining the constraint that failed, using a sentence structure similar to the above examples.</p> <h3 id="suppressing-values-in-cli-output">  Suppressing Values in CLI Output </h3> <blockquote class="alert alert-info" role="alert"> <p>This feature was introduced in Terraform v0.14.0.</p> </blockquote> <blockquote> <p><strong>Hands-on:</strong> Try the <a href="https://learn.hashicorp.com/tutorials/terraform/sensitive-variables?in=terraform/configuration-language&amp;utm_source=WEBSITE&amp;utm_medium=WEB_IO&amp;utm_offer=ARTICLE_PAGE&amp;utm_content=DOCS">Protect Sensitive Input Variables</a> tutorial on HashiCorp Learn.</p> </blockquote> <p>Setting a variable as <code>sensitive</code> prevents Terraform from showing its value in the <code>plan</code> or <code>apply</code> output, when you use that variable elsewhere in your configuration.</p> <p>Terraform will still record sensitive values in the <a href="../state/index">state</a>, and so anyone who can access the state data will have access to the sensitive values in cleartext. For more information, see <a href="../state/sensitive-data"><em>Sensitive Data in State</em></a>.</p> <p>Declare a variable as sensitive by setting the <code>sensitive</code> argument to <code>true</code>:</p> <pre>variable "user_information" {
  type = object({
    name    = string
    address = string
  })
  sensitive = true
}

resource "some_resource" "a" {
  name    = var.user_information.name
  address = var.user_information.address
}
</pre>
<p>Any expressions whose result depends on the sensitive variable will be treated as sensitive themselves, and so in the above example the two arguments of <code>resource "some_resource" "a"</code> will also be hidden in the plan output:</p> <pre>Terraform will perform the following actions:

  # some_resource.a will be created
  + resource "some_resource" "a" {
      + name    = (sensitive)
      + address = (sensitive)
    }

Plan: 1 to add, 0 to change, 0 to destroy.
</pre>
<p>In some cases where you use a sensitive variable inside a nested block, Terraform may treat the entire block as redacted. This happens for resource types where all of the blocks of a particular type are required to be unique, and so disclosing the content of one block might imply the content of a sibling block.</p> <pre>  # some_resource.a will be updated in-place
  ~ resource "some_resource" "a" {
      ~ nested_block {
          # At least one attribute in this block is (or was) sensitive,
          # so its contents will not be displayed.
        }
    }
</pre>
<p>A provider can also <a href="../../extend/best-practices/sensitive-state#using-the-sensitive-flag">declare an attribute as sensitive</a>, which will cause Terraform to hide it from regular output regardless of how you assign it a value. For more information, see <a href="../expressions/references#sensitive-resource-attributes">Sensitive Resource Attributes</a>.</p> <p>If you use a sensitive value from as part of an <a href="outputs">output value</a> then Terraform will require you to also mark the output value itself as sensitive, to confirm that you intended to export it.</p> <h4 id="cases-where-terraform-may-disclose-a-sensitive-variable">  Cases where Terraform may disclose a sensitive variable </h4> <p>A <code>sensitive</code> variable is a configuration-centered concept, and values are sent to providers without any obfuscation. A provider error could disclose a value if that value is included in the error message. For example, a provider might return the following error even if "foo" is a sensitive value: <code>"Invalid value 'foo' for field"</code></p> <p>If a resource attribute is used as, or part of, the provider-defined resource id, an <code>apply</code> will disclose the value. In the example below, the <code>prefix</code> attribute has been set to a sensitive variable, but then that value ("jae") is later disclosed as part of the resource id:</p> <pre>  # random_pet.animal will be created
  + resource "random_pet" "animal" {
      + id        = (known after apply)
      + length    = 2
      + prefix    = (sensitive)
      + separator = "-"
    }

Plan: 1 to add, 0 to change, 0 to destroy.

...

random_pet.animal: Creating...
random_pet.animal: Creation complete after 0s [id=jae-known-mongoose]
</pre>
<h2 id="using-input-variable-values">  Using Input Variable Values </h2> <p>Within the module that declared a variable, its value can be accessed from within <a href="../expressions/index">expressions</a> as <code>var.&lt;NAME&gt;</code>, where <code>&lt;NAME&gt;</code> matches the label given in the declaration block:</p> <blockquote class="alert alert-info" role="alert"> <p><strong>Note:</strong> Input variables are <em>created</em> by a <code>variable</code> block, but you <em>reference</em> them as attributes on an object named <code>var</code>.</p> </blockquote> <pre data-language="ruby">resource "aws_instance" "example" {
  instance_type = "t2.micro"
  ami           = var.image_id
}
</pre>
<p>The value assigned to a variable can only be accessed in expressions within the module where it was declared.</p> <h2 id="assigning-values-to-root-module-variables">  Assigning Values to Root Module Variables </h2> <p>When variables are declared in the root module of your configuration, they can be set in a number of ways:</p> <ul> <li>
<a href="../../cloud/workspaces/variables">In a Terraform Cloud workspace</a>. </li> <li>Individually, with the <code>-var</code> command line option. </li> <li>In variable definitions (<code>.tfvars</code>) files, either specified on the command line or automatically loaded. </li> <li>As environment variables. </li> </ul> <p>The following sections describe these options in more detail. This section does not apply to <em>child</em> modules, where values for input variables are instead assigned in the configuration of their parent module, as described in <a href="../modules/index"><em>Modules</em></a>.</p> <h3 id="variables-on-the-command-line">  Variables on the Command Line </h3> <p>To specify individual variables on the command line, use the <code>-var</code> option when running the <code>terraform plan</code> and <code>terraform apply</code> commands:</p> <pre>terraform apply -var="image_id=ami-abc123"
terraform apply -var='image_id_list=["ami-abc123","ami-def456"]' -var="instance_type=t2.micro"
terraform apply -var='image_id_map={"us-east-1":"ami-abc123","us-east-2":"ami-def456"}'
</pre>
<p>The above examples show appropriate syntax for Unix-style shells, such as on Linux or macOS. For more information on shell quoting, including additional examples for Windows Command Prompt, see <a href="../../cli/commands/plan#input-variables-on-the-command-line">Input Variables on the Command Line</a>.</p> <p>You can use the <code>-var</code> option multiple times in a single command to set several different variables.</p>  <h3 id="variable-definitions-tfvars-files">  Variable Definitions (<code>.tfvars</code>) Files </h3> <p>To set lots of variables, it is more convenient to specify their values in a <em>variable definitions file</em> (with a filename ending in either <code>.tfvars</code> or <code>.tfvars.json</code>) and then specify that file on the command line with <code>-var-file</code>:</p> <pre>terraform apply -var-file="testing.tfvars"
</pre>
<blockquote class="alert alert-info" role="alert"> <p><strong>Note:</strong> This is how Terraform Cloud passes <a href="../../cloud/workspaces/variables">workspace variables</a> to Terraform.</p> </blockquote> <p>A variable definitions file uses the same basic syntax as Terraform language files, but consists only of variable name assignments:</p> <pre data-language="ruby">image_id = "ami-abc123"
availability_zone_names = [
  "us-east-1a",
  "us-west-1c",
]
</pre>
<p>Terraform also automatically loads a number of variable definitions files if they are present:</p> <ul> <li>Files named exactly <code>terraform.tfvars</code> or <code>terraform.tfvars.json</code>. </li> <li>Any files with names ending in <code>.auto.tfvars</code> or <code>.auto.tfvars.json</code>. </li> </ul> <p>Files whose names end with <code>.json</code> are parsed instead as JSON objects, with the root object properties corresponding to variable names:</p> <pre data-language="json">{
  "image_id": "ami-abc123",
  "availability_zone_names": ["us-west-1a", "us-west-1c"]
}
</pre>
<h3 id="environment-variables">  Environment Variables </h3> <p>As a fallback for the other ways of defining variables, Terraform searches the environment of its own process for environment variables named <code>TF_VAR_</code> followed by the name of a declared variable.</p> <p>This can be useful when running Terraform in automation, or when running a sequence of Terraform commands in succession with the same variables. For example, at a <code>bash</code> prompt on a Unix system:</p> <pre>$ export TF_VAR_image_id=ami-abc123
$ terraform plan
...
</pre>
<p>On operating systems where environment variable names are case-sensitive, Terraform matches the variable name exactly as given in configuration, and so the required environment variable name will usually have a mix of upper and lower case letters as in the above example.</p> <h3 id="complex-typed-values">  Complex-typed Values </h3> <p>When variable values are provided in a variable definitions file, you can use Terraform's usual syntax for <a href="../expressions/types#literal-expressions">literal expressions</a> to assign complex-typed values, like lists and maps.</p> <p>Some special rules apply to the <code>-var</code> command line option and to environment variables. For convenience, Terraform defaults to interpreting <code>-var</code> and environment variable values as literal strings, which need only shell quoting, and no special quoting for Terraform. For example, in a Unix-style shell:</p> <pre>$ export TF_VAR_image_id='ami-abc123'
</pre>
<p>However, if a root module variable uses a <a href="#type-constraints">type constraint</a> to require a complex value (list, set, map, object, or tuple), Terraform will instead attempt to parse its value using the same syntax used within variable definitions files, which requires careful attention to the string escaping rules in your shell:</p> <pre>$ export TF_VAR_availability_zone_names='["us-west-1b","us-west-1d"]'
</pre>
<p>For readability, and to avoid the need to worry about shell escaping, we recommend always setting complex variable values via variable definitions files. For more information on quoting and escaping for <code>-var</code> arguments, see <a href="../../cli/commands/plan#input-variables-on-the-command-line">Input Variables on the Command Line</a>.</p> <h3 id="values-for-undeclared-variables">  Values for Undeclared Variables </h3> <p>If you have defined a variable value, but not its corresponding <code>variable {}</code> definition, you may get an error or warning depending on how you have provided that value.</p> <p>If you provide values for undeclared variables defined as <a href="#environment-variables">environment variables</a> you will not get an error or warning. This is because environment variables may be declared but not used in all configurations that might be run.</p> <p>If you provide values for undeclared variables defined <a href="#variable-definitions-tfvars-files">in a file</a> you will get a warning. This is to help in cases where you have provided a variable value <em>meant</em> for a variable declaration, but perhaps there is a mistake in the value definition. For example, the following configuration:</p> <pre data-language="ruby">variable "moose" {
  type = string
}
</pre>
<p>And the following <code>.tfvars</code> file:</p> <pre data-language="ruby">mosse = "Moose"
</pre>
<p>Will cause Terraform to warn you that there is no variable declared <code>"mosse"</code>, which can help you spot this mistake.</p> <p>If you use <code>.tfvars</code> files across multiple configurations and expect to continue to see this warning, you can use the <a href="../../cli/commands/plan#compact-warnings"><code>-compact-warnings</code></a> option to simplify your output.</p> <p>If you provide values for undeclared variables on the <a href="#variables-on-the-command-line">command line</a>, Terraform will error. To avoid this error, either declare a variable block for the value, or remove the variable value from your Terraform call.</p> <h3 id="variable-definition-precedence">  Variable Definition Precedence </h3> <p>The above mechanisms for setting variables can be used together in any combination. If the same variable is assigned multiple values, Terraform uses the <em>last</em> value it finds, overriding any previous values. Note that the same variable cannot be assigned multiple values within a single source.</p> <p>Terraform loads variables in the following order, with later sources taking precedence over earlier ones:</p> <ul> <li>Environment variables </li> <li>The <code>terraform.tfvars</code> file, if present. </li> <li>The <code>terraform.tfvars.json</code> file, if present. </li> <li>Any <code>*.auto.tfvars</code> or <code>*.auto.tfvars.json</code> files, processed in lexical order of their filenames. </li> <li>Any <code>-var</code> and <code>-var-file</code> options on the command line, in the order they are provided. (This includes variables set by a Terraform Cloud workspace.) </li> </ul> <blockquote class="alert alert-warning" role="alert"> <p><strong>Important:</strong> In Terraform 0.12 and later, variables with map and object values behave the same way as other variables: the last value found overrides the previous values. This is a change from previous versions of Terraform, which would <em>merge</em> map values instead of overriding them.</p> </blockquote><div class="_attribution">
  <p class="_attribution-p">
    <a href="https://www.terraform.io/docs/language/values/variables.html" class="_attribution-link" target="_blank">https://www.terraform.io/docs/language/values/variables.html</a>
  </p>
</div>
