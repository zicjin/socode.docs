 <h1 id="the-terraform_remote_state-data-source">  The <code>terraform_remote_state</code> Data Source </h1> <p>The <code>terraform_remote_state</code> data source retrieves the root module output values from some other Terraform configuration, using the latest state snapshot from the remote backend.</p> <p>This data source is built into Terraform, and is always available; you do not need to require or configure a provider in order to use it.</p> <blockquote class="alert alert-info" role="alert"> <p><strong>Note:</strong> This data source is implemented by a built-in provider, whose <a href="../providers/requirements#source-addresses">source address</a> is <code>terraform.io/builtin/terraform</code>. That provider does not include any other resources or data sources.</p> </blockquote> <h2 id="alternative-ways-to-share-data-between-configurations">  Alternative Ways to Share Data Between Configurations </h2> <p>Sharing data with root module outputs is convenient, but it has drawbacks. Although <code>terraform_remote_state</code> only exposes output values, its user must have access to the entire state snapshot, which often includes some sensitive information.</p> <p>When possible, we recommend explicitly publishing data for external consumption to a separate location instead of accessing it via remote state. This lets you apply different access controls for shared information and state snapshots.</p> <p>To share data explicitly between configurations, you can use pairs of managed resource types and data sources in various providers, including (but not limited to) the following:</p> <table>
<thead> <tr> <th>System</th> <th>Publish with...</th> <th>Read with...</th> </tr> </thead>
<tbody> <tr> <td>Alibaba Cloud DNS<br><small>(for IP addresses and hostnames)</small>
</td> <td><a href="https://registry.terraform.io/providers/aliyun/alicloud/latest/docs/resources/alidns_record"><code>alicloud_alidns_record</code> resource type</a></td> <td>Normal DNS lookups, or <a href="https://registry.terraform.io/providers/hashicorp/dns/latest/docs">the <code>dns</code> provider</a>
</td> </tr> <tr> <td>Amazon Route53<br><small>(for IP addresses and hostnames)</small>
</td> <td><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/route53_record"><code>aws_route53_record</code> resource type</a></td> <td>Normal DNS lookups, or <a href="https://registry.terraform.io/providers/hashicorp/dns/latest/docs">the <code>dns</code> provider</a>
</td> </tr> <tr> <td>Amazon S3</td> <td><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_object"><code>aws_s3_bucket_object</code> resource type</a></td> <td><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/data-sources/s3_bucket_object"><code>aws_s3_bucket_object</code> data source</a></td> </tr> <tr> <td>Amazon SSM Parameter Store</td> <td><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ssm_parameter"><code>aws_ssm_parameter</code> resource type</a></td> <td><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/data-sources/ssm_parameter"><code>aws_ssm_parameter</code> data source</a></td> </tr> <tr> <td>Azure Automation</td> <td><a href="https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/automation_variable_string"><code>azurerm_automation_variable_string</code> resource type</a></td> <td><a href="https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/data-sources/automation_variable_string"><code>azurerm_automation_variable_string</code> data source</a></td> </tr> <tr> <td>Azure DNS<br><small>(for IP addresses and hostnames)</small>
</td> <td>
<a href="https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/dns_a_record"><code>azurerm_dns_a_record</code> resource type</a>, etc</td> <td>Normal DNS lookups, or <a href="https://registry.terraform.io/providers/hashicorp/dns/latest/docs">the <code>dns</code> provider</a>
</td> </tr> <tr> <td>Google Cloud DNS<br><small>(for IP addresses and hostnames)</small>
</td> <td><a href="https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/dns_record_set"><code>google_dns_record_set</code> resource type</a></td> <td>Normal DNS lookups, or <a href="https://registry.terraform.io/providers/hashicorp/dns/latest/docs">the <code>dns</code> provider</a>
</td> </tr> <tr> <td>Google Cloud Storage</td> <td><a href="https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/storage_bucket_object"><code>google_storage_bucket_object</code> resource type</a></td> <td>
<a href="https://registry.terraform.io/providers/hashicorp/google/latest/docs/data-sources/storage_bucket_object"><code>google_storage_bucket_object</code> data source</a> and <a href="https://registry.terraform.io/providers/hashicorp/http/latest/docs/data-sources/http"><code>http</code> data source</a>
</td> </tr> <tr> <td>HashiCorp Consul</td> <td><a href="https://registry.terraform.io/providers/hashicorp/consul/latest/docs/resources/key_prefix"><code>consul_key_prefix</code> resource type</a></td> <td><a href="https://registry.terraform.io/providers/hashicorp/consul/latest/docs/data-sources/key_prefix"><code>consul_key_prefix</code> data source</a></td> </tr> <tr> <td>Kubernetes</td> <td><a href="https://registry.terraform.io/providers/hashicorp/kubernetes/latest/docs/resources/config_map"><code>kubernetes_config_map</code> resource type</a></td> <td><a href="https://registry.terraform.io/providers/hashicorp/kubernetes/latest/docs/data-sources/config_map"><code>kubernetes_config_map</code> data source</a></td> </tr> <tr> <td>OCI Object Storage</td> <td><a href="https://registry.terraform.io/providers/hashicorp/oci/latest/docs/resources/objectstorage_object"><code>oci_objectstorage_bucket</code> resource type</a></td> <td><a href="https://registry.terraform.io/providers/hashicorp/oci/latest/docs/data-sources/objectstorage_object"><code>oci_objectstorage_bucket</code> data source</a></td> </tr> </tbody>
</table> <blockquote class="alert alert-info" role="alert"> <p>These are some common options from the Official Terraform providers, but there are too many configuration storage options for us to list them all here, including some in partner and community providers. Any pair of managed resource type and corresponding data source can potentially be used to share data between Terraform configurations. See individual provider documentation to find other possibilities.</p> </blockquote> <p>A key advantage of using a separate explicit configuration store instead of <code>terraform_remote_state</code> is that the data can potentially also be read by systems other than Terraform, such as configuration management or scheduler systems within your compute instances. For that reason, we recommend selecting a configuration store that your other infrastructure could potentially make use of. For example:</p> <ul> <li>If you wish to share IP addresses and hostnames, you could publish them as normal DNS <code>A</code>, <code>AAAA</code>, <code>CNAME</code>, and <code>SRV</code> records in a private DNS zone and then configure your other infrastructure to refer to that zone so you can find infrastructure objects via your system's built-in DNS resolver. </li> <li>If you use HashiCorp Consul then publishing data to the Consul key/value store or Consul service catalog can make that data also accessible via <a href="https://github.com/hashicorp/consul-template">Consul Template</a> or the <a href="https://www.nomadproject.io/docs/job-specification/template">HashiCorp Nomad</a> <code>template</code> stanza. </li> <li>If you use Kubernetes then you can <a href="https://kubernetes.io/docs/tasks/configure-pod-container/configure-pod-configmap/">make Config Maps available to your Pods</a>. </li> </ul> <p>Some of the data stores listed above are specifically designed for storing small configuration values, while others are generic blob storage systems. For those generic systems, you can use <a href="../functions/jsonencode">the <code>jsonencode</code> function</a> and <a href="../functions/jsondecode">the <code>jsondecode</code> function</a> respectively to store and retrieve structured data.</p> <p>You can encapsulate the implementation details of retrieving your published configuration data by writing a <a href="../modules/develop/composition#data-only-modules">data-only module</a> containing the necessary data source configuration and any necessary post-processing such as JSON decoding. You can then change that module later if you switch to a different strategy for sharing data between multiple Terraform configurations.</p> <h2 id="example-usage-remote-backend-">  Example Usage (<code>remote</code> Backend) </h2> <pre data-language="ruby">data "terraform_remote_state" "vpc" {
  backend = "remote"

  config = {
    organization = "hashicorp"
    workspaces = {
      name = "vpc-prod"
    }
  }
}

# Terraform &gt;= 0.12
resource "aws_instance" "foo" {
  # ...
  subnet_id = data.terraform_remote_state.vpc.outputs.subnet_id
}

# Terraform &lt;= 0.11
resource "aws_instance" "foo" {
  # ...
  subnet_id = "${data.terraform_remote_state.vpc.subnet_id}"
}
</pre>
<h2 id="example-usage-local-backend-">  Example Usage (<code>local</code> Backend) </h2> <pre data-language="ruby">data "terraform_remote_state" "vpc" {
  backend = "local"

  config = {
    path = "..."
  }
}

# Terraform &gt;= 0.12
resource "aws_instance" "foo" {
  # ...
  subnet_id = data.terraform_remote_state.vpc.outputs.subnet_id
}

# Terraform &lt;= 0.11
resource "aws_instance" "foo" {
  # ...
  subnet_id = "${data.terraform_remote_state.vpc.subnet_id}"
}
</pre>
<h2 id="argument-reference">  Argument Reference </h2> <p>The following arguments are supported:</p> <ul> <li>
<a href="#backend"><code>backend</code></a> - (Required) The remote backend to use. </li> <li>
<a href="#workspace"><code>workspace</code></a> - (Optional) The Terraform workspace to use, if the backend supports workspaces. </li> <li>
<p><a href="#config"><code>config</code></a> - (Optional; object) The configuration of the remote backend. Although this argument is listed as optional, most backends require some configuration.</p> <p>The <code>config</code> object can use any arguments that would be valid in the equivalent <code>terraform { backend "&lt;TYPE&gt;" { ... } }</code> block. See <a href="../settings/backends/index">the documentation of your chosen backend</a> for details.</p> <blockquote class="alert alert-info" role="alert"> <p><strong>Note:</strong> If the backend configuration requires a nested block, specify it here as a normal attribute with an object value. (For example, <code>workspaces = { ... }</code> instead of <code>workspaces { ... }</code>.)</p> </blockquote> </li> <li>
<p><a href="#defaults"><code>defaults</code></a> - (Optional; object) Default values for outputs, in case the state file is empty or lacks a required output.</p> </li> </ul> <h2 id="attributes-reference">  Attributes Reference </h2> <p>In addition to the above, the following attributes are exported:</p> <ul> <li>(v0.12+) <code>outputs</code> - An object containing every root-level <a href="../values/outputs">output</a> in the remote state. </li> <li>(&lt;= v0.11) <code>&lt;OUTPUT NAME&gt;</code> - Each root-level <a href="../values/outputs">output</a> in the remote state appears as a top level attribute on the data source. </li> </ul> <h2 id="root-outputs-only">  Root Outputs Only </h2> <p>Only the root-level output values from the remote state snapshot are exposed for use elsewhere in your module. Resource data and output values from nested modules are not accessible.</p> <p>If you wish to make a nested module output value accessible as a root module output value, you must explicitly configure a passthrough in the root module. For example:</p> <p>For example:</p> <pre data-language="ruby">module "app" {
  source = "..."
}

output "app_value" {
  # This syntax is for Terraform 0.12 or later.
  value = module.app.example
}
</pre>
<p>In this example, the output value named <code>example</code> from the "app" module is available as the <code>app_value</code> root module output value. If this configuration didn't include the <code>output "app_value"</code> block then the data would not be accessible via <code>terraform_remote_state</code>.</p> <blockquote class="alert alert-warning" role="alert"> <p><strong>Warning:</strong> Although <code>terraform_remote_state</code> doesn't expose any other state snapshot information for use in configuration, the state snapshot data is a single object and so any user or server which has enough access to read the root module output values will also always have access to the full state snapshot data by direct network requests. Don't use <code>terraform_remote_state</code> if any of the resources in your configuration work with data that you consider sensitive.</p> </blockquote><div class="_attribution">
  <p class="_attribution-p">
    <a href="https://www.terraform.io/docs/language/state/remote-state-data.html" class="_attribution-link" target="_blank">https://www.terraform.io/docs/language/state/remote-state-data.html</a>
  </p>
</div>
