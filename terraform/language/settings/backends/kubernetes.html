 <h1 id="kubernetes">  kubernetes </h1> <blockquote class="alert alert-info" role="alert"> <p><strong>Note:</strong> This backend is limited by Kubernetes' maximum Secret size of 1MB. See <a href="https://kubernetes.io/docs/concepts/configuration/secret/#restrictions">Secret restrictions</a> for details.</p> </blockquote> <p><strong>Kind: Standard (with locking)</strong></p> <p>Stores the state in a <a href="https://kubernetes.io/docs/concepts/configuration/secret/">Kubernetes secret</a> with locking done using a Lease resource.</p> <h2 id="example-configuration">  Example Configuration </h2> <pre data-language="ruby">terraform {
  backend "kubernetes" {
    secret_suffix    = "state"
    load_config_file = true
  }
}
</pre>
<p>This assumes the user/service account running terraform has <a href="https://kubernetes.io/docs/reference/access-authn-authz/authorization/">permissions</a> to read/write secrets in the <a href="https://kubernetes.io/docs/concepts/overview/working-with-objects/namespaces/">namespace</a> used to store the secret.</p> <p>If the <code>load_config_file</code> flag is set the backend will attempt to use a <a href="https://kubernetes.io/docs/concepts/configuration/organize-cluster-access-kubeconfig/">kubeconfig file</a> to gain access to the cluster.</p> <p>If the <code>in_cluster_config</code> flag is set the backend will attempt to use a <a href="https://kubernetes.io/docs/tasks/configure-pod-container/configure-service-account/">service account</a> to access the cluster. This can be used if Terraform is being run from within a pod running in the Kubernetes cluster.</p> <p>For most use cases either <code>in_cluster_config</code> or <code>load_config_file</code> will need to be set to <code>true</code>. If both flags are set the configuration from <code>load_config_file</code> will be used.</p> <p>Note that for the access credentials we recommend using a <a href="configuration#partial-configuration">partial configuration</a>.</p> <h2 id="example-referencing">  Example Referencing </h2> <pre data-language="ruby">data "terraform_remote_state" "foo" {
  backend = "kubernetes"
  config = {
    secret_suffix    = "state"
    load_config_file = true
  }
}
</pre>
<h2 id="configuration-variables">  Configuration variables </h2> <p>The following configuration options are supported:</p> <ul> <li>
<a href="#secret_suffix"><code>secret_suffix</code></a> - (Required) Suffix used when creating secrets. Secrets will be named in the format: <code>tfstate-{workspace}-{secret_suffix}</code>. </li> <li>
<a href="#labels"><code>labels</code></a> - (Optional) Map of additional labels to be applied to the secret and lease. </li> <li>
<a href="#namespace"><code>namespace</code></a> - (Optional) Namespace to store the secret and lease in. Can be sourced from <code>KUBE_NAMESPACE</code>. </li> <li>
<a href="#in_cluster_config"><code>in_cluster_config</code></a> - (Optional) Used to authenticate to the cluster from inside a pod. Can be sourced from <code>KUBE_IN_CLUSTER_CONFIG</code>. </li> <li>
<a href="#load_config_file"><code>load_config_file</code></a> - (Optional) Use a kubeconfig file to access the cluster. Can be sourced from <code>KUBE_LOAD_CONFIG_FILE</code>. </li> <li>
<a href="#host"><code>host</code></a> - (Optional) The hostname (in form of URI) of Kubernetes master. Can be sourced from <code>KUBE_HOST</code>. Defaults to <code>https://localhost</code>. </li> <li>
<a href="#username"><code>username</code></a> - (Optional) The username to use for HTTP basic authentication when accessing the Kubernetes master endpoint. Can be sourced from <code>KUBE_USER</code>. </li> <li>
<a href="#password"><code>password</code></a> - (Optional) The password to use for HTTP basic authentication when accessing the Kubernetes master endpoint. Can be sourced from <code>KUBE_PASSWORD</code>. </li> <li>
<a href="#insecure"><code>insecure</code></a> - (Optional) Whether server should be accessed without verifying the TLS certificate. Can be sourced from <code>KUBE_INSECURE</code>. Defaults to <code>false</code>. </li> <li>
<a href="#client_certificate"><code>client_certificate</code></a> - (Optional) PEM-encoded client certificate for TLS authentication. Can be sourced from <code>KUBE_CLIENT_CERT_DATA</code>. </li> <li>
<a href="#client_key"><code>client_key</code></a> - (Optional) PEM-encoded client certificate key for TLS authentication. Can be sourced from <code>KUBE_CLIENT_KEY_DATA</code>. </li> <li>
<a href="#cluster_ca_certificate"><code>cluster_ca_certificate</code></a> - (Optional) PEM-encoded root certificates bundle for TLS authentication. Can be sourced from <code>KUBE_CLUSTER_CA_CERT_DATA</code>. </li> <li>
<a href="#config_path"><code>config_path</code></a> - (Optional) Path to the kube config file. Can be sourced from <code>KUBE_CONFIG</code> or <code>KUBECONFIG</code>. Defaults to <code>~/.kube/config</code>. </li> <li>
<a href="#config_context"><code>config_context</code></a> - (Optional) Context to choose from the config file. Can be sourced from <code>KUBE_CTX</code>. </li> <li>
<a href="#config_context_auth_info"><code>config_context_auth_info</code></a> - (Optional) Authentication info context of the kube config (name of the kubeconfig user, <code>--user</code> flag in <code>kubectl</code>). Can be sourced from <code>KUBE_CTX_AUTH_INFO</code>. </li> <li>
<a href="#config_context_cluster"><code>config_context_cluster</code></a> - (Optional) Cluster context of the kube config (name of the kubeconfig cluster, <code>--cluster</code> flag in <code>kubectl</code>). Can be sourced from <code>KUBE_CTX_CLUSTER</code>. </li> <li>
<a href="#token"><code>token</code></a> - (Optional) Token of your service account. Can be sourced from <code>KUBE_TOKEN</code>. </li> <li>
<a href="#exec"><code>exec</code></a> - (Optional) Configuration block to use an <a href="https://kubernetes.io/docs/reference/access-authn-authz/authentication/#client-go-credential-plugins">exec-based credential plugin</a>, e.g. call an external command to receive user credentials. <ul> <li>
<a href="#api_version"><code>api_version</code></a> - (Required) API version to use when decoding the ExecCredentials resource, e.g. <code>client.authentication.k8s.io/v1beta1</code>. </li> <li>
<a href="#command"><code>command</code></a> - (Required) Command to execute. </li> <li>
<a href="#args"><code>args</code></a> - (Optional) List of arguments to pass when executing the plugin. </li> <li>
<a href="#env"><code>env</code></a> - (Optional) Map of environment variables to set when executing the plugin. </li> </ul> </li> </ul><div class="_attribution">
  <p class="_attribution-p">
    <a href="https://www.terraform.io/docs/language/settings/backends/kubernetes.html" class="_attribution-link" target="_blank">https://www.terraform.io/docs/language/settings/backends/kubernetes.html</a>
  </p>
</div>
