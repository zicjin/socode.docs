 <h1 id="plans-api">  Plans API </h1> <p>A plan represents the execution plan of a Run in a Terraform workspace.</p> <h2 id="attributes">  Attributes </h2> <h3 id="plan-states">  Plan States </h3> <p>The plan state is found in <code>data.attributes.status</code>, and you can reference the following list of possible states.</p> <table>
<thead> <tr> <th>State</th> <th>Description</th> </tr> </thead>
<tbody> <tr> <td><code>pending</code></td> <td>The initial status of a plan once it has been created.</td> </tr> <tr> <td>
<code>managed_queued</code>/<code>queued</code>
</td> <td>The plan has been queued, awaiting backend service capacity to run terraform.</td> </tr> <tr> <td><code>running</code></td> <td>The plan is running.</td> </tr> <tr> <td><code>errored</code></td> <td>The plan has errored. This is a final state.</td> </tr> <tr> <td><code>canceled</code></td> <td>The plan has been canceled. This is a final state.</td> </tr> <tr> <td><code>finished</code></td> <td>The plan has completed sucessfully. This is a final state.</td> </tr> <tr> <td><code>unreachable</code></td> <td>The plan will not run. This is a final state.</td> </tr> </tbody>
</table> <h2 id="show-a-plan">  Show a plan </h2> <p><code>GET /plans/:id</code></p> <table>
<thead> <tr> <th>Parameter</th> <th>Description</th> </tr> </thead>
<tbody> <tr> <td><code>id</code></td> <td>The ID of the plan to show.</td> </tr> </tbody>
</table> <p>There is no endpoint to list plans. You can find the ID for a plan in the <code>relationships.plan</code> property of a run object.</p> <table>
<thead> <tr> <th>Status</th> <th>Response</th> <th>Reason</th> </tr> </thead>
<tbody> <tr> <td><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/200">200</a></td> <td>
<a href="index#json-api-documents">JSON API document</a> (<code>type: "plans"</code>)</td> <td>The request was successful</td> </tr> <tr> <td><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404">404</a></td> <td><a href="https://jsonapi.org/format/#error-objects">JSON API error object</a></td> <td>Plan not found, or user unauthorized to perform action</td> </tr> </tbody>
</table> <h3 id="sample-request">  Sample Request </h3> <pre data-language="shell">curl \
  --header "Authorization: Bearer $TOKEN" \
  --header "Content-Type: application/vnd.api+json" \
  https://app.terraform.io/api/v2/plans/plan-8F5JFydVYAmtTjET
</pre>
<h3 id="sample-response">  Sample Response </h3> <pre data-language="json">{
  "data": {
    "id": "plan-8F5JFydVYAmtTjET",
    "type": "plans",
    "attributes": {
      "execution-details": {
        "mode": "remote",
      },
      "has-changes": true,
      "resource-additions": 0,
      "resource-changes": 1,
      "resource-destructions": 0,
      "status": "finished",
      "status-timestamps": {
        "queued-at": "2018-07-02T22:29:53+00:00",
        "pending-at": "2018-07-02T22:29:53+00:00",
        "started-at": "2018-07-02T22:29:54+00:00",
        "finished-at": "2018-07-02T22:29:58+00:00"
      },
      "log-read-url": "https://archivist.terraform.io/v1/object/dmF1bHQ6djE6OFA1eEdlSFVHRSs4YUcwaW83a1dRRDA0U2E3T3FiWk1HM2NyQlNtcS9JS1hHN3dmTXJmaFhEYTlHdTF1ZlgxZ2wzVC9kVTlNcjRPOEJkK050VFI3U3dvS2ZuaUhFSGpVenJVUFYzSFVZQ1VZYno3T3UyYjdDRVRPRE5pbWJDVTIrNllQTENyTndYd1Y0ak1DL1dPVlN1VlNxKzYzbWlIcnJPa2dRRkJZZGtFeTNiaU84YlZ4QWs2QzlLY3VJb3lmWlIrajF4a1hYZTlsWnFYemRkL2pNOG9Zc0ZDakdVMCtURUE3dDNMODRsRnY4cWl1dUN5dUVuUzdnZzFwL3BNeHlwbXNXZWRrUDhXdzhGNnF4c3dqaXlZS29oL3FKakI5dm9uYU5ZKzAybnloREdnQ3J2Rk5WMlBJemZQTg"
    },
    "relationships": {
      "state-versions": {
        "data": []
      }
    },
    "links": {
      "self": "/api/v2/plans/plan-8F5JFydVYAmtTjET",
      "json-output": "/api/v2/plans/plan-8F5JFydVYAmtTjET/json-output"
    }
  }
}
</pre>
<p><em>Using Terraform Cloud Agents</em></p> <p><a href="agents">Terraform Cloud Agents</a> are a solution to allow Terraform Cloud to communicate with isolated, private, or on-premises infrastructure. When a workspace is set to use the agent execution mode, the plan response will include additional details about the agent pool and agent used.</p> <pre data-language="json">{
  "data": {
    "id": "plan-8F5JFydVYAmtTjET",
    "type": "plans",
    "attributes": {
      "execution-details": {
        "agent-id": "agent-S1Y7tcKxXPJDQAvq",
        "agent-name": "agent_01",
        "agent-pool-id": "apool-Zigq2VGreKq7nwph",
        "agent-pool-name": "first-pool",
        "mode": "agent",
      },
      "has-changes": true,
      "resource-additions": 0,
      "resource-changes": 1,
      "resource-destructions": 0,
      "status": "finished",
      "status-timestamps": {
        "queued-at": "2018-07-02T22:29:53+00:00",
        "pending-at": "2018-07-02T22:29:53+00:00",
        "started-at": "2018-07-02T22:29:54+00:00",
        "finished-at": "2018-07-02T22:29:58+00:00"
      },
      "log-read-url": "https://archivist.terraform.io/v1/object/dmF1bHQ6djE6OFA1eEdlSFVHRSs4YUcwaW83a1dRRDA0U2E3T3FiWk1HM2NyQlNtcS9JS1hHN3dmTXJmaFhEYTlHdTF1ZlgxZ2wzVC9kVTlNcjRPOEJkK050VFI3U3dvS2ZuaUhFSGpVenJVUFYzSFVZQ1VZYno3T3UyYjdDRVRPRE5pbWJDVTIrNllQTENyTndYd1Y0ak1DL1dPVlN1VlNxKzYzbWlIcnJPa2dRRkJZZGtFeTNiaU84YlZ4QWs2QzlLY3VJb3lmWlIrajF4a1hYZTlsWnFYemRkL2pNOG9Zc0ZDakdVMCtURUE3dDNMODRsRnY4cWl1dUN5dUVuUzdnZzFwL3BNeHlwbXNXZWRrUDhXdzhGNnF4c3dqaXlZS29oL3FKakI5dm9uYU5ZKzAybnloREdnQ3J2Rk5WMlBJemZQTg"
    },
    "relationships": {
      "state-versions": {
        "data": []
      }
    },
    "links": {
      "self": "/api/v2/plans/plan-8F5JFydVYAmtTjET",
      "json-output": "/api/v2/plans/plan-8F5JFydVYAmtTjET/json-output"
    }
  }
}
</pre>
<h2 id="retrieve-the-json-execution-plan">  Retrieve the JSON execution plan </h2> <p><code>GET /plans/:id/json-output</code></p> <p><code>GET /runs/:id/plan/json-output</code></p> <p>These endpoints generate a temporary authenticated URL to the location of the <a href="../../internals/json-format#format-summary">JSON formatted execution plan</a>. When successful, this endpoint responds with a temporary redirect that should be followed. If using a client that can follow redirects, you can use this endpoint to save the <code>.json</code> file locally without needing to save the temporary URL.</p> <p>This temporary URL provided by the redirect has a life of <strong>1 minute</strong>, and should not be relied upon beyond the initial request. If you need repeat access, you should use this endpoint to generate a new URL each time.</p> <blockquote class="alert alert-info" role="alert"> <p><strong>Note:</strong> This endpoint is available for plans using Terraform 0.12 and later. For Terraform Enterprise, this endpoint is available from v202005-1, and its stability was improved in v202007-1.</p> </blockquote> <blockquote class="alert alert-info" role="alert"> <p><strong>Note:</strong> This endpoint cannot be accessed with <a href="../users-teams-organizations/api-tokens#organization-api-tokens">organization tokens</a>. You must access it with a <a href="../users-teams-organizations/users#api-tokens">user token</a> or <a href="../users-teams-organizations/api-tokens#team-api-tokens">team token</a> that has admin level access to the workspace. (<a href="../users-teams-organizations/permissions">More about permissions.</a>)</p> </blockquote> <table>
<thead> <tr> <th>Status</th> <th>Response</th> <th>Reason</th> </tr> </thead>
<tbody> <tr> <td><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/204">204</a></td> <td>No Content</td> <td>Plan JSON supported, but plan has not yet completed.</td> </tr> <tr> <td><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/307">307</a></td> <td>Temporary Redirect</td> <td>Plan JSON found and temporary download URL generated</td> </tr> <tr> <td><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/422">422</a></td> <td><a href="https://jsonapi.org/format/#error-objects">JSON API error object</a></td> <td>Plan does not use a supported version of terraform (&lt; 0.12.X)</td> </tr> </tbody>
</table> <h3 id="sample-request-1">  Sample Request </h3> <pre data-language="shell">curl \
  --header "Authorization: Bearer $TOKEN" \
  --header "Content-Type: application/vnd.api+json" \
  --location \
  https://app.terraform.io/api/v2/plans/plan-8F5JFydVYAmtTjET/json-output |
  &gt; json-output.json
</pre><div class="_attribution">
  <p class="_attribution-p">
    <a href="https://www.terraform.io/docs/cloud/api/plans.html" class="_attribution-link" target="_blank">https://www.terraform.io/docs/cloud/api/plans.html</a>
  </p>
</div>
