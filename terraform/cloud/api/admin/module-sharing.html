 <h1 id="admin-module-sharing-api">  Admin Module Sharing API </h1> <blockquote class="alert alert-info" role="alert"> <p><strong>Terraform Enterprise feature:</strong> The admin API is exclusive to Terraform Enterprise, and can only be used by the admins and operators who install and maintain their organization's Terraform Enterprise instance.</p> </blockquote> <blockquote class="alert alert-warning" role="alert"> <p><strong>Tip</strong>: This Admin Module Sharing API is <strong>deprecated</strong> and will be removed in a future release. Transition existing integrations with this API to the <a href="organizations#update-an-organization-39-s-module-consumers">Admin Organizations Module Consumers API</a>. Global module sharing should still be configured using the <a href="organizations#update-an-organization">Admin Organizations API</a>.</p> </blockquote> <p>There are two ways to configure module sharing via the Admin API:</p> <ul> <li>This endpoint, which allows an organization to share modules with a specific list of other organizations. </li> <li>The <a href="organizations#update-an-organization">update an organization endpoint</a>, whose <code>data.attributes.global-module-sharing</code> property allows an organization to share modules with every organization in the instance. </li> </ul> <p>Enabling either option will disable the other. For more information, see <a href="https://www.terraform.io/docs/enterprise/admin/module-sharing.html">Administration: Module Sharing</a>.</p> <h2 id="update-an-organization-39-s-module-consumers">  Update an Organization's Module Consumers </h2> <blockquote class="alert alert-info" role="alert"> <p>This API endpoint is available in Terraform Enterprise as of version 202012-1.</p> </blockquote> <p><code>PATCH /admin/organizations/:name/module-consumers</code></p> <p>This endpoint sets the list of organizations that can use modules from the sharing organization's private registry. Sharing with specific organizations will automatically turn off global module sharing, which is configured with the <a href="organizations#update-an-organization">update an organization endpoint</a> (via the <code>data.attributes.global-module-sharing</code> property).</p> <table>
<thead> <tr> <th>Parameter</th> <th>Description</th> </tr> </thead>
<tbody> <tr> <td><code>:name</code></td> <td>The name of the organization whose registry is being shared</td> </tr> </tbody>
</table> <table>
<thead> <tr> <th>Status</th> <th>Response</th> <th>Reason</th> </tr> </thead>
<tbody> <tr> <td><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/200">200</a></td> <td>
<a href="../index#json-api-documents">JSON API document</a> (<code>type: "module-partnerships"</code>)</td> <td>The list of module consumers was successfully updated</td> </tr> <tr> <td><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404">404</a></td> <td><a href="https://jsonapi.org/format/#error-objects">JSON API error object</a></td> <td>Organization not found or user unauthorized to perform action</td> </tr> <tr> <td><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/422">422</a></td> <td><a href="https://jsonapi.org/format/#error-objects">JSON API error object</a></td> <td>Malformed request body (missing attributes, wrong types, etc.)</td> </tr> </tbody>
</table> <h3 id="request-body">  Request Body </h3> <p>This PATCH endpoint requires a JSON object with the following properties as a request payload.</p> <table>
<thead> <tr> <th>Key path</th> <th>Type</th> <th>Default</th> <th>Description</th> </tr> </thead>
<tbody> <tr> <td><code>data.type</code></td> <td>string</td> <td></td> <td>Must be <code>"module-partnerships"</code>
</td> </tr> <tr> <td><code>data.attributes.module-consuming-organization-ids</code></td> <td>array[string]</td> <td></td> <td>A list of external ids for organizations that will be able to access modules in the producing organization's registry. These should have an <code>org-</code> prefix.</td> </tr> </tbody>
</table> <h3 id="sample-payload">  Sample Payload </h3> <pre data-language="json">{
  "data": {
    "type": "module-partnerships",
    "attributes": {
      "module-consuming-organization-ids": [
        "org-939hp5K7kecppVmd"
      ]
    }
  }
}
</pre>
<h3 id="sample-request">  Sample Request </h3> <pre data-language="shell">curl \
  --header "Authorization: Bearer $TOKEN" \
  --header "Content-Type: application/vnd.api+json" \
  --request PATCH \
  --data @payload.json \
  https://tfe.example.com/api/v2/admin/organizations/my-organization/module-consumers
</pre>
<h3 id="sample-response">  Sample Response </h3> <pre data-language="json">{
  "data": [
    {
      "id": "mp-tQATArr4gyYDBvkF",
      "type": "module-partnerships",
      "attributes": {
        "consuming-organization-id": "org-939hp5K7kecppVmd",
        "consuming-organization-name": "other-organization",
        "producing-organization-id": "org-etdex8r9VLnyHFct",
        "producing-organization-name": "my-organization"
      }
    }
  ]
}
</pre><div class="_attribution">
  <p class="_attribution-p">
    <a href="https://www.terraform.io/docs/cloud/api/admin/module-sharing.html" class="_attribution-link" target="_blank">https://www.terraform.io/docs/cloud/api/admin/module-sharing.html</a>
  </p>
</div>
