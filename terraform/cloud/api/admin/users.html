 <h1 id="admin-users-api">  Admin Users API </h1> <blockquote class="alert alert-info" role="alert"> <p><strong>Terraform Enterprise feature:</strong> The admin API is exclusive to Terraform Enterprise, and can only be used by the admins and operators who install and maintain their organization's Terraform Enterprise instance.</p> </blockquote> <blockquote class="alert alert-info" role="alert"> <p>These API endpoints are available in Terraform Enterprise as of version 201807-1.</p> </blockquote> <p>The Users Admin API contains endpoints to help site administrators manage user accounts.</p> <h2 id="list-all-users">  List all users </h2> <p><code>GET /api/v2/admin/users</code></p> <p>This endpoint lists all user accounts in the Terraform Enterprise installation.</p> <table>
<thead> <tr> <th>Status</th> <th>Response</th> <th>Reason</th> </tr> </thead>
<tbody> <tr> <td><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/200">200</a></td> <td>
<a href="../index#json-api-documents">JSON API document</a> (<code>type: "users"</code>)</td> <td>Successfully listed users</td> </tr> <tr> <td><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404">404</a></td> <td><a href="https://jsonapi.org/format/#error-objects">JSON API error object</a></td> <td>Client is not an administrator.</td> </tr> </tbody>
</table> <h3 id="query-parameters">  Query Parameters </h3> <p><a href="../index#query-parameters">These are standard URL query parameters</a>; remember to percent-encode <code>[</code> as <code>%5B</code> and <code>]</code> as <code>%5D</code> if your tooling doesn't automatically encode URLs.</p> <table>
<thead> <tr> <th>Parameter</th> <th>Description</th> </tr> </thead>
<tbody> <tr> <td><code>q</code></td> <td>
<strong>Optional.</strong> A search query string. Users are searchable by username and email address.</td> </tr> <tr> <td><code>filter[admin]</code></td> <td>
<strong>Optional.</strong> Can be <code>"true"</code> or <code>"false"</code> to show only administrators or non-administrators.</td> </tr> <tr> <td><code>filter[suspended]</code></td> <td>
<strong>Optional.</strong> Can be <code>"true"</code> or <code>"false"</code> to show only suspended users or users who are not suspended.</td> </tr> <tr> <td><code>page[number]</code></td> <td>
<strong>Optional.</strong> If omitted, the endpoint will return the first page.</td> </tr> <tr> <td><code>page[size]</code></td> <td>
<strong>Optional.</strong> If omitted, the endpoint will return 20 users per page.</td> </tr> </tbody>
</table> <h3 id="available-related-resources">  Available Related Resources </h3> <p>This GET endpoint can optionally return related resources, if requested with <a href="../index#inclusion-of-related-resources">the <code>include</code> query parameter</a>. The following resource types are available:</p> <table>
<thead> <tr> <th>Resource Name</th> <th>Description</th> </tr> </thead>
<tbody> <tr> <td><code>organizations</code></td> <td>A list of organizations that each user is a member of.</td> </tr> </tbody>
</table> <h3 id="sample-request">  Sample Request </h3> <pre data-language="shell">curl \
  --header "Authorization: Bearer $TOKEN" \
  --header "Content-Type: application/vnd.api+json" \
  "https://app.terraform.io/api/v2/admin/users"
</pre>
<h3 id="sample-response">  Sample Response </h3> <pre data-language="json">{
  "data": [
    {
      "id": "user-ZL4MsEKnd6iTigTb",
      "type": "users",
      "attributes": {
        "username": "myuser",
        "email": "myuser@example.com",
        "avatar-url": "https://www.gravatar.com/avatar/3a23b75d5aa41029b88b73f47a0d90db?s=100&amp;d=mm",
        "is-admin": true,
        "is-suspended": false,
        "is-service-account": false
      },
      "relationships": {
        "organizations": {
          "data": [
            {
              "id": "my-organization",
              "type": "organizations"
            }
          ]
        }
      },
      "links": {
        "self": "/api/v2/users/myuser"
      }
    }
  ],
  "links": {
    "self": "https://app.terraform.io/api/v2/admin/users?page%5Bnumber%5D=1&amp;page%5Bsize%5D=20",
    "first": "https://app.terraform.io/api/v2/admin/users?page%5Bnumber%5D=1&amp;page%5Bsize%5D=20",
    "prev": null,
    "next": null,
    "last": "https://app.terraform.io/api/v2/admin/users?page%5Bnumber%5D=1&amp;page%5Bsize%5D=20"
  },
  "meta": {
    "pagination": {
      "current-page": 1,
      "prev-page": null,
      "next-page": null,
      "total-pages": 1,
      "total-count": 1
    },
    "status-counts": {
      "total": 1,
      "suspended": 0,
      "admin": 1
    }
  }
}
</pre>
<h2 id="delete-a-user-account">  Delete a user account </h2> <p><code>DELETE /admin/users/:id</code></p> <p>This endpoint deletes a user's account from Terraform Enterprise. To prevent unowned organizations, a user cannot be deleted if they are the sole owner of any organizations. The organizations must be given a new owner or deleted first.</p> <table>
<thead> <tr> <th>Parameter</th> <th>Description</th> </tr> </thead>
<tbody> <tr> <td><code>:id</code></td> <td>The ID of the user to delete.</td> </tr> </tbody>
</table> <table>
<thead> <tr> <th>Status</th> <th>Response</th> <th>Reason</th> </tr> </thead>
<tbody> <tr> <td><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/204">204</a></td> <td>Empty body</td> <td>Successfully removed the user account.</td> </tr> <tr> <td><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404">404</a></td> <td><a href="https://jsonapi.org/format/#error-objects">JSON API error object</a></td> <td>Client is not an administrator.</td> </tr> <tr> <td><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/422">422</a></td> <td><a href="https://jsonapi.org/format/#error-objects">JSON API error object</a></td> <td>The user cannot be deleted because they are the sole owner of one or more organizations.</td> </tr> </tbody>
</table> <h3 id="sample-request-1">  Sample Request </h3> <pre data-language="shell">curl \
  --header "Authorization: Bearer $TOKEN" \
  --header "Content-Type: application/vnd.api+json" \
  --request DELETE \
  "https://app.terraform.io/api/v2/admin/users/user-ZL4MsEKnd6iTigTb"
</pre>
<h2 id="suspend-a-user">  Suspend a user </h2> <p><code>POST /admin/users/:id/actions/suspend</code></p> <table>
<thead> <tr> <th>Parameter</th> <th>Description</th> </tr> </thead>
<tbody> <tr> <td><code>:id</code></td> <td>The ID of the user to suspend.</td> </tr> </tbody>
</table> <p>This endpoint suspends a user's account, preventing them from authenticating and accessing resources.</p> <table>
<thead> <tr> <th>Status</th> <th>Response</th> <th>Reason</th> </tr> </thead>
<tbody> <tr> <td><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/200">200</a></td> <td>
<a href="../index#json-api-documents">JSON API document</a> (<code>type: "users"</code>)</td> <td>Successfully suspended the user's account.</td> </tr> <tr> <td><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/400">400</a></td> <td><a href="https://jsonapi.org/format/#error-objects">JSON API error object</a></td> <td>User is already suspended.</td> </tr> <tr> <td><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404">404</a></td> <td><a href="https://jsonapi.org/format/#error-objects">JSON API error object</a></td> <td>Client is not an administrator.</td> </tr> </tbody>
</table> <h3 id="sample-request-2">  Sample Request </h3> <pre data-language="shell">curl \
  --header "Authorization: Bearer $TOKEN" \
  --header "Content-Type: application/vnd.api+json" \
  --request POST \
  "https://app.terraform.io/api/v2/admin/users/user-ZL4MsEKnd6iTigTb/actions/suspend"
</pre>
<h3 id="sample-response-1">  Sample Response </h3> <pre data-language="json">{
  "data": {
    "id": "user-ZL4MsEKnd6iTigTb",
    "type": "users",
    "attributes": {
      "username": "myuser",
      "email": "myuser@example.com",
      "avatar-url": "https://www.gravatar.com/avatar/3a23b75d5aa41029b88b73f47a0d90db?s=100&amp;d=mm",
      "is-admin": false,
      "is-suspended": true,
      "is-service-account": false
    },
    "relationships": {
      "organizations": {
        "data": [
          {
            "id": "my-organization",
            "type": "organizations"
          }
        ]
      }
    },
    "links": {
      "self": "/api/v2/users/myuser"
    }
  }
}
</pre>
<h2 id="re-activate-a-suspended-user">  Re-activate a suspended user </h2> <p><code>POST /admin/users/:id/actions/unsuspend</code></p> <table>
<thead> <tr> <th>Parameter</th> <th>Description</th> </tr> </thead>
<tbody> <tr> <td><code>:id</code></td> <td>The ID of the user to re-activate.</td> </tr> </tbody>
</table> <p>This endpoint re-activates a suspended user's account, allowing them to resume authenticating and accessing resources.</p> <table>
<thead> <tr> <th>Status</th> <th>Response</th> <th>Reason</th> </tr> </thead>
<tbody> <tr> <td><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/200">200</a></td> <td>
<a href="../index#json-api-documents">JSON API document</a> (<code>type: "users"</code>)</td> <td>Successfully re-activated the user's account.</td> </tr> <tr> <td><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/400">400</a></td> <td><a href="https://jsonapi.org/format/#error-objects">JSON API error object</a></td> <td>User is not suspended.</td> </tr> <tr> <td><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404">404</a></td> <td><a href="https://jsonapi.org/format/#error-objects">JSON API error object</a></td> <td>User not found, or client is not an administrator.</td> </tr> </tbody>
</table> <h3 id="sample-request-3">  Sample Request </h3> <pre data-language="shell">curl \
  --header "Authorization: Bearer $TOKEN" \
  --header "Content-Type: application/vnd.api+json" \
  --request POST \
  "https://app.terraform.io/api/v2/admin/users/user-ZL4MsEKnd6iTigTb/actions/unsuspend"
</pre>
<h3 id="sample-response-2">  Sample Response </h3> <pre data-language="json">{
  "data": {
    "id": "user-ZL4MsEKnd6iTigTb",
    "type": "users",
    "attributes": {
      "username": "myuser",
      "email": "myuser@example.com",
      "avatar-url": "https://www.gravatar.com/avatar/3a23b75d5aa41029b88b73f47a0d90db?s=100&amp;d=mm",
      "is-admin": false,
      "is-suspended": false,
      "is-service-account": false
    },
    "relationships": {
      "organizations": {
        "data": [
          {
            "id": "my-organization",
            "type": "organizations"
          }
        ]
      }
    },
    "links": {
      "self": "/api/v2/users/myuser"
    }
  }
}
</pre>
<h2 id="grant-a-user-administrative-privileges">  Grant a user administrative privileges </h2> <p><code>POST /admin/users/:id/actions/grant_admin</code></p> <table>
<thead> <tr> <th>Parameter</th> <th>Description</th> </tr> </thead>
<tbody> <tr> <td><code>:id</code></td> <td>The ID of the user to make an administrator.</td> </tr> </tbody>
</table> <table>
<thead> <tr> <th>Status</th> <th>Response</th> <th>Reason</th> </tr> </thead>
<tbody> <tr> <td><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/200">200</a></td> <td>
<a href="../index#json-api-documents">JSON API document</a> (<code>type: "users"</code>)</td> <td>Successfully made the user an administrator.</td> </tr> <tr> <td><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/400">400</a></td> <td><a href="https://jsonapi.org/format/#error-objects">JSON API error object</a></td> <td>User is already an administrator.</td> </tr> <tr> <td><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404">404</a></td> <td><a href="https://jsonapi.org/format/#error-objects">JSON API error object</a></td> <td>User not found, or client is not an administrator.</td> </tr> <tr> <td><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/422">422</a></td> <td><a href="https://jsonapi.org/format/#error-objects">JSON API error object</a></td> <td>Validation errors</td> </tr> </tbody>
</table> <h3 id="sample-request-4">  Sample Request </h3> <pre data-language="shell">curl \
  --header "Authorization: Bearer $TOKEN" \
  --header "Content-Type: application/vnd.api+json" \
  --request POST \
  "https://app.terraform.io/api/v2/admin/users/user-ZL4MsEKnd6iTigTb/actions/grant_admin"
</pre>
<h3 id="sample-response-3">  Sample Response </h3> <pre data-language="json">{
  "data": {
    "id": "user-ZL4MsEKnd6iTigTb",
    "type": "users",
    "attributes": {
      "username": "myuser",
      "email": "myuser@example.com",
      "avatar-url": "https://www.gravatar.com/avatar/3a23b75d5aa41029b88b73f47a0d90db?s=100&amp;d=mm",
      "is-admin": true,
      "is-suspended": false,
      "is-service-account": false
    },
    "relationships": {
      "organizations": {
        "data": [
          {
            "id": "my-organization",
            "type": "organizations"
          }
        ]
      }
    },
    "links": {
      "self": "/api/v2/users/myuser"
    }
  }
}
</pre>
<h2 id="revoke-an-user-39-s-administrative-privileges">  Revoke an user's administrative privileges </h2> <p><code>POST /admin/users/:id/actions/revoke_admin</code></p> <table>
<thead> <tr> <th>Parameter</th> <th>Description</th> </tr> </thead>
<tbody> <tr> <td><code>:id</code></td> <td>The ID of the administrator to demote.</td> </tr> </tbody>
</table> <table>
<thead> <tr> <th>Status</th> <th>Response</th> <th>Reason</th> </tr> </thead>
<tbody> <tr> <td><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/200">200</a></td> <td>
<a href="../index#json-api-documents">JSON API document</a> (<code>type: "users"</code>)</td> <td>Successfully made the user an administrator.</td> </tr> <tr> <td><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/400">400</a></td> <td><a href="https://jsonapi.org/format/#error-objects">JSON API error object</a></td> <td>User is not an administrator.</td> </tr> <tr> <td><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404">404</a></td> <td><a href="https://jsonapi.org/format/#error-objects">JSON API error object</a></td> <td>User not found, or client is not an administrator.</td> </tr> </tbody>
</table> <h3 id="sample-request-5">  Sample Request </h3> <pre data-language="shell">curl \
  --header "Authorization: Bearer $TOKEN" \
  --header "Content-Type: application/vnd.api+json" \
  --request POST \
  "https://app.terraform.io/api/v2/admin/users/user-ZL4MsEKnd6iTigTb/actions/revoke_admin"
</pre>
<h3 id="sample-response-4">  Sample Response </h3> <pre data-language="json">{
  "data": {
    "id": "user-ZL4MsEKnd6iTigTb",
    "type": "users",
    "attributes": {
      "username": "myuser",
      "email": "myuser@example.com",
      "avatar-url": "https://www.gravatar.com/avatar/3a23b75d5aa41029b88b73f47a0d90db?s=100&amp;d=mm",
      "is-admin": false,
      "is-suspended": false,
      "is-service-account": false
    },
    "relationships": {
      "organizations": {
        "data": [
          {
            "id": "my-organization",
            "type": "organizations"
          }
        ]
      }
    },
    "links": {
      "self": "/api/v2/users/myuser"
    }
  }
}
</pre>
<h2 id="disable-a-user-39-s-two-factor-authentication">  Disable a user's two-factor authentication </h2> <p><code>POST /admin/users/:id/actions/disable_two_factor</code></p> <table>
<thead> <tr> <th>Parameter</th> <th>Description</th> </tr> </thead>
<tbody> <tr> <td><code>:id</code></td> <td>The ID of the user to disable 2FA for.</td> </tr> </tbody>
</table> <p>This endpoint disables a user's two-factor authentication in the situation where they have lost access to their device and recovery codes. Before disabling a user's two-factor authentication, completing a security verification process is recommended to ensure the request is legitimate.</p> <table>
<thead> <tr> <th>Status</th> <th>Response</th> <th>Reason</th> </tr> </thead>
<tbody> <tr> <td><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/200">200</a></td> <td>
<a href="../index#json-api-documents">JSON API document</a> (<code>type: "users"</code>)</td> <td>Successfully disabled the user's two-factor authentication.</td> </tr> <tr> <td><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/400">400</a></td> <td><a href="https://jsonapi.org/format/#error-objects">JSON API error object</a></td> <td>User does not have two-factor authentication enabled.</td> </tr> <tr> <td><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404">404</a></td> <td><a href="https://jsonapi.org/format/#error-objects">JSON API error object</a></td> <td>User not found, or client is not an administrator.</td> </tr> </tbody>
</table> <h3 id="sample-request-6">  Sample Request </h3> <pre data-language="shell">curl \
  --header "Authorization: Bearer $TOKEN" \
  --header "Content-Type: application/vnd.api+json" \
  --request POST \
  "https://app.terraform.io/api/v2/admin/users/user-ZL4MsEKnd6iTigTb/actions/disable_two_factor"
</pre>
<h3 id="sample-response-5">  Sample Response </h3> <pre data-language="json">{
  "data": {
    "id": "user-ZL4MsEKnd6iTigTb",
    "type": "users",
    "attributes": {
      "username": "myuser",
      "email": "myuser@example.com",
      "avatar-url": "https://www.gravatar.com/avatar/3a23b75d5aa41029b88b73f47a0d90db?s=100&amp;d=mm",
      "is-admin": false,
      "is-suspended": false,
      "is-service-account": false
    },
    "relationships": {
      "organizations": {
        "data": [
          {
            "id": "my-organization",
            "type": "organizations"
          }
        ]
      }
    },
    "links": {
      "self": "/api/v2/users/myuser"
    }
  }
}
</pre>
<h2 id="impersonate-another-user">  Impersonate another user </h2> <p><code>POST /admin/users/:id/actions/impersonate</code></p> <table>
<thead> <tr> <th>Parameter</th> <th>Description</th> </tr> </thead>
<tbody> <tr> <td><code>:id</code></td> <td>The ID of the user to impersonate. It is not possible to impersonate service accounts or your own account.</td> </tr> </tbody>
</table> <p>Impersonation allows an admin to begin a new session as another user in the system; for more information, see <a href="https://www.terraform.io/docs/enterprise/admin/resources.html#impersonating-a-user">Impersonating a User</a> in the Terraform Enterprise administration section.</p> <blockquote class="alert alert-info" role="alert"> <p><strong>Note:</strong> Impersonation is <a href="https://www.terraform.io/docs/enterprise/admin/resources.html#impersonating-a-user">intended as a UI feature</a>, and this endpoint exists to support that UI.</p> </blockquote> <table>
<thead> <tr> <th>Status</th> <th>Response</th> <th>Reason</th> </tr> </thead>
<tbody> <tr> <td><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/204">204</a></td> <td>Empty body</td> <td>Successfully impersonated the user.</td> </tr> <tr> <td><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/400">400</a></td> <td><a href="https://jsonapi.org/format/#error-objects">JSON API error object</a></td> <td>A reason for impersonation is required.</td> </tr> <tr> <td><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/403">403</a></td> <td><a href="https://jsonapi.org/format/#error-objects">JSON API error object</a></td> <td>Client is already impersonating another user.</td> </tr> <tr> <td><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/403">403</a></td> <td><a href="https://jsonapi.org/format/#error-objects">JSON API error object</a></td> <td>User cannot be impersonated.</td> </tr> <tr> <td><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404">404</a></td> <td><a href="https://jsonapi.org/format/#error-objects">JSON API error object</a></td> <td>User not found, or client is not an administrator.</td> </tr> </tbody>
</table> <h3 id="request-body">  Request Body </h3> <p>This POST endpoint requires a JSON object with the following properties as a request payload.</p> <table>
<thead> <tr> <th>Key path</th> <th>Type</th> <th>Default</th> <th>Description</th> </tr> </thead>
<tbody> <tr> <td><code>reason</code></td> <td>string</td> <td></td> <td>A reason for impersonation, which will be recorded in the Audit Log.</td> </tr> </tbody>
</table> <h3 id="sample-payload">  Sample Payload </h3> <pre data-language="json">{
  "reason": "Reason for impersonation"
}
</pre>
<h3 id="sample-request-7">  Sample Request </h3> <pre data-language="shell">curl \
  --header "Cookie: $COOKIE" \
  --header "Content-Type: application/vnd.api+json" \
  --request POST \
  --data @payload.json \
  https://app.terraform.io/api/v2/admin/users/user-ZL4MsEKnd6iTigTb/actions/impersonate
</pre>
<h2 id="end-an-impersonation-session">  End an impersonation session </h2> <p><code>POST /admin/users/actions/unimpersonate</code></p> <p>When an admin has used the above endpoint to begin an impersonation session, they can make a request to this endpoint, using the cookie provided originally, in order to end that session and log out as the impersonated user.</p> <p>This endpoint does not respond with a body, but the response does include a <code>Set-Cookie</code> header to persist a new session as the original admin user. As such, this endpoint will have no effect unless the client is able to persist and use cookies.</p> <table>
<thead> <tr> <th>Status</th> <th>Response</th> <th>Reason</th> </tr> </thead>
<tbody> <tr> <td><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/204">204</a></td> <td>Empty body</td> <td>Successfully ended the impersonation session.</td> </tr> <tr> <td><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/400">400</a></td> <td><a href="https://jsonapi.org/format/#error-objects">JSON API error object</a></td> <td>Client is not in an impersonation session.</td> </tr> <tr> <td><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404">404</a></td> <td><a href="https://jsonapi.org/format/#error-objects">JSON API error object</a></td> <td>Client is not an administrator.</td> </tr> </tbody>
</table> <h3 id="sample-request-8">  Sample Request </h3> <pre data-language="shell">curl \
  --header "Cookie: $COOKIE" \
  --header "Content-Type: application/vnd.api+json" \
  --request POST \
  https://app.terraform.io/api/v2/admin/users/actions/unimpersonate
</pre><div class="_attribution">
  <p class="_attribution-p">
    <a href="https://www.terraform.io/docs/cloud/api/admin/users.html" class="_attribution-link" target="_blank">https://www.terraform.io/docs/cloud/api/admin/users.html</a>
  </p>
</div>
