 <h1 id="example-policies">  Example Policies </h1> <blockquote class="alert alert-info" role="alert"> <p><strong>Note:</strong> Terraform policies are a paid feature, available as part of the <strong>Team &amp; Governance</strong> upgrade package. <a href="https://www.hashicorp.com/products/terraform/pricing">Learn more about Terraform Cloud pricing here</a>.</p> </blockquote> <blockquote> <p><strong>Hands-on:</strong> Try the <a href="https://learn.hashicorp.com/collections/terraform/policy?utm_source=WEBSITE&amp;utm_medium=WEB_IO&amp;utm_offer=ARTICLE_PAGE&amp;utm_content=DOCS">Enforce Policy with Sentinel</a> collection on HashiCorp Learn.</p> </blockquote> <p>This page lists some example policies. These examples are not exhaustive, but they demonstrate some of the most common use cases of policies with Terraform Cloud. For more examples, see the <a href="https://github.com/hashicorp/terraform-guides/tree/master/governance/third-generation">Governance section of the hashicorp/terraform-guides repository</a>.</p> <blockquote class="alert alert-warning" role="alert"> <p><strong>Important:</strong> These examples are a demonstration of the Sentinel policy language and its features. They should not be used verbatim in your Terraform Cloud organization. Make sure you fully understand the intent and behavior of a policy before relying on it in production.</p> </blockquote> <h3 id="amazon-web-services">  Amazon Web Services </h3> <ul> <li>
<a href="https://github.com/hashicorp/terraform-guides/blob/master/governance/third-generation/aws/restrict-ami-owners.sentinel">Restrict owners of the <code>aws_ami</code> data source</a> </li> <li>
<a href="https://github.com/hashicorp/terraform-guides/blob/master/governance/third-generation/aws/enforce-mandatory-tags.sentinel">Enforce mandatory tags on taggable AWS resources</a> </li> <li>
<a href="https://github.com/hashicorp/terraform-guides/blob/master/governance/third-generation/aws/restrict-availability-zones.sentinel">Restrict availability zones used by EC2 instances</a> </li> <li>
<a href="https://github.com/hashicorp/terraform-guides/blob/master/governance/third-generation/aws/restrict-ingress-sg-rule-cidr-blocks.sentinel">Disallow 0.0.0.0/0 CIDR block in security groups</a> </li> <li>
<a href="https://github.com/hashicorp/terraform-guides/blob/master/governance/third-generation/aws/restrict-ec2-instance-type.sentinel">Restrict instance types of EC2 instances</a> </li> <li>
<a href="https://github.com/hashicorp/terraform-guides/blob/master/governance/third-generation/aws/require-private-acl-and-kms-for-s3-buckets.sentinel">Require S3 buckets to be private and encrypted by KMS keys</a> </li> <li>
<a href="https://github.com/hashicorp/terraform-guides/blob/master/governance/third-generation/aws/require-dns-support-for-vpcs.sentinel">Require VPCs to have DNS hostnames enabled</a> </li> </ul> <h3 id="microsoft-azure">  Microsoft Azure </h3> <ul> <li>
<a href="https://github.com/hashicorp/terraform-guides/blob/master/governance/third-generation/azure/enforce-mandatory-tags.sentinel">Enforce mandatory tags of VMs</a> </li> <li>
<a href="https://github.com/hashicorp/terraform-guides/blob/master/governance/third-generation/azure/restrict-vm-publisher.sentinel">Restrict publishers of VMs</a> </li> <li>
<a href="https://github.com/hashicorp/terraform-guides/blob/master/governance/third-generation/azure/restrict-vm-image-id.sentinel">Restrict VM images</a> </li> <li>
<a href="https://github.com/hashicorp/terraform-guides/blob/master/governance/third-generation/azure/restrict-vm-size.sentinel">Restrict the size of Azure VMs</a> </li> <li>
<a href="https://github.com/hashicorp/terraform-guides/blob/master/governance/third-generation/azure/restrict-aks-clusters.sentinel">Enforce limits on AKS clusters</a> </li> <li>
<a href="https://github.com/hashicorp/terraform-guides/blob/master/governance/third-generation/azure/restrict-inbound-source-address-prefixes.sentinel">Restict CIDR blocks of security groups</a> </li> </ul> <h3 id="google-cloud-platform">  Google Cloud Platform </h3> <ul> <li>
<a href="https://github.com/hashicorp/terraform-guides/blob/master/governance/third-generation/gcp/enforce-mandatory-labels.sentinel">Enforce mandatory labels on VMs</a> </li> <li>
<a href="https://github.com/hashicorp/terraform-guides/blob/master/governance/third-generation/gcp/restrict-ingress-firewall-source-ranges.sentinel">Disallow 0.0.0.0/0 CIDR block in network firewalls</a> </li> <li>
<a href="https://github.com/hashicorp/terraform-guides/blob/master/governance/third-generation/gcp/restrict-gke-clusters.sentinel">Enforce limits on GKE clusters</a> </li> <li>
<a href="https://github.com/hashicorp/terraform-guides/blob/master/governance/third-generation/gcp/restrict-gce-machine-type.sentinel">Restrict machine type of VMs</a> </li> </ul> <h3 id="vmware">  VMware </h3> <ul> <li>
<a href="https://github.com/hashicorp/terraform-guides/blob/master/governance/third-generation/vmware/require-storage-drs.sentinel">Require Storage DRS on datastore clusters</a> </li> <li>
<a href="https://github.com/hashicorp/terraform-guides/blob/master/governance/third-generation/vmware/restrict-virtual-disk-size-and-type.sentinel">Restrict size and type of virtual disks</a> </li> <li>
<a href="https://github.com/hashicorp/terraform-guides/blob/master/governance/third-generation/vmware/restrict-vm-cpu-and-memory.sentinel">Restrict CPU count and memory of VMs</a> </li> <li>
<a href="https://github.com/hashicorp/terraform-guides/blob/master/governance/third-generation/vmware/restrict-vm-disk-size.sentinel">Restrict size of VM disks</a> </li> <li>
<a href="https://github.com/hashicorp/terraform-guides/blob/master/governance/third-generation/vmware/require_nfs41_and_kerberos.sentinel">Require NFS 4.1 and Kerberos on NAS datastores</a> </li> </ul> <h3 id="cloud-agnostic">  Cloud-Agnostic </h3> <ul> <li>
<a href="https://github.com/hashicorp/terraform-guides/blob/master/governance/third-generation/cloud-agnostic/allowed-providers.sentinel">Allowed providers</a> </li> <li>
<a href="https://github.com/hashicorp/terraform-guides/blob/master/governance/third-generation/cloud-agnostic/prohibited-providers.sentinel">Prohibited providers</a> </li> <li>
<a href="https://github.com/hashicorp/terraform-guides/blob/master/governance/third-generation/cloud-agnostic/limit-proposed-monthly-cost.sentinel">Limit proposed monthly costs</a> </li> <li>
<a href="https://github.com/hashicorp/terraform-guides/blob/master/governance/third-generation/cloud-agnostic/prevent-non-root-providers.sentinel">Prevent providers in non-root modules</a> </li> <li>
<a href="https://github.com/hashicorp/terraform-guides/blob/master/governance/third-generation/cloud-agnostic/require-all-modules-have-version-constraint.sentinel">Require all modules have version constraints</a> </li> <li>
<a href="https://github.com/hashicorp/terraform-guides/blob/master/governance/third-generation/cloud-agnostic/require-all-resources-from-pmr.sentinel">Require all resources be created in modules in a private module registry</a> </li> <li>
<a href="https://github.com/hashicorp/terraform-guides/blob/master/governance/third-generation/cloud-agnostic/http-examples/use-latest-module-versions.sentinel">Use most recent versions of modules in a private module registry</a> </li> </ul> <p>Note that the last policy illustrates how to use Sentinel's <a href="https://docs.hashicorp.com/sentinel/imports/http">http import</a> to send an HTTP request to an API endpoint (Terraform Cloud's own API in this case).</p> <blockquote class="alert alert-info" role="alert"> <p><strong>Note:</strong> We've also developed a number of first-class foundational policies to work out-of-the-box with Amazon Web Services, Microsoft Azure and Google Cloud Platform. These policies are based on several <a href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmarks</a>. Check out the library of <a href="https://github.com/hashicorp/terraform-foundational-policies-library">Terraform Foundational Policies</a> written by HashiCorp to get up and running with your next <a href="manage-policies#policies-and-policy-sets">Policy Set</a>.</p> </blockquote><div class="_attribution">
  <p class="_attribution-p">
    <a href="https://www.terraform.io/docs/cloud/sentinel/examples.html" class="_attribution-link" target="_blank">https://www.terraform.io/docs/cloud/sentinel/examples.html</a>
  </p>
</div>
