<p>Meteor runs most app code within Fibers, which allows keeping track of the context a function is running in. <code>Meteor.EnvironmentVariable</code> works with <code>Meteor.bindEnvironment</code>, promises, and many other Meteor APIâ€™s to preserve the context in async code. Some examples of how it is used in Meteor are to store the current user in methods, and record which arguments have been checked when using <code>audit-argument-checks</code>.</p>  <pre class="line-numbers" style><code class="language-js">const currentRequest = new Meteor.EnvironmentVariable();

function log(message) {
  const requestId = currentRequest.get() || 'None';
  console.log(`[${requestId}]`, message);
}


currentRequest.withValue('12345', () =&gt; {
  log('Handling request'); // Logs: [12345] Handling request
});
</code></pre>  <h2 class="api-heading" id="Meteor-EnvironmentVariable"> <div class="locus"> Anywhere </div> <code>new Meteor.EnvironmentVariable()</code> <div class="subtext-api"> <code>import { Meteor } from 'meteor/meteor'</code> <a class="src-code link secondary" href="https://github.com/meteor/meteor/blob/master/packages/meteor/dynamics_nodejs.js#L21" target="_blank"> (meteor/dynamics_nodejs.js, line 21) </a> </div> </h2>   <p>Constructor for EnvironmentVariable</p>     <h2 class="api-heading" id="Meteor-EnvironmentVariable-get"> <div class="locus"> Anywhere </div> <code>Meteor.EnvironmentVariable.get()</code> <div class="subtext-api"> <code>import { Meteor } from 'meteor/meteor'</code> <a class="src-code link secondary" href="https://github.com/meteor/meteor/blob/master/packages/meteor/dynamics_nodejs.js#L27" target="_blank"> (meteor/dynamics_nodejs.js, line 27) </a> </div> </h2>   <p>Return value of environment variable if available</p>     <h2 class="api-heading" id="Meteor-EnvironmentVariable-withValue"> <div class="locus"> Anywhere </div> <code>Meteor.EnvironmentVariable.withValue(value, func)</code> <div class="subtext-api"> <code>import { Meteor } from 'meteor/meteor'</code> <a class="src-code link secondary" href="https://github.com/meteor/meteor/blob/master/packages/meteor/dynamics_nodejs.js#L59" target="_blank"> (meteor/dynamics_nodejs.js, line 59) </a> </div> </h2>   <p>Set the environment variable to the given value while a function is run</p>  <h4 class="subheading">Arguments</h4> <dl class="args"> <dt> <code>value</code> <span class="type">Any</span> </dt> <dd> <p>Value the environment variable should be set to</p> </dd> <dt> <code>func</code> <span class="type">Function</span> </dt> <dd> <p>The function to run</p> </dd> </dl>    <h2 class="api-heading" id="Meteor-bindEnvironment"> <div class="locus"> Anywhere </div> <code>Meteor.bindEnvironment(func, onException, _this)</code> <div class="subtext-api"> <code>import { Meteor } from 'meteor/meteor'</code> <a class="src-code link secondary" href="https://github.com/meteor/meteor/blob/master/packages/meteor/dynamics_nodejs.js#L114" target="_blank"> (meteor/dynamics_nodejs.js, line 114) </a> </div> </h2>   <p>Stores the current Meteor environment variables, and wraps the function to run with the environment variables restored. On the server, the function is wrapped within a fiber.</p>  <h4 class="subheading">Arguments</h4> <dl class="args"> <dt> <code>func</code> <span class="type">Function</span> </dt> <dd> <p>Function that is wrapped</p> </dd> <dt> <code>onException</code> <span class="type">Function</span> </dt>  <dt> <code>_this</code> <span class="type">Object</span> </dt> <dd> <p>Optional <code>this</code> object against which the original function will be invoked</p> </dd> </dl><div class="_attribution">
  <p class="_attribution-p">
    <a href="https://docs.meteor.com/api/environment.html" class="_attribution-link" target="_blank">https://docs.meteor.com/api/environment.html</a>
  </p>
</div>
