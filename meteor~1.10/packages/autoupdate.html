<p>This is the Meteor package that provides hot code push (HCP) functionality.</p> <p>Every Meteor application that wasn’t created with the <code>--minimal</code> option has this package already through <code>meteor-base</code> and HCP should work out of the box. For those running <code>--minimal</code> applications and want to benefit from this package, just add it with <code>meteor add autoupdate</code>.</p> <blockquote> <p><code>autoupdate</code> adds up to 30KB on your client’s production bundle.</p> </blockquote> <p>With this package Meteor will use DDP to publish a collection called <em>‘meteor_autoupdate_clientVersions’</em>. This collection will be subscribed by the user’s client and every time the client identifies a change in the published version it will refresh itself.</p> <h2 id="Browser-Client">Browser Client</h2>
<p>The refresh will happen in the browser in two different ways: a <em>soft update</em>, and a <em>hard update</em>. If Meteor identifies that only stylesheets were changed, then it will verify if the user’s browser is capable of reloading CSS on the fly, and a soft update will take place. The soft update will replace the old stylesheet with the new stylesheet without triggering a full page reload. </p> <p>In cases where a change in a server’s or client’s compiled file happens, the hard update will take place: Meteor will force a complete browser reload using the <code>reload</code> package.</p> <blockquote> <p>Among other things, the <code>reload</code> package tries do reload the application preserving some unchanged cached files.</p> </blockquote> <h2 id="Cordova-Client">Cordova Client</h2>
<p>There is no soft update with Cordova apps, the client is always fully refreshed once a change is detected.</p> <h3 id="usesCleartextTraffic">
<code>usesCleartextTraffic</code>
</h3>
<p>Starting with Android 9 (API level 28), <a href="https://developer.android.com/training/articles/security-config" target="_blank" rel="noopener">cleartext support is disabled</a> by default. During development <code>autoupdate</code> uses cleartext to publish new client versions. If your app targets Android 9 or greater, it will be necessary to create a <code>mobile-config.js</code> file enabling the use of cleartext in order to have HCP working: </p>  <pre class="line-numbers" style><code class="language-js">App.appendToConfig(`&lt;edit-config file="app/src/main/AndroidManifest.xml"
                     mode="merge"
                     target="/manifest/application"
                     xmlns:android="http://schemas.android.com/apk/res/android"&gt;
        &lt;application android:usesCleartextTraffic="true"&gt;&lt;/application&gt;
    &lt;/edit-config&gt;
`);
</code></pre> <h3 id="mobile-server">
<code>--mobile-server</code>
</h3>
<p>Additionally, for the HCP functionality to work it is also mandatory to provide the address for the application server with <code>--mobile-server</code> option. If you’re testing your app on an emulator you should run it with <code>meteor run android --mobile-server 10.0.2.2:3000</code>. If you’re running it on a real device, the application server and the device should be on the same network, and you should run your app with <code>meteor run android --mobile-server XXX.XXX.XXX.XXX</code> where <em>XXX.XXX.XXX.XXX</em> is your local development address, <em>e.g. 192.168.1.4</em>.</p> <blockquote> <p>To have a better understanding of how HCP works for mobile apps already published to production refer to <a href="https://guide.meteor.com/cordova.html#hot-code-push" target="_blank" rel="noopener">Hot code push on mobile</a></p> </blockquote><div class="_attribution">
  <p class="_attribution-p">
    <a href="https://docs.meteor.com/packages/autoupdate.html" class="_attribution-link" target="_blank">https://docs.meteor.com/packages/autoupdate.html</a>
  </p>
</div>
