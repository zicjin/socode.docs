<h1 id="class-Net::IMAP" class="class"> class Net::IMAP </h1>
<dl class="meta">
<dt>Parent:</dt>
<dd class="meta-parent">Protocol</dd>
<dt>Included modules:</dt>
<dd class="meta-includes">
<a class="include" href="../monitormixin">MonitorMixin</a>, <a class="include" href="../openssl">OpenSSL</a>, <a class="include" href="../openssl/ssl">OpenSSL::SSL</a>
</dd>
</dl> <section class="description"> <p><a href="imap"><code>Net::IMAP</code></a> implements Internet Message Access Protocol (<a href="imap"><code>IMAP</code></a>) client functionality. The protocol is described in [IMAP].</p> <h2 id="class-Net::IMAP-label-IMAP+Overview">
<a href="imap"><code>IMAP</code></a> Overview</h2> <p>An <a href="imap"><code>IMAP</code></a> client connects to a server, and then authenticates itself using either <a href="imap#method-i-authenticate"><code>authenticate()</code></a> or <a href="imap#method-i-login"><code>login()</code></a>. Having authenticated itself, there is a range of commands available to it. Most work with mailboxes, which may be arranged in an hierarchical namespace, and each of which contains zero or more messages. How this is implemented on the server is implementation-dependent; on a UNIX server, it will frequently be implemented as files in mailbox format within a hierarchy of directories.</p> <p>To work on the messages within a mailbox, the client must first select that mailbox, using either <a href="imap#method-i-select"><code>select()</code></a> or (for read-only access) <a href="imap#method-i-examine"><code>examine()</code></a>. Once the client has successfully selected a mailbox, they enter <em>selected</em> state, and that mailbox becomes the <em>current</em> mailbox, on which mail-item related commands implicitly operate.</p> <p>Messages have two sorts of identifiers: message sequence numbers and UIDs.</p> <p>Message sequence numbers number messages within a mailbox from 1 up to the number of items in the mailbox. If a new message arrives during a session, it receives a sequence number equal to the new size of the mailbox. If messages are expunged from the mailbox, remaining messages have their sequence numbers “shuffled down” to fill the gaps.</p> <p>UIDs, on the other hand, are permanently guaranteed not to identify another message within the same mailbox, even if the existing message is deleted. UIDs are required to be assigned in ascending (but not necessarily sequential) order within a mailbox; this means that if a non-IMAP client rearranges the order of mailitems within a mailbox, the UIDs have to be reassigned. An <a href="imap"><code>IMAP</code></a> client thus cannot rearrange message orders.</p> <h2 id="class-Net::IMAP-label-Examples+of+Usage">Examples of Usage</h2> <h3 id="class-Net::IMAP-label-List+sender+and+subject+of+all+recent+messages+in+the+default+mailbox">List sender and subject of all recent messages in the default mailbox</h3> <pre class="ruby" data-language="ruby">imap = Net::IMAP.new('mail.example.com')
imap.authenticate('LOGIN', 'joe_user', 'joes_password')
imap.examine('INBOX')
imap.search(["RECENT"]).each do |message_id|
  envelope = imap.fetch(message_id, "ENVELOPE")[0].attr["ENVELOPE"]
  puts "#{envelope.from[0].name}: \t#{envelope.subject}"
end
</pre> <h3 id="class-Net::IMAP-label-Move+all+messages+from+April+2003+from+-22Mail-2Fsent-mail-22+to+-22Mail-2Fsent-apr03-22">Move all messages from April 2003 from “Mail/sent-mail” to “Mail/sent-apr03”</h3> <pre class="ruby" data-language="ruby">imap = Net::IMAP.new('mail.example.com')
imap.authenticate('LOGIN', 'joe_user', 'joes_password')
imap.select('Mail/sent-mail')
if not imap.list('Mail/', 'sent-apr03')
  imap.create('Mail/sent-apr03')
end
imap.search(["BEFORE", "30-Apr-2003", "SINCE", "1-Apr-2003"]).each do |message_id|
  imap.copy(message_id, "Mail/sent-apr03")
  imap.store(message_id, "+FLAGS", [:Deleted])
end
imap.expunge
</pre> <h2 id="class-Net::IMAP-label-Thread+Safety">
<a href="../thread"><code>Thread</code></a> Safety</h2> <p><a href="imap"><code>Net::IMAP</code></a> supports concurrent threads. For example,</p> <pre class="ruby" data-language="ruby">imap = Net::IMAP.new("imap.foo.net", "imap2")
imap.authenticate("cram-md5", "bar", "password")
imap.select("inbox")
fetch_thread = Thread.start { imap.fetch(1..-1, "UID") }
search_result = imap.search(["BODY", "hello"])
fetch_result = fetch_thread.value
imap.disconnect
</pre> <p>This script invokes the FETCH command and the SEARCH command concurrently.</p> <h2 id="class-Net::IMAP-label-Errors">Errors</h2> <p>An <a href="imap"><code>IMAP</code></a> server can send three different types of responses to indicate failure:</p> <dl class="rdoc-list note-list">
<dt>NO </dt>
<dd> <p>the attempted command could not be successfully completed. For instance, the username/password used for logging in are incorrect; the selected mailbox does not exist; etc.</p> </dd>
<dt>BAD </dt>
<dd> <p>the request from the client does not follow the server's understanding of the <a href="imap"><code>IMAP</code></a> protocol. This includes attempting commands from the wrong client state; for instance, attempting to perform a SEARCH command without having SELECTed a current mailbox. It can also signal an internal server failure (such as a disk crash) has occurred.</p> </dd>
<dt>BYE </dt>
<dd> <p>the server is saying goodbye. This can be part of a normal logout sequence, and can be used as part of a login sequence to indicate that the server is (for some reason) unwilling to accept your connection. As a response to any other command, it indicates either that the server is shutting down, or that the server is timing out the client connection due to inactivity.</p> </dd>
</dl> <p>These three error response are represented by the errors <a href="imap/noresponseerror"><code>Net::IMAP::NoResponseError</code></a>, <a href="imap/badresponseerror"><code>Net::IMAP::BadResponseError</code></a>, and <a href="imap/byeresponseerror"><code>Net::IMAP::ByeResponseError</code></a>, all of which are subclasses of <a href="imap/responseerror"><code>Net::IMAP::ResponseError</code></a>. Essentially, all methods that involve sending a request to the server can generate one of these errors. Only the most pertinent instances have been documented below.</p> <p>Because the <a href="imap"><code>IMAP</code></a> class uses Sockets for communication, its methods are also susceptible to the various errors that can occur when working with sockets. These are generally represented as <a href="../errno"><code>Errno</code></a> errors. For instance, any method that involves sending a request to the server and/or receiving a response from it could raise an Errno::EPIPE error if the network connection unexpectedly goes down. See the socket(7), ip(7), tcp(7), socket(2), connect(2), and associated man pages.</p> <p>Finally, a <a href="imap/dataformaterror"><code>Net::IMAP::DataFormatError</code></a> is thrown if low-level data is found to be in an incorrect format (for instance, when converting between UTF-8 and UTF-16), and <a href="imap/responseparseerror"><code>Net::IMAP::ResponseParseError</code></a> is thrown if a server response is non-parseable.</p> <h2 id="class-Net::IMAP-label-References">References</h2> <dl class="rdoc-list label-list">
<dt>[IMAP] </dt>
<dd>
<ol style="list-style-type: upper-alpha"><li> <p>Crispin, “INTERNET MESSAGE ACCESS PROTOCOL - <a href="imap#VERSION"><code>VERSION</code></a> 4rev1”,</p> </li></ol> <p>RFC 2060, December 1996. (Note: since obsoleted by RFC 3501)</p> </dd>
<dt>[LANGUAGE-TAGS] </dt>
<dd> <p>Alvestrand, H., “Tags for the Identification of Languages”, RFC 1766, March 1995.</p> </dd>
<dt>[MD5] </dt>
<dd> <p>Myers, J., and M. Rose, “The Content-MD5 Header Field”, RFC 1864, October 1995.</p> </dd>
<dt>[MIME-IMB] </dt>
<dd> <p>Freed, N., and N. Borenstein, “MIME (Multipurpose Internet Mail Extensions) Part One: Format of Internet Message Bodies”, RFC 2045, November 1996.</p> </dd>
<dt>[RFC-822] </dt>
<dd> <p>Crocker, D., “Standard for the Format of ARPA Internet Text Messages”, STD 11, RFC 822, University of Delaware, August 1982.</p> </dd>
<dt>[RFC-2087] </dt>
<dd> <p>Myers, J., “IMAP4 QUOTA extension”, RFC 2087, January 1997.</p> </dd>
<dt>[RFC-2086] </dt>
<dd> <p>Myers, J., “IMAP4 <a href="../acl"><code>ACL</code></a> extension”, RFC 2086, January 1997.</p> </dd>
<dt>[RFC-2195] </dt>
<dd> <p>Klensin, J., Catoe, R., and Krumviede, P., “IMAP/POP AUTHorize Extension for Simple Challenge/Response”, RFC 2195, September 1997.</p> </dd>
<dt>[SORT-THREAD-EXT] </dt>
<dd> <p>Crispin, M., “INTERNET MESSAGE ACCESS PROTOCOL - SORT and THREAD Extensions”, draft-ietf-imapext-sort, May 2003.</p> </dd>
<dt>[OSSL] </dt>
<dd> <p><a href="http://www.openssl.org">www.openssl.org</a></p> </dd>
<dt>[RSSL] </dt>
<dd> <p><a href="http://savannah.gnu.org/projects/rubypki">savannah.gnu.org/projects/rubypki</a></p> </dd>
<dt>[UTF7] </dt>
<dd> <p>Goldsmith, D. and Davis, M., “UTF-7: A Mail-Safe Transformation Format of Unicode”, RFC 2152, May 1997.</p> </dd>
</dl> </section> <section id="5Buntitled-5D" class="documentation-section"> <section class="constants-list"> <header> <h3>Constants</h3> </header> <dl> <dt id="ANSWERED">ANSWERED </dt>
<dd>
<p>Flag indicating a message has been answered.</p> </dd>
<dt id="Address">Address </dt>
<dd>
<p><a href="imap#Address"><code>Net::IMAP::Address</code></a> represents electronic mail addresses.</p> <h4 id="label-Fields-3A">Fields:</h4> <dl class="rdoc-list note-list">
<dt>name </dt>
<dd> <p>Returns the phrase from [RFC-822] mailbox.</p> </dd>
<dt>route </dt>
<dd> <p>Returns the route from [RFC-822] route-addr.</p> </dd>
<dt>mailbox </dt>
<dd> <p>nil indicates end of [RFC-822] group. If non-nil and host is nil, returns [RFC-822] group name. Otherwise, returns [RFC-822] local-part.</p> </dd>
<dt>host </dt>
<dd> <p>nil indicates [RFC-822] group syntax. Otherwise, returns [RFC-822] domain name.</p> </dd>
</dl> </dd>
<dt id="ContentDisposition">ContentDisposition </dt>
<dd>
<p><a href="imap#ContentDisposition"><code>Net::IMAP::ContentDisposition</code></a> represents Content-Disposition fields.</p> <h4 id="label-Fields-3A">Fields:</h4> <dl class="rdoc-list note-list">
<dt>dsp_type </dt>
<dd> <p>Returns the disposition type.</p> </dd>
<dt>param </dt>
<dd> <p>Returns a hash that represents parameters of the Content-Disposition field.</p> </dd>
</dl> </dd>
<dt id="ContinuationRequest">ContinuationRequest </dt>
<dd>
<p><a href="imap#ContinuationRequest"><code>Net::IMAP::ContinuationRequest</code></a> represents command continuation requests.</p> <p>The command continuation request response is indicated by a “+” token instead of a tag. This form of response indicates that the server is ready to accept the continuation of a command from the client. The remainder of this response is a line of text.</p> <pre>continue_req    ::= "+" SPACE (resp_text / base64)</pre> <h4 id="label-Fields-3A">Fields:</h4> <dl class="rdoc-list note-list">
<dt>data </dt>
<dd> <p>Returns the data (<a href="imap#ResponseText"><code>Net::IMAP::ResponseText</code></a>).</p> </dd>
<dt>raw_data </dt>
<dd> <p>Returns the raw data string.</p> </dd>
</dl> </dd>
<dt id="DATE_MONTH">DATE_MONTH </dt>

<dt id="DELETED">DELETED </dt>
<dd>
<p>Flag indicating a message has been marked for deletion. This will occur when the mailbox is closed or expunged.</p> </dd>
<dt id="DRAFT">DRAFT </dt>
<dd>
<p>Flag indicating a message is only a draft or work-in-progress version.</p> </dd>
<dt id="Envelope">Envelope </dt>
<dd>
<p><a href="imap#Envelope"><code>Net::IMAP::Envelope</code></a> represents envelope structures of messages.</p> <h4 id="label-Fields-3A">Fields:</h4> <dl class="rdoc-list note-list">
<dt>date </dt>
<dd> <p>Returns a string that represents the date.</p> </dd>
<dt>subject </dt>
<dd> <p>Returns a string that represents the subject.</p> </dd>
<dt>from </dt>
<dd> <p>Returns an array of <a href="imap#Address"><code>Net::IMAP::Address</code></a> that represents the from.</p> </dd>
<dt>sender </dt>
<dd> <p>Returns an array of <a href="imap#Address"><code>Net::IMAP::Address</code></a> that represents the sender.</p> </dd>
<dt>reply_to </dt>
<dd> <p>Returns an array of <a href="imap#Address"><code>Net::IMAP::Address</code></a> that represents the reply-to.</p> </dd>
<dt>to </dt>
<dd> <p>Returns an array of <a href="imap#Address"><code>Net::IMAP::Address</code></a> that represents the to.</p> </dd>
<dt>cc </dt>
<dd> <p>Returns an array of <a href="imap#Address"><code>Net::IMAP::Address</code></a> that represents the cc.</p> </dd>
<dt>bcc </dt>
<dd> <p>Returns an array of <a href="imap#Address"><code>Net::IMAP::Address</code></a> that represents the bcc.</p> </dd>
<dt>in_reply_to </dt>
<dd> <p>Returns a string that represents the in-reply-to.</p> </dd>
<dt>message_id </dt>
<dd> <p>Returns a string that represents the message-id.</p> </dd>
</dl> </dd>
<dt id="FLAGGED">FLAGGED </dt>
<dd>
<p>Flag indicating a message has been flagged for special or urgent attention.</p> </dd>
<dt id="FetchData">FetchData </dt>
<dd>
<p><a href="imap#FetchData"><code>Net::IMAP::FetchData</code></a> represents the contents of the FETCH response.</p> <h4 id="label-Fields-3A">Fields:</h4> <dl class="rdoc-list note-list">
<dt>seqno </dt>
<dd> <p>Returns the message sequence number. (Note: not the unique identifier, even for the UID command response.)</p> </dd>
<dt>attr </dt>
<dd> <p>Returns a hash. Each key is a data item name, and each value is its value.</p> <p>The current data items are:</p> <dl class="rdoc-list label-list">
<dt>BODY </dt>
<dd> <p>A form of BODYSTRUCTURE without extension data.</p> </dd>
<dt>
<a href="#" imap><code>Net::IMAP::BodyTypeBasic</code></a>, <a href="imap/bodytypetext"><code>Net::IMAP::BodyTypeText</code></a>, <a href="imap/bodytypemessage"><code>Net::IMAP::BodyTypeMessage</code></a>, <a href="imap/bodytypemultipart"><code>Net::IMAP::BodyTypeMultipart</code></a>. </dt>
</dl>
</dd>
<dt>ENVELOPE </dt>
<dd> <p>A <a href="imap#Envelope"><code>Net::IMAP::Envelope</code></a> object that describes the envelope structure of a message.</p> </dd>
<dt>FLAGS </dt>
<dd> <p>A array of flag symbols that are set for this message. Flag symbols are capitalized by <a href="../string#method-i-capitalize"><code>String#capitalize</code></a>.</p> </dd>
<dt>INTERNALDATE </dt>
<dd> <p>A string representing the internal date of the message.</p> </dd>
<dt>RFC822 </dt>
<dd> <p>Equivalent to BODY[].</p> </dd>
<dt>RFC822.HEADER </dt>
<dd> <p>Equivalent to <span>BODY.PEEK</span>.</p> </dd>
<dt>RFC822.SIZE </dt>
<dd> <p>A number expressing the [RFC-822] size of the message.</p> </dd>
<dt>RFC822.TEXT </dt>
<dd> <p>Equivalent to <span>BODY</span>.</p> </dd>
<dt>UID </dt>
<dd> <p>A number expressing the unique identifier of the message.</p> </dd>
</dl> </dd>
</dl> <dt id="MARKED">MARKED </dt>
<dd>
<p>Flag indicating that a mailbox has been marked “interesting” by the server; this commonly indicates that the mailbox contains new messages.</p> </dd>
<dt id="MailboxACLItem">MailboxACLItem </dt>
<dd>
<p><a href="imap#MailboxACLItem"><code>Net::IMAP::MailboxACLItem</code></a> represents the response from GETACL.</p> <pre>acl_data        ::= "ACL" SPACE mailbox *(SPACE identifier SPACE rights)

identifier      ::= astring

rights          ::= astring</pre> <h4 id="label-Fields-3A">Fields:</h4> <dl class="rdoc-list note-list">
<dt>user </dt>
<dd> <p>Login name that has certain rights to the mailbox that was specified with the getacl command.</p> </dd>
<dt>rights </dt>
<dd> <p>The access rights the indicated user has to the mailbox.</p> </dd>
</dl> </dd>
<dt id="MailboxList">MailboxList </dt>
<dd>
<p><a href="imap#MailboxList"><code>Net::IMAP::MailboxList</code></a> represents contents of the LIST response.</p> <pre>mailbox_list    ::= "(" #("\Marked" / "\Noinferiors" /
                    "\Noselect" / "\Unmarked" / flag_extension) ")"
                    SPACE (&lt;"&gt; QUOTED_CHAR &lt;"&gt; / nil) SPACE mailbox</pre> <h4 id="label-Fields-3A">Fields:</h4> <dl class="rdoc-list note-list">
<dt>attr </dt>
<dd> <p>Returns the name attributes. Each name attribute is a symbol capitalized by <a href="../string#method-i-capitalize"><code>String#capitalize</code></a>, such as :Noselect (not :NoSelect).</p> </dd>
<dt>delim </dt>
<dd> <p>Returns the hierarchy delimiter.</p> </dd>
<dt>name </dt>
<dd> <p>Returns the mailbox name.</p> </dd>
</dl> </dd>
<dt id="MailboxQuota">MailboxQuota </dt>
<dd>
<p><a href="imap#MailboxQuota"><code>Net::IMAP::MailboxQuota</code></a> represents contents of GETQUOTA response. This object can also be a response to GETQUOTAROOT. In the syntax specification below, the delimiter used with the “#” construct is a single space (SPACE).</p> <pre>quota_list      ::= "(" #quota_resource ")"

quota_resource  ::= atom SPACE number SPACE number

quota_response  ::= "QUOTA" SPACE astring SPACE quota_list</pre> <h4 id="label-Fields-3A">Fields:</h4> <dl class="rdoc-list note-list">
<dt>mailbox </dt>
<dd> <p>The mailbox with the associated quota.</p> </dd>
<dt>usage </dt>
<dd> <p>Current storage usage of the mailbox.</p> </dd>
<dt>quota </dt>
<dd> <p>Quota limit imposed on the mailbox.</p> </dd>
</dl> </dd>
<dt id="MailboxQuotaRoot">MailboxQuotaRoot </dt>
<dd>
<p><a href="imap#MailboxQuotaRoot"><code>Net::IMAP::MailboxQuotaRoot</code></a> represents part of the GETQUOTAROOT response. (GETQUOTAROOT can also return <a href="imap#MailboxQuota"><code>Net::IMAP::MailboxQuota</code></a>.)</p> <pre>quotaroot_response ::= "QUOTAROOT" SPACE astring *(SPACE astring)</pre> <h4 id="label-Fields-3A">Fields:</h4> <dl class="rdoc-list note-list">
<dt>mailbox </dt>
<dd> <p>The mailbox with the associated quota.</p> </dd>
<dt>quotaroots </dt>
<dd> <p>Zero or more quotaroots that affect the quota on the specified mailbox.</p> </dd>
</dl> </dd>
<dt id="NOINFERIORS">NOINFERIORS </dt>
<dd>
<p>Flag indicating that a mailbox context name cannot contain children.</p> </dd>
<dt id="NOSELECT">NOSELECT </dt>
<dd>
<p>Flag indicating that a mailbox is not selected.</p> </dd>
<dt id="RECENT">RECENT </dt>
<dd>
<p>Flag indicating that the message is “recent,” meaning that this session is the first session in which the client has been notified of this message.</p> </dd>
<dt id="RESPONSE_ERRORS">RESPONSE_ERRORS </dt>

<dt id="ResponseCode">ResponseCode </dt>
<dd>
<p><a href="imap#ResponseCode"><code>Net::IMAP::ResponseCode</code></a> represents response codes.</p> <pre>resp_text_code  ::= "ALERT" / "PARSE" /
                    "PERMANENTFLAGS" SPACE "(" #(flag / "\*") ")" /
                    "READ-ONLY" / "READ-WRITE" / "TRYCREATE" /
                    "UIDVALIDITY" SPACE nz_number /
                    "UNSEEN" SPACE nz_number /
                    atom [SPACE 1*&lt;any TEXT_CHAR except "]"&gt;]</pre> <h4 id="label-Fields-3A">Fields:</h4> <dl class="rdoc-list note-list">
<dt>name </dt>
<dd> <p>Returns the name, such as “ALERT”, “PERMANENTFLAGS”, or “UIDVALIDITY”.</p> </dd>
<dt>data </dt>
<dd> <p>Returns the data, if it exists.</p> </dd>
</dl> </dd>
<dt id="ResponseText">ResponseText </dt>
<dd>
<p><a href="imap#ResponseText"><code>Net::IMAP::ResponseText</code></a> represents texts of responses. The text may be prefixed by the response code.</p> <pre>resp_text       ::= ["[" resp_text_code "]" SPACE] (text_mime2 / text)
                    ;; text SHOULD NOT begin with "[" or "="</pre> <h4 id="label-Fields-3A">Fields:</h4> <dl class="rdoc-list note-list">
<dt>code </dt>
<dd> <p>Returns the response code. See ((&lt;Net::IMAP::ResponseCode&gt;)).</p> </dd>
<dt>text </dt>
<dd> <p>Returns the text.</p> </dd>
</dl> </dd>
<dt id="SEEN">SEEN </dt>
<dd>
<p>Flag indicating a message has been seen.</p> </dd>
<dt id="StatusData">StatusData </dt>
<dd>
<p><a href="imap#StatusData"><code>Net::IMAP::StatusData</code></a> represents the contents of the STATUS response.</p> <h4 id="label-Fields-3A">Fields:</h4> <dl class="rdoc-list note-list">
<dt>mailbox </dt>
<dd> <p>Returns the mailbox name.</p> </dd>
<dt>attr </dt>
<dd> <p>Returns a hash. Each key is one of “MESSAGES”, “RECENT”, “UIDNEXT”, “UIDVALIDITY”, “UNSEEN”. Each value is a number.</p> </dd>
</dl> </dd>
<dt id="TaggedResponse">TaggedResponse </dt>
<dd>
<p><a href="imap#TaggedResponse"><code>Net::IMAP::TaggedResponse</code></a> represents tagged responses.</p> <p>The server completion result response indicates the success or failure of the operation. It is tagged with the same tag as the client command which began the operation.</p> <pre>response_tagged ::= tag SPACE resp_cond_state CRLF

tag             ::= 1*&lt;any ATOM_CHAR except "+"&gt;

resp_cond_state ::= ("OK" / "NO" / "BAD") SPACE resp_text</pre> <h4 id="label-Fields-3A">Fields:</h4> <dl class="rdoc-list note-list">
<dt>tag </dt>
<dd> <p>Returns the tag.</p> </dd>
<dt>name </dt>
<dd> <p>Returns the name, one of “OK”, “NO”, or “BAD”.</p> </dd>
<dt>data </dt>
<dd> <p>Returns the data. See ((&lt;Net::IMAP::ResponseText&gt;)).</p> </dd>
<dt>raw_data </dt>
<dd> <p>Returns the raw data string.</p> </dd>
</dl> </dd>
<dt id="ThreadMember">ThreadMember </dt>
<dd>
<p><a href="imap#ThreadMember"><code>Net::IMAP::ThreadMember</code></a> represents a thread-node returned by <a href="imap#method-i-thread"><code>Net::IMAP#thread</code></a>.</p> <h4 id="label-Fields-3A">Fields:</h4> <dl class="rdoc-list note-list">
<dt>seqno </dt>
<dd> <p>The sequence number of this message.</p> </dd>
<dt>children </dt>
<dd> <p>An array of <a href="imap#ThreadMember"><code>Net::IMAP::ThreadMember</code></a> objects for mail items that are children of this in the thread.</p> </dd>
</dl> </dd>
<dt id="UNMARKED">UNMARKED </dt>
<dd>
<p>Flag indicating that the mailbox does not contains new messages.</p> </dd>
<dt id="UntaggedResponse">UntaggedResponse </dt>
<dd>
<p><a href="imap#UntaggedResponse"><code>Net::IMAP::UntaggedResponse</code></a> represents untagged responses.</p> <p>Data transmitted by the server to the client and status responses that do not indicate command completion are prefixed with the token “*”, and are called untagged responses.</p> <pre>response_data   ::= "*" SPACE (resp_cond_state / resp_cond_bye /
                    mailbox_data / message_data / capability_data)</pre> <h4 id="label-Fields-3A">Fields:</h4> <dl class="rdoc-list note-list">
<dt>name </dt>
<dd> <p>Returns the name, such as “FLAGS”, “LIST”, or “FETCH”.</p> </dd>
<dt>data </dt>
<dd> <p>Returns the data such as an array of flag symbols, a ((&lt;Net::IMAP::MailboxList&gt;)) object.</p> </dd>
<dt>raw_data </dt>
<dd> <p>Returns the raw data string.</p> </dd>
</dl> </dd>
<dt id="VERSION">VERSION </dt>
</section> <section class="attribute-method-details"> <header> <h3>Attributes</h3> </header> <div class="method-detail"> <div class="method-heading attribute-method-heading" id="attribute-i-client_thread"> <span class="method-name">client_thread</span><span class="attribute-access-type">[RW]</span> </div> <div class="method-description"> <p>The thread to receive exceptions.</p> </div> </div> <div class="method-detail"> <div class="method-heading attribute-method-heading" id="attribute-i-greeting"> <span class="method-name">greeting</span><span class="attribute-access-type">[R]</span> </div> <div class="method-description"> <p>Returns an initial greeting response from the server.</p> </div> </div> <div class="method-detail"> <div class="method-heading attribute-method-heading" id="attribute-i-open_timeout"> <span class="method-name">open_timeout</span><span class="attribute-access-type">[R]</span> </div> <div class="method-description"> <p>Seconds to wait until a connection is opened. If the <a href="imap"><code>IMAP</code></a> object cannot open a connection within this time, it raises a <a href="opentimeout"><code>Net::OpenTimeout</code></a> exception. The default value is 30 seconds.</p> </div> </div> <div class="method-detail"> <div class="method-heading attribute-method-heading" id="attribute-i-response_handlers"> <span class="method-name">response_handlers</span><span class="attribute-access-type">[R]</span> </div> <div class="method-description"> <p>Returns all response handlers.</p> </div> </div> <div class="method-detail"> <div class="method-heading attribute-method-heading" id="attribute-i-responses"> <span class="method-name">responses</span><span class="attribute-access-type">[R]</span> </div> <div class="method-description"> <p>Returns recorded untagged responses. For example:</p> <pre class="ruby" data-language="ruby">imap.select("inbox")
p imap.responses["EXISTS"][-1]
#=&gt; 2
p imap.responses["UIDVALIDITY"][-1]
#=&gt; 968263756
</pre> </div> </div> </section> <section id="public-class-5Buntitled-5D-method-details" class="method-section"> <header> <h3>Public Class Methods</h3> </header> <div class="method-detail "> <div class="method-heading" id="method-c-add_authenticator"> <span class="method-name">add_authenticator</span><span class="method-args">(auth_type, authenticator)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="add_authenticator-source"> <pre class="ruby" data-language="ruby"># File lib/net/imap.rb, line 303
def self.add_authenticator(auth_type, authenticator)
  @@authenticators[auth_type] = authenticator
end</pre> </div> <p>Adds an authenticator for <a href="imap#method-i-authenticate"><code>Net::IMAP#authenticate</code></a>. <code>auth_type</code> is the type of authentication this authenticator supports (for instance, “LOGIN”). The <code>authenticator</code> is an object which defines a process() method to handle authentication with the server. See <a href="imap/loginauthenticator"><code>Net::IMAP::LoginAuthenticator</code></a>, <a href="imap/crammd5authenticator"><code>Net::IMAP::CramMD5Authenticator</code></a>, and <a href="imap/digestmd5authenticator"><code>Net::IMAP::DigestMD5Authenticator</code></a> for examples.</p> <p>If <code>auth_type</code> refers to an existing authenticator, it will be replaced by the new one.</p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-c-debug"> <span class="method-name">debug</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="debug-source"> <pre class="ruby" data-language="ruby"># File lib/net/imap.rb, line 273
def self.debug
  return @@debug
end</pre> </div> <p>Returns the debug mode.</p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-c-debug-3D"> <span class="method-name">debug=</span><span class="method-args">(val)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="debug-3D-source"> <pre class="ruby" data-language="ruby"># File lib/net/imap.rb, line 278
def self.debug=(val)
  return @@debug = val
end</pre> </div> <p>Sets the debug mode.</p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-c-decode_utf7"> <span class="method-name">decode_utf7</span><span class="method-args">(s)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="decode_utf7-source"> <pre class="ruby" data-language="ruby"># File lib/net/imap.rb, line 1002
def self.decode_utf7(s)
  return s.gsub(/&amp;([^-]+)?-/n) {
    if $1
      ($1.tr(",", "/") + "===").unpack1("m").encode(Encoding::UTF_8, Encoding::UTF_16BE)
    else
      "&amp;"
    end
  }
end</pre> </div> <p>Decode a string from modified UTF-7 format to UTF-8.</p> <p>UTF-7 is a 7-bit encoding of Unicode [UTF7]. <a href="imap"><code>IMAP</code></a> uses a slightly modified version of this to encode mailbox names containing non-ASCII characters; see [IMAP] section 5.1.3.</p> <p><a href="imap"><code>Net::IMAP</code></a> does <em>not</em> automatically encode and decode mailbox names to and from UTF-7.</p>  </div> </div> <div class="method-detail method-alias"> <div class="method-heading" id="method-c-default_imap_port"> <span class="method-name">default_imap_port</span><span class="method-args">()</span> </div>  <div class="aliases"> Alias for: <a href="imap#method-c-default_port">default_port</a> </div> </div> <div class="method-detail method-alias"> <div class="method-heading" id="method-c-default_imaps_port"> <span class="method-name">default_imaps_port</span><span class="method-args">()</span> </div>  <div class="aliases"> Alias for: <a href="imap#method-c-default_tls_port">default_tls_port</a> </div> </div> <div class="method-detail "> <div class="method-heading" id="method-c-default_port"> <span class="method-name">default_port</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="default_port-source"> <pre class="ruby" data-language="ruby"># File lib/net/imap.rb, line 308
def self.default_port
  return PORT
end</pre> </div> <p>The default port for <a href="imap"><code>IMAP</code></a> connections, port 143</p>  </div> <div class="aliases"> Also aliased as: <a href="imap#method-c-default_imap_port">default_imap_port</a> </div> </div> <div class="method-detail method-alias"> <div class="method-heading" id="method-c-default_ssl_port"> <span class="method-name">default_ssl_port</span><span class="method-args">()</span> </div>  <div class="aliases"> Alias for: <a href="imap#method-c-default_tls_port">default_tls_port</a> </div> </div> <div class="method-detail "> <div class="method-heading" id="method-c-default_tls_port"> <span class="method-name">default_tls_port</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="default_tls_port-source"> <pre class="ruby" data-language="ruby"># File lib/net/imap.rb, line 313
def self.default_tls_port
  return SSL_PORT
end</pre> </div> <p>The default port for IMAPS connections, port 993</p>  </div> <div class="aliases"> Also aliased as: <a href="imap#method-c-default_imaps_port">default_imaps_port</a>, <a href="imap#method-c-default_ssl_port">default_ssl_port</a> </div> </div> <div class="method-detail "> <div class="method-heading" id="method-c-encode_utf7"> <span class="method-name">encode_utf7</span><span class="method-args">(s)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="encode_utf7-source"> <pre class="ruby" data-language="ruby"># File lib/net/imap.rb, line 1013
def self.encode_utf7(s)
  return s.gsub(/(&amp;)|[^\x20-\x7e]+/) {
    if $1
      "&amp;-"
    else
      base64 = [$&amp;.encode(Encoding::UTF_16BE)].pack("m0")
      "&amp;" + base64.delete("=").tr("/", ",") + "-"
    end
  }.force_encoding("ASCII-8BIT")
end</pre> </div> <p>Encode a string from UTF-8 format to modified UTF-7.</p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-c-format_date"> <span class="method-name">format_date</span><span class="method-args">(time)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="format_date-source"> <pre class="ruby" data-language="ruby"># File lib/net/imap.rb, line 1025
def self.format_date(time)
  return time.strftime('%d-%b-%Y')
end</pre> </div> <p>Formats <code>time</code> as an IMAP-style date.</p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-c-format_datetime"> <span class="method-name">format_datetime</span><span class="method-args">(time)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="format_datetime-source"> <pre class="ruby" data-language="ruby"># File lib/net/imap.rb, line 1030
def self.format_datetime(time)
  return time.strftime('%d-%b-%Y %H:%M %z')
end</pre> </div> <p>Formats <code>time</code> as an IMAP-style date-time.</p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-c-max_flag_count"> <span class="method-name">max_flag_count</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="max_flag_count-source"> <pre class="ruby" data-language="ruby"># File lib/net/imap.rb, line 283
def self.max_flag_count
  return @@max_flag_count
end</pre> </div> <p>Returns the max number of flags interned to symbols.</p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-c-max_flag_count-3D"> <span class="method-name">max_flag_count=</span><span class="method-args">(count)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="max_flag_count-3D-source"> <pre class="ruby" data-language="ruby"># File lib/net/imap.rb, line 288
def self.max_flag_count=(count)
  @@max_flag_count = count
end</pre> </div> <p>Sets the max number of flags interned to symbols.</p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-c-new"> <span class="method-callseq"> Net::IMAP.new(host, options = {}) </span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="new-source"> <pre class="ruby" data-language="ruby"># File lib/net/imap.rb, line 1073
def initialize(host, port_or_options = {},
               usessl = false, certs = nil, verify = true)
  super()
  @host = host
  begin
    options = port_or_options.to_hash
  rescue NoMethodError
    # for backward compatibility
    options = {}
    options[:port] = port_or_options
    if usessl
      options[:ssl] = create_ssl_params(certs, verify)
    end
  end
  @port = options[:port] || (options[:ssl] ? SSL_PORT : PORT)
  @tag_prefix = "RUBY"
  @tagno = 0
  @open_timeout = options[:open_timeout] || 30
  @parser = ResponseParser.new
  @sock = tcp_socket(@host, @port)
  begin
    if options[:ssl]
      start_tls_session(options[:ssl])
      @usessl = true
    else
      @usessl = false
    end
    @responses = Hash.new([].freeze)
    @tagged_responses = {}
    @response_handlers = []
    @tagged_response_arrival = new_cond
    @continued_command_tag = nil
    @continuation_request_arrival = new_cond
    @continuation_request_exception = nil
    @idle_done_cond = nil
    @logout_command_tag = nil
    @debug_output_bol = true
    @exception = nil

    @greeting = get_response
    if @greeting.nil?
      raise Error, "connection closed"
    end
    if @greeting.name == "BYE"
      raise ByeResponseError, @greeting
    end

    @client_thread = Thread.current
    @receiver_thread = Thread.start {
      begin
        receive_responses
      rescue Exception
      end
    }
    @receiver_thread_terminating = false
  rescue Exception
    @sock.close
    raise
  end
end</pre> </div> <p>Creates a new <a href="imap"><code>Net::IMAP</code></a> object and connects it to the specified <code>host</code>.</p> <p><code>options</code> is an option hash, each key of which is a symbol.</p> <p>The available options are:</p> <dl class="rdoc-list note-list">
<dt>port </dt>
<dd> <p>Port number (default value is 143 for imap, or 993 for imaps)</p> </dd>
<dt>ssl </dt>
<dd> <p>If <a href="#">options</a> is true, then an attempt will be made to use SSL (now TLS) to connect to the server. For this to work <a href="../openssl"><code>OpenSSL</code></a> [OSSL] and the Ruby <a href="../openssl"><code>OpenSSL</code></a> [RSSL] extensions need to be installed. If <a href="#">options</a> is a hash, it's passed to <a href="../openssl/ssl/sslcontext#method-i-set_params"><code>OpenSSL::SSL::SSLContext#set_params</code></a> as parameters.</p> </dd>
<dt>
<a href="imap#attribute-i-open_timeout"><code>open_timeout</code></a> </dt>
<dd> <p>Seconds to wait until a connection is opened</p> </dd>
</dl> <p>The most common errors are:</p> <dl class="rdoc-list note-list">
<dt>Errno::ECONNREFUSED </dt>
<dd> <p>Connection refused by <code>host</code> or an intervening firewall.</p> </dd>
<dt>Errno::ETIMEDOUT </dt>
<dd> <p>Connection timed out (possibly due to packets being dropped by an intervening firewall).</p> </dd>
<dt>Errno::ENETUNREACH </dt>
<dd> <p>There is no route to that network.</p> </dd>
<dt>
<a href="../socketerror"><code>SocketError</code></a> </dt>
<dd> <p>Hostname not known or other socket error.</p> </dd>
<dt>
<a href="imap/byeresponseerror"><code>Net::IMAP::ByeResponseError</code></a> </dt>
<dd> <p>The connected to the host was successful, but it immediately said goodbye.</p> </dd>
</dl> <div class="method-calls-super"> Calls superclass method <a href="../monitormixin#method-c-new"><code>MonitorMixin::new</code></a> </div>  </div> </div> </section> <section id="public-instance-5Buntitled-5D-method-details" class="method-section"> <header> <h3>Public Instance Methods</h3> </header> <div class="method-detail "> <div class="method-heading" id="method-i-add_response_handler"> <span class="method-name">add_response_handler</span><span class="method-args">(handler = nil, &amp;block)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="add_response_handler-source"> <pre class="ruby" data-language="ruby"># File lib/net/imap.rb, line 908
def add_response_handler(handler = nil, &amp;block)
  raise ArgumentError, "two Procs are passed" if handler &amp;&amp; block
  @response_handlers.push(block || handler)
end</pre> </div> <p>Adds a response handler. For example, to detect when the server sends a new EXISTS response (which normally indicates new messages being added to the mailbox), add the following handler after selecting the mailbox:</p> <pre class="ruby" data-language="ruby">imap.add_response_handler { |resp|
  if resp.kind_of?(Net::IMAP::UntaggedResponse) and resp.name == "EXISTS"
    puts "Mailbox now has #{resp.data} messages"
  end
}
</pre>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-append"> <span class="method-name">append</span><span class="method-args">(mailbox, message, flags = nil, date_time = nil)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="append-source"> <pre class="ruby" data-language="ruby"># File lib/net/imap.rb, line 701
def append(mailbox, message, flags = nil, date_time = nil)
  args = []
  if flags
    args.push(flags)
  end
  args.push(date_time) if date_time
  args.push(Literal.new(message))
  send_command("APPEND", mailbox, *args)
end</pre> </div> <p>Sends a APPEND command to append the <code>message</code> to the end of the <code>mailbox</code>. The optional <code>flags</code> argument is an array of flags initially passed to the new message. The optional <code>date_time</code> argument specifies the creation time to assign to the new message; it defaults to the current time. For example:</p> <pre class="ruby" data-language="ruby">imap.append("inbox", &lt;&lt;EOF.gsub(/\n/, "\r\n"), [:Seen], Time.now)
Subject: hello
From: shugo@ruby-lang.org
To: shugo@ruby-lang.org

hello world
EOF
</pre> <p>A <a href="imap/noresponseerror"><code>Net::IMAP::NoResponseError</code></a> is raised if the mailbox does not exist (it is not created automatically), or if the flags, date_time, or message arguments contain errors.</p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-authenticate"> <span class="method-name">authenticate</span><span class="method-args">(auth_type, *args)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="authenticate-source"> <pre class="ruby" data-language="ruby"># File lib/net/imap.rb, line 419
def authenticate(auth_type, *args)
  auth_type = auth_type.upcase
  unless @@authenticators.has_key?(auth_type)
    raise ArgumentError,
      format('unknown auth type - "%s"', auth_type)
  end
  authenticator = @@authenticators[auth_type].new(*args)
  send_command("AUTHENTICATE", auth_type) do |resp|
    if resp.instance_of?(ContinuationRequest)
      data = authenticator.process(resp.data.text.unpack("m")[0])
      s = [data].pack("m0")
      send_string_data(s)
      put_string(CRLF)
    end
  end
end</pre> </div> <p>Sends an AUTHENTICATE command to authenticate the client. The <code>auth_type</code> parameter is a string that represents the authentication mechanism to be used. Currently <a href="imap"><code>Net::IMAP</code></a> supports the authentication mechanisms:</p> <pre>LOGIN:: login using cleartext user and password.
CRAM-MD5:: login with cleartext user and encrypted password
           (see [RFC-2195] for a full description).  This
           mechanism requires that the server have the user's
           password stored in clear-text password.</pre> <p>For both of these mechanisms, there should be two <code>args</code>: username and (cleartext) password. A server may not support one or the other of these mechanisms; check <a href="imap#method-i-capability"><code>capability()</code></a> for a capability of the form “AUTH=LOGIN” or “AUTH=CRAM-MD5”.</p> <p>Authentication is done using the appropriate authenticator object: see @@authenticators for more information on plugging in your own authenticator.</p> <p>For example:</p> <pre class="ruby" data-language="ruby">imap.authenticate('LOGIN', user, password)
</pre> <p>A <a href="imap/noresponseerror"><code>Net::IMAP::NoResponseError</code></a> is raised if authentication fails.</p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-capability"> <span class="method-name">capability</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="capability-source"> <pre class="ruby" data-language="ruby"># File lib/net/imap.rb, line 361
def capability
  synchronize do
    send_command("CAPABILITY")
    return @responses.delete("CAPABILITY")[-1]
  end
end</pre> </div> <p>Sends a CAPABILITY command, and returns an array of capabilities that the server supports. Each capability is a string. See [IMAP] for a list of possible capabilities.</p> <p>Note that the <a href="imap"><code>Net::IMAP</code></a> class does not modify its behaviour according to the capabilities of the server; it is up to the user of the class to ensure that a certain capability is supported by a server before using it.</p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-check"> <span class="method-name">check</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="check-source"> <pre class="ruby" data-language="ruby"># File lib/net/imap.rb, line 715
def check
  send_command("CHECK")
end</pre> </div> <p>Sends a CHECK command to request a checkpoint of the currently selected mailbox. This performs implementation-specific housekeeping; for instance, reconciling the mailbox's in-memory and on-disk state.</p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-close"> <span class="method-name">close</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="close-source"> <pre class="ruby" data-language="ruby"># File lib/net/imap.rb, line 722
def close
  send_command("CLOSE")
end</pre> </div> <p>Sends a CLOSE command to close the currently selected mailbox. The CLOSE command permanently removes from the mailbox all messages that have the Deleted flag set.</p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-copy"> <span class="method-name">copy</span><span class="method-args">(set, mailbox)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="copy-source"> <pre class="ruby" data-language="ruby"># File lib/net/imap.rb, line 855
def copy(set, mailbox)
  copy_internal("COPY", set, mailbox)
end</pre> </div> <p>Sends a COPY command to copy the specified message(s) to the end of the specified destination <code>mailbox</code>. The <code>set</code> parameter is a number, an array of numbers, or a <a href="../range"><code>Range</code></a> object. The number is a message sequence number.</p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-create"> <span class="method-name">create</span><span class="method-args">(mailbox)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="create-source"> <pre class="ruby" data-language="ruby"># File lib/net/imap.rb, line 482
def create(mailbox)
  send_command("CREATE", mailbox)
end</pre> </div> <p>Sends a CREATE command to create a new <code>mailbox</code>.</p> <p>A <a href="imap/noresponseerror"><code>Net::IMAP::NoResponseError</code></a> is raised if a mailbox with that name cannot be created.</p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-delete"> <span class="method-name">delete</span><span class="method-args">(mailbox)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="delete-source"> <pre class="ruby" data-language="ruby"># File lib/net/imap.rb, line 491
def delete(mailbox)
  send_command("DELETE", mailbox)
end</pre> </div> <p>Sends a DELETE command to remove the <code>mailbox</code>.</p> <p>A <a href="imap/noresponseerror"><code>Net::IMAP::NoResponseError</code></a> is raised if a mailbox with that name cannot be deleted, either because it does not exist or because the client does not have permission to delete it.</p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-disconnect"> <span class="method-name">disconnect</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="disconnect-source"> <pre class="ruby" data-language="ruby"># File lib/net/imap.rb, line 324
def disconnect
  return if disconnected?
  begin
    begin
      # try to call SSL::SSLSocket#io.
      @sock.io.shutdown
    rescue NoMethodError
      # @sock is not an SSL::SSLSocket.
      @sock.shutdown
    end
  rescue Errno::ENOTCONN
    # ignore `Errno::ENOTCONN: Socket is not connected' on some platforms.
  rescue Exception =&gt; e
    @receiver_thread.raise(e)
  end
  @receiver_thread.join
  synchronize do
    @sock.close
  end
  raise e if e
end</pre> </div> <p>Disconnects from the server.</p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-disconnected-3F"> <span class="method-name">disconnected?</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="disconnected-3F-source"> <pre class="ruby" data-language="ruby"># File lib/net/imap.rb, line 347
def disconnected?
  return @sock.closed?
end</pre> </div> <p>Returns true if disconnected from the server.</p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-examine"> <span class="method-name">examine</span><span class="method-args">(mailbox)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="examine-source"> <pre class="ruby" data-language="ruby"># File lib/net/imap.rb, line 471
def examine(mailbox)
  synchronize do
    @responses.clear
    send_command("EXAMINE", mailbox)
  end
end</pre> </div> <p>Sends a EXAMINE command to select a <code>mailbox</code> so that messages in the <code>mailbox</code> can be accessed. Behaves the same as <a href="imap#method-i-select"><code>select()</code></a>, except that the selected <code>mailbox</code> is identified as read-only.</p> <p>A <a href="imap/noresponseerror"><code>Net::IMAP::NoResponseError</code></a> is raised if the mailbox does not exist or is for some reason non-examinable.</p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-expunge"> <span class="method-name">expunge</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="expunge-source"> <pre class="ruby" data-language="ruby"># File lib/net/imap.rb, line 728
def expunge
  synchronize do
    send_command("EXPUNGE")
    return @responses.delete("EXPUNGE")
  end
end</pre> </div> <p>Sends a EXPUNGE command to permanently remove from the currently selected mailbox all messages that have the Deleted flag set.</p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-fetch"> <span class="method-name">fetch</span><span class="method-args">(set, attr, mod = nil)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="fetch-source"> <pre class="ruby" data-language="ruby"># File lib/net/imap.rb, line 819
def fetch(set, attr, mod = nil)
  return fetch_internal("FETCH", set, attr, mod)
end</pre> </div> <p>Sends a FETCH command to retrieve data associated with a message in the mailbox.</p> <p>The <code>set</code> parameter is a number or a range between two numbers, or an array of those. The number is a message sequence number, where -1 represents a '*' for use in range notation like 100..-1 being interpreted as '100:*'. Beware that the <code>exclude_end?</code> property of a <a href="../range"><code>Range</code></a> object is ignored, and the contents of a range are independent of the order of the range endpoints as per the protocol specification, so 1…5, 5..1 and 5…1 are all equivalent to 1..5.</p> <p><code>attr</code> is a list of attributes to fetch; see the documentation for <a href="imap#FetchData"><code>Net::IMAP::FetchData</code></a> for a list of valid attributes.</p> <p>The return value is an array of <a href="imap#FetchData"><code>Net::IMAP::FetchData</code></a> or nil (instead of an empty array) if there is no matching message.</p> <p>For example:</p> <pre class="ruby" data-language="ruby">p imap.fetch(6..8, "UID")
#=&gt; [#&lt;Net::IMAP::FetchData seqno=6, attr={"UID"=&gt;98}&gt;, \\
     #&lt;Net::IMAP::FetchData seqno=7, attr={"UID"=&gt;99}&gt;, \\
     #&lt;Net::IMAP::FetchData seqno=8, attr={"UID"=&gt;100}&gt;]
p imap.fetch(6, "BODY[HEADER.FIELDS (SUBJECT)]")
#=&gt; [#&lt;Net::IMAP::FetchData seqno=6, attr={"BODY[HEADER.FIELDS (SUBJECT)]"=&gt;"Subject: test\r\n\r\n"}&gt;]
data = imap.uid_fetch(98, ["RFC822.SIZE", "INTERNALDATE"])[0]
p data.seqno
#=&gt; 6
p data.attr["RFC822.SIZE"]
#=&gt; 611
p data.attr["INTERNALDATE"]
#=&gt; "12-Oct-2000 22:40:59 +0900"
p data.attr["UID"]
#=&gt; 98
</pre>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-getacl"> <span class="method-name">getacl</span><span class="method-args">(mailbox)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="getacl-source"> <pre class="ruby" data-language="ruby"># File lib/net/imap.rb, line 641
def getacl(mailbox)
  synchronize do
    send_command("GETACL", mailbox)
    return @responses.delete("ACL")[-1]
  end
end</pre> </div> <p>Send the GETACL command along with a specified <code>mailbox</code>. If this mailbox exists, an array containing objects of <a href="imap#MailboxACLItem"><code>Net::IMAP::MailboxACLItem</code></a> will be returned.</p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-getquota"> <span class="method-name">getquota</span><span class="method-args">(mailbox)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="getquota-source"> <pre class="ruby" data-language="ruby"># File lib/net/imap.rb, line 605
def getquota(mailbox)
  synchronize do
    send_command("GETQUOTA", mailbox)
    return @responses.delete("QUOTA")
  end
end</pre> </div> <p>Sends the GETQUOTA command along with specified <code>mailbox</code>. If this mailbox exists, then an array containing a <a href="imap#MailboxQuota"><code>Net::IMAP::MailboxQuota</code></a> object is returned. This command is generally only available to server admin.</p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-getquotaroot"> <span class="method-name">getquotaroot</span><span class="method-args">(mailbox)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="getquotaroot-source"> <pre class="ruby" data-language="ruby"># File lib/net/imap.rb, line 591
def getquotaroot(mailbox)
  synchronize do
    send_command("GETQUOTAROOT", mailbox)
    result = []
    result.concat(@responses.delete("QUOTAROOT"))
    result.concat(@responses.delete("QUOTA"))
    return result
  end
end</pre> </div> <p>Sends the GETQUOTAROOT command along with the specified <code>mailbox</code>. This command is generally available to both admin and user. If this mailbox exists, it returns an array containing objects of type <a href="imap#MailboxQuotaRoot"><code>Net::IMAP::MailboxQuotaRoot</code></a> and <a href="imap#MailboxQuota"><code>Net::IMAP::MailboxQuota</code></a>.</p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-idle"> <span class="method-name">idle</span><span class="method-args">(timeout = nil, &amp;response_handler)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="idle-source"> <pre class="ruby" data-language="ruby"># File lib/net/imap.rb, line 955
def idle(timeout = nil, &amp;response_handler)
  raise LocalJumpError, "no block given" unless response_handler

  response = nil

  synchronize do
    tag = Thread.current[:net_imap_tag] = generate_tag
    put_string("#{tag} IDLE#{CRLF}")

    begin
      add_response_handler(&amp;response_handler)
      @idle_done_cond = new_cond
      @idle_done_cond.wait(timeout)
      @idle_done_cond = nil
      if @receiver_thread_terminating
        raise @exception || Net::IMAP::Error.new("connection closed")
      end
    ensure
      unless @receiver_thread_terminating
        remove_response_handler(response_handler)
        put_string("DONE#{CRLF}")
        response = get_tagged_response(tag, "IDLE")
      end
    end
  end

  return response
end</pre> </div> <p>Sends an IDLE command that waits for notifications of new or expunged messages. Yields responses from the server during the IDLE.</p> <p>Use <a href="imap#method-i-idle_done"><code>idle_done()</code></a> to leave IDLE.</p> <p>If <code>timeout</code> is given, this method returns after <code>timeout</code> seconds passed. <code>timeout</code> can be used for keep-alive. For example, the following code checks the connection for each 60 seconds.</p> <pre>loop do
  imap.idle(60) do |res|
    ...
  end
end</pre>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-idle_done"> <span class="method-name">idle_done</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="idle_done-source"> <pre class="ruby" data-language="ruby"># File lib/net/imap.rb, line 985
def idle_done
  synchronize do
    if @idle_done_cond.nil?
      raise Net::IMAP::Error, "not during IDLE"
    end
    @idle_done_cond.signal
  end
end</pre> </div> <p>Leaves IDLE.</p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-list"> <span class="method-name">list</span><span class="method-args">(refname, mailbox)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="list-source"> <pre class="ruby" data-language="ruby"># File lib/net/imap.rb, line 548
def list(refname, mailbox)
  synchronize do
    send_command("LIST", refname, mailbox)
    return @responses.delete("LIST")
  end
end</pre> </div> <p>Sends a LIST command, and returns a subset of names from the complete set of all names available to the client. <code>refname</code> provides a context (for instance, a base directory in a directory-based mailbox hierarchy). <code>mailbox</code> specifies a mailbox or (via wildcards) mailboxes under that context. Two wildcards may be used in <code>mailbox</code>: '*', which matches all characters <strong>including</strong> the hierarchy delimiter (for instance, '/' on a UNIX-hosted directory-based mailbox hierarchy); and '%', which matches all characters <strong>except</strong> the hierarchy delimiter.</p> <p>If <code>refname</code> is empty, <code>mailbox</code> is used directly to determine which mailboxes to match. If <code>mailbox</code> is empty, the root name of <code>refname</code> and the hierarchy delimiter are returned.</p> <p>The return value is an array of <code>Net::IMAP::MailboxList</code>. For example:</p> <pre class="ruby" data-language="ruby">imap.create("foo/bar")
imap.create("foo/baz")
p imap.list("", "foo/%")
#=&gt; [#&lt;Net::IMAP::MailboxList attr=[:Noselect], delim="/", name="foo/"&gt;, \\
     #&lt;Net::IMAP::MailboxList attr=[:Noinferiors, :Marked], delim="/", name="foo/bar"&gt;, \\
     #&lt;Net::IMAP::MailboxList attr=[:Noinferiors], delim="/", name="foo/baz"&gt;]
</pre>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-login"> <span class="method-name">login</span><span class="method-args">(user, password)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="login-source"> <pre class="ruby" data-language="ruby"># File lib/net/imap.rb, line 442
def login(user, password)
  send_command("LOGIN", user, password)
end</pre> </div> <p>Sends a LOGIN command to identify the client and carries the plaintext <code>password</code> authenticating this <code>user</code>. Note that, unlike calling <a href="imap#method-i-authenticate"><code>authenticate()</code></a> with an <code>auth_type</code> of “LOGIN”, <a href="imap#method-i-login"><code>login()</code></a> does <strong>not</strong> use the login authenticator.</p> <p>A <a href="imap/noresponseerror"><code>Net::IMAP::NoResponseError</code></a> is raised if authentication fails.</p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-logout"> <span class="method-name">logout</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="logout-source"> <pre class="ruby" data-language="ruby"># File lib/net/imap.rb, line 375
def logout
  send_command("LOGOUT")
end</pre> </div> <p>Sends a LOGOUT command to inform the server that the client is done with the connection.</p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-lsub"> <span class="method-name">lsub</span><span class="method-args">(refname, mailbox)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="lsub-source"> <pre class="ruby" data-language="ruby"># File lib/net/imap.rb, line 653
def lsub(refname, mailbox)
  synchronize do
    send_command("LSUB", refname, mailbox)
    return @responses.delete("LSUB")
  end
end</pre> </div> <p>Sends a LSUB command, and returns a subset of names from the set of names that the user has declared as being “active” or “subscribed.” <code>refname</code> and <code>mailbox</code> are interpreted as for <a href="imap#method-i-list"><code>list()</code></a>. The return value is an array of <code>Net::IMAP::MailboxList</code>.</p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-move"> <span class="method-name">move</span><span class="method-args">(set, mailbox)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="move-source"> <pre class="ruby" data-language="ruby"># File lib/net/imap.rb, line 869
def move(set, mailbox)
  copy_internal("MOVE", set, mailbox)
end</pre> </div> <p>Sends a MOVE command to move the specified message(s) to the end of the specified destination <code>mailbox</code>. The <code>set</code> parameter is a number, an array of numbers, or a <a href="../range"><code>Range</code></a> object. The number is a message sequence number. The <a href="imap"><code>IMAP</code></a> MOVE extension is described in [RFC-6851].</p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-noop"> <span class="method-name">noop</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="noop-source"> <pre class="ruby" data-language="ruby"># File lib/net/imap.rb, line 369
def noop
  send_command("NOOP")
end</pre> </div> <p>Sends a NOOP command to the server. It does nothing.</p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-remove_response_handler"> <span class="method-name">remove_response_handler</span><span class="method-args">(handler)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="remove_response_handler-source"> <pre class="ruby" data-language="ruby"># File lib/net/imap.rb, line 914
def remove_response_handler(handler)
  @response_handlers.delete(handler)
end</pre> </div> <p>Removes the response handler.</p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-rename"> <span class="method-name">rename</span><span class="method-args">(mailbox, newname)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="rename-source"> <pre class="ruby" data-language="ruby"># File lib/net/imap.rb, line 502
def rename(mailbox, newname)
  send_command("RENAME", mailbox, newname)
end</pre> </div> <p>Sends a RENAME command to change the name of the <code>mailbox</code> to <code>newname</code>.</p> <p>A <a href="imap/noresponseerror"><code>Net::IMAP::NoResponseError</code></a> is raised if a mailbox with the name <code>mailbox</code> cannot be renamed to <code>newname</code> for whatever reason; for instance, because <code>mailbox</code> does not exist, or because there is already a mailbox with the name <code>newname</code>.</p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-search"> <span class="method-name">search</span><span class="method-args">(keys, charset = nil)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="search-source"> <pre class="ruby" data-language="ruby"># File lib/net/imap.rb, line 775
def search(keys, charset = nil)
  return search_internal("SEARCH", keys, charset)
end</pre> </div> <p>Sends a SEARCH command to search the mailbox for messages that match the given searching criteria, and returns message sequence numbers. <code>keys</code> can either be a string holding the entire search string, or a single-dimension array of search keywords and arguments. The following are some common search criteria; see [IMAP] section 6.4.4 for a full list.</p> <dl class="rdoc-list note-list">
<dt>&lt;message set&gt; </dt>
<dd> <p>a set of message sequence numbers. ',' indicates an interval, ':' indicates a range. For instance, '2,10:12,15' means “2,10,11,12,15”.</p> </dd>
<dt>BEFORE &lt;date&gt; </dt>
<dd> <p>messages with an internal date strictly before &lt;date&gt;. The date argument has a format similar to 8-Aug-2002.</p> </dd>
<dt>BODY &lt;string&gt; </dt>
<dd> <p>messages that contain &lt;string&gt; within their body.</p> </dd>
<dt>CC &lt;string&gt; </dt>
<dd> <p>messages containing &lt;string&gt; in their CC field.</p> </dd>
<dt>FROM &lt;string&gt; </dt>
<dd> <p>messages that contain &lt;string&gt; in their FROM field.</p> </dd>
<dt>NEW </dt>
<dd> <p>messages with the Recent, but not the Seen, flag set.</p> </dd>
<dt>NOT &lt;search-key&gt; </dt>
<dd> <p>negate the following search key.</p> </dd>
<dt>OR &lt;search-key&gt; &lt;search-key&gt; </dt>
<dd> <p>“or” two search keys together.</p> </dd>
<dt>ON &lt;date&gt; </dt>
<dd> <p>messages with an internal date exactly equal to &lt;date&gt;, which has a format similar to 8-Aug-2002.</p> </dd>
<dt>SINCE &lt;date&gt; </dt>
<dd> <p>messages with an internal date on or after &lt;date&gt;.</p> </dd>
<dt>SUBJECT &lt;string&gt; </dt>
<dd> <p>messages with &lt;string&gt; in their subject.</p> </dd>
<dt>TO &lt;string&gt; </dt>
<dd> <p>messages with &lt;string&gt; in their TO field.</p> </dd>
</dl> <p>For example:</p> <pre class="ruby" data-language="ruby">p imap.search(["SUBJECT", "hello", "NOT", "NEW"])
#=&gt; [1, 6, 7, 8]
</pre>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-select"> <span class="method-name">select</span><span class="method-args">(mailbox)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="select-source"> <pre class="ruby" data-language="ruby"># File lib/net/imap.rb, line 458
def select(mailbox)
  synchronize do
    @responses.clear
    send_command("SELECT", mailbox)
  end
end</pre> </div> <p>Sends a SELECT command to select a <code>mailbox</code> so that messages in the <code>mailbox</code> can be accessed.</p> <p>After you have selected a mailbox, you may retrieve the number of items in that mailbox from @<a href="imap" exists>responses</a>[-1], and the number of recent messages from @<a href="imap" recent>responses</a>[-1]. Note that these values can change if new messages arrive during a session; see <a href="imap#method-i-add_response_handler"><code>add_response_handler()</code></a> for a way of detecting this event.</p> <p>A <a href="imap/noresponseerror"><code>Net::IMAP::NoResponseError</code></a> is raised if the mailbox does not exist or is for some reason non-selectable.</p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-setacl"> <span class="method-name">setacl</span><span class="method-args">(mailbox, user, rights)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="setacl-source"> <pre class="ruby" data-language="ruby"># File lib/net/imap.rb, line 630
def setacl(mailbox, user, rights)
  if rights.nil?
    send_command("SETACL", mailbox, user, "")
  else
    send_command("SETACL", mailbox, user, rights)
  end
end</pre> </div> <p>Sends the SETACL command along with <code>mailbox</code>, <code>user</code> and the <code>rights</code> that user is to have on that mailbox. If <code>rights</code> is nil, then that user will be stripped of any rights to that mailbox. The <a href="imap"><code>IMAP</code></a> <a href="../acl"><code>ACL</code></a> commands are described in [RFC-2086].</p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-setquota"> <span class="method-name">setquota</span><span class="method-args">(mailbox, quota)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="setquota-source"> <pre class="ruby" data-language="ruby"># File lib/net/imap.rb, line 617
def setquota(mailbox, quota)
  if quota.nil?
    data = '()'
  else
    data = '(STORAGE ' + quota.to_s + ')'
  end
  send_command("SETQUOTA", mailbox, RawData.new(data))
end</pre> </div> <p>Sends a SETQUOTA command along with the specified <code>mailbox</code> and <code>quota</code>. If <code>quota</code> is nil, then <code>quota</code> will be unset for that mailbox. Typically one needs to be logged in as a server admin for this to work. The <a href="imap"><code>IMAP</code></a> quota commands are described in [RFC-2087].</p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-sort"> <span class="method-name">sort</span><span class="method-args">(sort_keys, search_keys, charset)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="sort-source"> <pre class="ruby" data-language="ruby"># File lib/net/imap.rb, line 887
def sort(sort_keys, search_keys, charset)
  return sort_internal("SORT", sort_keys, search_keys, charset)
end</pre> </div> <p>Sends a SORT command to sort messages in the mailbox. Returns an array of message sequence numbers. For example:</p> <pre class="ruby" data-language="ruby">p imap.sort(["FROM"], ["ALL"], "US-ASCII")
#=&gt; [1, 2, 3, 5, 6, 7, 8, 4, 9]
p imap.sort(["DATE"], ["SUBJECT", "hello"], "US-ASCII")
#=&gt; [6, 7, 8, 1]
</pre> <p>See [SORT-THREAD-EXT] for more details.</p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-starttls"> <span class="method-name">starttls</span><span class="method-args">(options = {}, verify = true)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="starttls-source"> <pre class="ruby" data-language="ruby"># File lib/net/imap.rb, line 380
def starttls(options = {}, verify = true)
  send_command("STARTTLS") do |resp|
    if resp.kind_of?(TaggedResponse) &amp;&amp; resp.name == "OK"
      begin
        # for backward compatibility
        certs = options.to_str
        options = create_ssl_params(certs, verify)
      rescue NoMethodError
      end
      start_tls_session(options)
    end
  end
end</pre> </div> <p>Sends a STARTTLS command to start TLS session.</p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-status"> <span class="method-name">status</span><span class="method-args">(mailbox, attr)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="status-source"> <pre class="ruby" data-language="ruby"># File lib/net/imap.rb, line 676
def status(mailbox, attr)
  synchronize do
    send_command("STATUS", mailbox, attr)
    return @responses.delete("STATUS")[-1].attr
  end
end</pre> </div> <p>Sends a STATUS command, and returns the status of the indicated <code>mailbox</code>. <code>attr</code> is a list of one or more attributes whose statuses are to be requested. Supported attributes include:</p> <pre>MESSAGES:: the number of messages in the mailbox.
RECENT:: the number of recent messages in the mailbox.
UNSEEN:: the number of unseen messages in the mailbox.</pre> <p>The return value is a hash of attributes. For example:</p> <pre class="ruby" data-language="ruby">p imap.status("inbox", ["MESSAGES", "RECENT"])
#=&gt; {"RECENT"=&gt;0, "MESSAGES"=&gt;44}
</pre> <p>A <a href="imap/noresponseerror"><code>Net::IMAP::NoResponseError</code></a> is raised if status values for <code>mailbox</code> cannot be returned; for instance, because it does not exist.</p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-store"> <span class="method-name">store</span><span class="method-args">(set, attr, flags)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="store-source"> <pre class="ruby" data-language="ruby"># File lib/net/imap.rb, line 842
def store(set, attr, flags)
  return store_internal("STORE", set, attr, flags)
end</pre> </div> <p>Sends a STORE command to alter data associated with messages in the mailbox, in particular their flags. The <code>set</code> parameter is a number, an array of numbers, or a <a href="../range"><code>Range</code></a> object. Each number is a message sequence number. <code>attr</code> is the name of a data item to store: 'FLAGS' will replace the message's flag list with the provided one, '+FLAGS' will add the provided flags, and '-FLAGS' will remove them. <code>flags</code> is a list of flags.</p> <p>The return value is an array of <a href="imap#FetchData"><code>Net::IMAP::FetchData</code></a>. For example:</p> <pre class="ruby" data-language="ruby">p imap.store(6..8, "+FLAGS", [:Deleted])
#=&gt; [#&lt;Net::IMAP::FetchData seqno=6, attr={"FLAGS"=&gt;[:Seen, :Deleted]}&gt;, \\
     #&lt;Net::IMAP::FetchData seqno=7, attr={"FLAGS"=&gt;[:Seen, :Deleted]}&gt;, \\
     #&lt;Net::IMAP::FetchData seqno=8, attr={"FLAGS"=&gt;[:Seen, :Deleted]}&gt;]
</pre>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-subscribe"> <span class="method-name">subscribe</span><span class="method-args">(mailbox)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="subscribe-source"> <pre class="ruby" data-language="ruby"># File lib/net/imap.rb, line 512
def subscribe(mailbox)
  send_command("SUBSCRIBE", mailbox)
end</pre> </div> <p>Sends a SUBSCRIBE command to add the specified <code>mailbox</code> name to the server's set of “active” or “subscribed” mailboxes as returned by <a href="imap#method-i-lsub"><code>lsub()</code></a>.</p> <p>A <a href="imap/noresponseerror"><code>Net::IMAP::NoResponseError</code></a> is raised if <code>mailbox</code> cannot be subscribed to; for instance, because it does not exist.</p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-thread"> <span class="method-name">thread</span><span class="method-args">(algorithm, search_keys, charset)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="thread-source"> <pre class="ruby" data-language="ruby"># File lib/net/imap.rb, line 931
def thread(algorithm, search_keys, charset)
  return thread_internal("THREAD", algorithm, search_keys, charset)
end</pre> </div> <p>Similar to <a href="imap#method-i-search"><code>search()</code></a>, but returns message sequence numbers in threaded format, as a <a href="imap#ThreadMember"><code>Net::IMAP::ThreadMember</code></a> tree. The supported algorithms are:</p> <dl class="rdoc-list note-list">
<dt>ORDEREDSUBJECT </dt>
<dd> <p>split into single-level threads according to subject, ordered by date.</p> </dd>
<dt>REFERENCES </dt>
<dd> <p>split into threads by parent/child relationships determined by which message is a reply to which.</p> </dd>
</dl> <p>Unlike <a href="imap#method-i-search"><code>search()</code></a>, <code>charset</code> is a required argument. US-ASCII and UTF-8 are sample values.</p> <p>See [SORT-THREAD-EXT] for more details.</p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-uid_copy"> <span class="method-name">uid_copy</span><span class="method-args">(set, mailbox)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="uid_copy-source"> <pre class="ruby" data-language="ruby"># File lib/net/imap.rb, line 860
def uid_copy(set, mailbox)
  copy_internal("UID COPY", set, mailbox)
end</pre> </div> <p>Similar to <a href="imap#method-i-copy"><code>copy()</code></a>, but <code>set</code> contains unique identifiers.</p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-uid_fetch"> <span class="method-name">uid_fetch</span><span class="method-args">(set, attr, mod = nil)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="uid_fetch-source"> <pre class="ruby" data-language="ruby"># File lib/net/imap.rb, line 824
def uid_fetch(set, attr, mod = nil)
  return fetch_internal("UID FETCH", set, attr, mod)
end</pre> </div> <p>Similar to <a href="imap#method-i-fetch"><code>fetch()</code></a>, but <code>set</code> contains unique identifiers.</p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-uid_move"> <span class="method-name">uid_move</span><span class="method-args">(set, mailbox)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="uid_move-source"> <pre class="ruby" data-language="ruby"># File lib/net/imap.rb, line 874
def uid_move(set, mailbox)
  copy_internal("UID MOVE", set, mailbox)
end</pre> </div> <p>Similar to <a href="imap#method-i-move"><code>move()</code></a>, but <code>set</code> contains unique identifiers.</p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-uid_search"> <span class="method-name">uid_search</span><span class="method-args">(keys, charset = nil)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="uid_search-source"> <pre class="ruby" data-language="ruby"># File lib/net/imap.rb, line 780
def uid_search(keys, charset = nil)
  return search_internal("UID SEARCH", keys, charset)
end</pre> </div> <p>Similar to <a href="imap#method-i-search"><code>search()</code></a>, but returns unique identifiers.</p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-uid_sort"> <span class="method-name">uid_sort</span><span class="method-args">(sort_keys, search_keys, charset)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="uid_sort-source"> <pre class="ruby" data-language="ruby"># File lib/net/imap.rb, line 892
def uid_sort(sort_keys, search_keys, charset)
  return sort_internal("UID SORT", sort_keys, search_keys, charset)
end</pre> </div> <p>Similar to <a href="imap#method-i-sort"><code>sort()</code></a>, but returns an array of unique identifiers.</p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-uid_store"> <span class="method-name">uid_store</span><span class="method-args">(set, attr, flags)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="uid_store-source"> <pre class="ruby" data-language="ruby"># File lib/net/imap.rb, line 847
def uid_store(set, attr, flags)
  return store_internal("UID STORE", set, attr, flags)
end</pre> </div> <p>Similar to <a href="imap#method-i-store"><code>store()</code></a>, but <code>set</code> contains unique identifiers.</p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-uid_thread"> <span class="method-name">uid_thread</span><span class="method-args">(algorithm, search_keys, charset)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="uid_thread-source"> <pre class="ruby" data-language="ruby"># File lib/net/imap.rb, line 937
def uid_thread(algorithm, search_keys, charset)
  return thread_internal("UID THREAD", algorithm, search_keys, charset)
end</pre> </div> <p>Similar to <a href="imap#method-i-thread"><code>thread()</code></a>, but returns unique identifiers instead of message sequence numbers.</p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-unsubscribe"> <span class="method-name">unsubscribe</span><span class="method-args">(mailbox)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="unsubscribe-source"> <pre class="ruby" data-language="ruby"># File lib/net/imap.rb, line 522
def unsubscribe(mailbox)
  send_command("UNSUBSCRIBE", mailbox)
end</pre> </div> <p>Sends a UNSUBSCRIBE command to remove the specified <code>mailbox</code> name from the server's set of “active” or “subscribed” mailboxes.</p> <p>A <a href="imap/noresponseerror"><code>Net::IMAP::NoResponseError</code></a> is raised if <code>mailbox</code> cannot be unsubscribed from; for instance, because the client is not currently subscribed to it.</p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-xlist"> <span class="method-name">xlist</span><span class="method-args">(refname, mailbox)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="xlist-source"> <pre class="ruby" data-language="ruby"># File lib/net/imap.rb, line 580
def xlist(refname, mailbox)
  synchronize do
    send_command("XLIST", refname, mailbox)
    return @responses.delete("XLIST")
  end
end</pre> </div> <p>Sends a XLIST command, and returns a subset of names from the complete set of all names available to the client. <code>refname</code> provides a context (for instance, a base directory in a directory-based mailbox hierarchy). <code>mailbox</code> specifies a mailbox or (via wildcards) mailboxes under that context. Two wildcards may be used in <code>mailbox</code>: '*', which matches all characters <strong>including</strong> the hierarchy delimiter (for instance, '/' on a UNIX-hosted directory-based mailbox hierarchy); and '%', which matches all characters <strong>except</strong> the hierarchy delimiter.</p> <p>If <code>refname</code> is empty, <code>mailbox</code> is used directly to determine which mailboxes to match. If <code>mailbox</code> is empty, the root name of <code>refname</code> and the hierarchy delimiter are returned.</p> <p>The XLIST command is like the LIST command except that the flags returned refer to the function of the folder/mailbox, e.g. :Sent</p> <p>The return value is an array of <code>Net::IMAP::MailboxList</code>. For example:</p> <pre class="ruby" data-language="ruby">imap.create("foo/bar")
imap.create("foo/baz")
p imap.xlist("", "foo/%")
#=&gt; [#&lt;Net::IMAP::MailboxList attr=[:Noselect], delim="/", name="foo/"&gt;, \\
     #&lt;Net::IMAP::MailboxList attr=[:Noinferiors, :Marked], delim="/", name="foo/bar"&gt;, \\
     #&lt;Net::IMAP::MailboxList attr=[:Noinferiors], delim="/", name="foo/baz"&gt;]
</pre>  </div> </div> </section> <section id="private-instance-5Buntitled-5D-method-details" class="method-section"> <header> <h3>Private Instance Methods</h3> </header> <div class="method-detail "> <div class="method-heading" id="method-i-copy_internal"> <span class="method-name">copy_internal</span><span class="method-args">(cmd, set, mailbox)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="copy_internal-source"> <pre class="ruby" data-language="ruby"># File lib/net/imap.rb, line 1461
def copy_internal(cmd, set, mailbox)
  send_command(cmd, MessageSet.new(set), mailbox)
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-create_ssl_params"> <span class="method-name">create_ssl_params</span><span class="method-args">(certs = nil, verify = true)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="create_ssl_params-source"> <pre class="ruby" data-language="ruby"># File lib/net/imap.rb, line 1500
def create_ssl_params(certs = nil, verify = true)
  params = {}
  if certs
    if File.file?(certs)
      params[:ca_file] = certs
    elsif File.directory?(certs)
      params[:ca_path] = certs
    end
  end
  if verify
    params[:verify_mode] = VERIFY_PEER
  else
    params[:verify_mode] = VERIFY_NONE
  end
  return params
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-fetch_internal"> <span class="method-name">fetch_internal</span><span class="method-args">(cmd, set, attr, mod = nil)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="fetch_internal-source"> <pre class="ruby" data-language="ruby"># File lib/net/imap.rb, line 1429
def fetch_internal(cmd, set, attr, mod = nil)
  case attr
  when String then
    attr = RawData.new(attr)
  when Array then
    attr = attr.map { |arg|
      arg.is_a?(String) ? RawData.new(arg) : arg
    }
  end

  synchronize do
    @responses.delete("FETCH")
    if mod
      send_command(cmd, MessageSet.new(set), attr, mod)
    else
      send_command(cmd, MessageSet.new(set), attr)
    end
    return @responses.delete("FETCH")
  end
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-generate_tag"> <span class="method-name">generate_tag</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="generate_tag-source"> <pre class="ruby" data-language="ruby"># File lib/net/imap.rb, line 1285
def generate_tag
  @tagno += 1
  return format("%s%04d", @tag_prefix, @tagno)
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-get_response"> <span class="method-name">get_response</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="get_response-source"> <pre class="ruby" data-language="ruby"># File lib/net/imap.rb, line 1230
def get_response
  buff = String.new
  while true
    s = @sock.gets(CRLF)
    break unless s
    buff.concat(s)
    if /\{(\d+)\}\r\n/n =~ s
      s = @sock.read($1.to_i)
      buff.concat(s)
    else
      break
    end
  end
  return nil if buff.length == 0
  if @@debug
    $stderr.print(buff.gsub(/^/n, "S: "))
  end
  return @parser.parse(buff)
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-get_tagged_response"> <span class="method-name">get_tagged_response</span><span class="method-args">(tag, cmd)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="get_tagged_response-source"> <pre class="ruby" data-language="ruby"># File lib/net/imap.rb, line 1214
def get_tagged_response(tag, cmd)
  until @tagged_responses.key?(tag)
    raise @exception if @exception
    @tagged_response_arrival.wait
  end
  resp = @tagged_responses.delete(tag)
  case resp.name
  when /\A(?:NO)\z/ni
    raise NoResponseError, resp
  when /\A(?:BAD)\z/ni
    raise BadResponseError, resp
  else
    return resp
  end
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-normalize_searching_criteria"> <span class="method-name">normalize_searching_criteria</span><span class="method-args">(keys)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="normalize_searching_criteria-source"> <pre class="ruby" data-language="ruby"># File lib/net/imap.rb, line 1489
def normalize_searching_criteria(keys)
  keys.collect! do |i|
    case i
    when -1, Range, Array
      MessageSet.new(i)
    else
      i
    end
  end
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-put_string"> <span class="method-name">put_string</span><span class="method-args">(str)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="put_string-source"> <pre class="ruby" data-language="ruby"># File lib/net/imap.rb, line 1290
def put_string(str)
  @sock.print(str)
  if @@debug
    if @debug_output_bol
      $stderr.print("C: ")
    end
    $stderr.print(str.gsub(/\n(?!\z)/n, "\nC: "))
    if /\r\n\z/n.match(str)
      @debug_output_bol = true
    else
      @debug_output_bol = false
    end
  end
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-receive_responses"> <span class="method-name">receive_responses</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="receive_responses-source"> <pre class="ruby" data-language="ruby"># File lib/net/imap.rb, line 1143
def receive_responses
  connection_closed = false
  until connection_closed
    synchronize do
      @exception = nil
    end
    begin
      resp = get_response
    rescue Exception =&gt; e
      synchronize do
        @sock.close
        @exception = e
      end
      break
    end
    unless resp
      synchronize do
        @exception = EOFError.new("end of file reached")
      end
      break
    end
    begin
      synchronize do
        case resp
        when TaggedResponse
          @tagged_responses[resp.tag] = resp
          @tagged_response_arrival.broadcast
          case resp.tag
          when @logout_command_tag
            return
          when @continued_command_tag
            @continuation_request_exception =
              RESPONSE_ERRORS[resp.name].new(resp)
            @continuation_request_arrival.signal
          end
        when UntaggedResponse
          record_response(resp.name, resp.data)
          if resp.data.instance_of?(ResponseText) &amp;&amp;
              (code = resp.data.code)
            record_response(code.name, code.data)
          end
          if resp.name == "BYE" &amp;&amp; @logout_command_tag.nil?
            @sock.close
            @exception = ByeResponseError.new(resp)
            connection_closed = true
          end
        when ContinuationRequest
          @continuation_request_arrival.signal
        end
        @response_handlers.each do |handler|
          handler.call(resp)
        end
      end
    rescue Exception =&gt; e
      @exception = e
      synchronize do
        @tagged_response_arrival.broadcast
        @continuation_request_arrival.broadcast
      end
    end
  end
  synchronize do
    @receiver_thread_terminating = true
    @tagged_response_arrival.broadcast
    @continuation_request_arrival.broadcast
    if @idle_done_cond
      @idle_done_cond.signal
    end
  end
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-record_response"> <span class="method-name">record_response</span><span class="method-args">(name, data)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="record_response-source"> <pre class="ruby" data-language="ruby"># File lib/net/imap.rb, line 1250
def record_response(name, data)
  unless @responses.has_key?(name)
    @responses[name] = []
  end
  @responses[name].push(data)
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-search_internal"> <span class="method-name">search_internal</span><span class="method-args">(cmd, keys, charset)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="search_internal-source"> <pre class="ruby" data-language="ruby"># File lib/net/imap.rb, line 1413
def search_internal(cmd, keys, charset)
  if keys.instance_of?(String)
    keys = [RawData.new(keys)]
  else
    normalize_searching_criteria(keys)
  end
  synchronize do
    if charset
      send_command(cmd, "CHARSET", charset, *keys)
    else
      send_command(cmd, *keys)
    end
    return @responses.delete("SEARCH")[-1]
  end
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-send_command"> <span class="method-name">send_command</span><span class="method-args">(cmd, *args, &amp;block)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="send_command-source"> <pre class="ruby" data-language="ruby"># File lib/net/imap.rb, line 1257
def send_command(cmd, *args, &amp;block)
  synchronize do
    args.each do |i|
      validate_data(i)
    end
    tag = generate_tag
    put_string(tag + " " + cmd)
    args.each do |i|
      put_string(" ")
      send_data(i, tag)
    end
    put_string(CRLF)
    if cmd == "LOGOUT"
      @logout_command_tag = tag
    end
    if block
      add_response_handler(&amp;block)
    end
    begin
      return get_tagged_response(tag, cmd)
    ensure
      if block
        remove_response_handler(block)
      end
    end
  end
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-send_data"> <span class="method-name">send_data</span><span class="method-args">(data, tag = nil)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="send_data-source"> <pre class="ruby" data-language="ruby"># File lib/net/imap.rb, line 1326
def send_data(data, tag = nil)
  case data
  when nil
    put_string("NIL")
  when String
    send_string_data(data, tag)
  when Integer
    send_number_data(data)
  when Array
    send_list_data(data, tag)
  when Time
    send_time_data(data)
  when Symbol
    send_symbol_data(data)
  else
    data.send_data(self, tag)
  end
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-send_list_data"> <span class="method-name">send_list_data</span><span class="method-args">(list, tag = nil)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="send_list_data-source"> <pre class="ruby" data-language="ruby"># File lib/net/imap.rb, line 1385
def send_list_data(list, tag = nil)
  put_string("(")
  first = true
  list.each do |i|
    if first
      first = false
    else
      put_string(" ")
    end
    send_data(i, tag)
  end
  put_string(")")
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-send_literal"> <span class="method-name">send_literal</span><span class="method-args">(str, tag = nil)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="send_literal-source"> <pre class="ruby" data-language="ruby"># File lib/net/imap.rb, line 1364
def send_literal(str, tag = nil)
  synchronize do
    put_string("{" + str.bytesize.to_s + "}" + CRLF)
    @continued_command_tag = tag
    @continuation_request_exception = nil
    begin
      @continuation_request_arrival.wait
      e = @continuation_request_exception || @exception
      raise e if e
      put_string(str)
    ensure
      @continued_command_tag = nil
      @continuation_request_exception = nil
    end
  end
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-send_number_data"> <span class="method-name">send_number_data</span><span class="method-args">(num)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="send_number_data-source"> <pre class="ruby" data-language="ruby"># File lib/net/imap.rb, line 1381
def send_number_data(num)
  put_string(num.to_s)
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-send_quoted_string"> <span class="method-name">send_quoted_string</span><span class="method-args">(str)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="send_quoted_string-source"> <pre class="ruby" data-language="ruby"># File lib/net/imap.rb, line 1360
def send_quoted_string(str)
  put_string('"' + str.gsub(/["\\]/n, "\\\\\\&amp;") + '"')
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-send_string_data"> <span class="method-name">send_string_data</span><span class="method-args">(str, tag = nil)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="send_string_data-source"> <pre class="ruby" data-language="ruby"># File lib/net/imap.rb, line 1345
def send_string_data(str, tag = nil)
  case str
  when ""
    put_string('""')
  when /[\x80-\xff\r\n]/n
    # literal
    send_literal(str, tag)
  when /[(){ \x00-\x1f\x7f%*"\\]/n
    # quoted string
    send_quoted_string(str)
  else
    put_string(str)
  end
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-send_symbol_data"> <span class="method-name">send_symbol_data</span><span class="method-args">(symbol)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="send_symbol_data-source"> <pre class="ruby" data-language="ruby"># File lib/net/imap.rb, line 1409
def send_symbol_data(symbol)
  put_string("\\" + symbol.to_s)
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-send_time_data"> <span class="method-name">send_time_data</span><span class="method-args">(time)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="send_time_data-source"> <pre class="ruby" data-language="ruby"># File lib/net/imap.rb, line 1401
def send_time_data(time)
  t = time.dup.gmtime
  s = format('"%2d-%3s-%4d %02d:%02d:%02d +0000"',
             t.day, DATE_MONTH[t.month - 1], t.year,
             t.hour, t.min, t.sec)
  put_string(s)
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-sort_internal"> <span class="method-name">sort_internal</span><span class="method-args">(cmd, sort_keys, search_keys, charset)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="sort_internal-source"> <pre class="ruby" data-language="ruby"># File lib/net/imap.rb, line 1465
def sort_internal(cmd, sort_keys, search_keys, charset)
  if search_keys.instance_of?(String)
    search_keys = [RawData.new(search_keys)]
  else
    normalize_searching_criteria(search_keys)
  end
  normalize_searching_criteria(search_keys)
  synchronize do
    send_command(cmd, sort_keys, charset, *search_keys)
    return @responses.delete("SORT")[-1]
  end
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-start_tls_session"> <span class="method-name">start_tls_session</span><span class="method-args">(params = {})</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="start_tls_session-source"> <pre class="ruby" data-language="ruby"># File lib/net/imap.rb, line 1517
def start_tls_session(params = {})
  unless defined?(OpenSSL::SSL)
    raise "SSL extension not installed"
  end
  if @sock.kind_of?(OpenSSL::SSL::SSLSocket)
    raise RuntimeError, "already using SSL"
  end
  begin
    params = params.to_hash
  rescue NoMethodError
    params = {}
  end
  context = SSLContext.new
  context.set_params(params)
  if defined?(VerifyCallbackProc)
    context.verify_callback = VerifyCallbackProc
  end
  @sock = SSLSocket.new(@sock, context)
  @sock.sync_close = true
  @sock.hostname = @host if @sock.respond_to? :hostname=
  ssl_socket_connect(@sock, @open_timeout)
  if context.verify_mode != VERIFY_NONE
    @sock.post_connection_check(@host)
  end
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-store_internal"> <span class="method-name">store_internal</span><span class="method-args">(cmd, set, attr, flags)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="store_internal-source"> <pre class="ruby" data-language="ruby"># File lib/net/imap.rb, line 1450
def store_internal(cmd, set, attr, flags)
  if attr.instance_of?(String)
    attr = RawData.new(attr)
  end
  synchronize do
    @responses.delete("FETCH")
    send_command(cmd, MessageSet.new(set), attr, flags)
    return @responses.delete("FETCH")
  end
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-tcp_socket"> <span class="method-name">tcp_socket</span><span class="method-args">(host, port)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="tcp_socket-source"> <pre class="ruby" data-language="ruby"># File lib/net/imap.rb, line 1134
def tcp_socket(host, port)
  s = Socket.tcp(host, port, :connect_timeout =&gt; @open_timeout)
  s.setsockopt(:SOL_SOCKET, :SO_KEEPALIVE, true)
  s
rescue Errno::ETIMEDOUT
  raise Net::OpenTimeout, "Timeout to open TCP connection to " +
    "#{host}:#{port} (exceeds #{@open_timeout} seconds)"
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-thread_internal"> <span class="method-name">thread_internal</span><span class="method-args">(cmd, algorithm, search_keys, charset)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="thread_internal-source"> <pre class="ruby" data-language="ruby"># File lib/net/imap.rb, line 1478
def thread_internal(cmd, algorithm, search_keys, charset)
  if search_keys.instance_of?(String)
    search_keys = [RawData.new(search_keys)]
  else
    normalize_searching_criteria(search_keys)
  end
  normalize_searching_criteria(search_keys)
  send_command(cmd, algorithm, charset, *search_keys)
  return @responses.delete("THREAD")[-1]
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-validate_data"> <span class="method-name">validate_data</span><span class="method-args">(data)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="validate_data-source"> <pre class="ruby" data-language="ruby"># File lib/net/imap.rb, line 1305
def validate_data(data)
  case data
  when nil
  when String
  when Integer
    NumValidator.ensure_number(data)
  when Array
    if data[0] == 'CHANGEDSINCE'
      NumValidator.ensure_mod_sequence_value(data[1])
    else
      data.each do |i|
        validate_data(i)
      end
    end
  when Time
  when Symbol
  else
    data.validate
  end
end</pre> </div>  </div> </div> </section> </section><div class="_attribution">
  <p class="_attribution-p">
    Ruby Core &copy; 1993&ndash;2020 Yukihiro Matsumoto<br>Licensed under the Ruby License.<br>Ruby Standard Library &copy; contributors<br>Licensed under their own licenses.<br>
    
  </p>
</div>
