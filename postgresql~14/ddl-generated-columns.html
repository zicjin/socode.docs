<h1>5.3. Generated Columns</h1>    <p>A generated column is a special column that is always computed from other columns. Thus, it is for columns what a view is for tables. There are two kinds of generated columns: stored and virtual. A stored generated column is computed when it is written (inserted or updated) and occupies storage as if it were a normal column. A virtual generated column occupies no storage and is computed when it is read. Thus, a virtual generated column is similar to a view and a stored generated column is similar to a materialized view (except that it is always updated automatically). PostgreSQL currently implements only stored generated columns.</p> <p>To create a generated column, use the <code class="literal">GENERATED ALWAYS AS</code> clause in <code class="command">CREATE TABLE</code>, for example:</p> <pre data-language="sql">
CREATE TABLE people (
    ...,
    height_cm numeric,
    height_in numeric <strong>GENERATED ALWAYS AS (height_cm / 2.54) STORED</strong>
);
</pre> <p>The keyword <code class="literal">STORED</code> must be specified to choose the stored kind of generated column. See <a class="xref" href="sql-createtable" title="CREATE TABLE">CREATE TABLE</a> for more details.</p> <p>A generated column cannot be written to directly. In <code class="command">INSERT</code> or <code class="command">UPDATE</code> commands, a value cannot be specified for a generated column, but the keyword <code class="literal">DEFAULT</code> may be specified.</p> <p>Consider the differences between a column with a default and a generated column. The column default is evaluated once when the row is first inserted if no other value was provided; a generated column is updated whenever the row changes and cannot be overridden. A column default may not refer to other columns of the table; a generation expression would normally do so. A column default can use volatile functions, for example <code class="literal">random()</code> or functions referring to the current time; this is not allowed for generated columns.</p> <p>Several restrictions apply to the definition of generated columns and tables involving generated columns:</p>  <ul> <li> <p>The generation expression can only use immutable functions and cannot use subqueries or reference anything other than the current row in any way.</p> </li> <li> <p>A generation expression cannot reference another generated column.</p> </li> <li> <p>A generation expression cannot reference a system column, except <code class="varname">tableoid</code>.</p> </li> <li> <p>A generated column cannot have a column default or an identity definition.</p> </li> <li> <p>A generated column cannot be part of a partition key.</p> </li> <li> <p>Foreign tables can have generated columns. See <a class="xref" href="sql-createforeigntable" title="CREATE FOREIGN TABLE">CREATE FOREIGN TABLE</a> for details.</p> </li> <li> <p>For inheritance:</p>  <ul> <li> <p>If a parent column is a generated column, a child column must also be a generated column using the same expression. In the definition of the child column, leave off the <code class="literal">GENERATED</code> clause, as it will be copied from the parent.</p> </li> <li> <p>In case of multiple inheritance, if one parent column is a generated column, then all parent columns must be generated columns and with the same expression.</p> </li> <li> <p>If a parent column is not a generated column, a child column may be defined to be a generated column or not.</p> </li> </ul>  </li> </ul>  <p>Additional considerations apply to the use of generated columns.</p>  <ul> <li> <p>Generated columns maintain access privileges separately from their underlying base columns. So, it is possible to arrange it so that a particular role can read from a generated column but not from the underlying base columns.</p> </li> <li> <p>Generated columns are, conceptually, updated after <code class="literal">BEFORE</code> triggers have run. Therefore, changes made to base columns in a <code class="literal">BEFORE</code> trigger will be reflected in generated columns. But conversely, it is not allowed to access generated columns in <code class="literal">BEFORE</code> triggers.</p> </li> </ul>   <div xmlns="http://www.w3.org/TR/xhtml1/transitional" class="navfooter">  <table summary="Navigation footer"> <tr> <td width="40%" align="left">
<a accesskey="p" href="ddl-default" title="5.2. Default Values">Prev</a> </td> <td width="20%" align="center"><a accesskey="u" href="https://www.postgresql.org/docs/14/ddl.html" title="Chapter 5. Data Definition">Up</a></td> <td width="40%" align="right"> <a accesskey="n" href="ddl-constraints" title="5.4. Constraints">Next</a>
</td> </tr> <tr> <td width="40%" align="left">5.2. Default Values </td> <td width="20%" align="center"><a accesskey="h" href="https://www.postgresql.org/docs/14/index.html" title="PostgreSQL 14.4 Documentation">Home</a></td> <td width="40%" align="right"> 5.4. Constraints</td> </tr> </table> </div><div class="_attribution">
  <p class="_attribution-p">
    <a href="https://www.postgresql.org/docs/14/ddl-generated-columns.html" class="_attribution-link" target="_blank">https://www.postgresql.org/docs/14/ddl-generated-columns.html</a>
  </p>
</div>
