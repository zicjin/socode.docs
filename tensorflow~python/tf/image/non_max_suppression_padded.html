<h1 class="devsite-page-title">tf.image.non_max_suppression_padded</h1>     <div itemscope itemtype="http://developers.google.com/ReferenceObject"> <meta itemprop="name" content="tf.image.non_max_suppression_padded"> <meta itemprop="path" content="Stable"> </div>   <table class="tfo-notebook-buttons tfo-api" align="left"> <td> <a target="_blank" href="https://www.tensorflow.org/versions/r1.15/api_docs/python/tf/image/non_max_suppression_padded">  TensorFlow 1 version</a> </td> <td> <a target="_blank" href="https://github.com/tensorflow/tensorflow/blob/r2.1/tensorflow/python/ops/image_ops_impl.py#L2769-L2822">  View source on GitHub </a> </td>
</table>  <p>Greedily selects a subset of bounding boxes in descending order of score.</p> <pre class="prettyprint lang-python" translate="no" dir="ltr" data-language="python">tf.image.non_max_suppression_padded(
    boxes,
    scores,
    max_output_size,
    iou_threshold=0.5,
    score_threshold=float('-inf'),
    pad_to_max_output_size=False,
    name=None
)
</pre>  <p>Performs algorithmically equivalent operation to tf.image.non_max_suppression, with the addition of an optional parameter which zero-pads the output to be of size <code translate="no" dir="ltr">max_output_size</code>. The output of this operation is a tuple containing the set of integers indexing into the input collection of bounding boxes representing the selected boxes and the number of valid indices in the index set. The bounding box coordinates corresponding to the selected indices can then be obtained using the <a href="../slice"><code translate="no" dir="ltr">tf.slice</code></a> and <a href="../gather"><code translate="no" dir="ltr">tf.gather</code></a> operations. For example:</p> <pre class="prettyprint" translate="no" dir="ltr" data-language="python">selected_indices_padded, num_valid = tf.image.non_max_suppression_padded(
    boxes, scores, max_output_size, iou_threshold,
    score_threshold, pad_to_max_output_size=True)
selected_indices = tf.slice(
    selected_indices_padded, tf.constant([0]), num_valid)
selected_boxes = tf.gather(boxes, selected_indices)
</pre> <h4 id="args_2">Args:</h4> <ul> <li>
<b><code translate="no" dir="ltr">boxes</code></b>: A 2-D float <code translate="no" dir="ltr">Tensor</code> of shape <code translate="no" dir="ltr">[num_boxes, 4]</code>.</li> <li>
<b><code translate="no" dir="ltr">scores</code></b>: A 1-D float <code translate="no" dir="ltr">Tensor</code> of shape <code translate="no" dir="ltr">[num_boxes]</code> representing a single score corresponding to each box (each row of boxes).</li> <li>
<b><code translate="no" dir="ltr">max_output_size</code></b>: A scalar integer <code translate="no" dir="ltr">Tensor</code> representing the maximum number of boxes to be selected by non max suppression.</li> <li>
<b><code translate="no" dir="ltr">iou_threshold</code></b>: A float representing the threshold for deciding whether boxes overlap too much with respect to IOU.</li> <li>
<b><code translate="no" dir="ltr">score_threshold</code></b>: A float representing the threshold for deciding when to remove boxes based on score.</li> <li>
<b><code translate="no" dir="ltr">pad_to_max_output_size</code></b>: bool. If True, size of <code translate="no" dir="ltr">selected_indices</code> output is padded to <code translate="no" dir="ltr">max_output_size</code>.</li> <li>
<b><code translate="no" dir="ltr">name</code></b>: A name for the operation (optional).</li> </ul> <h4 id="returns_2">Returns:</h4> <ul> <li>
<b><code translate="no" dir="ltr">selected_indices</code></b>: A 1-D integer <code translate="no" dir="ltr">Tensor</code> of shape <code translate="no" dir="ltr">[M]</code> representing the selected indices from the boxes tensor, where <code translate="no" dir="ltr">M &lt;= max_output_size</code>.</li> <li>
<b><code translate="no" dir="ltr">valid_outputs</code></b>: A scalar integer <code translate="no" dir="ltr">Tensor</code> denoting how many elements in <code translate="no" dir="ltr">selected_indices</code> are valid. Valid elements occur first, then padding.</li> </ul> <h2 id="compat_aliases_2">Compat aliases</h2> <ul> <li><a href="non_max_suppression_padded"><code translate="no" dir="ltr">tf.compat.v1.image.non_max_suppression_padded</code></a></li> <li><a href="non_max_suppression_padded"><code translate="no" dir="ltr">tf.compat.v2.image.non_max_suppression_padded</code></a></li> </ul>  <devsite-page-rating position="footer" selected-rating="0" hover-rating-star="0"> </devsite-page-rating><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2019 The TensorFlow Authors. All rights reserved.<br>Licensed under the Creative Commons Attribution License 3.0.<br>Code samples licensed under the Apache 2.0 License.<br>
    <a href="https://www.tensorflow.org/api_docs/python/tf/image/non_max_suppression_padded" class="_attribution-link">https://www.tensorflow.org/api_docs/python/tf/image/non_max_suppression_padded</a>
  </p>
</div>
