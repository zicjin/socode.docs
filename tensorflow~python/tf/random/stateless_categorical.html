<h1 class="devsite-page-title">tf.random.stateless_categorical</h1>     <div itemscope itemtype="http://developers.google.com/ReferenceObject"> <meta itemprop="name" content="tf.random.stateless_categorical"> <meta itemprop="path" content="Stable"> </div>  <table class="tfo-notebook-buttons tfo-api" align="left"> <td> <a target="_blank" href="https://www.tensorflow.org/versions/r1.15/api_docs/python/tf/random/stateless_categorical">  TensorFlow 1 version</a> </td> <td> <a target="_blank" href="https://github.com/tensorflow/tensorflow/blob/r2.1/tensorflow/python/ops/stateless_random_ops.py#L230-L266">  View source on GitHub </a> </td>
</table>  <p>Draws deterministic pseudorandom samples from a categorical distribution.</p> <pre class="prettyprint lang-python" translate="no" dir="ltr" data-language="python">tf.random.stateless_categorical(
    logits,
    num_samples,
    seed,
    dtype=tf.dtypes.int64,
    name=None
)
</pre>  <p>This is a stateless version of <code translate="no" dir="ltr">tf.categorical</code>: if run twice with the same seeds, it will produce the same pseudorandom numbers. The output is consistent across multiple runs on the same hardware (and between CPU and GPU), but may change between versions of TensorFlow or on non-CPU/GPU hardware.</p> <h4 id="example">Example:</h4> <pre class="prettyprint lang-python" translate="no" dir="ltr" data-language="python"># samples has shape [1, 5], where each value is either 0 or 1 with equal
# probability.
samples = tf.random.stateless_categorical(
    tf.math.log([[0.5, 0.5]]), 5, seed=[7, 17])
</pre> <h4 id="args">Args:</h4> <ul> <li>
<b><code translate="no" dir="ltr">logits</code></b>: 2-D Tensor with shape <code translate="no" dir="ltr">[batch_size, num_classes]</code>. Each slice <code translate="no" dir="ltr">[i, :]</code> represents the unnormalized log-probabilities for all classes.</li> <li>
<b><code translate="no" dir="ltr">num_samples</code></b>: 0-D. Number of independent samples to draw for each row slice.</li> <li>
<b><code translate="no" dir="ltr">seed</code></b>: A shape [2] integer Tensor of seeds to the random number generator.</li> <li>
<b><code translate="no" dir="ltr">dtype</code></b>: integer type to use for the output. Defaults to int64.</li> <li>
<b><code translate="no" dir="ltr">name</code></b>: Optional name for the operation.</li> </ul> <h4 id="returns">Returns:</h4> <p>The drawn samples of shape <code translate="no" dir="ltr">[batch_size, num_samples]</code>.</p> <h2 id="compat_aliases">Compat aliases</h2> <ul> <li><a href="stateless_categorical"><code translate="no" dir="ltr">tf.compat.v1.random.stateless_categorical</code></a></li> <li><a href="stateless_categorical"><code translate="no" dir="ltr">tf.compat.v2.random.stateless_categorical</code></a></li> </ul>  <devsite-page-rating position="footer" selected-rating="0" hover-rating-star="0"> </devsite-page-rating><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2019 The TensorFlow Authors. All rights reserved.<br>Licensed under the Creative Commons Attribution License 3.0.<br>Code samples licensed under the Apache 2.0 License.<br>
    <a href="https://www.tensorflow.org/api_docs/python/tf/random/stateless_categorical" class="_attribution-link">https://www.tensorflow.org/api_docs/python/tf/random/stateless_categorical</a>
  </p>
</div>
