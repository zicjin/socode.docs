<h1 class="devsite-page-title">tf.keras.layers.Bidirectional</h1>     <div itemscope itemtype="http://developers.google.com/ReferenceObject"> <meta itemprop="name" content="tf.keras.layers.Bidirectional"> <meta itemprop="path" content="Stable"> <meta itemprop="property" content="constraints"> <meta itemprop="property" content="__init__"> <meta itemprop="property" content="reset_states"> </div>  <table class="tfo-notebook-buttons tfo-api" align="left"> <td> <a target="_blank" href="https://www.tensorflow.org/versions/r1.15/api_docs/python/tf/keras/layers/Bidirectional">  TensorFlow 1 version</a> </td> <td> <a target="_blank" href="https://github.com/tensorflow/tensorflow/blob/r2.1/tensorflow/python/keras/layers/wrappers.py#L353-L757">  View source on GitHub </a> </td>
</table>  <h2 id="class_bidirectional">Class <code translate="no" dir="ltr">Bidirectional</code>
</h2> <p>Bidirectional wrapper for RNNs.</p> <p>Inherits From: <a href="wrapper"><code translate="no" dir="ltr">Wrapper</code></a></p> <h3 id="used_in_the_guide">Used in the guide:</h3> <ul> <li><a href="https://www.tensorflow.org/guide/keras/rnn">Recurrent Neural Networks (RNN) with Keras</a></li> </ul> <h3 id="used_in_the_tutorials">Used in the tutorials:</h3> <ul> <li><a href="https://www.tensorflow.org/tutorials/text/text_classification_rnn">Text classification with an RNN</a></li> <li><a href="https://www.tensorflow.org/tutorials/load_data/text">Load text</a></li> </ul> <h4 id="arguments">Arguments:</h4> <ul> <li>
<b><code translate="no" dir="ltr">layer</code></b>: <code translate="no" dir="ltr">Recurrent</code> instance.</li> <li>
<b><code translate="no" dir="ltr">merge_mode</code></b>: Mode by which outputs of the forward and backward RNNs will be combined. One of {'sum', 'mul', 'concat', 'ave', None}. If None, the outputs will not be combined, they will be returned as a list.</li> <li>
<b><code translate="no" dir="ltr">backward_layer</code></b>: Optional <code translate="no" dir="ltr">Recurrent</code> instance to be used to handle backwards input processing. If <code translate="no" dir="ltr">backward_layer</code> is not provided, the layer instance passed as the <code translate="no" dir="ltr">layer</code> argument will be used to generate the backward layer automatically. Note that the provided <code translate="no" dir="ltr">backward_layer</code> layer should have properties matching those of the <code translate="no" dir="ltr">layer</code> argument, in particular it should have the same values for <code translate="no" dir="ltr">stateful</code>, <code translate="no" dir="ltr">return_states</code>, <code translate="no" dir="ltr">return_sequence</code>, etc. In addition, <code translate="no" dir="ltr">backward_layer</code> and <code translate="no" dir="ltr">layer</code> should have different <code translate="no" dir="ltr">go_backwards</code> argument values. A <code translate="no" dir="ltr">ValueError</code> will be raised if these requirements are not met.</li> </ul> <h4 id="call_arguments">Call arguments:</h4> <p>The call arguments for this layer are the same as those of the wrapped RNN layer.</p> <h4 id="raises">Raises:</h4> <ul> <li>
<b><code translate="no" dir="ltr">ValueError</code></b>: 1. If <code translate="no" dir="ltr">layer</code> or <code translate="no" dir="ltr">backward_layer</code> is not a <code translate="no" dir="ltr">Layer</code> instance. <ol> <li>In case of invalid <code translate="no" dir="ltr">merge_mode</code> argument.</li> <li>If <code translate="no" dir="ltr">backward_layer</code> has mismatched properties compared to <code translate="no" dir="ltr">layer</code>.</li> </ol>
</li> </ul> <h4 id="examples">Examples:</h4> <pre class="prettyprint lang-python" translate="no" dir="ltr" data-language="python">model = Sequential()
model.add(Bidirectional(LSTM(10, return_sequences=True), input_shape=(5, 10)))
model.add(Bidirectional(LSTM(10)))
model.add(Dense(5))
model.add(Activation('softmax'))
model.compile(loss='categorical_crossentropy', optimizer='rmsprop')

 # With custom backward layer
 model = Sequential()
 forward_layer = LSTM(10, return_sequences=True)
 backward_layer = LSTM(10, activation='relu', return_sequences=True,
                       go_backwards=True)
 model.add(Bidirectional(forward_layer, backward_layer=backward_layer,
                         input_shape=(5, 10)))
 model.add(Dense(5))
 model.add(Activation('softmax'))
 model.compile(loss='categorical_crossentropy', optimizer='rmsprop')
</pre> <h2 id="__init__"><code translate="no" dir="ltr">__init__</code></h2> <p><a target="_blank" href="https://github.com/tensorflow/tensorflow/blob/r2.1/tensorflow/python/keras/layers/wrappers.py#L407-L468">View source</a></p> <pre class="prettyprint lang-python" translate="no" dir="ltr" data-language="python">__init__(
    layer,
    merge_mode='concat',
    weights=None,
    backward_layer=None,
    **kwargs
)
</pre> <h2 id="properties">Properties</h2> <h3 id="constraints"><code translate="no" dir="ltr">constraints</code></h3> <h2 id="methods">Methods</h2> <h3 id="reset_states"><code translate="no" dir="ltr">reset_states</code></h3> <p><a target="_blank" href="https://github.com/tensorflow/tensorflow/blob/r2.1/tensorflow/python/keras/layers/wrappers.py#L691-L693">View source</a></p> <pre class="prettyprint lang-python" translate="no" dir="ltr" data-language="python">reset_states()
</pre> <h2 id="compat_aliases">Compat aliases</h2> <ul> <li><a href="bidirectional"><code translate="no" dir="ltr">tf.compat.v1.keras.layers.Bidirectional</code></a></li> <li><a href="bidirectional"><code translate="no" dir="ltr">tf.compat.v2.keras.layers.Bidirectional</code></a></li> </ul>  <devsite-page-rating position="footer" selected-rating="0" hover-rating-star="0"> </devsite-page-rating><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2019 The TensorFlow Authors. All rights reserved.<br>Licensed under the Creative Commons Attribution License 3.0.<br>Code samples licensed under the Apache 2.0 License.<br>
    <a href="https://www.tensorflow.org/api_docs/python/tf/keras/layers/Bidirectional" class="_attribution-link">https://www.tensorflow.org/api_docs/python/tf/keras/layers/Bidirectional</a>
  </p>
</div>
