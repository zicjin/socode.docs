<h1 class="devsite-page-title">tf.keras.layers.ConvLSTM2D</h1>     <div itemscope itemtype="http://developers.google.com/ReferenceObject"> <meta itemprop="name" content="tf.keras.layers.ConvLSTM2D"> <meta itemprop="path" content="Stable"> <meta itemprop="property" content="activation"> <meta itemprop="property" content="bias_constraint"> <meta itemprop="property" content="bias_initializer"> <meta itemprop="property" content="bias_regularizer"> <meta itemprop="property" content="data_format"> <meta itemprop="property" content="dilation_rate"> <meta itemprop="property" content="dropout"> <meta itemprop="property" content="filters"> <meta itemprop="property" content="kernel_constraint"> <meta itemprop="property" content="kernel_initializer"> <meta itemprop="property" content="kernel_regularizer"> <meta itemprop="property" content="kernel_size"> <meta itemprop="property" content="padding"> <meta itemprop="property" content="recurrent_activation"> <meta itemprop="property" content="recurrent_constraint"> <meta itemprop="property" content="recurrent_dropout"> <meta itemprop="property" content="recurrent_initializer"> <meta itemprop="property" content="recurrent_regularizer"> <meta itemprop="property" content="states"> <meta itemprop="property" content="strides"> <meta itemprop="property" content="unit_forget_bias"> <meta itemprop="property" content="use_bias"> <meta itemprop="property" content="__init__"> <meta itemprop="property" content="reset_states"> </div>  <table class="tfo-notebook-buttons tfo-api" align="left"> <td> <a target="_blank" href="https://www.tensorflow.org/versions/r1.15/api_docs/python/tf/keras/layers/ConvLSTM2D">  TensorFlow 1 version</a> </td> <td> <a target="_blank" href="https://github.com/tensorflow/tensorflow/blob/r2.1/tensorflow/python/keras/layers/convolutional_recurrent.py#L758-L1061">  View source on GitHub </a> </td>
</table>  <h2 id="class_convlstm2d">Class <code translate="no" dir="ltr">ConvLSTM2D</code>
</h2> <p>Convolutional LSTM.</p>  <p>It is similar to an LSTM layer, but the input transformations and recurrent transformations are both convolutional.</p> <h4 id="arguments">Arguments:</h4> <ul> <li>
<b><code translate="no" dir="ltr">filters</code></b>: Integer, the dimensionality of the output space (i.e. the number of output filters in the convolution).</li> <li>
<b><code translate="no" dir="ltr">kernel_size</code></b>: An integer or tuple/list of n integers, specifying the dimensions of the convolution window.</li> <li>
<b><code translate="no" dir="ltr">strides</code></b>: An integer or tuple/list of n integers, specifying the strides of the convolution. Specifying any stride value != 1 is incompatible with specifying any <code translate="no" dir="ltr">dilation_rate</code> value != 1.</li> <li>
<b><code translate="no" dir="ltr">padding</code></b>: One of <code translate="no" dir="ltr">"valid"</code> or <code translate="no" dir="ltr">"same"</code> (case-insensitive).</li> <li>
<b><code translate="no" dir="ltr">data_format</code></b>: A string, one of <code translate="no" dir="ltr">channels_last</code> (default) or <code translate="no" dir="ltr">channels_first</code>. The ordering of the dimensions in the inputs. <code translate="no" dir="ltr">channels_last</code> corresponds to inputs with shape <code translate="no" dir="ltr">(batch, time, ..., channels)</code> while <code translate="no" dir="ltr">channels_first</code> corresponds to inputs with shape <code translate="no" dir="ltr">(batch, time, channels, ...)</code>. It defaults to the <code translate="no" dir="ltr">image_data_format</code> value found in your Keras config file at <code translate="no" dir="ltr">~/.keras/keras.json</code>. If you never set it, then it will be "channels_last".</li> <li>
<b><code translate="no" dir="ltr">dilation_rate</code></b>: An integer or tuple/list of n integers, specifying the dilation rate to use for dilated convolution. Currently, specifying any <code translate="no" dir="ltr">dilation_rate</code> value != 1 is incompatible with specifying any <code translate="no" dir="ltr">strides</code> value != 1.</li> <li>
<b><code translate="no" dir="ltr">activation</code></b>: Activation function to use. By default hyperbolic tangent activation function is applied (<code translate="no" dir="ltr">tanh(x)</code>).</li> <li>
<b><code translate="no" dir="ltr">recurrent_activation</code></b>: Activation function to use for the recurrent step.</li> <li>
<b><code translate="no" dir="ltr">use_bias</code></b>: Boolean, whether the layer uses a bias vector.</li> <li>
<b><code translate="no" dir="ltr">kernel_initializer</code></b>: Initializer for the <code translate="no" dir="ltr">kernel</code> weights matrix, used for the linear transformation of the inputs.</li> <li>
<b><code translate="no" dir="ltr">recurrent_initializer</code></b>: Initializer for the <code translate="no" dir="ltr">recurrent_kernel</code> weights matrix, used for the linear transformation of the recurrent state.</li> <li>
<b><code translate="no" dir="ltr">bias_initializer</code></b>: Initializer for the bias vector.</li> <li>
<b><code translate="no" dir="ltr">unit_forget_bias</code></b>: Boolean. If True, add 1 to the bias of the forget gate at initialization. Use in combination with <code translate="no" dir="ltr">bias_initializer="zeros"</code>. This is recommended in <a href="http://www.jmlr.org/proceedings/papers/v37/jozefowicz15.pdf">Jozefowicz et al.</a>
</li> <li>
<b><code translate="no" dir="ltr">kernel_regularizer</code></b>: Regularizer function applied to the <code translate="no" dir="ltr">kernel</code> weights matrix.</li> <li>
<b><code translate="no" dir="ltr">recurrent_regularizer</code></b>: Regularizer function applied to the <code translate="no" dir="ltr">recurrent_kernel</code> weights matrix.</li> <li>
<b><code translate="no" dir="ltr">bias_regularizer</code></b>: Regularizer function applied to the bias vector.</li> <li>
<b><code translate="no" dir="ltr">activity_regularizer</code></b>: Regularizer function applied to.</li> <li>
<b><code translate="no" dir="ltr">kernel_constraint</code></b>: Constraint function applied to the <code translate="no" dir="ltr">kernel</code> weights matrix.</li> <li>
<b><code translate="no" dir="ltr">recurrent_constraint</code></b>: Constraint function applied to the <code translate="no" dir="ltr">recurrent_kernel</code> weights matrix.</li> <li>
<b><code translate="no" dir="ltr">bias_constraint</code></b>: Constraint function applied to the bias vector.</li> <li>
<b><code translate="no" dir="ltr">return_sequences</code></b>: Boolean. Whether to return the last output in the output sequence, or the full sequence.</li> <li>
<b><code translate="no" dir="ltr">go_backwards</code></b>: Boolean (default False). If True, process the input sequence backwards.</li> <li>
<b><code translate="no" dir="ltr">stateful</code></b>: Boolean (default False). If True, the last state for each sample at index i in a batch will be used as initial state for the sample of index i in the following batch.</li> <li>
<b><code translate="no" dir="ltr">dropout</code></b>: Float between 0 and 1. Fraction of the units to drop for the linear transformation of the inputs.</li> <li>
<b><code translate="no" dir="ltr">recurrent_dropout</code></b>: Float between 0 and 1. Fraction of the units to drop for the linear transformation of the recurrent state.</li> </ul> <h4 id="call_arguments">Call arguments:</h4> <ul> <li>
<b><code translate="no" dir="ltr">inputs</code></b>: A 5D tensor.</li> <li>
<b><code translate="no" dir="ltr">mask</code></b>: Binary tensor of shape <code translate="no" dir="ltr">(samples, timesteps)</code> indicating whether a given timestep should be masked.</li> <li>
<b><code translate="no" dir="ltr">training</code></b>: Python boolean indicating whether the layer should behave in training mode or in inference mode. This argument is passed to the cell when calling it. This is only relevant if <code translate="no" dir="ltr">dropout</code> or <code translate="no" dir="ltr">recurrent_dropout</code> are set.</li> <li>
<b><code translate="no" dir="ltr">initial_state</code></b>: List of initial state tensors to be passed to the first call of the cell.</li> </ul> <h4 id="input_shape">Input shape:</h4> <ul> <li>If data_format='channels_first' 5D tensor with shape: <code translate="no" dir="ltr">(samples, time, channels, rows, cols)</code>
</li> <li>If data_format='channels_last' 5D tensor with shape: <code translate="no" dir="ltr">(samples, time, rows, cols, channels)</code>
</li> </ul> <h4 id="output_shape">Output shape:</h4> <ul> <li>If <code translate="no" dir="ltr">return_sequences</code> <ul> <li>If data_format='channels_first' 5D tensor with shape: <code translate="no" dir="ltr">(samples, time, filters, output_row, output_col)</code>
</li> <li>If data_format='channels_last' 5D tensor with shape: <code translate="no" dir="ltr">(samples, time, output_row, output_col, filters)</code>
</li> </ul>
</li> <li>Else <ul> <li>If data_format ='channels_first' 4D tensor with shape: <code translate="no" dir="ltr">(samples, filters, output_row, output_col)</code>
</li> <li>If data_format='channels_last' 4D tensor with shape: <code translate="no" dir="ltr">(samples, output_row, output_col, filters)</code> where <code translate="no" dir="ltr">o_row</code> and <code translate="no" dir="ltr">o_col</code> depend on the shape of the filter and the padding</li> </ul>
</li> </ul> <h4 id="raises">Raises:</h4> <ul> <li>
<b><code translate="no" dir="ltr">ValueError</code></b>: in case of invalid constructor arguments.</li> </ul> <h4 id="references">References:</h4> <ul> <li>
<a href="http://arxiv.org/abs/1506.04214v1">Convolutional LSTM Network: A Machine Learning Approach for Precipitation Nowcasting</a> The current implementation does not include the feedback loop on the cells output.</li> </ul> <h2 id="__init__"><code translate="no" dir="ltr">__init__</code></h2> <p><a target="_blank" href="https://github.com/tensorflow/tensorflow/blob/r2.1/tensorflow/python/keras/layers/convolutional_recurrent.py#L877-L931">View source</a></p> <pre class="prettyprint lang-python" translate="no" dir="ltr" data-language="python">__init__(
    filters,
    kernel_size,
    strides=(1, 1),
    padding='valid',
    data_format=None,
    dilation_rate=(1, 1),
    activation='tanh',
    recurrent_activation='hard_sigmoid',
    use_bias=True,
    kernel_initializer='glorot_uniform',
    recurrent_initializer='orthogonal',
    bias_initializer='zeros',
    unit_forget_bias=True,
    kernel_regularizer=None,
    recurrent_regularizer=None,
    bias_regularizer=None,
    activity_regularizer=None,
    kernel_constraint=None,
    recurrent_constraint=None,
    bias_constraint=None,
    return_sequences=False,
    go_backwards=False,
    stateful=False,
    dropout=0.0,
    recurrent_dropout=0.0,
    **kwargs
)
</pre> <h2 id="properties">Properties</h2> <h3 id="activation"><code translate="no" dir="ltr">activation</code></h3> <h3 id="bias_constraint"><code translate="no" dir="ltr">bias_constraint</code></h3> <h3 id="bias_initializer"><code translate="no" dir="ltr">bias_initializer</code></h3> <h3 id="bias_regularizer"><code translate="no" dir="ltr">bias_regularizer</code></h3> <h3 id="data_format"><code translate="no" dir="ltr">data_format</code></h3> <h3 id="dilation_rate"><code translate="no" dir="ltr">dilation_rate</code></h3> <h3 id="dropout"><code translate="no" dir="ltr">dropout</code></h3> <h3 id="filters"><code translate="no" dir="ltr">filters</code></h3> <h3 id="kernel_constraint"><code translate="no" dir="ltr">kernel_constraint</code></h3> <h3 id="kernel_initializer"><code translate="no" dir="ltr">kernel_initializer</code></h3> <h3 id="kernel_regularizer"><code translate="no" dir="ltr">kernel_regularizer</code></h3> <h3 id="kernel_size"><code translate="no" dir="ltr">kernel_size</code></h3> <h3 id="padding"><code translate="no" dir="ltr">padding</code></h3> <h3 id="recurrent_activation"><code translate="no" dir="ltr">recurrent_activation</code></h3> <h3 id="recurrent_constraint"><code translate="no" dir="ltr">recurrent_constraint</code></h3> <h3 id="recurrent_dropout"><code translate="no" dir="ltr">recurrent_dropout</code></h3> <h3 id="recurrent_initializer"><code translate="no" dir="ltr">recurrent_initializer</code></h3> <h3 id="recurrent_regularizer"><code translate="no" dir="ltr">recurrent_regularizer</code></h3> <h3 id="states"><code translate="no" dir="ltr">states</code></h3> <h3 id="strides"><code translate="no" dir="ltr">strides</code></h3> <h3 id="unit_forget_bias"><code translate="no" dir="ltr">unit_forget_bias</code></h3> <h3 id="use_bias"><code translate="no" dir="ltr">use_bias</code></h3> <h2 id="methods">Methods</h2> <h3 id="reset_states"><code translate="no" dir="ltr">reset_states</code></h3> <p><a target="_blank" href="https://github.com/tensorflow/tensorflow/blob/r2.1/tensorflow/python/keras/layers/convolutional_recurrent.py#L414-L482">View source</a></p> <pre class="prettyprint lang-python" translate="no" dir="ltr" data-language="python">reset_states(states=None)
</pre> <p>Reset the recorded states for the stateful RNN layer.</p> <p>Can only be used when RNN layer is constructed with <code translate="no" dir="ltr">stateful</code> = <code translate="no" dir="ltr">True</code>. Args: states: Numpy arrays that contains the value for the initial state, which will be feed to cell at the first time step. When the value is None, zero filled numpy array will be created based on the cell state size.</p> <h4 id="raises_2">Raises:</h4> <ul> <li>
<b><code translate="no" dir="ltr">AttributeError</code></b>: When the RNN layer is not stateful.</li> <li>
<b><code translate="no" dir="ltr">ValueError</code></b>: When the batch size of the RNN layer is unknown.</li> <li>
<b><code translate="no" dir="ltr">ValueError</code></b>: When the input numpy array is not compatible with the RNN layer state, either size wise or dtype wise.</li> </ul> <h2 id="compat_aliases">Compat aliases</h2> <ul> <li><a href="convlstm2d"><code translate="no" dir="ltr">tf.compat.v1.keras.layers.ConvLSTM2D</code></a></li> <li><a href="convlstm2d"><code translate="no" dir="ltr">tf.compat.v2.keras.layers.ConvLSTM2D</code></a></li> </ul>  <devsite-page-rating position="footer" selected-rating="0" hover-rating-star="0"> </devsite-page-rating><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2019 The TensorFlow Authors. All rights reserved.<br>Licensed under the Creative Commons Attribution License 3.0.<br>Code samples licensed under the Apache 2.0 License.<br>
    <a href="https://www.tensorflow.org/api_docs/python/tf/keras/layers/ConvLSTM2D" class="_attribution-link">https://www.tensorflow.org/api_docs/python/tf/keras/layers/ConvLSTM2D</a>
  </p>
</div>
