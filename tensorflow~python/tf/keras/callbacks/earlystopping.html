<h1 class="devsite-page-title">tf.keras.callbacks.EarlyStopping</h1>     <div itemscope itemtype="http://developers.google.com/ReferenceObject"> <meta itemprop="name" content="tf.keras.callbacks.EarlyStopping"> <meta itemprop="path" content="Stable"> <meta itemprop="property" content="__init__"> <meta itemprop="property" content="get_monitor_value"> <meta itemprop="property" content="set_model"> <meta itemprop="property" content="set_params"> </div>   <table class="tfo-notebook-buttons tfo-api" align="left"> <td> <a target="_blank" href="https://www.tensorflow.org/versions/r1.15/api_docs/python/tf/keras/callbacks/EarlyStopping">  TensorFlow 1 version</a> </td> <td> <a target="_blank" href="https://github.com/tensorflow/tensorflow/blob/r2.1/tensorflow/python/keras/callbacks.py#L1170-L1287">  View source on GitHub </a> </td>
</table>  <h2 id="class_earlystopping_2">Class <code translate="no" dir="ltr">EarlyStopping</code>
</h2> <p>Stop training when a monitored quantity has stopped improving.</p> <p>Inherits From: <a href="callback"><code translate="no" dir="ltr">Callback</code></a></p> <h3 id="used_in_the_guide_2">Used in the guide:</h3> <ul> <li><a href="https://www.tensorflow.org/guide/keras/overview">Keras overview</a></li> <li><a href="https://www.tensorflow.org/guide/keras/train_and_evaluate">Train and evaluate with Keras</a></li> </ul> <h3 id="used_in_the_tutorials_2">Used in the tutorials:</h3> <ul> <li><a href="https://www.tensorflow.org/tutorials/keras/overfit_and_underfit">Overfit and underfit</a></li> <li><a href="https://www.tensorflow.org/tutorials/keras/regression">Basic regression: Predict fuel efficiency</a></li> <li><a href="https://www.tensorflow.org/tutorials/structured_data/imbalanced_data">Classification on imbalanced data</a></li> </ul> <h4 id="arguments_2">Arguments:</h4> <ul> <li>
<b><code translate="no" dir="ltr">monitor</code></b>: Quantity to be monitored.</li> <li>
<b><code translate="no" dir="ltr">min_delta</code></b>: Minimum change in the monitored quantity to qualify as an improvement, i.e. an absolute change of less than min_delta, will count as no improvement.</li> <li>
<b><code translate="no" dir="ltr">patience</code></b>: Number of epochs with no improvement after which training will be stopped.</li> <li>
<b><code translate="no" dir="ltr">verbose</code></b>: verbosity mode.</li> <li>
<b><code translate="no" dir="ltr">mode</code></b>: One of <code translate="no" dir="ltr">{"auto", "min", "max"}</code>. In <code translate="no" dir="ltr">min</code> mode, training will stop when the quantity monitored has stopped decreasing; in <code translate="no" dir="ltr">max</code> mode it will stop when the quantity monitored has stopped increasing; in <code translate="no" dir="ltr">auto</code> mode, the direction is automatically inferred from the name of the monitored quantity.</li> <li>
<b><code translate="no" dir="ltr">baseline</code></b>: Baseline value for the monitored quantity. Training will stop if the model doesn't show improvement over the baseline.</li> <li>
<b><code translate="no" dir="ltr">restore_best_weights</code></b>: Whether to restore model weights from the epoch with the best value of the monitored quantity. If False, the model weights obtained at the last step of training are used.</li> </ul> <h4 id="example_3">Example:</h4> <pre class="prettyprint lang-python" translate="no" dir="ltr" data-language="python">callback = tf.keras.callbacks.EarlyStopping(monitor='val_loss', patience=3)
# This callback will stop the training when there is no improvement in
# the validation loss for three consecutive epochs.
model.fit(data, labels, epochs=100, callbacks=[callback],
    validation_data=(val_data, val_labels))
</pre> <h2 id="__init__"><code translate="no" dir="ltr">__init__</code></h2> <p><a target="_blank" href="https://github.com/tensorflow/tensorflow/blob/r2.1/tensorflow/python/keras/callbacks.py#L1208-L1246">View source</a></p> <pre class="prettyprint lang-python" translate="no" dir="ltr" data-language="python">__init__(
    monitor='val_loss',
    min_delta=0,
    patience=0,
    verbose=0,
    mode='auto',
    baseline=None,
    restore_best_weights=False
)
</pre> <p>Initialize self. See help(type(self)) for accurate signature.</p> <h2 id="methods_2">Methods</h2> <h3 id="get_monitor_value"><code translate="no" dir="ltr">get_monitor_value</code></h3> <p><a target="_blank" href="https://github.com/tensorflow/tensorflow/blob/r2.1/tensorflow/python/keras/callbacks.py#L1280-L1287">View source</a></p> <pre class="prettyprint lang-python" translate="no" dir="ltr" data-language="python">get_monitor_value(logs)
</pre> <h3 id="set_model"><code translate="no" dir="ltr">set_model</code></h3> <p><a target="_blank" href="https://github.com/tensorflow/tensorflow/blob/r2.1/tensorflow/python/keras/callbacks.py#L465-L466">View source</a></p> <pre class="prettyprint lang-python" translate="no" dir="ltr" data-language="python">set_model(model)
</pre> <h3 id="set_params"><code translate="no" dir="ltr">set_params</code></h3> <p><a target="_blank" href="https://github.com/tensorflow/tensorflow/blob/r2.1/tensorflow/python/keras/callbacks.py#L462-L463">View source</a></p> <pre class="prettyprint lang-python" translate="no" dir="ltr" data-language="python">set_params(params)
</pre> <h2 id="compat_aliases_2">Compat aliases</h2> <ul> <li><a href="earlystopping"><code translate="no" dir="ltr">tf.compat.v1.keras.callbacks.EarlyStopping</code></a></li> <li><a href="earlystopping"><code translate="no" dir="ltr">tf.compat.v2.keras.callbacks.EarlyStopping</code></a></li> </ul>  <devsite-page-rating position="footer" selected-rating="0" hover-rating-star="0"> </devsite-page-rating><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2019 The TensorFlow Authors. All rights reserved.<br>Licensed under the Creative Commons Attribution License 3.0.<br>Code samples licensed under the Apache 2.0 License.<br>
    <a href="https://www.tensorflow.org/api_docs/python/tf/keras/callbacks/EarlyStopping" class="_attribution-link">https://www.tensorflow.org/api_docs/python/tf/keras/callbacks/EarlyStopping</a>
  </p>
</div>
