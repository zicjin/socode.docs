<h1 class="devsite-page-title">tf.keras.estimator.model_to_estimator</h1>     <div itemscope itemtype="http://developers.google.com/ReferenceObject"> <meta itemprop="name" content="tf.keras.estimator.model_to_estimator"> <meta itemprop="path" content="Stable"> </div>  <table class="tfo-notebook-buttons tfo-api" align="left"> <td> <a target="_blank" href="https://www.tensorflow.org/versions/r1.15/api_docs/python/tf/keras/estimator/model_to_estimator">  TensorFlow 1 version</a> </td> <td> <a target="_blank" href="https://github.com/tensorflow/tensorflow/blob/r2.1/tensorflow/python/keras/estimator/__init__.py#L120-L202">  View source on GitHub </a> </td>
</table>  <p>Constructs an <code translate="no" dir="ltr">Estimator</code> instance from given keras model.</p> <pre class="prettyprint lang-python" translate="no" dir="ltr" data-language="python">tf.keras.estimator.model_to_estimator(
    keras_model=None,
    keras_model_path=None,
    custom_objects=None,
    model_dir=None,
    config=None,
    checkpoint_format='checkpoint'
)
</pre> <h3 id="used_in_the_guide">Used in the guide:</h3> <ul> <li><a href="https://www.tensorflow.org/guide/estimator">Estimators</a></li> <li><a href="https://www.tensorflow.org/guide/migrate">Migrate your TensorFlow 1 code to TensorFlow 2</a></li> </ul> <h3 id="used_in_the_tutorials">Used in the tutorials:</h3> <ul> <li><a href="https://www.tensorflow.org/tutorials/estimator/keras_model_to_estimator">Create an Estimator from a Keras model</a></li> </ul> <p>If you use infrastructure or other tooling that relies on Estimators, you can still build a Keras model and use model_to_estimator to convert the Keras model to an Estimator for use with downstream systems.</p> <p>For usage example, please see: <a href="https://www.tensorflow.org/guide/estimators#creating_estimators_from_keras_models">Creating estimators from Keras Models</a>.</p> <p><strong>Sample Weights</strong> Estimators returned by <code translate="no" dir="ltr">model_to_estimator</code> are configured to handle sample weights (similar to <code translate="no" dir="ltr">keras_model.fit(x, y, sample_weights)</code>). To pass sample weights when training or evaluating the Estimator, the first item returned by the input function should be a dictionary with keys <code translate="no" dir="ltr">features</code> and <code translate="no" dir="ltr">sample_weights</code>. Example below:</p> <pre class="prettyprint" translate="no" dir="ltr" data-language="python">keras_model = tf.keras.Model(...)
keras_model.compile(...)

estimator = tf.keras.estimator.model_to_estimator(keras_model)

def input_fn():
  return dataset_ops.Dataset.from_tensors(
      ({'features': features, 'sample_weights': sample_weights},
       targets))

estimator.train(input_fn, steps=1)
</pre> <h4 id="args">Args:</h4> <ul> <li>
<b><code translate="no" dir="ltr">keras_model</code></b>: A compiled Keras model object. This argument is mutually exclusive with <code translate="no" dir="ltr">keras_model_path</code>.</li> <li>
<b><code translate="no" dir="ltr">keras_model_path</code></b>: Path to a compiled Keras model saved on disk, in HDF5 format, which can be generated with the <code translate="no" dir="ltr">save()</code> method of a Keras model. This argument is mutually exclusive with <code translate="no" dir="ltr">keras_model</code>.</li> <li>
<b><code translate="no" dir="ltr">custom_objects</code></b>: Dictionary for custom objects.</li> <li>
<b><code translate="no" dir="ltr">model_dir</code></b>: Directory to save <code translate="no" dir="ltr">Estimator</code> model parameters, graph, summary files for TensorBoard, etc.</li> <li>
<b><code translate="no" dir="ltr">config</code></b>: <code translate="no" dir="ltr">RunConfig</code> to config <code translate="no" dir="ltr">Estimator</code>.</li> <li>
<b><code translate="no" dir="ltr">checkpoint_format</code></b>: Sets the format of the checkpoint saved by the estimator when training. May be <code translate="no" dir="ltr">saver</code> or <code translate="no" dir="ltr">checkpoint</code>, depending on whether to save checkpoints from <a href="../../compat/v1/train/saver"><code translate="no" dir="ltr">tf.compat.v1.train.Saver</code></a> or <a href="../../train/checkpoint"><code translate="no" dir="ltr">tf.train.Checkpoint</code></a>. The default is <code translate="no" dir="ltr">checkpoint</code>. Estimators use name-based <code translate="no" dir="ltr">tf.train.Saver</code> checkpoints, while Keras models use object-based checkpoints from <a href="../../train/checkpoint"><code translate="no" dir="ltr">tf.train.Checkpoint</code></a>. Currently, saving object-based checkpoints from <code translate="no" dir="ltr">model_to_estimator</code> is only supported by Functional and Sequential models.</li> </ul> <h4 id="returns">Returns:</h4> <p>An Estimator from given keras model.</p> <h4 id="raises">Raises:</h4> <ul> <li>
<b><code translate="no" dir="ltr">ValueError</code></b>: if neither keras_model nor keras_model_path was given.</li> <li>
<b><code translate="no" dir="ltr">ValueError</code></b>: if both keras_model and keras_model_path was given.</li> <li>
<b><code translate="no" dir="ltr">ValueError</code></b>: if the keras_model_path is a GCS URI.</li> <li>
<b><code translate="no" dir="ltr">ValueError</code></b>: if keras_model has not been compiled.</li> <li>
<b><code translate="no" dir="ltr">ValueError</code></b>: if an invalid checkpoint_format was given.</li> </ul> <h2 id="compat_aliases">Compat aliases</h2> <ul> <li><a href="model_to_estimator"><code translate="no" dir="ltr">tf.compat.v2.keras.estimator.model_to_estimator</code></a></li> </ul>  <devsite-page-rating position="footer" selected-rating="0" hover-rating-star="0"> </devsite-page-rating><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2019 The TensorFlow Authors. All rights reserved.<br>Licensed under the Creative Commons Attribution License 3.0.<br>Code samples licensed under the Apache 2.0 License.<br>
    <a href="https://www.tensorflow.org/api_docs/python/tf/keras/estimator/model_to_estimator" class="_attribution-link">https://www.tensorflow.org/api_docs/python/tf/keras/estimator/model_to_estimator</a>
  </p>
</div>
