<h1 class="devsite-page-title">tf.keras.optimizers.Adagrad</h1>    <devsite-mathjax config="TeX-AMS-MML_SVG"></devsite-mathjax>  <div itemscope itemtype="http://developers.google.com/ReferenceObject"> <meta itemprop="name" content="tf.keras.optimizers.Adagrad"> <meta itemprop="path" content="Stable"> <meta itemprop="property" content="iterations"> <meta itemprop="property" content="weights"> <meta itemprop="property" content="__init__"> <meta itemprop="property" content="add_slot"> <meta itemprop="property" content="add_weight"> <meta itemprop="property" content="apply_gradients"> <meta itemprop="property" content="from_config"> <meta itemprop="property" content="get_config"> <meta itemprop="property" content="get_gradients"> <meta itemprop="property" content="get_slot"> <meta itemprop="property" content="get_slot_names"> <meta itemprop="property" content="get_updates"> <meta itemprop="property" content="get_weights"> <meta itemprop="property" content="minimize"> <meta itemprop="property" content="set_weights"> <meta itemprop="property" content="variables"> </div>   <table class="tfo-notebook-buttons tfo-api" align="left"> <td> <a target="_blank" href="https://www.tensorflow.org/versions/r1.15/api_docs/python/tf/keras/optimizers/Adagrad">  TensorFlow 1 version</a> </td> <td> <a target="_blank" href="https://github.com/tensorflow/tensorflow/blob/r2.1/tensorflow/python/keras/optimizer_v2/adagrad.py#L34-L183">  View source on GitHub </a> </td>
</table>  <h2 id="class_adagrad_2">Class <code translate="no" dir="ltr">Adagrad</code>
</h2> <p>Optimizer that implements the Adagrad algorithm.</p> <p>Inherits From: <a href="optimizer"><code translate="no" dir="ltr">Optimizer</code></a></p> <p><strong>Aliases</strong>: <a href="adagrad"><code translate="no" dir="ltr">tf.optimizers.Adagrad</code></a></p>  <p>Adagrad is an optimizer with parameter-specific learning rates, which are adapted relative to how frequently a parameter gets updated during training. The more updates a parameter receives, the smaller the updates.</p> <h4 id="initialization_2">Initialization:</h4> <div> $$accum_{g_0} := \text{initial_accumulator_value}$$ </div> <h4 id="update_step_2">Update step:</h4> <div> $$t := t + 1$$ </div> <div> $$accum_{g_t} := accum_{g_{t-1}} + g^2$$ </div> <div> $$\theta_t := \theta_{t-1} - lr * g / (\sqrt{accum_{g_t}} + \epsilon)$$ </div> <h4 id="references_2">References:</h4> <ul> <li>
<a href="http://www.jmlr.org/papers/volume12/duchi11a/duchi11a.pdf">Paper</a>.</li> <li>
<a href="https://ppasupat.github.io/a9online/uploads/proximal_notes.pdf">Introduction</a>.</li> </ul> <h2 id="__init__"><code translate="no" dir="ltr">__init__</code></h2> <p><a target="_blank" href="https://github.com/tensorflow/tensorflow/blob/r2.1/tensorflow/python/keras/optimizer_v2/adagrad.py#L57-L97">View source</a></p> <pre class="prettyprint lang-python" translate="no" dir="ltr" data-language="python">__init__(
    learning_rate=0.001,
    initial_accumulator_value=0.1,
    epsilon=1e-07,
    name='Adagrad',
    **kwargs
)
</pre> <p>Construct a new Adagrad optimizer.</p> <h4 id="args_4">Args:</h4> <ul> <li>
<b><code translate="no" dir="ltr">learning_rate</code></b>: A <code translate="no" dir="ltr">Tensor</code> or a floating point value. The learning rate.</li> <li>
<b><code translate="no" dir="ltr">initial_accumulator_value</code></b>: A floating point value. Starting value for the accumulators, must be non-negative.</li> <li>
<b><code translate="no" dir="ltr">epsilon</code></b>: A small floating point value to avoid zero denominator.</li> <li>
<b><code translate="no" dir="ltr">name</code></b>: Optional name prefix for the operations created when applying gradients. Defaults to "Adagrad".</li> <li>
<b><code translate="no" dir="ltr">**kwargs</code></b>: keyword arguments. Allowed to be {<code translate="no" dir="ltr">clipnorm</code>, <code translate="no" dir="ltr">clipvalue</code>, <code translate="no" dir="ltr">lr</code>, <code translate="no" dir="ltr">decay</code>}. <code translate="no" dir="ltr">clipnorm</code> is clip gradients by norm; <code translate="no" dir="ltr">clipvalue</code> is clip gradients by value, <code translate="no" dir="ltr">decay</code> is included for backward compatibility to allow time inverse decay of learning rate. <code translate="no" dir="ltr">lr</code> is included for backward compatibility, recommended to use <code translate="no" dir="ltr">learning_rate</code> instead.</li> </ul> <h4 id="raises_5">Raises:</h4> <ul> <li>
<b><code translate="no" dir="ltr">ValueError</code></b>: If the <code translate="no" dir="ltr">initial_accumulator_value</code> or <code translate="no" dir="ltr">epsilon</code> is invalid.</li> </ul> <h4 id="eager_compatibility_2">Eager Compatibility</h4> <p>When eager execution is enabled, <code translate="no" dir="ltr">learning_rate</code> can be a callable that takes no arguments and returns the actual value to use. This can be useful for changing these values across different invocations of optimizer functions.</p> <h2 id="properties_2">Properties</h2> <h3 id="iterations"><code translate="no" dir="ltr">iterations</code></h3> <p>Variable. The number of training steps this Optimizer has run.</p> <h3 id="weights"><code translate="no" dir="ltr">weights</code></h3> <p>Returns variables of this Optimizer based on the order created.</p> <h2 id="methods_2">Methods</h2> <h3 id="add_slot"><code translate="no" dir="ltr">add_slot</code></h3> <p><a target="_blank" href="https://github.com/tensorflow/tensorflow/blob/r2.1/tensorflow/python/keras/optimizer_v2/optimizer_v2.py#L570-L606">View source</a></p> <pre class="prettyprint lang-python" translate="no" dir="ltr" data-language="python">add_slot(
    var,
    slot_name,
    initializer='zeros'
)
</pre> <p>Add a new slot variable for <code translate="no" dir="ltr">var</code>.</p> <h3 id="add_weight"><code translate="no" dir="ltr">add_weight</code></h3> <p><a target="_blank" href="https://github.com/tensorflow/tensorflow/blob/r2.1/tensorflow/python/keras/optimizer_v2/optimizer_v2.py#L780-L820">View source</a></p> <pre class="prettyprint lang-python" translate="no" dir="ltr" data-language="python">add_weight(
    name,
    shape,
    dtype=None,
    initializer='zeros',
    trainable=None,
    synchronization=tf.VariableSynchronization.AUTO,
    aggregation=tf.compat.v1.VariableAggregation.NONE
)
</pre> <h3 id="apply_gradients"><code translate="no" dir="ltr">apply_gradients</code></h3> <p><a target="_blank" href="https://github.com/tensorflow/tensorflow/blob/r2.1/tensorflow/python/keras/optimizer_v2/optimizer_v2.py#L407-L444">View source</a></p> <pre class="prettyprint lang-python" translate="no" dir="ltr" data-language="python">apply_gradients(
    grads_and_vars,
    name=None
)
</pre> <p>Apply gradients to variables.</p> <p>This is the second part of <code translate="no" dir="ltr">minimize()</code>. It returns an <code translate="no" dir="ltr">Operation</code> that applies gradients.</p> <h4 id="args_5">Args:</h4> <ul> <li>
<b><code translate="no" dir="ltr">grads_and_vars</code></b>: List of (gradient, variable) pairs.</li> <li>
<b><code translate="no" dir="ltr">name</code></b>: Optional name for the returned operation. Default to the name passed to the <code translate="no" dir="ltr">Optimizer</code> constructor.</li> </ul> <h4 id="returns_7">Returns:</h4> <p>An <code translate="no" dir="ltr">Operation</code> that applies the specified gradients. The <code translate="no" dir="ltr">iterations</code> will be automatically increased by 1.</p> <h4 id="raises_6">Raises:</h4> <ul> <li>
<b><code translate="no" dir="ltr">TypeError</code></b>: If <code translate="no" dir="ltr">grads_and_vars</code> is malformed.</li> <li>
<b><code translate="no" dir="ltr">ValueError</code></b>: If none of the variables have gradients.</li> </ul> <h3 id="from_config"><code translate="no" dir="ltr">from_config</code></h3> <p><a target="_blank" href="https://github.com/tensorflow/tensorflow/blob/r2.1/tensorflow/python/keras/optimizer_v2/adagrad.py#L123-L144">View source</a></p> <pre class="prettyprint lang-python" translate="no" dir="ltr" data-language="python">@classmethod
from_config(
    cls,
    config,
    custom_objects=None
)
</pre> <p>Creates an optimizer from its config.</p> <p>This method is the reverse of <code translate="no" dir="ltr">get_config</code>, capable of instantiating the same optimizer from the config dictionary.</p> <h4 id="arguments_4">Arguments:</h4> <ul> <li>
<b><code translate="no" dir="ltr">config</code></b>: A Python dictionary, typically the output of get_config.</li> <li>
<b><code translate="no" dir="ltr">custom_objects</code></b>: A Python dictionary mapping names to additional Python objects used to create this optimizer, such as a function used for a hyperparameter.</li> </ul> <h4 id="returns_8">Returns:</h4> <p>An optimizer instance.</p> <h3 id="get_config"><code translate="no" dir="ltr">get_config</code></h3> <p><a target="_blank" href="https://github.com/tensorflow/tensorflow/blob/r2.1/tensorflow/python/keras/optimizer_v2/adagrad.py#L175-L183">View source</a></p> <pre class="prettyprint lang-python" translate="no" dir="ltr" data-language="python">get_config()
</pre> <p>Returns the config of the optimimizer.</p> <p>An optimizer config is a Python dictionary (serializable) containing the configuration of an optimizer. The same optimizer can be reinstantiated later (without any saved state) from this configuration.</p> <h4 id="returns_9">Returns:</h4> <p>Python dictionary.</p> <h3 id="get_gradients"><code translate="no" dir="ltr">get_gradients</code></h3> <p><a target="_blank" href="https://github.com/tensorflow/tensorflow/blob/r2.1/tensorflow/python/keras/optimizer_v2/optimizer_v2.py#L373-L405">View source</a></p> <pre class="prettyprint lang-python" translate="no" dir="ltr" data-language="python">get_gradients(
    loss,
    params
)
</pre> <p>Returns gradients of <code translate="no" dir="ltr">loss</code> with respect to <code translate="no" dir="ltr">params</code>.</p> <h4 id="arguments_5">Arguments:</h4> <ul> <li>
<b><code translate="no" dir="ltr">loss</code></b>: Loss tensor.</li> <li>
<b><code translate="no" dir="ltr">params</code></b>: List of variables.</li> </ul> <h4 id="returns_10">Returns:</h4> <p>List of gradient tensors.</p> <h4 id="raises_7">Raises:</h4> <ul> <li>
<b><code translate="no" dir="ltr">ValueError</code></b>: In case any gradient cannot be computed (e.g. if gradient function not implemented).</li> </ul> <h3 id="get_slot"><code translate="no" dir="ltr">get_slot</code></h3> <p><a target="_blank" href="https://github.com/tensorflow/tensorflow/blob/r2.1/tensorflow/python/keras/optimizer_v2/optimizer_v2.py#L608-L611">View source</a></p> <pre class="prettyprint lang-python" translate="no" dir="ltr" data-language="python">get_slot(
    var,
    slot_name
)
</pre> <h3 id="get_slot_names"><code translate="no" dir="ltr">get_slot_names</code></h3> <p><a target="_blank" href="https://github.com/tensorflow/tensorflow/blob/r2.1/tensorflow/python/keras/optimizer_v2/optimizer_v2.py#L566-L568">View source</a></p> <pre class="prettyprint lang-python" translate="no" dir="ltr" data-language="python">get_slot_names()
</pre> <p>A list of names for this optimizer's slots.</p> <h3 id="get_updates"><code translate="no" dir="ltr">get_updates</code></h3> <p><a target="_blank" href="https://github.com/tensorflow/tensorflow/blob/r2.1/tensorflow/python/keras/optimizer_v2/optimizer_v2.py#L502-L509">View source</a></p> <pre class="prettyprint lang-python" translate="no" dir="ltr" data-language="python">get_updates(
    loss,
    params
)
</pre> <h3 id="get_weights"><code translate="no" dir="ltr">get_weights</code></h3> <p><a target="_blank" href="https://github.com/tensorflow/tensorflow/blob/r2.1/tensorflow/python/keras/optimizer_v2/optimizer_v2.py#L755-L757">View source</a></p> <pre class="prettyprint lang-python" translate="no" dir="ltr" data-language="python">get_weights()
</pre> <h3 id="minimize"><code translate="no" dir="ltr">minimize</code></h3> <p><a target="_blank" href="https://github.com/tensorflow/tensorflow/blob/r2.1/tensorflow/python/keras/optimizer_v2/optimizer_v2.py#L289-L318">View source</a></p> <pre class="prettyprint lang-python" translate="no" dir="ltr" data-language="python">minimize(
    loss,
    var_list,
    grad_loss=None,
    name=None
)
</pre> <p>Minimize <code translate="no" dir="ltr">loss</code> by updating <code translate="no" dir="ltr">var_list</code>.</p> <p>This method simply computes gradient using <a href="../../gradienttape"><code translate="no" dir="ltr">tf.GradientTape</code></a> and calls <code translate="no" dir="ltr">apply_gradients()</code>. If you want to process the gradient before applying then call <a href="../../gradienttape"><code translate="no" dir="ltr">tf.GradientTape</code></a> and <code translate="no" dir="ltr">apply_gradients()</code> explicitly instead of using this function.</p> <h4 id="args_6">Args:</h4> <ul> <li>
<b><code translate="no" dir="ltr">loss</code></b>: A callable taking no arguments which returns the value to minimize.</li> <li>
<b><code translate="no" dir="ltr">var_list</code></b>: list or tuple of <code translate="no" dir="ltr">Variable</code> objects to update to minimize <code translate="no" dir="ltr">loss</code>, or a callable returning the list or tuple of <code translate="no" dir="ltr">Variable</code> objects. Use callable when the variable list would otherwise be incomplete before <code translate="no" dir="ltr">minimize</code> since the variables are created at the first time <code translate="no" dir="ltr">loss</code> is called.</li> <li>
<b><code translate="no" dir="ltr">grad_loss</code></b>: Optional. A <code translate="no" dir="ltr">Tensor</code> holding the gradient computed for <code translate="no" dir="ltr">loss</code>.</li> <li>
<b><code translate="no" dir="ltr">name</code></b>: Optional name for the returned operation.</li> </ul> <h4 id="returns_11">Returns:</h4> <p>An <code translate="no" dir="ltr">Operation</code> that updates the variables in <code translate="no" dir="ltr">var_list</code>. The <code translate="no" dir="ltr">iterations</code> will be automatically increased by 1.</p> <h4 id="raises_8">Raises:</h4> <ul> <li>
<b><code translate="no" dir="ltr">ValueError</code></b>: If some of the variables are not <code translate="no" dir="ltr">Variable</code> objects.</li> </ul> <h3 id="set_weights"><code translate="no" dir="ltr">set_weights</code></h3> <p><a target="_blank" href="https://github.com/tensorflow/tensorflow/blob/r2.1/tensorflow/python/keras/optimizer_v2/adagrad.py#L114-L121">View source</a></p> <pre class="prettyprint lang-python" translate="no" dir="ltr" data-language="python">set_weights(weights)
</pre> <h3 id="variables"><code translate="no" dir="ltr">variables</code></h3> <p><a target="_blank" href="https://github.com/tensorflow/tensorflow/blob/r2.1/tensorflow/python/keras/optimizer_v2/optimizer_v2.py#L746-L748">View source</a></p> <pre class="prettyprint lang-python" translate="no" dir="ltr" data-language="python">variables()
</pre> <p>Returns variables of this Optimizer based on the order created.</p> <h2 id="compat_aliases_2">Compat aliases</h2> <ul> <li><a href="adagrad"><code translate="no" dir="ltr">tf.compat.v1.keras.optimizers.Adagrad</code></a></li> <li><a href="adagrad"><code translate="no" dir="ltr">tf.compat.v2.keras.optimizers.Adagrad</code></a></li> <li><a href="adagrad"><code translate="no" dir="ltr">tf.compat.v2.optimizers.Adagrad</code></a></li> </ul>  <devsite-page-rating position="footer" selected-rating="0" hover-rating-star="0"> </devsite-page-rating><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2019 The TensorFlow Authors. All rights reserved.<br>Licensed under the Creative Commons Attribution License 3.0.<br>Code samples licensed under the Apache 2.0 License.<br>
    <a href="https://www.tensorflow.org/api_docs/python/tf/keras/optimizers/Adagrad" class="_attribution-link">https://www.tensorflow.org/api_docs/python/tf/keras/optimizers/Adagrad</a>
  </p>
</div>
