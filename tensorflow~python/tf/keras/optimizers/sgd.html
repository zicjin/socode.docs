<h1 class="devsite-page-title">tf.keras.optimizers.SGD</h1>     <div itemscope itemtype="http://developers.google.com/ReferenceObject"> <meta itemprop="name" content="tf.keras.optimizers.SGD"> <meta itemprop="path" content="Stable"> <meta itemprop="property" content="iterations"> <meta itemprop="property" content="weights"> <meta itemprop="property" content="__init__"> <meta itemprop="property" content="add_slot"> <meta itemprop="property" content="add_weight"> <meta itemprop="property" content="apply_gradients"> <meta itemprop="property" content="from_config"> <meta itemprop="property" content="get_config"> <meta itemprop="property" content="get_gradients"> <meta itemprop="property" content="get_slot"> <meta itemprop="property" content="get_slot_names"> <meta itemprop="property" content="get_updates"> <meta itemprop="property" content="get_weights"> <meta itemprop="property" content="minimize"> <meta itemprop="property" content="set_weights"> <meta itemprop="property" content="variables"> </div>   <table class="tfo-notebook-buttons tfo-api" align="left"> <td> <a target="_blank" href="https://www.tensorflow.org/versions/r1.15/api_docs/python/tf/keras/optimizers/SGD">  TensorFlow 1 version</a> </td> <td> <a target="_blank" href="https://github.com/tensorflow/tensorflow/blob/r2.1/tensorflow/python/keras/optimizer_v2/gradient_descent.py#L29-L164">  View source on GitHub </a> </td>
</table>  <h2 id="class_sgd_2">Class <code translate="no" dir="ltr">SGD</code>
</h2> <p>Stochastic gradient descent and momentum optimizer.</p> <p>Inherits From: <a href="optimizer"><code translate="no" dir="ltr">Optimizer</code></a></p> <p><strong>Aliases</strong>: <a href="sgd"><code translate="no" dir="ltr">tf.optimizers.SGD</code></a></p> <h3 id="used_in_the_guide_2">Used in the guide:</h3> <ul> <li><a href="https://www.tensorflow.org/guide/keras/train_and_evaluate">Train and evaluate with Keras</a></li> <li><a href="https://www.tensorflow.org/guide/distributed_training">Distributed training with TensorFlow</a></li> <li><a href="https://www.tensorflow.org/guide/eager">Eager execution</a></li> <li><a href="https://www.tensorflow.org/guide/gpu">Use a GPU</a></li> <li><a href="https://www.tensorflow.org/guide/keras/overview">Keras overview</a></li> </ul> <h3 id="used_in_the_tutorials_2">Used in the tutorials:</h3> <ul> <li><a href="https://www.tensorflow.org/tutorials/customization/custom_training_walkthrough">Custom training: walkthrough</a></li> <li><a href="https://www.tensorflow.org/tutorials/distribute/multi_worker_with_keras">Multi-worker training with Keras</a></li> </ul> <h4 id="computes_2">Computes:</h4> <pre class="prettyprint" translate="no" dir="ltr" data-language="python">theta(t+1) = theta(t) - learning_rate * gradient
gradient is evaluated at theta(t).
</pre> <p>or Computes (if <code translate="no" dir="ltr">nesterov = False</code>):</p> <pre class="prettyprint" translate="no" dir="ltr" data-language="python">v(t+1) = momentum * v(t) - learning_rate * gradient
theta(t+1) = theta(t) + v(t+1)
if `nesterov` is False, gradient is evaluated at theta(t).
if `nesterov` is True, gradient is evaluated at theta(t) + momentum * v(t),
  and the variables always store theta + m v instead of theta
</pre> <p>Some of the args below are hyperparameters, where a hyperparameter is defined as a scalar Tensor, a regular Python value, or a callable (which will be evaluated when <code translate="no" dir="ltr">apply_gradients</code> is called) returning a scalar Tensor or a Python value.</p> <h1 id="references_2" class="page-title">References</h1> <pre class="prettyprint" translate="no" dir="ltr" data-language="python">nesterov = True, See [Sutskever et al., 2013](
  http://jmlr.org/proceedings/papers/v28/sutskever13.pdf).
</pre> <h4 id="eager_compatibility_2">Eager Compatibility</h4> <p>When eager execution is enabled, learning_rate can be a callable that takes no arguments and returns the actual value to use. This can be useful for changing these values across different invocations of optimizer functions.</p> <h2 id="__init__"><code translate="no" dir="ltr">__init__</code></h2> <p><a target="_blank" href="https://github.com/tensorflow/tensorflow/blob/r2.1/tensorflow/python/keras/optimizer_v2/gradient_descent.py#L63-L95">View source</a></p> <pre class="prettyprint lang-python" translate="no" dir="ltr" data-language="python">__init__(
    learning_rate=0.01,
    momentum=0.0,
    nesterov=False,
    name='SGD',
    **kwargs
)
</pre> <p>Construct a new Stochastic Gradient Descent or Momentum optimizer.</p> <h4 id="arguments_5">Arguments:</h4> <ul> <li>
<b><code translate="no" dir="ltr">learning_rate</code></b>: float hyperparameter &gt;= 0. Learning rate.</li> <li>
<b><code translate="no" dir="ltr">momentum</code></b>: float hyperparameter &gt;= 0 that accelerates SGD in the relevant direction and dampens oscillations.</li> <li>
<b><code translate="no" dir="ltr">nesterov</code></b>: boolean. Whether to apply Nesterov momentum.</li> <li>
<b><code translate="no" dir="ltr">name</code></b>: Optional name prefix for the operations created when applying gradients. Defaults to 'SGD'.</li> <li>
<b><code translate="no" dir="ltr">**kwargs</code></b>: keyword arguments. Allowed to be {<code translate="no" dir="ltr">clipnorm</code>, <code translate="no" dir="ltr">clipvalue</code>, <code translate="no" dir="ltr">lr</code>, <code translate="no" dir="ltr">decay</code>}. <code translate="no" dir="ltr">clipnorm</code> is clip gradients by norm; <code translate="no" dir="ltr">clipvalue</code> is clip gradients by value, <code translate="no" dir="ltr">decay</code> is included for backward compatibility to allow time inverse decay of learning rate. <code translate="no" dir="ltr">lr</code> is included for backward compatibility, recommended to use <code translate="no" dir="ltr">learning_rate</code> instead.</li> </ul> <h2 id="properties_2">Properties</h2> <h3 id="iterations"><code translate="no" dir="ltr">iterations</code></h3> <p>Variable. The number of training steps this Optimizer has run.</p> <h3 id="weights"><code translate="no" dir="ltr">weights</code></h3> <p>Returns variables of this Optimizer based on the order created.</p> <h2 id="methods_2">Methods</h2> <h3 id="add_slot"><code translate="no" dir="ltr">add_slot</code></h3> <p><a target="_blank" href="https://github.com/tensorflow/tensorflow/blob/r2.1/tensorflow/python/keras/optimizer_v2/optimizer_v2.py#L570-L606">View source</a></p> <pre class="prettyprint lang-python" translate="no" dir="ltr" data-language="python">add_slot(
    var,
    slot_name,
    initializer='zeros'
)
</pre> <p>Add a new slot variable for <code translate="no" dir="ltr">var</code>.</p> <h3 id="add_weight"><code translate="no" dir="ltr">add_weight</code></h3> <p><a target="_blank" href="https://github.com/tensorflow/tensorflow/blob/r2.1/tensorflow/python/keras/optimizer_v2/optimizer_v2.py#L780-L820">View source</a></p> <pre class="prettyprint lang-python" translate="no" dir="ltr" data-language="python">add_weight(
    name,
    shape,
    dtype=None,
    initializer='zeros',
    trainable=None,
    synchronization=tf.VariableSynchronization.AUTO,
    aggregation=tf.compat.v1.VariableAggregation.NONE
)
</pre> <h3 id="apply_gradients"><code translate="no" dir="ltr">apply_gradients</code></h3> <p><a target="_blank" href="https://github.com/tensorflow/tensorflow/blob/r2.1/tensorflow/python/keras/optimizer_v2/optimizer_v2.py#L407-L444">View source</a></p> <pre class="prettyprint lang-python" translate="no" dir="ltr" data-language="python">apply_gradients(
    grads_and_vars,
    name=None
)
</pre> <p>Apply gradients to variables.</p> <p>This is the second part of <code translate="no" dir="ltr">minimize()</code>. It returns an <code translate="no" dir="ltr">Operation</code> that applies gradients.</p> <h4 id="args_3">Args:</h4> <ul> <li>
<b><code translate="no" dir="ltr">grads_and_vars</code></b>: List of (gradient, variable) pairs.</li> <li>
<b><code translate="no" dir="ltr">name</code></b>: Optional name for the returned operation. Default to the name passed to the <code translate="no" dir="ltr">Optimizer</code> constructor.</li> </ul> <h4 id="returns_7">Returns:</h4> <p>An <code translate="no" dir="ltr">Operation</code> that applies the specified gradients. The <code translate="no" dir="ltr">iterations</code> will be automatically increased by 1.</p> <h4 id="raises_4">Raises:</h4> <ul> <li>
<b><code translate="no" dir="ltr">TypeError</code></b>: If <code translate="no" dir="ltr">grads_and_vars</code> is malformed.</li> <li>
<b><code translate="no" dir="ltr">ValueError</code></b>: If none of the variables have gradients.</li> </ul> <h3 id="from_config"><code translate="no" dir="ltr">from_config</code></h3> <p><a target="_blank" href="https://github.com/tensorflow/tensorflow/blob/r2.1/tensorflow/python/keras/optimizer_v2/optimizer_v2.py#L710-L733">View source</a></p> <pre class="prettyprint lang-python" translate="no" dir="ltr" data-language="python">from_config(
    cls,
    config,
    custom_objects=None
)
</pre> <p>Creates an optimizer from its config.</p> <p>This method is the reverse of <code translate="no" dir="ltr">get_config</code>, capable of instantiating the same optimizer from the config dictionary.</p> <h4 id="arguments_6">Arguments:</h4> <ul> <li>
<b><code translate="no" dir="ltr">config</code></b>: A Python dictionary, typically the output of get_config.</li> <li>
<b><code translate="no" dir="ltr">custom_objects</code></b>: A Python dictionary mapping names to additional Python objects used to create this optimizer, such as a function used for a hyperparameter.</li> </ul> <h4 id="returns_8">Returns:</h4> <p>An optimizer instance.</p> <h3 id="get_config"><code translate="no" dir="ltr">get_config</code></h3> <p><a target="_blank" href="https://github.com/tensorflow/tensorflow/blob/r2.1/tensorflow/python/keras/optimizer_v2/gradient_descent.py#L156-L164">View source</a></p> <pre class="prettyprint lang-python" translate="no" dir="ltr" data-language="python">get_config()
</pre> <p>Returns the config of the optimimizer.</p> <p>An optimizer config is a Python dictionary (serializable) containing the configuration of an optimizer. The same optimizer can be reinstantiated later (without any saved state) from this configuration.</p> <h4 id="returns_9">Returns:</h4> <p>Python dictionary.</p> <h3 id="get_gradients"><code translate="no" dir="ltr">get_gradients</code></h3> <p><a target="_blank" href="https://github.com/tensorflow/tensorflow/blob/r2.1/tensorflow/python/keras/optimizer_v2/optimizer_v2.py#L373-L405">View source</a></p> <pre class="prettyprint lang-python" translate="no" dir="ltr" data-language="python">get_gradients(
    loss,
    params
)
</pre> <p>Returns gradients of <code translate="no" dir="ltr">loss</code> with respect to <code translate="no" dir="ltr">params</code>.</p> <h4 id="arguments_7">Arguments:</h4> <ul> <li>
<b><code translate="no" dir="ltr">loss</code></b>: Loss tensor.</li> <li>
<b><code translate="no" dir="ltr">params</code></b>: List of variables.</li> </ul> <h4 id="returns_10">Returns:</h4> <p>List of gradient tensors.</p> <h4 id="raises_5">Raises:</h4> <ul> <li>
<b><code translate="no" dir="ltr">ValueError</code></b>: In case any gradient cannot be computed (e.g. if gradient function not implemented).</li> </ul> <h3 id="get_slot"><code translate="no" dir="ltr">get_slot</code></h3> <p><a target="_blank" href="https://github.com/tensorflow/tensorflow/blob/r2.1/tensorflow/python/keras/optimizer_v2/optimizer_v2.py#L608-L611">View source</a></p> <pre class="prettyprint lang-python" translate="no" dir="ltr" data-language="python">get_slot(
    var,
    slot_name
)
</pre> <h3 id="get_slot_names"><code translate="no" dir="ltr">get_slot_names</code></h3> <p><a target="_blank" href="https://github.com/tensorflow/tensorflow/blob/r2.1/tensorflow/python/keras/optimizer_v2/optimizer_v2.py#L566-L568">View source</a></p> <pre class="prettyprint lang-python" translate="no" dir="ltr" data-language="python">get_slot_names()
</pre> <p>A list of names for this optimizer's slots.</p> <h3 id="get_updates"><code translate="no" dir="ltr">get_updates</code></h3> <p><a target="_blank" href="https://github.com/tensorflow/tensorflow/blob/r2.1/tensorflow/python/keras/optimizer_v2/optimizer_v2.py#L502-L509">View source</a></p> <pre class="prettyprint lang-python" translate="no" dir="ltr" data-language="python">get_updates(
    loss,
    params
)
</pre> <h3 id="get_weights"><code translate="no" dir="ltr">get_weights</code></h3> <p><a target="_blank" href="https://github.com/tensorflow/tensorflow/blob/r2.1/tensorflow/python/keras/optimizer_v2/optimizer_v2.py#L755-L757">View source</a></p> <pre class="prettyprint lang-python" translate="no" dir="ltr" data-language="python">get_weights()
</pre> <h3 id="minimize"><code translate="no" dir="ltr">minimize</code></h3> <p><a target="_blank" href="https://github.com/tensorflow/tensorflow/blob/r2.1/tensorflow/python/keras/optimizer_v2/optimizer_v2.py#L289-L318">View source</a></p> <pre class="prettyprint lang-python" translate="no" dir="ltr" data-language="python">minimize(
    loss,
    var_list,
    grad_loss=None,
    name=None
)
</pre> <p>Minimize <code translate="no" dir="ltr">loss</code> by updating <code translate="no" dir="ltr">var_list</code>.</p> <p>This method simply computes gradient using <a href="../../gradienttape"><code translate="no" dir="ltr">tf.GradientTape</code></a> and calls <code translate="no" dir="ltr">apply_gradients()</code>. If you want to process the gradient before applying then call <a href="../../gradienttape"><code translate="no" dir="ltr">tf.GradientTape</code></a> and <code translate="no" dir="ltr">apply_gradients()</code> explicitly instead of using this function.</p> <h4 id="args_4">Args:</h4> <ul> <li>
<b><code translate="no" dir="ltr">loss</code></b>: A callable taking no arguments which returns the value to minimize.</li> <li>
<b><code translate="no" dir="ltr">var_list</code></b>: list or tuple of <code translate="no" dir="ltr">Variable</code> objects to update to minimize <code translate="no" dir="ltr">loss</code>, or a callable returning the list or tuple of <code translate="no" dir="ltr">Variable</code> objects. Use callable when the variable list would otherwise be incomplete before <code translate="no" dir="ltr">minimize</code> since the variables are created at the first time <code translate="no" dir="ltr">loss</code> is called.</li> <li>
<b><code translate="no" dir="ltr">grad_loss</code></b>: Optional. A <code translate="no" dir="ltr">Tensor</code> holding the gradient computed for <code translate="no" dir="ltr">loss</code>.</li> <li>
<b><code translate="no" dir="ltr">name</code></b>: Optional name for the returned operation.</li> </ul> <h4 id="returns_11">Returns:</h4> <p>An <code translate="no" dir="ltr">Operation</code> that updates the variables in <code translate="no" dir="ltr">var_list</code>. The <code translate="no" dir="ltr">iterations</code> will be automatically increased by 1.</p> <h4 id="raises_6">Raises:</h4> <ul> <li>
<b><code translate="no" dir="ltr">ValueError</code></b>: If some of the variables are not <code translate="no" dir="ltr">Variable</code> objects.</li> </ul> <h3 id="set_weights"><code translate="no" dir="ltr">set_weights</code></h3> <p><a target="_blank" href="https://github.com/tensorflow/tensorflow/blob/r2.1/tensorflow/python/keras/optimizer_v2/optimizer_v2.py#L760-L778">View source</a></p> <pre class="prettyprint lang-python" translate="no" dir="ltr" data-language="python">set_weights(weights)
</pre> <h3 id="variables"><code translate="no" dir="ltr">variables</code></h3> <p><a target="_blank" href="https://github.com/tensorflow/tensorflow/blob/r2.1/tensorflow/python/keras/optimizer_v2/optimizer_v2.py#L746-L748">View source</a></p> <pre class="prettyprint lang-python" translate="no" dir="ltr" data-language="python">variables()
</pre> <p>Returns variables of this Optimizer based on the order created.</p> <h2 id="compat_aliases_2">Compat aliases</h2> <ul> <li><a href="sgd"><code translate="no" dir="ltr">tf.compat.v1.keras.optimizers.SGD</code></a></li> <li><a href="sgd"><code translate="no" dir="ltr">tf.compat.v2.keras.optimizers.SGD</code></a></li> <li><a href="sgd"><code translate="no" dir="ltr">tf.compat.v2.optimizers.SGD</code></a></li> </ul>  <devsite-page-rating position="footer" selected-rating="0" hover-rating-star="0"> </devsite-page-rating><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2019 The TensorFlow Authors. All rights reserved.<br>Licensed under the Creative Commons Attribution License 3.0.<br>Code samples licensed under the Apache 2.0 License.<br>
    <a href="https://www.tensorflow.org/api_docs/python/tf/keras/optimizers/SGD" class="_attribution-link">https://www.tensorflow.org/api_docs/python/tf/keras/optimizers/SGD</a>
  </p>
</div>
