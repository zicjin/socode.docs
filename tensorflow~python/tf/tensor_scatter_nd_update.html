<h1 class="devsite-page-title">tf.tensor_scatter_nd_update</h1>     <div itemscope itemtype="http://developers.google.com/ReferenceObject"> <meta itemprop="name" content="tf.tensor_scatter_nd_update"> <meta itemprop="path" content="Stable"> </div>   <table class="tfo-notebook-buttons tfo-api" align="left"> <td> <a target="_blank" href="https://www.tensorflow.org/versions/r1.15/api_docs/python/tf/tensor_scatter_nd_update">  TensorFlow 1 version</a> </td> </table>  <p>Scatter <code translate="no" dir="ltr">updates</code> into an existing tensor according to <code translate="no" dir="ltr">indices</code>.</p> <pre class="prettyprint lang-python" translate="no" dir="ltr" data-language="python">tf.tensor_scatter_nd_update(
    tensor,
    indices,
    updates,
    name=None
)
</pre>  <p>This operation creates a new tensor by applying sparse <code translate="no" dir="ltr">updates</code> to the passed in <code translate="no" dir="ltr">tensor</code>. This operation is very similar to <a href="scatter_nd"><code translate="no" dir="ltr">tf.scatter_nd</code></a>, except that the updates are scattered onto an existing tensor (as opposed to a zero-tensor). If the memory for the existing tensor cannot be re-used, a copy is made and updated.</p> <p>If <code translate="no" dir="ltr">indices</code> contains duplicates, then their updates are accumulated (summed).</p> <p><strong>WARNING</strong>: The order in which updates are applied is nondeterministic, so the output will be nondeterministic if <code translate="no" dir="ltr">indices</code> contains duplicates -- because of some numerical approximation issues, numbers summed in different order may yield different results.</p> <p><code translate="no" dir="ltr">indices</code> is an integer tensor containing indices into a new tensor of shape <code translate="no" dir="ltr">shape</code>. The last dimension of <code translate="no" dir="ltr">indices</code> can be at most the rank of <code translate="no" dir="ltr">shape</code>:</p> <pre class="prettyprint" translate="no" dir="ltr" data-language="python">indices.shape[-1] &lt;= shape.rank
</pre> <p>The last dimension of <code translate="no" dir="ltr">indices</code> corresponds to indices into elements (if <code translate="no" dir="ltr">indices.shape[-1] = shape.rank</code>) or slices (if <code translate="no" dir="ltr">indices.shape[-1] &lt; shape.rank</code>) along dimension <code translate="no" dir="ltr">indices.shape[-1]</code> of <code translate="no" dir="ltr">shape</code>. <code translate="no" dir="ltr">updates</code> is a tensor with shape</p> <pre class="prettyprint" translate="no" dir="ltr" data-language="python">indices.shape[:-1] + shape[indices.shape[-1]:]
</pre> <p>The simplest form of scatter is to insert individual elements in a tensor by index. For example, say we want to insert 4 scattered elements in a rank-1 tensor with 8 elements.</p> <div style="width:70%; margin:auto; margin-bottom:10px; margin-top:20px;"> <img style="width:100%" src="data:image/png;base64,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" alt> </div> <p>In Python, this scatter operation would look like this:</p> <pre class="prettyprint lang-python" translate="no" dir="ltr" data-language="python">indices = tf.constant([[4], [3], [1], [7]])
updates = tf.constant([9, 10, 11, 12])
tensor = tf.ones([8], dtype=tf.int32)
updated = tf.tensor_scatter_nd_update(tensor, indices, updates)
print(updated)
</pre> <p>The resulting tensor would look like this:</p> <pre class="prettyprint" translate="no" dir="ltr" data-language="python">[1, 11, 1, 10, 9, 1, 1, 12]
</pre> <p>We can also, insert entire slices of a higher rank tensor all at once. For example, if we wanted to insert two slices in the first dimension of a rank-3 tensor with two matrices of new values.</p> <p>In Python, this scatter operation would look like this:</p> <pre class="prettyprint lang-python" translate="no" dir="ltr" data-language="python">indices = tf.constant([[0], [2]])
updates = tf.constant([[[5, 5, 5, 5], [6, 6, 6, 6],
                        [7, 7, 7, 7], [8, 8, 8, 8]],
                       [[5, 5, 5, 5], [6, 6, 6, 6],
                        [7, 7, 7, 7], [8, 8, 8, 8]]])
tensor = tf.ones([4, 4, 4],dtype=tf.int32)
updated = tf.tensor_scatter_nd_update(tensor, indices, updates)
print(updated)
</pre> <p>The resulting tensor would look like this:</p> <pre class="prettyprint" translate="no" dir="ltr" data-language="python">[[[5, 5, 5, 5], [6, 6, 6, 6], [7, 7, 7, 7], [8, 8, 8, 8]],
 [[1, 1, 1, 1], [1, 1, 1, 1], [1, 1, 1, 1], [1, 1, 1, 1]],
 [[5, 5, 5, 5], [6, 6, 6, 6], [7, 7, 7, 7], [8, 8, 8, 8]],
 [[1, 1, 1, 1], [1, 1, 1, 1], [1, 1, 1, 1], [1, 1, 1, 1]]]
</pre> <p>Note that on CPU, if an out of bound index is found, an error is returned. On GPU, if an out of bound index is found, the index is ignored.</p> <h4 id="args_2">Args:</h4> <ul> <li>
<b><code translate="no" dir="ltr">tensor</code></b>: A <code translate="no" dir="ltr">Tensor</code>. Tensor to copy/update.</li> <li>
<b><code translate="no" dir="ltr">indices</code></b>: A <code translate="no" dir="ltr">Tensor</code>. Must be one of the following types: <code translate="no" dir="ltr">int32</code>, <code translate="no" dir="ltr">int64</code>. Index tensor.</li> <li>
<b><code translate="no" dir="ltr">updates</code></b>: A <code translate="no" dir="ltr">Tensor</code>. Must have the same type as <code translate="no" dir="ltr">tensor</code>. Updates to scatter into output.</li> <li>
<b><code translate="no" dir="ltr">name</code></b>: A name for the operation (optional).</li> </ul> <h4 id="returns_2">Returns:</h4> <p>A <code translate="no" dir="ltr">Tensor</code>. Has the same type as <code translate="no" dir="ltr">tensor</code>.</p> <h2 id="compat_aliases_2">Compat aliases</h2> <ul> <li><a href="tensor_scatter_nd_update"><code translate="no" dir="ltr">tf.compat.v1.tensor_scatter_nd_update</code></a></li> <li><a href="tensor_scatter_nd_update"><code translate="no" dir="ltr">tf.compat.v1.tensor_scatter_update</code></a></li> <li><a href="tensor_scatter_nd_update"><code translate="no" dir="ltr">tf.compat.v2.tensor_scatter_nd_update</code></a></li> </ul>  <devsite-page-rating position="footer" selected-rating="0" hover-rating-star="0"> </devsite-page-rating><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2019 The TensorFlow Authors. All rights reserved.<br>Licensed under the Creative Commons Attribution License 3.0.<br>Code samples licensed under the Apache 2.0 License.<br>
    <a href="https://www.tensorflow.org/api_docs/python/tf/tensor_scatter_nd_update" class="_attribution-link">https://www.tensorflow.org/api_docs/python/tf/tensor_scatter_nd_update</a>
  </p>
</div>
