<h1>WebAssembly.Exception.prototype.stack</h1>
<div class="section-content">
<div class="notecard nonstandard" id="sect1"><p><strong>Non-standard:</strong> This feature is non-standard and is not on a standards track. Do not use it on production sites facing the Web: it will not work for every user. There may also be large incompatibilities between implementations and the behavior may change in the future.</p></div> <p>The read-only <code>stack</code> property of an object instance of type <a href="../exception"><code>WebAssembly.Exception</code></a> <em>may</em> contain a stack trace.</p> <p>Exceptions from WebAssembly code do not include a stack trace by default.</p> <p> If WebAssembly code needs to provide a stack trace, it must call a JavaScript function to create the exception, passing <code>options.traceStack=true</code> parameter in the <a href="exception">constructor</a>. The virtual machine can then attach a stack trace to the exception object returned by the constructor. </p> <div class="notecard note" id="sect2"> <p> <strong>Note:</strong> Stack traces are not normally sent from WebAssembly code to improve performance. The ability to add stack traces to these exceptions is provided for developer tooling, and is not generally recommended for broader use. </p> </div>
</div>
<section aria-labelledby="value"><h2 id="value">Value</h2>
<div class="section-content">
<p>A string containing the stack trace, or <a href="../../undefined"><code>undefined</code></a> if no trace has been assigned.</p> <p> The stack trace string lists the locations of each operation on the stack in WebAssembly format. This is a human readable string indicating the URL, name of the function type called, the function index, and its offset in the module binary. It has approximately this format (see <a href="https://webassembly.github.io/spec/web-api/index.html#conventions" rel=" noopener">stack trace conventions</a> in the specification for more information): </p> <pre class="notranslate">${url}:wasm-function[${funcIndex}]:${pcOffset}
</pre>
</div></section><section aria-labelledby="examples"><h2 id="examples">Examples</h2>
<div class="section-content">
<p>This example demonstrate how to throw an exception from WebAssembly that includes a stack trace.</p> <p> Consider the following WebAssembly code, which is assumed to be compiled to a file named <strong>example.wasm</strong>. This imports a tag, which it refers to as <code>$tagname</code> internally, and imports a function that it refers to as <code>$throwExnWithStack</code>. It exports the method <code>run</code> that can be called by external code to call <code>$throwExnWithStack</code> (and hence the JavaScript function). </p> <div class="code-example"><pre data-language="wasm"><span class="token punctuation">(</span><span class="token keyword">module</span>
  <span class="token comment">;; import tag that will be referred to here as $tagname</span>
  <span class="token punctuation">(</span><span class="token keyword">import</span> <span class="token string">"extmod"</span> <span class="token string">"exttag"</span> <span class="token punctuation">(</span>tag <span class="token variable">$tagname</span> <span class="token punctuation">(</span><span class="token keyword">param</span> <span class="token keyword">i32</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

  <span class="token comment">;; import function that will be referred to here as $throwExnWithStack</span>
  <span class="token punctuation">(</span><span class="token keyword">import</span> <span class="token string">"extmod"</span> <span class="token string">"throwExnWithStack"</span> <span class="token punctuation">(</span><span class="token keyword">func</span> <span class="token variable">$throwExnWithStack</span> <span class="token punctuation">(</span><span class="token keyword">param</span> <span class="token keyword">i32</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

  <span class="token comment">;; call $throwExnWithStack passing 42 as parameter</span>
  <span class="token punctuation">(</span><span class="token keyword">func</span> <span class="token punctuation">(</span><span class="token keyword">export</span> <span class="token string">"run"</span><span class="token punctuation">)</span>
    <span class="token keyword">i32<span class="token punctuation">.</span>const</span> <span class="token number">42</span>
    <span class="token keyword">call</span> <span class="token variable">$throwExnWithStack</span>
  <span class="token punctuation">)</span>
<span class="token punctuation">)</span>
</pre></div> <p> The JavaScript code below defines a new tag <code>tag</code> and the function <code>throwExceptionWithStack</code>. These are passed to the WebAssembly module in the <code>importObject</code> when it is instantiated. </p> <p> Once the file is instantiated, the code calls the exported WebAssembly <code>run()</code> method, which will immediately throw an exception. The stack is then logged from the <code>catch</code> statement. </p> <div class="code-example"><pre data-language="js"><span class="token keyword">const</span> tag <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WebAssembly<span class="token punctuation">.</span>Tag</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">parameters</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'i32'</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">throwExceptionWithStack</span><span class="token punctuation">(</span><span class="token parameter">param</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// Note: We declare the exception with "{traceStack: true}"</span>
  <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">WebAssembly<span class="token punctuation">.</span>Exception</span><span class="token punctuation">(</span>tag<span class="token punctuation">,</span> <span class="token punctuation">[</span>param<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token literal-property property">traceStack</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// Note: importObject properties match the WebAssembly import statements.</span>
<span class="token keyword">const</span> importObject <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token string-property property">"extmod"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string-property property">"exttag"</span><span class="token operator">:</span> tag<span class="token punctuation">,</span>
    <span class="token string-property property">"throwExnWithStack"</span><span class="token operator">:</span> throwExceptionWithStack<span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

WebAssembly<span class="token punctuation">.</span><span class="token function">instantiateStreaming</span><span class="token punctuation">(</span><span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">'example.wasm'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> importObject<span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span>instance<span class="token punctuation">.</span>exports<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">stack: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>e<span class="token punctuation">.</span>stack<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//Log output (something like):</span>
<span class="token comment">// stack: throwExceptionWithStack@http://&lt;url&gt;/main.js:76:9</span>
<span class="token comment">// @http://&lt;url&gt;/example.wasm:wasm-function[3]:0x73</span>
<span class="token comment">// @http://&lt;url&gt;/main.js:82:38</span>
</pre></div> <p>The most "relevant" part of this code is the line where the exception is created:</p> <div class="code-example"><pre data-language="js"><span class="token keyword">new</span> <span class="token class-name">WebAssembly<span class="token punctuation">.</span>Exception</span><span class="token punctuation">(</span>tag<span class="token punctuation">,</span> <span class="token punctuation">[</span>param<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token literal-property property">traceStack</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre></div> <p> Passing in <code>{traceStack: true}</code> tells the WebAssembly virtual machine that it should attach a stack trace to the returned <code>WebAssembly.Exception</code>. Without this, the stack would be <code>undefined</code>. </p>
</div></section><h2 id="browser_compatibility">Browser compatibility</h2>
<table>
<thead>
<tr id="bct-browser-type">
<th></th>
<th colspan="6">Desktop</th>
<th colspan="6">Mobile</th>
<th colspan="2">Server</th>
</tr>
<tr id="bct-browsers">
<th></th>
<th>Chrome</th>
<th>Edge</th>
<th>Firefox</th>
<th>Internet Explorer</th>
<th>Opera</th>
<th>Safari</th>
<th>WebView Android</th>
<th>Chrome Android</th>
<th>Firefox for Android</th>
<th>Opera Android</th>
<th>Safari on IOS</th>
<th>Samsung Internet</th>
<th>Deno</th>
<th>Node.js</th>
</tr>
</thead>
<tbody><tr>
<th><code>stack</code></th>
<td class="bc-supports-yes"><div>95</div></td>
<td class="bc-supports-yes"><div>95</div></td>
<td class="bc-supports-yes">
<div>100</div>
<div>98-100</div>
</td>
<td class="bc-supports-no"><div>No</div></td>
<td class="bc-supports-yes"><div>81</div></td>
<td class="bc-supports-yes"><div>15.2</div></td>
<td class="bc-supports-yes"><div>95</div></td>
<td class="bc-supports-yes"><div>95</div></td>
<td class="bc-supports-yes"><div>100</div></td>
<td class="bc-supports-yes"><div>67</div></td>
<td class="bc-supports-yes"><div>15.2</div></td>
<td class="bc-supports-yes"><div>17.0</div></td>
<td class="bc-supports-no"><div>No</div></td>
<td class="bc-supports-yes"><div>17.0.0</div></td>
</tr></tbody>
</table>
<section aria-labelledby="see_also"><h2 id="see_also">See also</h2>
<div class="section-content"><ul> <li>
<a href="https://developer.mozilla.org/en-US/docs/WebAssembly">WebAssembly</a> overview</li> <li><a href="https://developer.mozilla.org/en-US/docs/WebAssembly/Concepts">WebAssembly concepts</a></li> <li><a href="https://developer.mozilla.org/en-US/docs/WebAssembly/Using_the_JavaScript_API">Using the WebAssembly JavaScript API</a></li> </ul></div></section><aside class="metadata"><div class="metadata-content-container">
<div id="on-github" class="on-github">
<h3>Found a problem with this page?</h3>
<ul>
<li><a href="https://github.com/mdn/content/edit/main/files/en-us/web/javascript/reference/global_objects/webassembly/exception/stack/index.md" target="_blank" rel="noopener noreferrer">Edit on <b>GitHub</b></a></li>
<li><a href="https://github.com/mdn/content/blob/main/files/en-us/web/javascript/reference/global_objects/webassembly/exception/stack/index.md?plain=1" target="_blank" rel="noopener noreferrer">Source on <b>GitHub</b></a></li>
<li><a href="https://github.com/mdn/content/issues/new?template=page-report.yml&amp;mdn-url=https%3A%2F%2Fdeveloper.mozilla.org%2Fen-US%2Fdocs%2FWeb%2FJavaScript%2FReference%2FGlobal_Objects%2FWebAssembly%2FException%2Fstack&amp;metadata=%3C%21--+Do+not+make+changes+below+this+line+--%3E%0A%3Cdetails%3E%0A%3Csummary%3EPage+report+details%3C%2Fsummary%3E%0A%0A*+Folder%3A+%60en-us%2Fweb%2Fjavascript%2Freference%2Fglobal_objects%2Fwebassembly%2Fexception%2Fstack%60%0A*+MDN+URL%3A+https%3A%2F%2Fdeveloper.mozilla.org%2Fen-US%2Fdocs%2FWeb%2FJavaScript%2FReference%2FGlobal_Objects%2FWebAssembly%2FException%2Fstack%0A*+GitHub+URL%3A+https%3A%2F%2Fgithub.com%2Fmdn%2Fcontent%2Fblob%2Fmain%2Ffiles%2Fen-us%2Fweb%2Fjavascript%2Freference%2Fglobal_objects%2Fwebassembly%2Fexception%2Fstack%2Findex.md%0A*+Last+commit%3A+https%3A%2F%2Fgithub.com%2Fmdn%2Fcontent%2Fcommit%2Fd6f63f6e41146f459e21046af1c51fadb772de70%0A*+Document+last+modified%3A+2022-08-05T15%3A37%3A08.000Z%0A%0A%3C%2Fdetails%3E" target="_blank" rel="noopener noreferrer">Report a problem with this content on <b>GitHub</b></a></li>
<li>Want to fix the problem yourself? See <a href="https://github.com/mdn/content/blob/main/README.md" target="_blank" rel="noopener noreferrer">our Contribution guide</a>.</li>
</ul>
</div>
<p class="last-modified-date"><b>Last modified:</b> <time datetime="2022-08-05T15:37:08.000Z">Aug 5, 2022</time>, <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/WebAssembly/Exception/stack/contributors.txt">by MDN contributors</a></p>
</div></aside><div class="_attribution">
  <p class="_attribution-p">
    <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/WebAssembly/Exception/stack" class="_attribution-link" target="_blank">https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/WebAssembly/Exception/stack</a>
  </p>
</div>
