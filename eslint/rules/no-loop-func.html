
<h1 id="disallow-functions-in-loops-no-loop-func">Disallow Functions in Loops (no-loop-func)</h1>
<p>Writing functions within loops tends to result in errors due to the way the function creates a closure around the loop. For example:</p>
<pre data-language="js">for (var i = 0; i &lt; 10; i++) {
    funcs[i] = function() {
        return i;
    };
}</pre>
<p>In this case, you would expect each function created within the loop to return a different number. In reality, each function returns 10, because that was the last value of <code>i</code> in the scope.</p>
<p><code>let</code> or <code>const</code> mitigate this problem.</p>
<pre data-language="js">/*eslint-env es6*/

for (let i = 0; i &lt; 10; i++) {
    funcs[i] = function() {
        return i;
    };
}</pre>
<p>In this case, each function created within the loop returns a different number as expected.</p>
<h2 id="rule-details">Rule Details</h2>
<p>This error is raised to highlight a piece of code that may not work as you expect it to and could also indicate a misunderstanding of how the language works. Your code may run without any problems if you do not fix this error, but in some situations it could behave unexpectedly.</p>
<p>This rule disallows any function within a loop that contains unsafe references (e.g. to modified variables from the outer scope).</p>
<p>Examples of <strong>incorrect</strong> code for this rule:</p>
<pre data-language="js">/*eslint no-loop-func: "error"*/
/*eslint-env es6*/

for (var i=10; i; i--) {
    (function() { return i; })();
}

while(i) {
    var a = function() { return i; };
    a();
}

do {
    function a() { return i; };
    a();
} while (i);

let foo = 0;
for (let i = 0; i &lt; 10; ++i) {
    //Bad, `foo` is not in the loop-block's scope and `foo` is modified in/after the loop
    setTimeout(() =&gt; console.log(foo));
    foo += 1;
}

for (let i = 0; i &lt; 10; ++i) {
    //Bad, `foo` is not in the loop-block's scope and `foo` is modified in/after the loop
    setTimeout(() =&gt; console.log(foo));
}
foo = 100;</pre>
<p>Examples of <strong>correct</strong> code for this rule:</p>
<pre data-language="js">/*eslint no-loop-func: "error"*/
/*eslint-env es6*/

var a = function() {};

for (var i=10; i; i--) {
    a();
}

for (var i=10; i; i--) {
    var a = function() {}; // OK, no references to variables in the outer scopes.
    a();
}

for (let i=10; i; i--) {
    var a = function() { return i; }; // OK, all references are referring to block scoped variables in the loop.
    a();
}

var foo = 100;
for (let i=10; i; i--) {
    var a = function() { return foo; }; // OK, all references are referring to never modified variables.
    a();
}
//... no modifications of foo after this loop ...</pre>
<h2 id="version">Version</h2>
<p>This rule was introduced in ESLint 0.0.9.</p>
<h2 id="resources">Resources</h2>
<ul>
<li><a href="https://github.com/eslint/eslint/tree/master/lib/rules/no-loop-func.js">Rule source</a></li>
<li><a href="https://github.com/eslint/eslint/tree/master/docs/rules/no-loop-func.md">Documentation source</a></li>
</ul><div class="_attribution">
  <p class="_attribution-p">
    <a href="https://eslint.org/docs/rules/no-loop-func" class="_attribution-link" target="_blank">https://eslint.org/docs/rules/no-loop-func</a>
  </p>
</div>
