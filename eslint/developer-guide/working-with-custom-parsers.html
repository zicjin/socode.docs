<a href="#main" class="c-btn c-btn--primary" id="skip-link">Skip to main content</a> <header class="site-header"> <div class="docs-wrapper">  <nav class="docs-site-nav" aria-label="Main"> <div class="flexer"> <a href="https://eslint.org/donate" class="c-btn c-btn--primary donate-link">Donate</a>  </div> <div class="docs-nav-panel" id="nav-panel"> <ul id="nav-list"> <li> <a href="https://eslint.org/team">Team</a> </li> <li> <a href="https://eslint.org/blog">Blog</a> </li> <li> <a href="../latest/index" aria-current="true">Docs</a> </li> <li> <a href="https://eslint.threadless.com" target="_blank">Store</a> </li> <li> <a href="https://eslint.org/play">Playground</a> </li> </ul> <div class="mobile-only">  <div class="version-switcher"> <a href="../latest/versions/index" class="switcher-fallback">Versions</a> <div hidden role="region" class="switcher switcher--version" aria-labelledby="nav-version-switcher-label" id="nav-version-switcher"> <span id="nav-version-switcher-label" hidden>Version Switcher</span> <div class="infobox visually-hidden" id="nav-version-infobox"> Selecting a version will take you to the chosen version of the ESLint docs. </div> <label class="switcher__label label--block" for="version-select"> <span class="label__text">Version</span> </label> <select name="version selector" id="nav-version-select" aria-describedby="nav-version-infobox" class="c-custom-select switcher__select auto-switcher"> <option value="HEAD" data-url="/docs/head/">HEAD</option> <option value="8.21.0" data-url="/docs/latest/" selected>v8.21.0</option> </select> </div> </div> </div> </div> </nav> </div> </header> <div class="docs-wrapper"> <div class="docs-nav"> <div class="desktop-only">  <div class="version-switcher"> <a href="../latest/versions/index" class="switcher-fallback">Versions</a> <div hidden role="region" class="switcher switcher--version" aria-labelledby="version-switcher-label" id="version-switcher"> <span id="version-switcher-label" hidden>Version Switcher</span> <div class="infobox visually-hidden" id="version-infobox"> Selecting a version will take you to the chosen version of the ESLint docs. </div> <label class="switcher__label label--block" for="version-select"> <span class="label__text">Version</span> </label> <select name="version selector" id="version-select" aria-describedby="version-infobox" class="c-custom-select switcher__select auto-switcher"> <option value="HEAD" data-url="/docs/head/">HEAD</option> <option value="8.21.0" data-url="/docs/latest/" selected>v8.21.0</option> </select> </div> </div> </div> <nav class="docs-index" id="docs-index"> <button class="docs-index-toggle" id="js-docs-index-toggle" hidden> Index  </button> <div class="docs__index__panel" id="js-docs-index-panel"> <div role="region" aria-labelledby="search-label" class="search"> <label for="search" class="label--block"> <span class="label__text" id="search-label">Search</span> </label> <div class="search__input-wrapper">  <p id="search-hint">Results will be shown and updated as you type.</p> <div class="search__inner-input-wrapper"> <input type="search" id="search" class="search__input" autocomplete="off" aria-describedby="search-hint" pattern="\S+"> <button class="search__clear-btn" id="search__clear-btn" hidden> <span class="visually-hidden">Clear search</span>  </button> </div> </div>   </div> <ul class="docs-index__list" id="js-docs-list">
<li class="docs-index__item" data-has-children> <a href="../latest/user-guide/index">User Guide</a><ul data-child-list>
<li class="docs-index__item"> <a href="../latest/user-guide/getting-started">Getting Started</a>
</li>
<li class="docs-index__item" data-has-children> <a href="../latest/user-guide/configuring/index">Configuring</a><ul data-child-list>
<li class="docs-index__item"> <a href="../latest/user-guide/configuring/configuration-files-new">Configuration Files (New)</a>
</li>
<li class="docs-index__item"> <a href="../latest/user-guide/configuring/configuration-files">Configuration Files</a>
</li>
<li class="docs-index__item"> <a href="../latest/user-guide/configuring/language-options">Configuring Language Options</a>
</li>
<li class="docs-index__item"> <a href="../latest/user-guide/configuring/rules">Configuring Rules</a>
</li>
<li class="docs-index__item"> <a href="../latest/user-guide/configuring/plugins">Configuring Plugins</a>
</li>
<li class="docs-index__item"> <a href="../latest/user-guide/configuring/ignoring-code">Ignoring Code</a>
</li>
</ul>
</li>
<li class="docs-index__item"> <a href="../latest/user-guide/command-line-interface">Command Line Interface</a>
</li>
<li class="docs-index__item"> <a href="../latest/rules/index">Rules</a>
</li>
<li class="docs-index__item"> <a href="../latest/user-guide/formatters/index">Formatters</a>
</li>
<li class="docs-index__item"> <a href="../latest/user-guide/integrations">Integrations</a>
</li>
<li class="docs-index__item"> <a href="../latest/user-guide/migrating-to-8.0.0">Migrating to v8.x</a>
</li>
</ul>
</li>
<li class="docs-index__item" data-has-children> <a href="../latest/developer-guide/index">Developer Guide</a><ul data-child-list>
<li class="docs-index__item"> <a href="../latest/developer-guide/architecture/index">Architecture</a>
</li>
<li class="docs-index__item"> <a href="../latest/developer-guide/source-code">Getting the Source Code</a>
</li>
<li class="docs-index__item"> <a href="../latest/developer-guide/development-environment">Set Up a Development Environment</a>
</li>
<li class="docs-index__item"> <a href="../latest/developer-guide/unit-tests">Run the Tests</a>
</li>
<li class="docs-index__item"> <a href="../latest/developer-guide/working-with-rules">Working with Rules</a>
</li>
<li class="docs-index__item"> <a href="../latest/developer-guide/working-with-plugins">Working with Plugins</a>
</li>
<li class="docs-index__item"> <a href="../latest/developer-guide/working-with-custom-formatters">Working with Custom Formatters</a>
</li>
<li class="docs-index__item"> <a href="../latest/developer-guide/working-with-custom-parsers" aria-current="true">Working with Custom Parsers</a>
</li>
<li class="docs-index__item"> <a href="../latest/developer-guide/shareable-configs">Shareable Configs</a>
</li>
<li class="docs-index__item"> <a href="../latest/developer-guide/nodejs-api">Node.js API</a>
</li>
<li class="docs-index__item"> <a href="../latest/developer-guide/contributing/index">Contributing</a>
</li>
</ul>
</li>
<li class="docs-index__item" data-has-children> <a href="https://eslint.org/docs/latest/maintainer-guide/">Maintainer Guide</a><ul data-child-list>
<li class="docs-index__item"> <a href="https://eslint.org/docs/latest/maintainer-guide/issues">Managing Issues</a>
</li>
<li class="docs-index__item"> <a href="https://eslint.org/docs/latest/maintainer-guide/pullrequests">Reviewing Pull Requests</a>
</li>
<li class="docs-index__item"> <a href="https://eslint.org/docs/latest/maintainer-guide/releases">Managing Releases</a>
</li>
<li class="docs-index__item"> <a href="https://eslint.org/docs/latest/maintainer-guide/governance">Governance</a>
</li>
</ul>
</li>
</ul> </div> </nav> </div> <div class="docs-content"> <main id="main" tabindex="-1" class="docs-main"> <div class="docs-main__content"> <h1>Working with Custom Parsers</h1> <nav class="docs-toc c-toc" aria-labelledby="js-toc-label"><h2 class="c-toc__label" id="js-toc-label">Table of Contents</h2> <div class="c-toc__panel" id="js-toc-panel"> <nav class="c-toc"> <ol> <li>
<a href="#the-ast-specification">The AST specification</a> <ol> <li>
<a href="#all-nodes">All nodes:</a> </li> <li>
<a href="#the-program-node">The Program node:</a> </li> <li>
<a href="#the-literal-node">The Literal node:</a> </li> </ol> </li> </ol> </nav> </div></nav> <p>If you want to use your own parser and provide additional capabilities for your rules, you can specify your own custom parser. If a <code>parseForESLint</code> method is exposed on the parser, this method will be used to parse the code. Otherwise, the <code>parse</code> method will be used. Both methods should take in the source code as the first argument, and an optional configuration object as the second argument (provided as <code>parserOptions</code> in a config file). The <code>parse</code> method should simply return the AST. The <code>parseForESLint</code> method should return an object that contains the required property <code>ast</code> and optional properties <code>services</code>, <code>scopeManager</code>, and <code>visitorKeys</code>.</p> <ul> <li>
<code>ast</code> should contain the AST.</li> <li>
<code>services</code> can contain any parser-dependent services (such as type checkers for nodes). The value of the <code>services</code> property is available to rules as <code>context.parserServices</code>. Default is an empty object.</li> <li>
<code>scopeManager</code> can be a <a href="../latest/developer-guide/working-with-custom-parsers./scope-manager-interface">ScopeManager</a> object. Custom parsers can use customized scope analysis for experimental/enhancement syntaxes. Default is the <code>ScopeManager</code> object which is created by <a href="https://github.com/eslint/eslint-scope">eslint-scope</a>. <ul> <li>Support for <code>scopeManager</code> was added in ESLint v4.14.0. ESLint versions which support <code>scopeManager</code> will provide an <code>eslintScopeManager: true</code> property in <code>parserOptions</code>, which can be used for feature detection.</li> </ul> </li> <li>
<code>visitorKeys</code> can be an object to customize AST traversal. The keys of the object are the type of AST nodes. Each value is an array of the property names which should be traversed. Default is <a href="https://github.com/eslint/eslint-visitor-keys#evkkeys">KEYS of <code>eslint-visitor-keys</code></a>. <ul> <li>Support for <code>visitorKeys</code> was added in ESLint v4.14.0. ESLint versions which support <code>visitorKeys</code> will provide an <code>eslintVisitorKeys: true</code> property in <code>parserOptions</code>, which can be used for feature detection.</li> </ul> </li> </ul> <p>You can find an ESLint parser project <a href="https://github.com/typescript-eslint/typescript-eslint">here</a>.</p> <pre class="language-json"><code><span class="highlight-line"><span class="token punctuation">{</span></span><br><span class="highlight-line">    <span class="token property">"parser"</span><span class="token operator">:</span> <span class="token string">"./path/to/awesome-custom-parser.js"</span></span><br><span class="highlight-line"><span class="token punctuation">}</span></span></code></pre> <pre class="language-javascript"><code><span class="highlight-line"><span class="token keyword">var</span> espree <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"espree"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><br><span class="highlight-line"><span class="token comment">// awesome-custom-parser.js</span></span><br><span class="highlight-line">exports<span class="token punctuation">.</span><span class="token function-variable function">parseForESLint</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">code<span class="token punctuation">,</span> options</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span><br><span class="highlight-line">    <span class="token keyword">return</span> <span class="token punctuation">{</span></span><br><span class="highlight-line">        <span class="token literal-property property">ast</span><span class="token operator">:</span> espree<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>code<span class="token punctuation">,</span> options<span class="token punctuation">)</span><span class="token punctuation">,</span></span><br><span class="highlight-line">        <span class="token literal-property property">services</span><span class="token operator">:</span> <span class="token punctuation">{</span></span><br><span class="highlight-line">            <span class="token function-variable function">foo</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span><br><span class="highlight-line">                console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"foo"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><br><span class="highlight-line">            <span class="token punctuation">}</span></span><br><span class="highlight-line">        <span class="token punctuation">}</span><span class="token punctuation">,</span></span><br><span class="highlight-line">        <span class="token literal-property property">scopeManager</span><span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span></span><br><span class="highlight-line">        <span class="token literal-property property">visitorKeys</span><span class="token operator">:</span> <span class="token keyword">null</span></span><br><span class="highlight-line">    <span class="token punctuation">}</span><span class="token punctuation">;</span></span><br><span class="highlight-line"><span class="token punctuation">}</span><span class="token punctuation">;</span></span><br></code></pre> <h2 id="the-ast-specification" tabindex="-1">The AST specification</h2> <p>The AST that custom parsers should create is based on <a href="https://github.com/estree/estree">ESTree</a>. The AST requires some additional properties about detail information of the source code.</p> <h3 id="all-nodes" tabindex="-1">All nodes:</h3> <p>All nodes must have <code>range</code> property.</p> <ul> <li>
<code>range</code> (<code>number[]</code>) is an array of two numbers. Both numbers are a 0-based index which is the position in the array of source code characters. The first is the start position of the node, the second is the end position of the node. <code>code.slice(node.range[0], node.range[1])</code> must be the text of the node. This range does not include spaces/parentheses which are around the node.</li> <li>
<code>loc</code> (<code>SourceLocation</code>) must not be <code>null</code>. <a href="https://github.com/estree/estree/blob/25834f7247d44d3156030f8e8a2d07644d771fdb/es5.md#node-objects">The <code>loc</code> property is defined as nullable by ESTree</a>, but ESLint requires this property. On the other hand, <code>SourceLocation#source</code> property can be <code>undefined</code>. ESLint does not use the <code>SourceLocation#source</code> property.</li> </ul> <p>The <code>parent</code> property of all nodes must be rewritable. ESLint sets each nodeâ€™s <code>parent</code> property to its parent node while traversing, before any rules have access to the AST.</p> <h3 id="the-program-node" tabindex="-1">The <code>Program</code> node:</h3> <p>The <code>Program</code> node must have <code>tokens</code> and <code>comments</code> properties. Both properties are an array of the below Token interface.</p> <pre class="language-ts"><code><span class="highlight-line"><span class="token keyword">interface</span> <span class="token class-name">Token</span> <span class="token punctuation">{</span></span><br><span class="highlight-line">    type<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span></span><br><span class="highlight-line">    loc<span class="token operator">:</span> SourceLocation<span class="token punctuation">;</span></span><br><span class="highlight-line">    range<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token builtin">number</span><span class="token punctuation">,</span> <span class="token builtin">number</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// See "All nodes:" section for details of `range` property.</span></span><br><span class="highlight-line">    value<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span></span><br><span class="highlight-line"><span class="token punctuation">}</span></span></code></pre> <ul> <li>
<code>tokens</code> (<code>Token[]</code>) is the array of tokens which affect the behavior of programs. Arbitrary spaces can exist between tokens, so rules check the <code>Token#range</code> to detect spaces between tokens. This must be sorted by <code>Token#range[0]</code>.</li> <li>
<code>comments</code> (<code>Token[]</code>) is the array of comment tokens. This must be sorted by <code>Token#range[0]</code>.</li> </ul> <p>The range indexes of all tokens and comments must not overlap with the range of other tokens and comments.</p> <h3 id="the-literal-node" tabindex="-1">The <code>Literal</code> node:</h3> <p>The <code>Literal</code> node must have <code>raw</code> property.</p> <ul> <li>
<code>raw</code> (<code>string</code>) is the source code of this literal. This is the same as <code>code.slice(node.range[0], node.range[1])</code>.</li> </ul> </div> <div class="docs-edit-link"> <a href="https://github.com/eslint/eslint/edit/main/docs/src/developer-guide/working-with-custom-parsers.md" class="c-btn c-btn--secondary">Edit this page</a> </div> </main> <div class="docs-aside"> <div class="docs-aside__content">  <nav class="docs-toc c-toc" aria-labelledby="js-toc-label"><h2 class="c-toc__label" id="js-toc-label">Table of Contents</h2> <div class="c-toc__panel" id="js-toc-panel"> <nav class="c-toc"> <ol> <li>
<a href="#the-ast-specification">The AST specification</a> <ol> <li>
<a href="#all-nodes">All nodes:</a> </li> <li>
<a href="#the-program-node">The Program node:</a> </li> <li>
<a href="#the-literal-node">The Literal node:</a> </li> </ol> </li> </ol> </nav> </div></nav> </div> <footer class="docs-footer"> <div class="docs-socials-and-legal"> <div class="docs-social-icons"> <nav aria-labelledby="eslint-social-label" class="eslint-social-icons"> <h2 id="eslint-social-label" hidden>Social Media</h2>  </nav> </div> <div class="docs-copyright"> Â© OpenJS Foundation and ESLint contributors, <a href="https://www.openjsf.org">www.openjsf.org</a> </div> </div> <div class="docs-switchers"> <div role="region" class="theme-switcher" aria-labelledby="theme-switcher-label" id="js-theme-switcher" hidden> <h2 class="theme-switcher-label visually-hidden" id="theme-switcher-label">Theme Switcher </h2> <div class="theme-switcher__buttons"> <button class="theme-switcher__button js-toggle-button" id="light-theme-toggle" data-theme="light">  <span>Light</span> </button> <button class="theme-switcher__button js-toggle-button" id="dark-theme-toggle" data-theme="dark">  <span>Dark</span> </button> </div> </div> <div class="language-switcher"> <a href="https://eslint.org/languages/" class="switcher-fallback">Change Language</a> <div hidden role="region" class="switcher switcher--language" aria-labelledby="language-switcher-label" id="language-switcher"> <span id="language-switcher-label" hidden>Language Switcher</span> <div class="infobox visually-hidden" id="language-infobox"> Selecting a language will take you to the ESLint website in that language. </div> <label class="switcher__label" for="language-select"> <span class="label__text"> Language </span> </label> <select name="language selector" id="language-select" aria-describedby="language-infobox" class="c-custom-select switcher__select"> <option value="en" data-url="https://eslint.org" selected> ðŸ‡ºðŸ‡¸ English (US) </option> </select> </div> </div> </div> </footer> </div> </div> </div><div class="_attribution">
  <p class="_attribution-p">
    <a href="https://eslint.org/docs/developer-guide/working-with-custom-parsers" class="_attribution-link" target="_blank">https://eslint.org/docs/developer-guide/working-with-custom-parsers</a>
  </p>
</div>
