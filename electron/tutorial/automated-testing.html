<h1>Automated Testing</h1>
<p>Test automation is an efficient way of validating that your application code works as intended. While Electron doesn't actively maintain its own testing solution, this guide will go over a couple ways you can run end-to-end automated tests on your Electron app.</p>
<h2 class="anchor anchorWithStickyNavbar_31ik" id="using-the-webdriver-interface">Using the WebDriver interface<a class="hash-link" href="#using-the-webdriver-interface" title="Direct link to heading">​</a>
</h2>
<p>From <a href="https://sites.google.com/chromium.org/driver/" target="_blank" rel="noopener noreferrer">ChromeDriver - WebDriver for Chrome</a>:</p>
<blockquote><p>WebDriver is an open source tool for automated testing of web apps across many browsers. It provides capabilities for navigating to web pages, user input, JavaScript execution, and more. ChromeDriver is a standalone server which implements WebDriver's wire protocol for Chromium. It is being developed by members of the Chromium and WebDriver teams.</p></blockquote>
<p>There are a few ways that you can set up testing using WebDriver.</p>
<h3 class="anchor anchorWithStickyNavbar_31ik" id="with-webdriverio">With WebdriverIO<a class="hash-link" href="#with-webdriverio" title="Direct link to heading">​</a>
</h3>
<p><a href="https://webdriver.io/" target="_blank" rel="noopener noreferrer">WebdriverIO</a> (WDIO) is a test automation framework that provides a Node.js package for testing with WebDriver. Its ecosystem also includes various plugins (e.g. reporter and services) that can help you put together your test setup.</p>
<h4 class="anchor anchorWithStickyNavbar_31ik" id="install-the-testrunner">Install the testrunner<a class="hash-link" href="#install-the-testrunner" title="Direct link to heading">​</a>
</h4>
<p>First you need to run the WebdriverIO starter toolkit in your project root directory:</p>
<div class="tabs-container">
<ul role="tablist" aria-orientation="horizontal" class="tabs">
<li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_1uMI tabs__item--active">npm</li>
<li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_1uMI">Yarn</li>
</ul>
<div class="margin-vert--md">
<div role="tabpanel"><div class="codeBlockContainer_K1bP language-sh theme-code-block"><div class="codeBlockContent_hGly sh"><pre tabindex="0" class="prism-code language-sh codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">npx wdio . --yes</span><br></span></code></pre></div></div></div>
<div role="tabpanel" hidden=""><div class="codeBlockContainer_K1bP language-sh theme-code-block"><div class="codeBlockContent_hGly sh"><pre tabindex="0" class="prism-code language-sh codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">npx wdio . --yes</span><br></span></code></pre></div></div></div>
</div>
</div>
<p>This installs all necessary packages for you and generates a <code>wdio.conf.js</code> configuration file.</p>
<h4 class="anchor anchorWithStickyNavbar_31ik" id="connect-wdio-to-your-electron-app">Connect WDIO to your Electron app<a class="hash-link" href="#connect-wdio-to-your-electron-app" title="Direct link to heading">​</a>
</h4>
<p>Update the capabilities in your configuration file to point to your Electron app binary:</p>
<div class="codeBlockContainer_K1bP language-javascript theme-code-block">
<div style="color:#393A34;background-color:#f6f8fa" class="codeBlockTitle_eoMF">wdio.conf.js</div>
<div class="codeBlockContent_hGly javascript"><pre tabindex="0" class="prism-code language-javascript codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword module" style="color:#00009f">export</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">config</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  capabilities</span><span class="token operator" style="color:#393A34">:</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    browserName</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">'chrome'</span><span class="token punctuation" style="color:#393A34">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">'goog:chromeOptions'</span><span class="token operator" style="color:#393A34">:</span><span class="token punctuation" style="color:#393A34">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      binary</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">'/path/to/your/electron/binary'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token comment" style="color:#999988;font-style:italic">// Path to your Electron binary.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      args</span><span class="token operator" style="color:#393A34">:</span><span class="token punctuation" style="color:#393A34">[</span><span class="token comment" style="color:#999988;font-style:italic">/* cli arguments */</span><span class="token punctuation" style="color:#393A34">]</span><span class="token comment" style="color:#999988;font-style:italic">// Optional, perhaps 'app=' + /path/to/your/app/</span><br></span><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">]</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div>
</div>
<h4 class="anchor anchorWithStickyNavbar_31ik" id="run-your-tests">Run your tests<a class="hash-link" href="#run-your-tests" title="Direct link to heading">​</a>
</h4>
<p>To run your tests:</p>
<div class="codeBlockContainer_K1bP language-sh theme-code-block"><div class="codeBlockContent_hGly sh"><pre tabindex="0" class="prism-code language-sh codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">$ npx wdio run wdio.conf.js</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_31ik" id="with-selenium">With Selenium<a class="hash-link" href="#with-selenium" title="Direct link to heading">​</a>
</h3>
<p><a href="https://www.selenium.dev/" target="_blank" rel="noopener noreferrer">Selenium</a> is a web automation framework that exposes bindings to WebDriver APIs in many languages. Their Node.js bindings are available under the <code>selenium-webdriver</code> package on NPM.</p>
<h4 class="anchor anchorWithStickyNavbar_31ik" id="run-a-chromedriver-server">Run a ChromeDriver server<a class="hash-link" href="#run-a-chromedriver-server" title="Direct link to heading">​</a>
</h4>
<p>In order to use Selenium with Electron, you need to download the <code>electron-chromedriver</code> binary, and run it:</p>
<div class="tabs-container">
<ul role="tablist" aria-orientation="horizontal" class="tabs">
<li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_1uMI tabs__item--active">npm</li>
<li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_1uMI">Yarn</li>
</ul>
<div class="margin-vert--md">
<div role="tabpanel"><div class="codeBlockContainer_K1bP language-sh theme-code-block"><div class="codeBlockContent_hGly sh"><pre tabindex="0" class="prism-code language-sh codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">npm install --save-dev electron-chromedriver</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">./node_modules/.bin/chromedriver</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Starting ChromeDriver (v2.10.291558) on port 9515</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Only local connections are allowed.</span><br></span></code></pre></div></div></div>
<div role="tabpanel" hidden=""><div class="codeBlockContainer_K1bP language-sh theme-code-block"><div class="codeBlockContent_hGly sh"><pre tabindex="0" class="prism-code language-sh codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">yarn add --dev electron-chromedriver</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">./node_modules/.bin/chromedriver</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Starting ChromeDriver (v2.10.291558) on port 9515</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Only local connections are allowed.</span><br></span></code></pre></div></div></div>
</div>
</div>
<p>Remember the port number <code>9515</code>, which will be used later.</p>
<h4 class="anchor anchorWithStickyNavbar_31ik" id="connect-selenium-to-chromedriver">Connect Selenium to ChromeDriver<a class="hash-link" href="#connect-selenium-to-chromedriver" title="Direct link to heading">​</a>
</h4>
<p>Next, install Selenium into your project:</p>
<div class="tabs-container">
<ul role="tablist" aria-orientation="horizontal" class="tabs">
<li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_1uMI tabs__item--active">npm</li>
<li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_1uMI">Yarn</li>
</ul>
<div class="margin-vert--md">
<div role="tabpanel"><div class="codeBlockContainer_K1bP language-sh theme-code-block"><div class="codeBlockContent_hGly sh"><pre tabindex="0" class="prism-code language-sh codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">npm install --save-dev selenium-webdriver</span><br></span></code></pre></div></div></div>
<div role="tabpanel" hidden=""><div class="codeBlockContainer_K1bP language-sh theme-code-block"><div class="codeBlockContent_hGly sh"><pre tabindex="0" class="prism-code language-sh codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">yarn add --dev selenium-webdriver</span><br></span></code></pre></div></div></div>
</div>
</div>
<p>Usage of <code>selenium-webdriver</code> with Electron is the same as with normal websites, except that you have to manually specify how to connect ChromeDriver and where to find the binary of your Electron app:</p>
<div class="codeBlockContainer_K1bP language-js theme-code-block">
<div style="color:#393A34;background-color:#f6f8fa" class="codeBlockTitle_eoMF">test.js</div>
<div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> webdriver </span><span class="token operator" style="color:#393A34">=</span><span class="token function" style="color:#d73a49">require</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">'selenium-webdriver'</span><span class="token punctuation" style="color:#393A34">)</span><br></span><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> driver </span><span class="token operator" style="color:#393A34">=</span><span class="token keyword" style="color:#00009f">new</span><span class="token class-name">webdriver</span><span class="token class-name punctuation" style="color:#393A34">.</span><span class="token class-name">Builder</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// The "9515" is the port opened by ChromeDriver.</span><br></span><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">usingServer</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">'http://localhost:9515'</span><span class="token punctuation" style="color:#393A34">)</span><br></span><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">withCapabilities</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">'goog:chromeOptions'</span><span class="token operator" style="color:#393A34">:</span><span class="token punctuation" style="color:#393A34">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// Here is the path to your Electron binary.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      binary</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">'/Path-to-Your-App.app/Contents/MacOS/Electron'</span><br></span><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><br></span><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">forBrowser</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">'chrome'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token comment" style="color:#999988;font-style:italic">// note: use .forBrowser('electron') for selenium-webdriver &lt;= 3.6.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">build</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">driver</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">'http://www.google.com'</span><span class="token punctuation" style="color:#393A34">)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">driver</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">findElement</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">webdriver</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access maybe-class-name">By</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">name</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">'q'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">sendKeys</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">'webdriver'</span><span class="token punctuation" style="color:#393A34">)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">driver</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">findElement</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">webdriver</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access maybe-class-name">By</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">name</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">'btnG'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">click</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">driver</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">wait</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token punctuation" style="color:#393A34">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> driver</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">getTitle</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">then</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">title</span><span class="token punctuation" style="color:#393A34">)</span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token punctuation" style="color:#393A34">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> title </span><span class="token operator" style="color:#393A34">===</span><span class="token string" style="color:#e3116c">'webdriver - Google Search'</span><br></span><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><br></span><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">1000</span><span class="token punctuation" style="color:#393A34">)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">driver</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">quit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div>
</div>
<h2 class="anchor anchorWithStickyNavbar_31ik" id="using-playwright">Using Playwright<a class="hash-link" href="#using-playwright" title="Direct link to heading">​</a>
</h2>
<p><a href="https://playwright.dev" target="_blank" rel="noopener noreferrer">Microsoft Playwright</a> is an end-to-end testing framework built using browser-specific remote debugging protocols, similar to the <a href="https://github.com/puppeteer/puppeteer" target="_blank" rel="noopener noreferrer">Puppeteer</a> headless Node.js API but geared towards end-to-end testing. Playwright has experimental Electron support via Electron's support for the <a href="https://chromedevtools.github.io/devtools-protocol/" target="_blank" rel="noopener noreferrer">Chrome DevTools Protocol</a> (CDP).</p>
<h3 class="anchor anchorWithStickyNavbar_31ik" id="install-dependencies">Install dependencies<a class="hash-link" href="#install-dependencies" title="Direct link to heading">​</a>
</h3>
<p>You can install Playwright through your preferred Node.js package manager. The Playwright team recommends using the <code>PLAYWRIGHT_SKIP_BROWSER_DOWNLOAD</code> environment variable to avoid unnecessary browser downloads when testing an Electron app.</p>
<div class="tabs-container">
<ul role="tablist" aria-orientation="horizontal" class="tabs">
<li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_1uMI tabs__item--active">npm</li>
<li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_1uMI">Yarn</li>
</ul>
<div class="margin-vert--md">
<div role="tabpanel"><div class="codeBlockContainer_K1bP language-sh theme-code-block"><div class="codeBlockContent_hGly sh"><pre tabindex="0" class="prism-code language-sh codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">PLAYWRIGHT_SKIP_BROWSER_DOWNLOAD=1 npm install --save-dev playwright</span><br></span></code></pre></div></div></div>
<div role="tabpanel" hidden=""><div class="codeBlockContainer_K1bP language-sh theme-code-block"><div class="codeBlockContent_hGly sh"><pre tabindex="0" class="prism-code language-sh codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">PLAYWRIGHT_SKIP_BROWSER_DOWNLOAD=1 yarn add --dev playwright</span><br></span></code></pre></div></div></div>
</div>
</div>
<p>Playwright also comes with its own test runner, Playwright Test, which is built for end-to-end testing. You can also install it as a dev dependency in your project:</p>
<div class="tabs-container">
<ul role="tablist" aria-orientation="horizontal" class="tabs">
<li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_1uMI tabs__item--active">npm</li>
<li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_1uMI">Yarn</li>
</ul>
<div class="margin-vert--md">
<div role="tabpanel"><div class="codeBlockContainer_K1bP language-sh theme-code-block"><div class="codeBlockContent_hGly sh"><pre tabindex="0" class="prism-code language-sh codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">npm install --save-dev @playwright/test</span><br></span></code></pre></div></div></div>
<div role="tabpanel" hidden=""><div class="codeBlockContainer_K1bP language-sh theme-code-block"><div class="codeBlockContent_hGly sh"><pre tabindex="0" class="prism-code language-sh codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">yarn add --dev @playwright/test</span><br></span></code></pre></div></div></div>
</div>
</div>
<div class="admonition admonition-caution alert alert--warning">
<div class="admonition-heading"><h5>
Dependencies</h5></div>
<div class="admonition-content"><p>This tutorial was written <code>playwright@1.16.3</code> and <code>@playwright/test@1.16.3</code>. Check out <a href="https://github.com/microsoft/playwright/releases" target="_blank" rel="noopener noreferrer">Playwright's releases</a> page to learn about changes that might affect the code below.</p></div>
</div>
<div class="admonition admonition-info alert alert--info">
<div class="admonition-heading"><h5>
Using third-party test runners</h5></div>
<div class="admonition-content"><p>If you're interested in using an alternative test runner (e.g. Jest or Mocha), check out Playwright's <a href="https://playwright.dev/docs/test-runners/" target="_blank" rel="noopener noreferrer">Third-Party Test Runner</a> guide.</p></div>
</div>
<h3 class="anchor anchorWithStickyNavbar_31ik" id="write-your-tests">Write your tests<a class="hash-link" href="#write-your-tests" title="Direct link to heading">​</a>
</h3>
<p>Playwright launches your app in development mode through the <code>_electron.launch</code> API. To point this API to your Electron app, you can pass the path to your main process entry point (here, it is <code>main.js</code>).</p>
<div class="codeBlockContainer_K1bP language-js theme-code-block"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">const</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> _electron</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> electron </span><span class="token punctuation" style="color:#393A34">}</span><span class="token operator" style="color:#393A34">=</span><span class="token function" style="color:#d73a49">require</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">'playwright'</span><span class="token punctuation" style="color:#393A34">)</span><br></span><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">const</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> test </span><span class="token punctuation" style="color:#393A34">}</span><span class="token operator" style="color:#393A34">=</span><span class="token function" style="color:#d73a49">require</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">'@playwright/test'</span><span class="token punctuation" style="color:#393A34">)</span><br></span><span class="token-line" style="color:#393A34"><br></span><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">test</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">'launch app'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token keyword" style="color:#00009f">async</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token punctuation" style="color:#393A34">{</span><br></span><span class="token-line docusaurus-highlight-code-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> electronApp </span><span class="token operator" style="color:#393A34">=</span><span class="token keyword control-flow" style="color:#00009f">await</span><span class="token plain"> electron</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">launch</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> args</span><span class="token operator" style="color:#393A34">:</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">'main.js'</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// close app</span><br></span><span class="token-line" style="color:#393A34"><span class="token keyword control-flow" style="color:#00009f">await</span><span class="token plain"> electronApp</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">close</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div>
<p>After that, you will access to an instance of Playwright's <code>ElectronApp</code> class. This is a powerful class that has access to main process modules for example:</p>
<div class="codeBlockContainer_K1bP language-js theme-code-block"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">const</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> _electron</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> electron </span><span class="token punctuation" style="color:#393A34">}</span><span class="token operator" style="color:#393A34">=</span><span class="token function" style="color:#d73a49">require</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">'playwright'</span><span class="token punctuation" style="color:#393A34">)</span><br></span><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">const</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> test </span><span class="token punctuation" style="color:#393A34">}</span><span class="token operator" style="color:#393A34">=</span><span class="token function" style="color:#d73a49">require</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">'@playwright/test'</span><span class="token punctuation" style="color:#393A34">)</span><br></span><span class="token-line" style="color:#393A34"><br></span><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">test</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">'get isPackaged'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token keyword" style="color:#00009f">async</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token punctuation" style="color:#393A34">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> electronApp </span><span class="token operator" style="color:#393A34">=</span><span class="token keyword control-flow" style="color:#00009f">await</span><span class="token plain"> electron</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">launch</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> args</span><span class="token operator" style="color:#393A34">:</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">'main.js'</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><br></span><span class="token-line docusaurus-highlight-code-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> isPackaged </span><span class="token operator" style="color:#393A34">=</span><span class="token keyword control-flow" style="color:#00009f">await</span><span class="token plain"> electronApp</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">evaluate</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">async</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter punctuation" style="color:#393A34">{</span><span class="token parameter"> app </span><span class="token parameter punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token punctuation" style="color:#393A34">{</span><br></span><span class="token-line docusaurus-highlight-code-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// This runs in Electron's main process, parameter here is always</span><br></span><span class="token-line docusaurus-highlight-code-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// the result of the require('electron') in the main app script.</span><br></span><span class="token-line docusaurus-highlight-code-line" style="color:#393A34"><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> app</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">isPackaged</span><br></span><span class="token-line docusaurus-highlight-code-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><br></span><span class="token-line docusaurus-highlight-code-line" style="color:#393A34"><span class="token console class-name">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">isPackaged</span><span class="token punctuation" style="color:#393A34">)</span><span class="token comment" style="color:#999988;font-style:italic">// false (because we're in development mode)</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// close app</span><br></span><span class="token-line" style="color:#393A34"><span class="token keyword control-flow" style="color:#00009f">await</span><span class="token plain"> electronApp</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">close</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div>
<p>It can also create individual <a href="https://playwright.dev/docs/api/class-page" target="_blank" rel="noopener noreferrer">Page</a> objects from Electron BrowserWindow instances. For example, to grab the first BrowserWindow and save a screenshot:</p>
<div class="codeBlockContainer_K1bP language-js theme-code-block"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">const</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> _electron</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> electron </span><span class="token punctuation" style="color:#393A34">}</span><span class="token operator" style="color:#393A34">=</span><span class="token function" style="color:#d73a49">require</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">'playwright'</span><span class="token punctuation" style="color:#393A34">)</span><br></span><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">const</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> test </span><span class="token punctuation" style="color:#393A34">}</span><span class="token operator" style="color:#393A34">=</span><span class="token function" style="color:#d73a49">require</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">'@playwright/test'</span><span class="token punctuation" style="color:#393A34">)</span><br></span><span class="token-line" style="color:#393A34"><br></span><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">test</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">'save screenshot'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token keyword" style="color:#00009f">async</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token punctuation" style="color:#393A34">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> electronApp </span><span class="token operator" style="color:#393A34">=</span><span class="token keyword control-flow" style="color:#00009f">await</span><span class="token plain"> electron</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">launch</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> args</span><span class="token operator" style="color:#393A34">:</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">'main.js'</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><br></span><span class="token-line docusaurus-highlight-code-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">const</span><span class="token dom variable" style="color:#36acaa">window</span><span class="token operator" style="color:#393A34">=</span><span class="token keyword control-flow" style="color:#00009f">await</span><span class="token plain"> electronApp</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">firstWindow</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span><span class="token-line docusaurus-highlight-code-line" style="color:#393A34"><span class="token keyword control-flow" style="color:#00009f">await</span><span class="token dom variable" style="color:#36acaa">window</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">screenshot</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> path</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">'intro.png'</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// close app</span><br></span><span class="token-line" style="color:#393A34"><span class="token keyword control-flow" style="color:#00009f">await</span><span class="token plain"> electronApp</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">close</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div>
<p>Putting all this together using the PlayWright Test runner, let's create a <code>example.spec.js</code> test file with a single test and assertion:</p>
<div class="codeBlockContainer_K1bP language-js theme-code-block">
<div style="color:#393A34;background-color:#f6f8fa" class="codeBlockTitle_eoMF">example.spec.js</div>
<div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">const</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> _electron</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> electron </span><span class="token punctuation" style="color:#393A34">}</span><span class="token operator" style="color:#393A34">=</span><span class="token function" style="color:#d73a49">require</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">'playwright'</span><span class="token punctuation" style="color:#393A34">)</span><br></span><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">const</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> test</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> expect </span><span class="token punctuation" style="color:#393A34">}</span><span class="token operator" style="color:#393A34">=</span><span class="token function" style="color:#d73a49">require</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">'@playwright/test'</span><span class="token punctuation" style="color:#393A34">)</span><br></span><span class="token-line" style="color:#393A34"><br></span><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">test</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">'example test'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token keyword" style="color:#00009f">async</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token punctuation" style="color:#393A34">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> electronApp </span><span class="token operator" style="color:#393A34">=</span><span class="token keyword control-flow" style="color:#00009f">await</span><span class="token plain"> electron</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">launch</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> args</span><span class="token operator" style="color:#393A34">:</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">'.'</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><br></span><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> isPackaged </span><span class="token operator" style="color:#393A34">=</span><span class="token keyword control-flow" style="color:#00009f">await</span><span class="token plain"> electronApp</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">evaluate</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">async</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter punctuation" style="color:#393A34">{</span><span class="token parameter"> app </span><span class="token parameter punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token punctuation" style="color:#393A34">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// This runs in Electron's main process, parameter here is always</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// the result of the require('electron') in the main app script.</span><br></span><span class="token-line" style="color:#393A34"><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> app</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">isPackaged</span><span class="token punctuation" style="color:#393A34">;</span><br></span><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span><span class="token-line" style="color:#393A34"><br></span><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">expect</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">isPackaged</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">toBe</span><span class="token punctuation" style="color:#393A34">(</span><span class="token boolean" style="color:#36acaa">false</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span><span class="token-line" style="color:#393A34"><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// Wait for the first BrowserWindow to open</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// and return its Page object</span><br></span><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">const</span><span class="token dom variable" style="color:#36acaa">window</span><span class="token operator" style="color:#393A34">=</span><span class="token keyword control-flow" style="color:#00009f">await</span><span class="token plain"> electronApp</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">firstWindow</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span><span class="token-line" style="color:#393A34"><span class="token keyword control-flow" style="color:#00009f">await</span><span class="token dom variable" style="color:#36acaa">window</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">screenshot</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> path</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">'intro.png'</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><br></span><span class="token-line" style="color:#393A34"><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// close app</span><br></span><span class="token-line" style="color:#393A34"><span class="token keyword control-flow" style="color:#00009f">await</span><span class="token plain"> electronApp</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">close</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre></div>
</div>
<p>Then, run Playwright Test using <code>npx playwright test</code>. You should see the test pass in your console, and have an <code>intro.png</code> screenshot on your filesystem.</p>
<div class="codeBlockContainer_K1bP language-console theme-code-block"><div class="codeBlockContent_hGly console"><pre tabindex="0" class="prism-code language-console codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">☁  $ npx playwright test</span><br></span><span class="token-line" style="color:#393A34"><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Running 1 test using 1 worker</span><br></span><span class="token-line" style="color:#393A34"><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ✓  example.spec.js:4:1 › example test (1s)</span><br></span></code></pre></div></div>
<div class="admonition admonition-info alert alert--info">
<div class="admonition-heading"><h5>
info</h5></div>
<div class="admonition-content"><p>Playwright Test will automatically run any files matching the <code>.*(test|spec)\.(js|ts|mjs)</code> regex. You can customize this match in the <a href="https://playwright.dev/docs/api/class-testconfig#test-config-test-match" target="_blank" rel="noopener noreferrer">Playwright Test configuration options</a>.</p></div>
</div>
<div class="admonition admonition-tip alert alert--success">
<div class="admonition-heading"><h5>
Further reading</h5></div>
<div class="admonition-content"><p>Check out Playwright's documentation for the full <a href="https://playwright.dev/docs/api/class-electron/" target="_blank" rel="noopener noreferrer">Electron</a> and <a href="https://playwright.dev/docs/api/class-electronapplication" target="_blank" rel="noopener noreferrer">ElectronApplication</a> class APIs.</p></div>
</div>
<h2 class="anchor anchorWithStickyNavbar_31ik" id="using-a-custom-test-driver">Using a custom test driver<a class="hash-link" href="#using-a-custom-test-driver" title="Direct link to heading">​</a>
</h2>
<p>It's also possible to write your own custom driver using Node.js' built-in IPC-over-STDIO. Custom test drivers require you to write additional app code, but have lower overhead and let you expose custom methods to your test suite.</p>
<p>To create a custom driver, we'll use Node.js' <a href="https://nodejs.org/api/child_process.html" target="_blank" rel="noopener noreferrer"><code>child_process</code></a> API. The test suite will spawn the Electron process, then establish a simple messaging protocol:</p>
<div class="codeBlockContainer_K1bP language-js theme-code-block">
<div style="color:#393A34;background-color:#f6f8fa" class="codeBlockTitle_eoMF">testDriver.js</div>
<div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> childProcess </span><span class="token operator" style="color:#393A34">=</span><span class="token function" style="color:#d73a49">require</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">'child_process'</span><span class="token punctuation" style="color:#393A34">)</span><br></span><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> electronPath </span><span class="token operator" style="color:#393A34">=</span><span class="token function" style="color:#d73a49">require</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">'electron'</span><span class="token punctuation" style="color:#393A34">)</span><br></span><span class="token-line" style="color:#393A34"><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// spawn the process</span><br></span><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> env </span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">{</span><span class="token comment" style="color:#999988;font-style:italic">/* ... */</span><span class="token punctuation" style="color:#393A34">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> stdio </span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">'inherit'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">'inherit'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">'inherit'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">'ipc'</span><span class="token punctuation" style="color:#393A34">]</span><br></span><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> appProcess </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> childProcess</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">spawn</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">electronPath</span><span class="token punctuation" style="color:#393A34">,</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">'./app'</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> stdio</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> env </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><br></span><span class="token-line" style="color:#393A34"><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// listen for IPC messages from the app</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">appProcess</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">on</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">'message'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">msg</span><span class="token punctuation" style="color:#393A34">)</span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token punctuation" style="color:#393A34">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><br></span><span class="token-line" style="color:#393A34"><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// send an IPC message to the app</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">appProcess</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">send</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> my</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">'message'</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div>
</div>
<p>From within the Electron app, you can listen for messages and send replies using the Node.js <a href="https://nodejs.org/api/process.html" target="_blank" rel="noopener noreferrer"><code>process</code></a> API:</p>
<div class="codeBlockContainer_K1bP language-js theme-code-block">
<div style="color:#393A34;background-color:#f6f8fa" class="codeBlockTitle_eoMF">main.js</div>
<div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// listen for messages from the test suite</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">process</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">on</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">'message'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">msg</span><span class="token punctuation" style="color:#393A34">)</span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token punctuation" style="color:#393A34">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><br></span><span class="token-line" style="color:#393A34"><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// send a message to the test suite</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">process</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">send</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> my</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">'message'</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div>
</div>
<p>We can now communicate from the test suite to the Electron app using the <code>appProcess</code> object.</p>
<p>For convenience, you may want to wrap <code>appProcess</code> in a driver object that provides more high-level functions. Here is an example of how you can do this. Let's start by creating a <code>TestDriver</code> class:</p>
<div class="codeBlockContainer_K1bP language-js theme-code-block">
<div style="color:#393A34;background-color:#f6f8fa" class="codeBlockTitle_eoMF">testDriver.js</div>
<div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">class</span><span class="token class-name">TestDriver</span><span class="token punctuation" style="color:#393A34">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">constructor</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter punctuation" style="color:#393A34">{</span><span class="token parameter"> path</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> args</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> env </span><span class="token parameter punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">rpcCalls</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><br></span><span class="token-line" style="color:#393A34"><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// start child process</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    env</span><span class="token punctuation" style="color:#393A34">.</span><span class="token constant" style="color:#36acaa">APP_TEST_DRIVER</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token comment" style="color:#999988;font-style:italic">// let the app know it should listen for messages</span><br></span><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">process</span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> childProcess</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">spawn</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">path</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> args</span><span class="token punctuation" style="color:#393A34">,</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> stdio</span><span class="token operator" style="color:#393A34">:</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">'inherit'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">'inherit'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">'inherit'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">'ipc'</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> env </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><br></span><span class="token-line" style="color:#393A34"><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// handle rpc responses</span><br></span><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">process</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">on</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">'message'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">message</span><span class="token punctuation" style="color:#393A34">)</span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token punctuation" style="color:#393A34">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// pop the handler</span><br></span><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> rpcCall </span><span class="token operator" style="color:#393A34">=</span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">rpcCalls</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">message</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">msgId</span><span class="token punctuation" style="color:#393A34">]</span><br></span><span class="token-line" style="color:#393A34"><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">!</span><span class="token plain">rpcCall</span><span class="token punctuation" style="color:#393A34">)</span><span class="token keyword control-flow" style="color:#00009f">return</span><br></span><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">rpcCalls</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">message</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">msgId</span><span class="token punctuation" style="color:#393A34">]</span><span class="token operator" style="color:#393A34">=</span><span class="token keyword null nil" style="color:#00009f">null</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// reject/resolve</span><br></span><span class="token-line" style="color:#393A34"><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">message</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">reject</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> rpcCall</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">reject</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">message</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">reject</span><span class="token punctuation" style="color:#393A34">)</span><br></span><span class="token-line" style="color:#393A34"><span class="token keyword control-flow" style="color:#00009f">else</span><span class="token plain"> rpcCall</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">resolve</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">message</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">resolve</span><span class="token punctuation" style="color:#393A34">)</span><br></span><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><br></span><span class="token-line" style="color:#393A34"><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// wait for ready</span><br></span><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">isReady</span><span class="token operator" style="color:#393A34">=</span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">rpc</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">'isReady'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token keyword control-flow" style="color:#00009f">catch</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">err</span><span class="token punctuation" style="color:#393A34">)</span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token punctuation" style="color:#393A34">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token console class-name">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">error</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">'Application failed to start'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> err</span><span class="token punctuation" style="color:#393A34">)</span><br></span><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">stop</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      process</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">exit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><br></span><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><br></span><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">}</span><br></span><span class="token-line" style="color:#393A34"><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// simple RPC call</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// to use: driver.rpc('method', 1, 2, 3).then(...)</span><br></span><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">async</span><span class="token function" style="color:#d73a49">rpc</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">cmd</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter operator" style="color:#393A34">...</span><span class="token parameter">args</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// send rpc request</span><br></span><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> msgId </span><span class="token operator" style="color:#393A34">=</span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">rpcCalls</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">length</span><br></span><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">process</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">send</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> msgId</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> cmd</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> args </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><br></span><span class="token-line" style="color:#393A34"><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token keyword" style="color:#00009f">new</span><span class="token class-name">Promise</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">resolve</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> reject</span><span class="token punctuation" style="color:#393A34">)</span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">rpcCalls</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">push</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> resolve</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> reject </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><br></span><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">}</span><br></span><span class="token-line" style="color:#393A34"><br></span><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">stop</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">process</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">kill</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">}</span><br></span><span class="token-line" style="color:#393A34"><br></span><span class="token-line" style="color:#393A34"><span class="token plain">module</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">exports</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">{</span><span class="token maybe-class-name">TestDriver</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre></div>
</div>
<p>In your app code, can then write a simple handler to receive RPC calls:</p>
<div class="codeBlockContainer_K1bP language-js theme-code-block">
<div style="color:#393A34;background-color:#f6f8fa" class="codeBlockTitle_eoMF">main.js</div>
<div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">const</span><span class="token constant" style="color:#36acaa">METHODS</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">isReady</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// do any setup needed</span><br></span><span class="token-line" style="color:#393A34"><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token boolean" style="color:#36acaa">true</span><br></span><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// define your RPC-able methods here</span><br></span><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">}</span><br></span><span class="token-line" style="color:#393A34"><br></span><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">const</span><span class="token function-variable function" style="color:#d73a49">onMessage</span><span class="token operator" style="color:#393A34">=</span><span class="token keyword" style="color:#00009f">async</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter punctuation" style="color:#393A34">{</span><span class="token parameter"> msgId</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> cmd</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> args </span><span class="token parameter punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token punctuation" style="color:#393A34">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> method </span><span class="token operator" style="color:#393A34">=</span><span class="token constant" style="color:#36acaa">METHODS</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">cmd</span><span class="token punctuation" style="color:#393A34">]</span><br></span><span class="token-line" style="color:#393A34"><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">!</span><span class="token plain">method</span><span class="token punctuation" style="color:#393A34">)</span><span class="token function-variable function" style="color:#d73a49">method</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token keyword" style="color:#00009f">new</span><span class="token class-name">Error</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">'Invalid method: '</span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> cmd</span><span class="token punctuation" style="color:#393A34">)</span><br></span><span class="token-line" style="color:#393A34"><span class="token keyword control-flow" style="color:#00009f">try</span><span class="token punctuation" style="color:#393A34">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> resolve </span><span class="token operator" style="color:#393A34">=</span><span class="token keyword control-flow" style="color:#00009f">await</span><span class="token function" style="color:#d73a49">method</span><span class="token punctuation" style="color:#393A34">(</span><span class="token spread operator" style="color:#393A34">...</span><span class="token plain">args</span><span class="token punctuation" style="color:#393A34">)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    process</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">send</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> msgId</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> resolve </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><br></span><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">}</span><span class="token keyword control-flow" style="color:#00009f">catch</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">err</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> reject </span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      message</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> err</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">message</span><span class="token punctuation" style="color:#393A34">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      stack</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> err</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">stack</span><span class="token punctuation" style="color:#393A34">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      name</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> err</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">name</span><br></span><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    process</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">send</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> msgId</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> reject </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><br></span><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">}</span><br></span><span class="token-line" style="color:#393A34"><br></span><span class="token-line" style="color:#393A34"><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">process</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">env</span><span class="token punctuation" style="color:#393A34">.</span><span class="token constant" style="color:#36acaa">APP_TEST_DRIVER</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  process</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">on</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">'message'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> onMessage</span><span class="token punctuation" style="color:#393A34">)</span><br></span><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div>
</div>
<p>Then, in your test suite, you can use your <code>TestDriver</code> class with the test automation framework of your choosing. The following example uses <a href="https://www.npmjs.com/package/ava" target="_blank" rel="noopener noreferrer"><code>ava</code></a>, but other popular choices like Jest or Mocha would work as well:</p>
<div class="codeBlockContainer_K1bP language-js theme-code-block">
<div style="color:#393A34;background-color:#f6f8fa" class="codeBlockTitle_eoMF">test.js</div>
<div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> test </span><span class="token operator" style="color:#393A34">=</span><span class="token function" style="color:#d73a49">require</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">'ava'</span><span class="token punctuation" style="color:#393A34">)</span><br></span><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> electronPath </span><span class="token operator" style="color:#393A34">=</span><span class="token function" style="color:#d73a49">require</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">'electron'</span><span class="token punctuation" style="color:#393A34">)</span><br></span><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">const</span><span class="token punctuation" style="color:#393A34">{</span><span class="token maybe-class-name">TestDriver</span><span class="token punctuation" style="color:#393A34">}</span><span class="token operator" style="color:#393A34">=</span><span class="token function" style="color:#d73a49">require</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">'./testDriver'</span><span class="token punctuation" style="color:#393A34">)</span><br></span><span class="token-line" style="color:#393A34"><br></span><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> app </span><span class="token operator" style="color:#393A34">=</span><span class="token keyword" style="color:#00009f">new</span><span class="token class-name">TestDriver</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  path</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> electronPath</span><span class="token punctuation" style="color:#393A34">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  args</span><span class="token operator" style="color:#393A34">:</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">'./app'</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  env</span><span class="token operator" style="color:#393A34">:</span><span class="token punctuation" style="color:#393A34">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token constant" style="color:#36acaa">NODE_ENV</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">'test'</span><br></span><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">test</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">before</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">async</span><span class="token parameter">t</span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token punctuation" style="color:#393A34">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token keyword control-flow" style="color:#00009f">await</span><span class="token plain"> app</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">isReady</span><br></span><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">test</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">after</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">always</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">'cleanup'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token keyword" style="color:#00009f">async</span><span class="token parameter">t</span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token punctuation" style="color:#393A34">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token keyword control-flow" style="color:#00009f">await</span><span class="token plain"> app</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">stop</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div>
</div><div class="_attribution">
  <p class="_attribution-p">
    <a href="https://www.electronjs.org/docs/latest/tutorial/automated-testing" class="_attribution-link" target="_blank">https://www.electronjs.org/docs/latest/tutorial/automated-testing</a>
  </p>
</div>
