<h1>desktopCapturer</h1>
<blockquote><p>Access information about media sources that can be used to capture audio and video from the desktop using the <a href="https://developer.mozilla.org/en/docs/Web/API/MediaDevices/getUserMedia" target="_blank" rel="noopener noreferrer"><code>navigator.mediaDevices.getUserMedia</code></a> API.</p></blockquote>
<p>Process: <a href="../glossary#main-process">Main</a>, <a href="../glossary#renderer-process">Renderer</a></p>
<p>The following example shows how to capture video from a desktop window whose title is <code>Electron</code>:</p>
<div class="codeBlockContainer_K1bP language-javascript theme-code-block"><div class="codeBlockContent_hGly javascript"><pre tabindex="0" class="prism-code language-javascript codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// In the renderer process.</span><br></span><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">const</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> desktopCapturer </span><span class="token punctuation" style="color:#393A34">}</span><span class="token operator" style="color:#393A34">=</span><span class="token function" style="color:#d73a49">require</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">'electron'</span><span class="token punctuation" style="color:#393A34">)</span><br></span><span class="token-line" style="color:#393A34"><br></span><span class="token-line" style="color:#393A34"><span class="token plain">desktopCapturer</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">getSources</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> types</span><span class="token operator" style="color:#393A34">:</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">'window'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">'screen'</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">then</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">async</span><span class="token parameter">sources</span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token punctuation" style="color:#393A34">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token keyword control-flow" style="color:#00009f">for</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> source </span><span class="token keyword" style="color:#00009f">of</span><span class="token plain"> sources</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">source</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">name</span><span class="token operator" style="color:#393A34">===</span><span class="token string" style="color:#e3116c">'Electron'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token keyword control-flow" style="color:#00009f">try</span><span class="token punctuation" style="color:#393A34">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> stream </span><span class="token operator" style="color:#393A34">=</span><span class="token keyword control-flow" style="color:#00009f">await</span><span class="token dom variable" style="color:#36acaa">navigator</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">mediaDevices</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">getUserMedia</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          audio</span><span class="token operator" style="color:#393A34">:</span><span class="token boolean" style="color:#36acaa">false</span><span class="token punctuation" style="color:#393A34">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          video</span><span class="token operator" style="color:#393A34">:</span><span class="token punctuation" style="color:#393A34">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            mandatory</span><span class="token operator" style="color:#393A34">:</span><span class="token punctuation" style="color:#393A34">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              chromeMediaSource</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">'desktop'</span><span class="token punctuation" style="color:#393A34">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              chromeMediaSourceId</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> source</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">id</span><span class="token punctuation" style="color:#393A34">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              minWidth</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">1280</span><span class="token punctuation" style="color:#393A34">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              maxWidth</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">1280</span><span class="token punctuation" style="color:#393A34">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              minHeight</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">720</span><span class="token punctuation" style="color:#393A34">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              maxHeight</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">720</span><br></span><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><br></span><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">handleStream</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">stream</span><span class="token punctuation" style="color:#393A34">)</span><br></span><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">}</span><span class="token keyword control-flow" style="color:#00009f">catch</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">e</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">handleError</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">e</span><span class="token punctuation" style="color:#393A34">)</span><br></span><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token keyword control-flow" style="color:#00009f">return</span><br></span><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><br></span><span class="token-line" style="color:#393A34"><br></span><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">function</span><span class="token function" style="color:#d73a49">handleStream</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">stream</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> video </span><span class="token operator" style="color:#393A34">=</span><span class="token dom variable" style="color:#36acaa">document</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">querySelector</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">'video'</span><span class="token punctuation" style="color:#393A34">)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  video</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">srcObject</span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> stream</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  video</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method-variable function-variable method function property-access" style="color:#d73a49">onloadedmetadata</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">e</span><span class="token punctuation" style="color:#393A34">)</span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> video</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">play</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">}</span><br></span><span class="token-line" style="color:#393A34"><br></span><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">function</span><span class="token function" style="color:#d73a49">handleError</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">e</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token console class-name">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">e</span><span class="token punctuation" style="color:#393A34">)</span><br></span><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<p>To capture video from a source provided by <code>desktopCapturer</code> the constraints passed to <a href="https://developer.mozilla.org/en/docs/Web/API/MediaDevices/getUserMedia" target="_blank" rel="noopener noreferrer"><code>navigator.mediaDevices.getUserMedia</code></a> must include <code>chromeMediaSource: 'desktop'</code>, and <code>audio: false</code>.</p>
<p>To capture both audio and video from the entire desktop the constraints passed to <a href="https://developer.mozilla.org/en/docs/Web/API/MediaDevices/getUserMedia" target="_blank" rel="noopener noreferrer"><code>navigator.mediaDevices.getUserMedia</code></a> must include <code>chromeMediaSource: 'desktop'</code>, for both <code>audio</code> and <code>video</code>, but should not include a <code>chromeMediaSourceId</code> constraint.</p>
<div class="codeBlockContainer_K1bP language-javascript theme-code-block"><div class="codeBlockContent_hGly javascript"><pre tabindex="0" class="prism-code language-javascript codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> constraints </span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  audio</span><span class="token operator" style="color:#393A34">:</span><span class="token punctuation" style="color:#393A34">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    mandatory</span><span class="token operator" style="color:#393A34">:</span><span class="token punctuation" style="color:#393A34">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      chromeMediaSource</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">'desktop'</span><br></span><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  video</span><span class="token operator" style="color:#393A34">:</span><span class="token punctuation" style="color:#393A34">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    mandatory</span><span class="token operator" style="color:#393A34">:</span><span class="token punctuation" style="color:#393A34">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      chromeMediaSource</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">'desktop'</span><br></span><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_31ik" id="methods">Methods<a class="hash-link" href="#methods" title="Direct link to heading">​</a>
</h2>
<p>The <code>desktopCapturer</code> module has the following methods:</p>
<h3 class="anchor anchorWithStickyNavbar_31ik" id="desktopcapturergetsourcesoptions">
<code>desktopCapturer.getSources(options)</code><a class="hash-link" href="#desktopcapturergetsourcesoptions" title="Direct link to heading">​</a>
</h3>
<ul><li>
<code>options</code> Object<ul>
<li>
<code>types</code> String[] - An array of Strings that lists the types of desktop sources to be captured, available types are <code>screen</code> and <code>window</code>.</li>
<li>
<code>thumbnailSize</code> <a aria-describedby="structures-tooltip" href="structures/size" class="link_2NU_">Size</a> (optional) - The size that the media source thumbnail should be scaled to. Default is <code>150</code> x <code>150</code>. Set width or height to 0 when you do not need the thumbnails. This will save the processing time required for capturing the content of each window and screen.</li>
<li>
<code>fetchWindowIcons</code> Boolean (optional) - Set to true to enable fetching window icons. The default value is false. When false the appIcon property of the sources return null. Same if a source has the type screen.</li>
</ul>
</li></ul>
<p>Returns <code>Promise&lt;DesktopCapturerSource[]&gt;</code> - Resolves with an array of <a aria-describedby="structures-tooltip" href="structures/desktop-capturer-source" class="link_2NU_">DesktopCapturerSource</a> objects, each <code>DesktopCapturerSource</code> represents a screen or an individual window that can be captured.</p>
<p><strong>Note</strong> Capturing the screen contents requires user consent on macOS 10.15 Catalina or higher, which can detected by <a href="system-preferences#systempreferencesgetmediaaccessstatusmediatype-windows-macos"><code>systemPreferences.getMediaAccessStatus</code></a>.</p>
<h2 class="anchor anchorWithStickyNavbar_31ik" id="caveats">Caveats<a class="hash-link" href="#caveats" title="Direct link to heading">​</a>
</h2>
<p><code>navigator.mediaDevices.getUserMedia</code> does not work on macOS for audio capture due to a fundamental limitation whereby apps that want to access the system's audio require a <a href="https://developer.apple.com/library/archive/documentation/Security/Conceptual/System_Integrity_Protection_Guide/KernelExtensions/KernelExtensions.html" target="_blank" rel="noopener noreferrer">signed kernel extension</a>. Chromium, and by extension Electron, does not provide this.</p>
<p>It is possible to circumvent this limitation by capturing system audio with another macOS app like Soundflower and passing it through a virtual audio input device. This virtual device can then be queried with <code>navigator.mediaDevices.getUserMedia</code>.</p><div class="_attribution">
  <p class="_attribution-p">
    <a href="https://www.electronjs.org/docs/latest/api/desktop-capturer" class="_attribution-link" target="_blank">https://www.electronjs.org/docs/latest/api/desktop-capturer</a>
  </p>
</div>
