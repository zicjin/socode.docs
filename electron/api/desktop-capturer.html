<h1 id="desktopcapturer">desktopCapturer</h1> <blockquote> <p>Access information about media sources that can be used to capture audio and video from the desktop using the <a href="https://developer.mozilla.org/en/docs/Web/API/MediaDevices/getUserMedia"><code>navigator.mediaDevices.getUserMedia</code></a> API.</p> </blockquote> <p>Process: <a href="../glossary#main-process">Main</a>, <a href="../glossary#renderer-process">Renderer</a></p> <p>The following example shows how to capture video from a desktop window whose title is <code>Electron</code>:</p> <pre data-language="javascript">// In the renderer process.
const { desktopCapturer } = require('electron')

desktopCapturer.getSources({ types: ['window', 'screen'] }).then(async sources =&gt; {
  for (const source of sources) {
    if (source.name === 'Electron') {
      try {
        const stream = await navigator.mediaDevices.getUserMedia({
          audio: false,
          video: {
            mandatory: {
              chromeMediaSource: 'desktop',
              chromeMediaSourceId: source.id,
              minWidth: 1280,
              maxWidth: 1280,
              minHeight: 720,
              maxHeight: 720
            }
          }
        })
        handleStream(stream)
      } catch (e) {
        handleError(e)
      }
      return
    }
  }
})

function handleStream (stream) {
  const video = document.querySelector('video')
  video.srcObject = stream
  video.onloadedmetadata = (e) =&gt; video.play()
}

function handleError (e) {
  console.log(e)
}
</pre> <p>To capture video from a source provided by <code>desktopCapturer</code> the constraints passed to <a href="https://developer.mozilla.org/en/docs/Web/API/MediaDevices/getUserMedia"><code>navigator.mediaDevices.getUserMedia</code></a> must include <code>chromeMediaSource: 'desktop'</code>, and <code>audio: false</code>.</p> <p>To capture both audio and video from the entire desktop the constraints passed to <a href="https://developer.mozilla.org/en/docs/Web/API/MediaDevices/getUserMedia"><code>navigator.mediaDevices.getUserMedia</code></a> must include <code>chromeMediaSource: 'desktop'</code>, for both <code>audio</code> and <code>video</code>, but should not include a <code>chromeMediaSourceId</code> constraint.</p> <pre data-language="javascript">const constraints = {
  audio: {
    mandatory: {
      chromeMediaSource: 'desktop'
    }
  },
  video: {
    mandatory: {
      chromeMediaSource: 'desktop'
    }
  }
}
</pre> <h2 id="methods">Methods</h2> <p>The <code>desktopCapturer</code> module has the following methods:</p> <h3 id="desktopcapturergetsourcesoptions"><code>desktopCapturer.getSources(options)</code></h3> <ul> <li>
<code>options</code> Object<ul> <li>
<code>types</code> String[] - An array of Strings that lists the types of desktop sources to be captured, available types are <code>screen</code> and <code>window</code>.</li> <li>
<code>thumbnailSize</code> <a href="structures/size">Size</a> (optional) - The size that the media source thumbnail should be scaled to. Default is <code>150</code> x <code>150</code>. Set width or height to 0 when you do not need the thumbnails. This will save the processing time required for capturing the content of each window and screen.</li> <li>
<code>fetchWindowIcons</code> Boolean (optional) - Set to true to enable fetching window icons. The default value is false. When false the appIcon property of the sources return null. Same if a source has the type screen.</li> </ul>
</li> </ul> <p>Returns <code>Promise&lt;DesktopCapturerSource[]&gt;</code> - Resolves with an array of <a href="structures/desktop-capturer-source"><code>DesktopCapturerSource</code></a> objects, each <code>DesktopCapturerSource</code> represents a screen or an individual window that can be captured.</p> <p><strong>Note</strong> Capturing the screen contents requires user consent on macOS 10.15 Catalina or higher, which can detected by <a href="system-preferences#systempreferencesgetmediaaccessstatusmediatype-windows-macos"><code>systemPreferences.getMediaAccessStatus</code></a>.</p> <h2 id="caveats">Caveats</h2> <p><code>navigator.mediaDevices.getUserMedia</code> does not work on macOS for audio capture due to a fundamental limitation whereby apps that want to access the system's audio require a <a href="https://developer.apple.com/library/archive/documentation/Security/Conceptual/System_Integrity_Protection_Guide/KernelExtensions/KernelExtensions.html">signed kernel extension</a>. Chromium, and by extension Electron, does not provide this.</p> <p>It is possible to circumvent this limitation by capturing system audio with another macOS app like Soundflower and passing it through a virtual audio input device. This virtual device can then be queried with <code>navigator.mediaDevices.getUserMedia</code>.</p><div class="_attribution">
  <p class="_attribution-p">
    <a href="https://www.electronjs.org/docs/api/desktop-capturer" class="_attribution-link" target="_blank">https://www.electronjs.org/docs/api/desktop-capturer</a>
  </p>
</div>
