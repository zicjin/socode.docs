   <h1 id="firstHeading" class="firstHeading">consteval specifier <span class="t-mark-rev t-since-cxx20">(since C++20)</span>
</h1>            <ul><li>
<code>consteval</code> - specifies that a function is an <i>immediate function</i>, that is, every call to the function must produce a compile-time constant </li></ul> <h3 id="Explanation">Explanation</h3> <p>The <code>consteval</code> specifier declares a function or function template to be an <i>immediate function</i>, that is, every call to the function must (directly or indirectly) produce a compile time <a href="constant_expression" title="cpp/language/constant expression">constant expression</a>. It may not be applied to destructors, allocation functions, or deallocation functions. A <code>consteval</code> specifier implies <code>inline</code>. The <code>consteval</code> and <code>constexpr</code> specifiers cannot both appear within the same sequence of declaration specifiers. If any declaration of a function or function template contains a <code>consteval</code> specifier, then all declarations of that function or function template must contain that specifier.</p>
<p>An immediate function is a constexpr function, and must satisfy the requirements applicable to <a href="constexpr" title="cpp/language/constexpr">constexpr functions or constexpr constructors</a>, as the case may be.</p>
<p>An invocation of an immediate function whose innermost non-block scope is not a <a href="scope#Function_parameter_scope" title="cpp/language/scope">function parameter scope</a> of an immediate function must produce a constant expression; such an invocation (known as an <i>immediate invocation</i>) is always evaluated, even in an unevaluated operand.</p>
<div class="cpp source-cpp"><pre data-language="cpp">consteval int sqr(int n) {
  return n*n;
}
constexpr int r = sqr(100);  // OK
 
int x = 100;
int r2 = sqr(x);  // Error: Call does not produce a constant
 
consteval int sqrsqr(int n) {
  return sqr(sqr(n)); // Not a constant expression at this point, but OK
}
 
constexpr int dblsqr(int n) {
  return 2*sqr(n); // Error: Enclosing function is not consteval and sqr(n) is not a constant
}</pre></div> <p>An <a href="name#In_expressions" title="cpp/language/identifiers">identifier expression</a> that denotes an immediate function may only appear within a subexpression of an immediate invocation or within an immediate function context. A pointer or reference to an immediate function can be taken but cannot escape constant expression evaluation:</p>
<div class="cpp source-cpp"><pre data-language="cpp">consteval int f() { return 42; }
consteval auto g() { return f; }
consteval int h(int (*p)() = g()) { return p(); }
constexpr int r = h();   // OK
constexpr auto e = g();  // ill-formed: a pointer to an immediate function is
                         // not a permitted result of a constant expression</pre></div> <h3 id="Keywords">Keywords</h3> <p><a href="../keyword/consteval" title="cpp/keyword/consteval"><code>consteval</code></a>.</p>
<h3 id="Example">Example</h3>  <h3 id="See_also">See also</h3> <ul>
<li> <a href="constexpr" title="cpp/language/constexpr"><code>constexpr</code></a> </li>
<li> <a href="constant_expression" title="cpp/language/constant expression">constant expression</a> </li>
</ul>          <div class="_attribution">
  <p class="_attribution-p">
    &copy; cppreference.com<br>Licensed under the Creative Commons Attribution-ShareAlike Unported License v3.0.<br>
    <a href="http://en.cppreference.com/w/cpp/language/consteval" class="_attribution-link">http://en.cppreference.com/w/cpp/language/consteval</a>
  </p>
</div>
