<h1>ImageMinimizerWebpackPlugin</h1>
<div>
<p>Plugin and Loader for <a href="http://webpack.js.org/">webpack</a> to optimize (compress) all images using <a href="https://github.com/imagemin/imagemin">imagemin</a>. Do not worry about size of images, now they are always optimized/compressed.</p>  <h2 id="getting-started">Getting Started
</h2> <p>This plugin can use 2 tools to compress images:</p> <ul> <li>
<a href="https://github.com/imagemin/imagemin"><code>imagemin</code></a> - optimize your images by default, since it is stable and works with all types of images</li> <li>
<a href="https://github.com/GoogleChromeLabs/squoosh/tree/dev/libsquoosh"><code>squoosh</code></a> - while working in experimental mode with <code>.jpg</code>, <code>.jpeg</code>, <code>.png</code>, <code>.webp</code>, <code>.avif</code> file types.</li> </ul> <p>To begin, you'll need to install <code>image-minimizer-webpack-plugin</code>:</p> <pre data-language="console">$ npm install image-minimizer-webpack-plugin --save-dev
</pre> <p>Images can be optimized in two modes:</p> <ol> <li>
<a href="https://en.wikipedia.org/wiki/Lossless_compression">Lossless</a> (without loss of quality).</li> <li>
<a href="https://en.wikipedia.org/wiki/Lossy_compression">Lossy</a> (with loss of quality).</li> </ol> <h3 id="optimize-with-imagemin">Optimize with <a href="https://github.com/imagemin/imagemin">imagemin</a>
</h3> <p>Note:</p> <ul> <li>
<a href="https://github.com/imagemin/imagemin-mozjpeg">imagemin-mozjpeg</a> can be configured in lossless and lossy mode.</li> <li>
<a href="https://github.com/imagemin/imagemin-svgo">imagemin-svgo</a> can be configured in lossless and lossy mode.</li> </ul> <p>Explore the options to get the best result for you.</p> <p><strong>Recommended imagemin plugins for lossless optimization</strong></p> <pre data-language="shell">npm install imagemin-gifsicle imagemin-jpegtran imagemin-optipng imagemin-svgo --save-dev</pre> <p><strong>Recommended imagemin plugins for lossy optimization</strong></p> <pre data-language="shell">npm install imagemin-gifsicle imagemin-mozjpeg imagemin-pngquant imagemin-svgo --save-dev</pre> <p>For <code>imagemin-svgo</code> v9.0.0+ need use svgo <a href="https://github.com/svg/svgo#configuration">configuration</a></p> <p><strong>webpack.config.js</strong></p> <pre data-language="js">const ImageMinimizerPlugin = require("image-minimizer-webpack-plugin");
const { extendDefaultPlugins } = require("svgo");

module.exports = {
  module: {
    rules: [
      {
        test: /\.(jpe?g|png|gif|svg)$/i,
        type: "asset",
      },
    ],
  },
  plugins: [
    new ImageMinimizerPlugin({
      minimizerOptions: {
        // Lossless optimization with custom option
        // Feel free to experiment with options for better result for you
        plugins: [
          ["gifsicle", { interlaced: true }],
          ["jpegtran", { progressive: true }],
          ["optipng", { optimizationLevel: 5 }],
          // Svgo configuration here https://github.com/svg/svgo#configuration
          [
            "svgo",
            {
              plugins: extendDefaultPlugins([
                {
                  name: "removeViewBox",
                  active: false,
                },
                {
                  name: "addAttributesToSVGElement",
                  params: {
                    attributes: [{ xmlns: "http://www.w3.org/2000/svg" }],
                  },
                },
              ]),
            },
          ],
        ],
      },
    }),
  ],
};</pre> <h3 id="optimize-with-squoosh">Optimize with <a href="https://github.com/GoogleChromeLabs/squoosh/tree/dev/libsquoosh"><code>squoosh</code></a>
</h3> <pre data-language="console">$ npm install @squoosh/lib --save-dev
</pre> <p><strong>Recommended <code>@squoosh/lib</code> options for lossy optimization</strong></p> <p>For lossy optimization we recommend using the default settings <code>@squoosh/lib</code>. The default values and supported file types for each option can be found in the <code>[codecs.ts]</code>(<a href="https://github.com/GoogleChromeLabs/squoosh/blob/dev/libsquoosh/src/codecs.ts">https://github.com/GoogleChromeLabs/squoosh/blob/dev/libsquoosh/src/codecs.ts</a>) file under <code>codecs</code>.</p> <p><strong>webpack.config.js</strong></p> <pre data-language="js">const ImageMinimizerPlugin = require("image-minimizer-webpack-plugin");

module.exports = {
  module: {
    rules: [
      {
        test: /\.(jpe?g|png)$/i,
        type: "asset",
      },
    ],
  },
  plugins: [
    new ImageMinimizerPlugin({
      minify: ImageMinimizerPlugin.squooshMinify,
    }),
  ],
};</pre> <p><strong>Recommended <code>squoosh</code> options for lossless optimization</strong></p> <p>For lossless optimization we recommend using the options listed below in <code>minimizerOptions.encodeOptions</code>.</p> <p><strong>webpack.config.js</strong></p> <pre data-language="js">const ImageMinimizerPlugin = require("image-minimizer-webpack-plugin");

module.exports = {
  module: {
    rules: [
      {
        test: /\.(jpe?g|png)$/i,
        type: "asset",
      },
    ],
  },
  plugins: [
    new ImageMinimizerPlugin({
      minify: ImageMinimizerPlugin.squooshMinify,
      minimizerOptions: {
        encodeOptions: {
          mozjpeg: {
            // That setting might be close to lossless, but it’s not guaranteed
            // https://github.com/GoogleChromeLabs/squoosh/issues/85
            quality: 100,
          },
          webp: {
            lossless: 1,
          },
          avif: {
            // https://github.com/GoogleChromeLabs/squoosh/blob/dev/codecs/avif/enc/README.md
            cqLevel: 0,
          },
        },
      },
    }),
  ],
};</pre> <blockquote> <p>ℹ️ If you want to use <code>loader</code> or <code>plugin</code> standalone see sections below, but this is not recommended.</p> </blockquote> <h3 id="standalone-loader">Standalone Loader
</h3> <p><a href="../concepts/loaders">Documentation: Using loaders</a></p> <p>In your <code>webpack.config.js</code>, add the <code>ImageMinimizerPlugin.loader</code> and specify the <a href="../guides/asset-modules">asset modules options</a>:</p> <p><strong>webpack.config.js</strong></p> <pre data-language="js">const ImageMinimizerPlugin = require("image-minimizer-webpack-plugin");

module.exports = {
  module: {
    rules: [
      {
        test: /\.(jpe?g|png|gif|svg)$/i,
        type: "asset",
      },
      {
        test: /\.(jpe?g|png|gif|svg)$/i,
        use: [
          {
            loader: ImageMinimizerPlugin.loader,
            options: {
              severityError: "warning", // Ignore errors on corrupted images
              minimizerOptions: {
                plugins: ["gifsicle"],
              },
            },
          },
        ],
      },
    ],
  },
};</pre> <h3 id="standalone-plugin">Standalone Plugin
</h3> <p><a href="../concepts/plugins">Documentation: Using plugins</a></p> <p><strong>webpack.config.js</strong></p> <pre data-language="js">const ImageMinimizerPlugin = require("image-minimizer-webpack-plugin");

module.exports = {
  module: {
    rules: [
      {
        test: /\.(jpe?g|png|gif|svg)$/i,
        type: "asset",
      },
    ],
  },
  plugins: [
    // Make sure that the plugin placed after any plugins that added images
    new ImageMinimizerPlugin({
      severityError: "warning", // Ignore errors on corrupted images
      minimizerOptions: {
        plugins: ["gifsicle"],
      },
      // Disable `loader`
      loader: false,
    }),
  ],
};</pre> <h2 id="options">Options
</h2> <h3 id="plugin-options">Plugin Options
</h3> <table> <thead> <tr> <th align="center">Name</th> <th align="center">Type</th> <th align="center">Default</th> <th align="left">Description</th> </tr> </thead> <tbody> <tr> <td align="center" data-th="Name"><span><strong><code>test</code></strong></span></td> <td align="center" data-th="Type"><span><code>{String\/RegExp|Array&lt;String|RegExp&gt;}</code></span></td> <td align="center" data-th="Default"><span><code>/.(jpe?g|png|gif|tif|webp|svg|avif)$/i</code></span></td> <td align="left" data-th="Description"><span>Test to match files against</span></td> </tr> <tr> <td align="center" data-th="Name"><span><strong><code>include</code></strong></span></td> <td align="center" data-th="Type"><span><code>{String\/RegExp|Array&lt;String|RegExp&gt;}</code></span></td> <td align="center" data-th="Default"><span><code>undefined</code></span></td> <td align="left" data-th="Description"><span>Files to <code>include</code></span></td> </tr> <tr> <td align="center" data-th="Name"><span><strong><code>exclude</code></strong></span></td> <td align="center" data-th="Type"><span><code>{String\/RegExp|Array&lt;String|RegExp&gt;}</code></span></td> <td align="center" data-th="Default"><span><code>undefined</code></span></td> <td align="left" data-th="Description"><span>Files to <code>exclude</code></span></td> </tr> <tr> <td align="center" data-th="Name"><span><strong><code>filter</code></strong></span></td> <td align="center" data-th="Type"><span><code>{Function}</code></span></td> <td align="center" data-th="Default"><span><code>() =&gt; true</code></span></td> <td align="left" data-th="Description"><span>Allows filtering of images for optimization</span></td> </tr> <tr> <td align="center" data-th="Name"><span><strong><code>severityError</code></strong></span></td> <td align="center" data-th="Type"><span><code>{String}</code></span></td> <td align="center" data-th="Default"><span><code>'error'</code></span></td> <td align="left" data-th="Description"><span>Allows to choose how errors are displayed</span></td> </tr> <tr> <td align="center" data-th="Name"><span><strong><code>minify</code></strong></span></td> <td align="center" data-th="Type"><span><code>{Function | Array&lt;Function&gt;}</code></span></td> <td align="center" data-th="Default"><span><code>ImageMinimizerPlugin.imageminMinify</code></span></td> <td align="left" data-th="Description"><span>Allows to override default minify function</span></td> </tr> <tr> <td align="center" data-th="Name"><span><strong><code>minimizerOptions</code></strong></span></td> <td align="center" data-th="Type"><span><code>{Object|Array&lt;Object&gt;}</code></span></td> <td align="center" data-th="Default"><span><code>{ plugins: [] }</code></span></td> <td align="left" data-th="Description"><span>Options for <code>imagemin</code></span></td> </tr> <tr> <td align="center" data-th="Name"><span><strong><code>loader</code></strong></span></td> <td align="center" data-th="Type"><span><code>{Boolean}</code></span></td> <td align="center" data-th="Default"><span><code>true</code></span></td> <td align="left" data-th="Description"><span>Automatically adding <code>imagemin-loader</code></span></td> </tr> <tr> <td align="center" data-th="Name"><span><strong><code>maxConcurrency</code></strong></span></td> <td align="center" data-th="Type"><span><code>{Number}</code></span></td> <td align="center" data-th="Default"><span><code>Math.max(1, os.cpus().length - 1)</code></span></td> <td align="left" data-th="Description"><span>Maximum number of concurrency optimization processes in one time</span></td> </tr> <tr> <td align="center" data-th="Name"><span><strong><code>filename</code></strong></span></td> <td align="center" data-th="Type"><span><code>{string|Function}</code></span></td> <td align="center" data-th="Default"><span><code>'[path][name][ext]'</code></span></td> <td align="left" data-th="Description"><span>Allows to set the filename for the generated asset. Useful for converting to a <code>webp</code></span></td> </tr> <tr> <td align="center" data-th="Name"><span><strong><code>deleteOriginalAssets</code></strong></span></td> <td align="center" data-th="Type"><span><code>{Boolean}</code></span></td> <td align="center" data-th="Default"><span><code>false</code></span></td> <td align="left" data-th="Description"><span>Allows to delete the original asset. Useful for converting to a <code>webp</code> and remove original assets</span></td> </tr> </tbody> </table> <h4 id="test">
<code>test</code>
</h4> <p>Type: <code>String|RegExp|Array&lt;String|RegExp&gt;</code> Default: <code>/\.(jpe?g\|png\|gif\|tif\|webp\|svg\|avif)\$/i</code></p> <p>Test to match files against.</p> <p><strong>webpack.config.js</strong></p> <pre data-language="js">const ImageMinimizerPlugin = require("image-minimizer-webpack-plugin");

module.exports = {
  plugins: [
    new ImageMinimizerPlugin({
      test: /\.(jpe?g|png|gif|svg)$/i,
    }),
  ],
};</pre> <h4 id="include">
<code>include</code>
</h4> <p>Type: <code>String|RegExp|Array&lt;String|RegExp&gt;</code> Default: <code>undefined</code></p> <p>Files to include.</p> <p><strong>webpack.config.js</strong></p> <pre data-language="js">const ImageMinimizerPlugin = require("image-minimizer-webpack-plugin");

module.exports = {
  plugins: [
    new ImageMinimizerPlugin({
      include: /\/includes/,
    }),
  ],
};</pre> <h4 id="exclude">
<code>exclude</code>
</h4> <p>Type: <code>String|RegExp|Array&lt;String|RegExp&gt;</code> Default: <code>undefined</code></p> <p>Files to exclude.</p> <p><strong>webpack.config.js</strong></p> <pre data-language="js">const ImageMinimizerPlugin = require("image-minimizer-webpack-plugin");

module.exports = {
  plugins: [
    new ImageMinimizerPlugin({
      exclude: /\/excludes/,
    }),
  ],
};</pre> <h4 id="filter">
<code>filter</code>
</h4> <p>Type: <code>Function</code> Default: <code>() =&gt; true</code></p> <p>Allows filtering of images for optimization.</p> <p>Return <code>true</code> to optimize the image, <code>false</code> otherwise.</p> <p><strong>webpack.config.js</strong></p> <pre data-language="js">const ImageMinimizerPlugin = require("image-minimizer-webpack-plugin");

module.exports = {
  plugins: [
    new ImageMinimizerPlugin({
      filter: (source, sourcePath) =&gt; {
        // The `source` argument is a `Buffer` of source file
        // The `sourcePath` argument is an absolute path to source
        if (source.byteLength &lt; 8192) {
          return false;
        }

        return true;
      },
    }),
  ],
};</pre> <h4 id="severityerror">
<code>severityError</code>
</h4> <p>Type: <code>String</code> Default: <code>'error'</code></p> <p>Allows to choose how errors are displayed.</p> <p>Сan have the following values:</p> <ul> <li>
<code>'off'</code> - suppresses errors and warnings</li> <li>
<code>'warning'</code> - emit warnings instead errors</li> <li>
<code>'error'</code> - emit errors</li> </ul> <p><strong>webpack.config.js</strong></p> <pre data-language="js">const ImageMinimizerPlugin = require("image-minimizer-webpack-plugin");

module.exports = {
  plugins: [
    new ImageMinimizerPlugin({
      severityError: "warning",
    }),
  ],
};</pre> <h4 id="minify">
<code>minify</code>
</h4> <p>Type: <code>Function|Array&lt;Function&gt;</code> Default: <code>ImageMinimizerPlugin.imageminMinify</code></p> <p>Allows to override default minify function. By default plugin uses <a href="https://github.com/imagemin/imagemin">imagemin</a> package. Useful for using and testing unpublished versions or forks.</p> <p>Аvailable minifiers:</p> <ul> <li>ImageMinimizerPlugin.imageminMinify</li> <li>ImageMinimizerPlugin.squooshMinify</li> </ul> <h5 id="function">
<code>Function</code>
</h5> <p><strong>webpack.config.js</strong></p> <pre data-language="js">const ImageMinimizerPlugin = require("image-minimizer-webpack-plugin");

module.exports = {
  plugins: [
    new ImageMinimizerPlugin({
      minify: async (data, minimizerOptions) =&gt; {
        const [[, input]] = Object.entries(data);

        let result;

        try {
          result = await minifyAndReturnBuffer(input);
        } catch (error) {
          // Return original input if there was an error
          return { data: input, errors: [error] };
        }

        return { data: result, warnings: [], errors: [] };
      },
      minimizerOptions: {},
    }),
  ],
};</pre> <h5 id="array">
<code>Array</code>
</h5> <p>If an array of functions is passed to the <code>minify</code> option, the <code>minimizerOptions</code> can be an array or an object. If <code>minimizerOptions</code> is array, the function index in the <code>minify</code> array corresponds to the options object with the same index in the <code>minimizerOptions</code> array. If you use <code>minimizerOptions</code> like object, all <code>minify</code> function accept it.</p> <p><strong>webpack.config.js</strong></p> <pre data-language="js">const ImageMinimizerPlugin = require("image-minimizer-webpack-plugin");

module.exports = {
  plugins: [
    new ImageMinimizerPlugin({
      minify: [
        ImageMinimizerPlugin.imageminMinify,
        (data, minimizerOptions) =&gt; {
          const [[, input]] = Object.entries(data);

          let result;

          try {
            result = minifyAndReturnBuffer(input);
          } catch (error) {
            // Return original input if there was an error
            return { data: input, errors: [error] };
          }

          return { data: result, warnings: [], errors: [] };
        },
      ],
      minimizerOptions: [
        // Options for the first function (ImageMinimizerPlugin.imageminMinify)
        {
          plugins: ["gifsicle", "mozjpeg", "pngquant", "svgo"],
        },
        // Options for the second function
        {},
      ],
    }),
  ],
};</pre> <h4 id="minimizeroptions">
<code>minimizerOptions</code>
</h4> <p>Type: <code>Object|Array&lt;Object&gt;</code> Default: <code>{ plugins: [] }</code></p> <p>Options for <code>minify</code> functions. <a href="https://github.com/imagemin/imagemin"><code>imagemin</code></a> is default minify function.</p> <p>More information and examples <a href="https://github.com/imagemin/imagemin">here</a>.</p> <h5 id="object">
<code>Object</code>
</h5> <p><strong>webpack.config.js</strong></p> <pre data-language="js">const ImageMinimizerPlugin = require("image-minimizer-webpack-plugin");

module.exports = {
  plugins: [
    new ImageMinimizerPlugin({
      minimizerOptions: {
        plugins: [
          // Name
          "gifsicle",
          // Name with options
          ["mozjpeg", { quality: 80 }],
          // Full package name
          [
            "imagemin-svgo",
            {
              plugins: [
                {
                  removeViewBox: false,
                },
              ],
            },
          ],
          [
            // Custom package name
            "nonstandard-imagemin-package-name",
            { myOptions: true },
          ],
        ],
      },
    }),
  ],
};</pre> <h5 id="array-1">
<code>Array</code>
</h5> <p>The function index in the <code>minify</code> array corresponds to the options object with the same index in the <code>minimizerOptions</code> array. If you use <code>minimizerOptions</code> like object, all <code>minify</code> function accept it.</p> <p><strong>webpack.config.js</strong></p> <pre data-language="js">const ImageMinimizerPlugin = require("image-minimizer-webpack-plugin");

module.exports = {
  plugins: [
    new ImageMinimizerPlugin({
      minify: [
        ImageMinimizerPlugin.imageminMinify,
        async (data, minimizerOptions) =&gt; {
          const [[, input]] = Object.entries(data);

          let result;

          try {
            result = await minifyAndReturnBuffer(input);
          } catch (error) {
            // Return original input if there was an error
            return { data: input, errors: [error] };
          }

          return { data: result, warnings: [], errors: [] };
        },
      ],
      minimizerOptions: [
        // Options for the first function (ImageMinimizerPlugin.imageminMinify)
        {
          plugins: ["gifsicle", "mozjpeg", "pngquant", "svgo"],
        },
        // Options for the second function
        {},
      ],
    }),
  ],
};</pre> <h4 id="loader">
<code>loader</code>
</h4> <p>Type: <code>Boolean</code> Default: <code>true</code></p> <p>Automatically adding <code>imagemin-loader</code>.</p> <p><strong>webpack.config.js</strong></p> <pre data-language="js">const ImageMinimizerPlugin = require("image-minimizer-webpack-plugin");

module.exports = {
  plugins: [
    new ImageMinimizerPlugin({
      loader: false,
    }),
  ],
};</pre> <h4 id="maxconcurrency">
<code>maxConcurrency</code>
</h4> <p>Type: <code>Number</code> Default: <code>Math.max(1, os.cpus().length - 1)</code></p> <p>Maximum number of concurrency optimization processes in one time.</p> <p><strong>webpack.config.js</strong></p> <pre data-language="js">const ImageMinimizerPlugin = require("image-minimizer-webpack-plugin");

module.exports = {
  plugins: [
    new ImageMinimizerPlugin({
      maxConcurrency: 3,
    }),
  ],
};</pre> <h4 id="filename">
<code>filename</code>
</h4> <p>Type: <code>String|Function</code> Default: <code>'[path][name][ext]'</code></p> <p>Allows to set the filename for the generated asset. Useful for converting to a <code>webp</code>. Supported values see in <a href="../configuration/output#template-strings"><code>webpack template strings</code></a>, <code>File-level</code> section.</p> <h5 id="string">
<code>String</code>
</h5> <p><strong>webpack.config.js</strong></p> <pre data-language="js">const ImageMinimizerPlugin = require("image-minimizer-webpack-plugin");

module.exports = {
  plugins: [
    // Images are converted to `webp` and the original assets have been kept
    new ImageMinimizerPlugin({
      test: /\.(png)$/i,
      filename: "[path][name].webp",
      minimizerOptions: {
        plugins: ["imagemin-webp"],
      },
    }),
  ],
};</pre> <h5 id="function-1">
<code>Function</code>
</h5> <p><strong>webpack.config.js</strong></p> <pre data-language="js">const ImageMinimizerPlugin = require("image-minimizer-webpack-plugin");

module.exports = {
  plugins: [
    // Images are converted to `webp` and the original assets have been kept
    new ImageMinimizerPlugin({
      test: /\.(png)$/i,
      filename: (pathData, assetInfo) =&gt; {
        if (/imageLg/i.test(pathData.filename)) {
          return "./bigImages/[path][name].webp";
        }

        return "[path][name].webp";
      },
      minimizerOptions: {
        plugins: ["imagemin-webp"],
      },
    }),
  ],
};</pre> <h5 id="converting-to-webp-using-imageminimizerpluginsquooshminify">Converting to <code>webp</code> using <code>ImageMinimizerPlugin.squooshMinify</code>
</h5> <p><strong>webpack.config.js</strong></p> <pre data-language="js">const ImageMinimizerPlugin = require("image-minimizer-webpack-plugin");
/*
const defaultTargets = {
  ".png": "oxipng",
  ".jpg": "mozjpeg",
  ".jpeg": "mozjpeg",
  ".jxl": "jxl",
  ".webp": "webp",
  ".avif": "avif",
};
*/

module.exports = {
  plugins: [
    // Images are converted to `webp` and the original assets have been kept
    new ImageMinimizerPlugin({
      test: /\.(png)$/i,
      filename: "[path][name].webp",
      minify: ImageMinimizerPlugin.squooshMinify,
      minimizerOptions: {
        targets: {
          ".png": "webp",
        },
      },
    }),
  ],
};</pre> <h4 id="deleteoriginalassets">
<code>deleteOriginalAssets</code>
</h4> <p>Type: <code>Boolean</code> Default: <code>false</code></p> <p>Allows to remove original assets. Useful for converting to a <code>webp</code> and remove original assets</p> <blockquote> <p>i Doesn't make sense if you haven't changed the original value of the <code>filename</code> option</p> </blockquote> <p><strong>webpack.config.js</strong></p> <pre data-language="js">const ImageMinimizerPlugin = require("image-minimizer-webpack-plugin");

module.exports = {
  plugins: [
    // Images are converted to `webp` and the original assets have been removed
    new ImageMinimizerPlugin({
      test: /\.(png)$/i,
      deleteOriginalAssets: true,
      filename: "[path][name].webp",
      minimizerOptions: {
        plugins: ["imagemin-webp"],
      },
    }),
  ],
};</pre> <p>To generate and compress the original assets:</p> <pre data-language="js">const ImageMinimizerPlugin = require("image-minimizer-webpack-plugin");

module.exports = {
  plugins: [
    // And the original assets will be compressed
    new ImageMinimizerPlugin({
      test: /\.(png)$/i,
      minimizerOptions: {
        plugins: ["pngquant"],
      },
    }),
    // Images are converted to `webp` and the original assets have been removed
    new ImageMinimizerPlugin({
      test: /\.(png)$/i,
      deleteOriginalAssets: false,
      filename: "[path][name].webp",
      minimizerOptions: {
        plugins: ["imagemin-webp"],
      },
    }),
  ],
};</pre> <h3 id="loader-options">Loader Options
</h3> <table> <thead> <tr> <th align="center">Name</th> <th align="center">Type</th> <th align="center">Default</th> <th align="left">Description</th> </tr> </thead> <tbody> <tr> <td align="center" data-th="Name"><span><strong><code>filter</code></strong></span></td> <td align="center" data-th="Type"><span><code>{Function}</code></span></td> <td align="center" data-th="Default"><span><code>undefined</code></span></td> <td align="left" data-th="Description"><span>Allows filtering of images for optimization</span></td> </tr> <tr> <td align="center" data-th="Name"><span><strong><code>severityError</code></strong></span></td> <td align="center" data-th="Type"><span><code>{String}</code></span></td> <td align="center" data-th="Default"><span><code>'error'</code></span></td> <td align="left" data-th="Description"><span>Allows to choose how errors are displayed</span></td> </tr> <tr> <td align="center" data-th="Name"><span><strong><code>minify</code></strong></span></td> <td align="center" data-th="Type"><span><code>{Function | Array&lt;Function&gt;}</code></span></td> <td align="center" data-th="Default"><span><code>ImageMinimizerPlugin.imageminMinify</code></span></td> <td align="left" data-th="Description"><span>Allows to override default minify function</span></td> </tr> <tr> <td align="center" data-th="Name"><span><strong><code>minimizerOptions</code></strong></span></td> <td align="center" data-th="Type"><span><code>{Object|Array&lt;Object&gt;}</code></span></td> <td align="center" data-th="Default"><span><code>{ plugins: [] }</code></span></td> <td align="left" data-th="Description"><span>Options for <code>imagemin</code></span></td> </tr> <tr> <td align="center" data-th="Name"><span><strong><code>filename</code></strong></span></td> <td align="center" data-th="Type"><span><code>{string|Function}</code></span></td> <td align="center" data-th="Default"><span><code>'[path][name][ext]'</code></span></td> <td align="left" data-th="Description"><span>Allows to set the filename for the generated asset. Useful for converting to a <code>webp</code></span></td> </tr> <tr> <td align="center" data-th="Name"><span><strong><code>deleteOriginalAssets</code></strong></span></td> <td align="center" data-th="Type"><span><code>{Boolean}</code></span></td> <td align="center" data-th="Default"><span><code>false</code></span></td> <td align="left" data-th="Description"><span>Allows to delete the original asset. Useful for converting to a <code>webp</code> and remove original assets</span></td> </tr> </tbody> </table> <h4 id="filter-1">
<code>filter</code>
</h4> <p>Type: <code>Function</code> Default: <code>() =&gt; true</code></p> <p>Allows filtering of images for optimization.</p> <p>Return <code>true</code> to optimize the image, <code>false</code> otherwise.</p> <p><strong>webpack.config.js</strong></p> <pre data-language="js">const ImageMinimizerPlugin = require("image-minimizer-webpack-plugin");

module.exports = {
  module: {
    rules: [
      {
        test: /\.(jpe?g|png|gif|svg)$/i,
        type: "asset",
      },
      {
        test: /\.(jpe?g|png|gif|svg)$/i,
        use: [
          {
            loader: ImageMinimizerPlugin.loader,
            options: {
              cache: true,
              filter: (source, sourcePath) =&gt; {
                // The `source` argument is a `Buffer` of source file
                // The `sourcePath` argument is an absolute path to source
                if (source.byteLength &lt; 8192) {
                  return false;
                }

                return true;
              },
              minimizerOptions: {
                plugins: ["gifsicle"],
              },
            },
          },
        ],
      },
    ],
  },
};</pre> <h4 id="severityerror-1">
<code>severityError</code>
</h4> <p>Type: <code>String</code> Default: <code>'error'</code></p> <p>Allows to choose how errors are displayed.</p> <p>Сan have the following values:</p> <ul> <li>
<code>'off'</code> - suppresses errors and warnings</li> <li>
<code>'warning'</code> - emit warnings instead errors</li> <li>
<code>'error'</code> - emit errors</li> </ul> <p><strong>webpack.config.js</strong></p> <pre data-language="js">const ImageMinimizerPlugin = require("image-minimizer-webpack-plugin");

module.exports = {
  module: {
    rules: [
      {
        test: /\.(jpe?g|png|gif|svg)$/i,
        type: "asset",
      },
      {
        test: /\.(jpe?g|png|gif|svg)$/i,
        use: [
          {
            loader: ImageMinimizerPlugin.loader,
            options: {
              severityError: "warning",
              minimizerOptions: {
                plugins: ["gifsicle"],
              },
            },
          },
        ],
      },
    ],
  },
};</pre> <h4 id="minify-1">
<code>minify</code>
</h4> <p>Type: <code>Function|Array&lt;Function&gt;</code> Default: <code>ImageMinimizerPlugin.imageminMinify</code></p> <p>Allows to override default minify function. By default plugin uses <a href="https://github.com/imagemin/imagemin">imagemin</a> package. Useful for using and testing unpublished versions or forks.</p> <p>Аvailable minifiers:</p> <ul> <li>ImageMinimizerPlugin.imageminMinify</li> <li>ImageMinimizerPlugin.squooshMinify</li> </ul> <h5 id="function-2">
<code>Function</code>
</h5> <p><strong>webpack.config.js</strong></p> <pre data-language="js">const ImageMinimizerPlugin = require("image-minimizer-webpack-plugin");

module.exports = {
  module: {
    rules: [
      {
        test: /\.(jpe?g|png|gif|svg)$/i,
        type: "asset",
      },
      {
        test: /\.(jpe?g|png|gif|svg)$/i,
        use: [
          {
            loader: ImageMinimizerPlugin.loader,
            options: {
              minify: async (data, minimizerOptions) =&gt; {
                const [[, input]] = Object.entries(data);

                let result;

                try {
                  result = await minifyAndReturnBuffer(input);
                } catch (error) {
                  // Return original input if there was an error
                  return { data: input, errors: [error] };
                }

                return { data: result, warnings: [], errors: [] };
              },
              minimizerOptions: {},
            },
          },
        ],
      },
    ],
  },
};</pre> <h5 id="array-2">
<code>Array</code>
</h5> <p>If an array of functions is passed to the <code>minify</code> option, the <code>minimizerOptions</code> can be an array or an object. If <code>minimizerOptions</code> is array, the function index in the <code>minify</code> array corresponds to the options object with the same index in the <code>minimizerOptions</code> array. If you use <code>minimizerOptions</code> like object, all <code>minify</code> function accept it.</p> <p><strong>webpack.config.js</strong></p> <pre data-language="js">const ImageMinimizerPlugin = require("image-minimizer-webpack-plugin");

module.exports = {
  module: {
    rules: [
      {
        test: /\.(jpe?g|png|gif|svg)$/i,
        type: "asset",
      },
      {
        test: /\.(jpe?g|png|gif|svg)$/i,
        use: [
          {
            loader: ImageMinimizerPlugin.loader,
            options: {
              minify: [
                ImageMinimizerPlugin.imageminMinify,
                async (data, minimizerOptions) =&gt; {
                  const [[, input]] = Object.entries(data);

                  let result;

                  try {
                    result = await minifyAndReturnBuffer(input);
                  } catch (error) {
                    // Return original input if there was an error
                    return { data: input, errors: [error] };
                  }

                  return { data: result, warnings: [], errors: [] };
                },
              ],
              minimizerOptions: [
                // Options for the first function (ImageMinimizerPlugin.imageminMinify)
                {
                  plugins: ["gifsicle", "mozjpeg", "pngquant", "svgo"],
                },
                // Options for the second function
                {},
              ],
            },
          },
        ],
      },
    ],
  },
};</pre> <h4 id="minimizeroptions-1">
<code>minimizerOptions</code>
</h4> <p>Type: <code>Object|Array&lt;Object&gt;</code> Default: <code>{ plugins: [] }</code></p> <p>Options for <code>minify</code> functions. <a href="https://github.com/imagemin/imagemin"><code>imagemin</code></a> is default minify function.</p> <p>More information and examples <a href="https://github.com/imagemin/imagemin">here</a>.</p> <h5 id="object-1">
<code>Object</code>
</h5> <p><strong>webpack.config.js</strong></p> <pre data-language="js">const ImageMinimizerPlugin = require("image-minimizer-webpack-plugin");

module.exports = {
  module: {
    rules: [
      {
        test: /\.(jpe?g|png|gif|svg)$/i,
        type: "asset",
      },
      {
        test: /\.(jpe?g|png|gif|svg)$/i,
        use: [
          {
            loader: ImageMinimizerPlugin.loader,
            options: {
              minimizerOptions: {
                plugins: [
                  ["gifsicle", { interlaced: true, optimizationLevel: 3 }],
                ],
              },
            },
          },
        ],
      },
    ],
  },
};</pre> <h5 id="array-3">
<code>Array</code>
</h5> <p>The function index in the <code>minify</code> array corresponds to the options object with the same index in the <code>minimizerOptions</code> array. If you use <code>minimizerOptions</code> like object, all <code>minify</code> function accept it.</p> <p><strong>webpack.config.js</strong></p> <pre data-language="js">const ImageMinimizerPlugin = require("image-minimizer-webpack-plugin");

module.exports = {
  module: {
    rules: [
      {
        test: /\.(jpe?g|png|gif|svg)$/i,
        type: "asset",
      },
      {
        test: /\.(jpe?g|png|gif|svg)$/i,
        use: [
          {
            loader: ImageMinimizerPlugin.loader,
            options: {
              minify: [
                ImageMinimizerPlugin.imageminMinify,
                async (data, minimizerOptions) =&gt; {
                  const [[, input]] = Object.entries(data);

                  let result;

                  try {
                    result = await minifyAndReturnBuffer(input);
                  } catch (error) {
                    // Return original input if there was an error
                    return { data: input, errors: [error] };
                  }

                  return { data: result, warnings: [], errors: [] };
                },
              ],
              minimizerOptions: [
                // Options for the first function (ImageMinimizerPlugin.imageminMinify)
                {
                  plugins: [
                    ["gifsicle", { interlaced: true, optimizationLevel: 3 }],
                  ],
                },
                // Options for the second function
                {},
              ],
            },
          },
        ],
      },
    ],
  },
};</pre> <h4 id="filename-1">
<code>filename</code>
</h4> <p>Type: <code>String|Function</code> Default: <code>'[path][name][ext]'</code></p> <p>Allows to set the filename for the generated asset. Useful for converting to a <code>webp</code>. Supported values see in <a href="../configuration/output#template-strings"><code>webpack template strings</code></a>, <code>File-level</code> section.</p> <h5 id="string-1">
<code>String</code>
</h5> <p><strong>webpack.config.js</strong></p> <pre data-language="js">const ImageMinimizerPlugin = require("image-minimizer-webpack-plugin");

module.exports = {
  module: {
    rules: [
      {
        test: /\.(jpe?g|png|gif)$/i,
        use: [
          {
            test: /\.(jpe?g|png|gif|svg)$/i,
            type: "asset",
          },
          {
            loader: ImageMinimizerPlugin.loader,
            options: {
              filename: "[path][name].webp",
              minimizerOptions: {
                plugins: ["imagemin-webp"],
              },
            },
          },
        ],
      },
    ],
  },
};</pre> <h5 id="function-3">
<code>Function</code>
</h5> <p><strong>webpack.config.js</strong></p> <pre data-language="js">const ImageMinimizerPlugin = require("image-minimizer-webpack-plugin");

module.exports = {
  module: {
    rules: [
      {
        test: /\.(jpe?g|png|gif)$/i,
        use: [
          {
            test: /\.(jpe?g|png|gif|svg)$/i,
            type: "asset",
          },
          {
            loader: ImageMinimizerPlugin.loader,
            options: {
              filename: (pathData, assetInfo) =&gt; {
                if (/imageLg/i.test(pathData.filename)) {
                  return "./bigImages/[path][name].webp";
                }

                return "[path][name].webp";
              },
              minimizerOptions: {
                plugins: ["imagemin-webp"],
              },
            },
          },
        ],
      },
    ],
  },
};</pre> <h4 id="deleteoriginalassets-1">
<code>deleteOriginalAssets</code>
</h4> <p>Type: <code>Boolean</code> Default: <code>false</code></p> <p>Allows to keep the original asset. Useful for converting to a <code>webp</code> and remove original assets.</p> <blockquote> <p>i Doesn't make sense if you haven't changed the original value of the <code>filename</code> option</p> </blockquote> <p><strong>webpack.config.js</strong></p> <pre data-language="js">const ImageMinimizerPlugin = require("image-minimizer-webpack-plugin");

module.exports = {
  module: {
    rules: [
      {
        test: /\.(png)$/i,
        use: [
          {
            test: /\.(jpe?g|png|gif|svg)$/i,
            type: "asset",
          },
          {
            loader: ImageMinimizerPlugin.loader,
            options: {
              // PNG images are converted to WEBP, and the originals will keep
              deleteOriginalAssets: false,
              filename: "[path][name].webp",
              minimizerOptions: {
                plugins: ["imagemin-webp"],
              },
            },
          },
        ],
      },
    ],
  },
};</pre> <h2 id="additional-api">Additional API
</h2> <h3 id="normalizeimageminconfigconfig">
<code>normalizeImageminConfig(config)</code>
</h3> <p>The function normalizes configuration (converts plugins names and options to <code>Function</code>s) for using in <code>imagemin</code> package directly.</p> <pre data-language="js">const imagemin = require("imagemin");
const { normalizeImageminConfig } = require("image-minimizer-webpack-plugin");
const imageminConfig = normalizeImageminConfig({
  plugins: [
    "jpegtran",
    [
      "pngquant",
      {
        quality: [0.6, 0.8],
      },
    ],
  ],
});

/*
  console.log(imageminConfig);
  =&gt;
  {
    plugins: [Function, Function],
    pluginsMeta: [
      { name: "imagemin-jpegtran", version: "x.x.x", options: {} },
      { name: "imagemin-pngquant", version: "x.x.x", options: { quality: [0.6, 0.8] }
    ]
  }
*/

(async () =&gt; {
  const files = await imagemin(["images/*.{jpg,png}"], {
    destination: "build/images",
    plugins: imageminConfig.plugins,
  });

  console.log(files);
  // =&gt; [{data: &lt;Buffer 89 50 4e …&gt;, path: 'build/images/foo.jpg'}, …]
})();</pre> <h2 id="examples">Examples
</h2> <h3 id="optimize-images-based-on-size">Optimize images based on size
</h3> <p>You can use difference options (like <code>progressive</code>/<code>interlaced</code> and etc) based on image size (example - don't do progressive transformation for small images).</p> <p>What is <code>progressive</code> image? <a href="https://jmperezperez.com/medium-image-progressive-loading-placeholder/"><code>Answer here</code></a>.</p> <p><strong>webpack.config.js</strong></p> <pre data-language="js">const ImageMinimizerPlugin = require("image-minimizer-webpack-plugin");

module.exports = {
  minimizer: [
    new ImageMinimizerPlugin({
      // Only apply this one to files equal to or over 8192 bytes
      filter: (source) =&gt; {
        if (source.byteLength &gt;= 8192) {
          return true;
        }

        return false;
      },
      minimizerOptions: {
        plugins: [["jpegtran", { progressive: true }]],
      },
    }),
    new ImageMinimizerPlugin({
      // Only apply this one to files under 8192
      filter: (source) =&gt; {
        if (source.byteLength &lt; 8192) {
          return true;
        }

        return false;
      },
      minimizerOptions: {
        plugins: [["jpegtran", { progressive: false }]],
      },
    }),
  ],
};</pre> <h3 id="optimize-and-transform-images-to-webp">Optimize and transform images to <code>webp</code>
</h3> <pre data-language="js">const ImageMinimizerPlugin = require("image-minimizer-webpack-plugin");

module.exports = {
  plugins: [
    new ImageMinimizerPlugin({
      minimizerOptions: {
        plugins: ["pngquant"],
      },
    }),
    new ImageMinimizerPlugin({
      deleteOriginalAssets: false,
      filename: "[path][name].webp",
      minimizerOptions: {
        plugins: ["imagemin-webp"],
      },
    }),
  ],
};</pre> <h2 id="contributing">Contributing
</h2> <p>Please take a moment to read our contributing guidelines if you haven't yet done so.</p> <p><a href="https://github.com/webpack-contrib/image-minimizer-webpack-plugin/blob/master/.github/CONTRIBUTING.md">CONTRIBUTING</a></p> <h2 id="license">License
</h2> <p><a href="https://github.com/webpack-contrib/image-minimizer-webpack-plugin/blob/master/LICENSE">MIT</a></p> </div>
<div class="print:hidden mt-20">
<a class="text-gray-500 dark:text-gray-500 text-sm cursor-pointer font-sans hover:underline" href="https://github.com/webpack-contrib/image-minimizer-webpack-plugin/edit/master/README.md">Edit this page</a><span class="mx-5 text-black font-bold dark:text-white">·</span><a class="text-gray-500 dark:text-gray-500 text-sm cursor-pointer font-sans hover:underline">Print this page</a><span class="mx-5 text-black font-bold dark:text-white">·</span><a class="text-gray-500 dark:text-gray-500 text-sm cursor-pointer font-sans hover:underline" href="https://github.com/webpack-contrib/image-minimizer-webpack-plugin">Jump to repository</a>
</div><div class="_attribution">
  <p class="_attribution-p">
    <a href="https://webpack.js.org/plugins/image-minimizer-webpack-plugin" class="_attribution-link" target="_blank">https://webpack.js.org/plugins/image-minimizer-webpack-plugin</a>
  </p>
</div>
