<h1 class="type-name"> class Crypto::Bcrypt </h1> <ul class="superclass-hierarchy">
<li class="superclass"><a href="bcrypt">Crypto::Bcrypt</a></li>
<li class="superclass"><a href="../reference">Reference</a></li>
<li class="superclass"><a href="../object">Object</a></li>
</ul> <h2>  Overview </h2> <p>Pure Crystal implementation of the Bcrypt algorithm by Niels Provos and David Mazi√®res, as <a href="https://www.usenix.org/legacy/events/usenix99/provos/provos_html/index.html">presented at USENIX in 1999</a>.</p> <p>The algorithm has a maximum password length limit of 71 characters (see <a href="https://security.stackexchange.com/questions/39849/does-bcrypt-have-a-maximum-password-length#answer-39851">this comment</a> on stackoverflow).</p> <p>Refer to <code><a href="bcrypt/password">Crypto::Bcrypt::Password</a></code> for a higher level interface.</p> <p>About the Cost</p> <p>Bcrypt, like the PBKDF2 or scrypt ciphers, are designed to be slow, so generating rainbow tables or cracking passwords is nearly impossible. Yet, computers are always getting faster and faster, so the actual cost must be incremented every once in a while. Always use the maximum cost that is tolerable, performance wise, for your application. Be sure to test and select this based on your server, not your home computer.</p> <p>This implementation of Bcrypt is currently 50% slower than pure C solutions, so keep this in mind when selecting your cost. It may be wise to test with Ruby's <a href="https://github.com/codahale/bcrypt-ruby">bcrypt gem</a> which is a binding to OpenBSD's implementation.</p> <p>Last but not least: beware of denial of services! Always protect your application using an external strategy (eg: rate limiting), otherwise endpoints that verifies bcrypt hashes will be an easy target.</p> <h2>  Defined in: </h2> <a href="https://github.com/crystal-lang/crystal/blob/994c70b10/src/crypto/bcrypt.cr#L32" target="_blank"> crypto/bcrypt.cr </a> <br> <h2>  Constant Summary </h2> <dl> <dt class="entry-const" id="COST_RANGE"> <strong>COST_RANGE</strong> = <code>4..31</code> </dt> <dt class="entry-const" id="DEFAULT_COST"> <strong>DEFAULT_COST</strong> = <code>11</code> </dt> <dt class="entry-const" id="PASSWORD_RANGE"> <strong>PASSWORD_RANGE</strong> = <code>1..72</code> </dt> <dt class="entry-const" id="SALT_SIZE"> <strong>SALT_SIZE</strong> = <code>16</code> </dt> </dl> <h2>  Constructors </h2> <ul class="list-summary"> <li class="entry-summary"> <a href="#new%28password%3AString%2Csalt%3AString%2Ccost%3DDEFAULT_COST%29-class-method" class="signature"><strong>.new</strong>(password : String, salt : String, cost = DEFAULT_COST)</a> <div class="summary"><p>Creates a new <code><a href="bcrypt">Crypto::Bcrypt</a></code> object from the given <em>password</em> with <em>salt</em> and <em>cost</em>.</p></div> </li> <li class="entry-summary"> <a href="#new%28password%3ABytes%2Csalt%3ABytes%2Ccost%3AInt32%3DDEFAULT_COST%29-class-method" class="signature"><strong>.new</strong>(password : Bytes, salt : Bytes, cost : Int32 = DEFAULT_COST)</a> <div class="summary"><p>Creates a new <code><a href="bcrypt">Crypto::Bcrypt</a></code> object from the given <em>password</em> with <em>salt</em> in bytes and <em>cost</em>.</p></div> </li> </ul> <h2>  Class Method Summary </h2> <ul class="list-summary"> <li class="entry-summary"> <a href="#hash_secret%28password%2Ccost%3DDEFAULT_COST%29%3AString-class-method" class="signature"><strong>.hash_secret</strong>(password, cost = DEFAULT_COST) : String</a> <div class="summary"><p>Hashes the <em>password</em> using bcrypt algorithm using salt obtained via <code><a href="../random/secure#random_bytes%28buf%3ABytes%29%3ANil-instance-method">Random::Secure.random_bytes(SALT_SIZE)</a></code>.</p></div> </li> </ul> <h2>  Instance Method Summary </h2> <ul class="list-summary"> <li class="entry-summary"> <a href="#cost%3AInt32-instance-method" class="signature"><strong>#cost</strong> : Int32</a> </li> <li class="entry-summary"> <a href="#digest%3ABytes-instance-method" class="signature"><strong>#digest</strong> : Bytes</a> </li> <li class="entry-summary"> <a href="#inspect%28io%3AIO%29%3ANil-instance-method" class="signature"><strong>#inspect</strong>(io : IO) : Nil</a> <div class="summary"><p>Appends a String representation of this object which includes its class name, its object address and the values of all instance variables.</p></div> </li> <li class="entry-summary"> <a href="#password%3ABytes-instance-method" class="signature"><strong>#password</strong> : Bytes</a> </li> <li class="entry-summary"> <a href="#salt%3ABytes-instance-method" class="signature"><strong>#salt</strong> : Bytes</a> </li> <li class="entry-summary"> <a href="#to_s%28io%3AIO%29%3ANil-instance-method" class="signature"><strong>#to_s</strong>(io : IO) : Nil</a> <div class="summary"><p>Appends a short String representation of this object which includes its class name and its object address.</p></div> </li> <li class="entry-summary"> <a href="#to_s%3AString-instance-method" class="signature"><strong>#to_s</strong> : String</a> <div class="summary"><p>Returns a string representation of this object.</p></div> </li> <li class="entry-summary"> <a href="#to_slice%28%2Aargs%2C%2A%2Aoptions%29-instance-method" class="signature"><strong>#to_slice</strong>(*args, **options)</a> </li> <li class="entry-summary"> <a href="#to_slice%28%2Aargs%2C%2A%2Aoptions%2C%26%29-instance-method" class="signature"><strong>#to_slice</strong>(*args, **options, &amp;)</a> </li> </ul> <div class="methods-inherited"> <h3>Instance methods inherited from class <code><a href="../reference">Reference</a></code>
</h3> <a href="../reference#%3D%3D%28other%3Aself%29-instance-method" class="tooltip"> ==(other : self)<br>==(other : JSON::Any)<br>==(other : YAML::Any)<br>==(other) ==</a>, <a href="../reference#dup-instance-method" class="tooltip"> dup dup</a>, <a href="../reference#hash%28hasher%29-instance-method" class="tooltip"> hash(hasher) hash</a>, <a href="../reference#initialize-instance-method" class="tooltip"> initialize initialize</a>, <a href="../reference#inspect%28io%3AIO%29%3ANil-instance-method" class="tooltip"> inspect(io : IO) : Nil inspect</a>, <a href="../reference#object_id%3AUInt64-instance-method" class="tooltip"> object_id : UInt64 object_id</a>, <a href="../reference#pretty_print%28pp%29%3ANil-instance-method" class="tooltip"> pretty_print(pp) : Nil pretty_print</a>, <a href="../reference#same%3F%28other%3AReference%29%3ABool-instance-method" class="tooltip"> same?(other : Reference) : Bool<br>same?(other : Nil) same?</a>, <a href="../reference#to_s%28io%3AIO%29%3ANil-instance-method" class="tooltip"> to_s(io : IO) : Nil to_s</a> <h3>Constructor methods inherited from class <code><a href="../reference">Reference</a></code>
</h3> <a href="../reference#new-class-method" class="tooltip"> new new</a> <h3>Instance methods inherited from class <code><a href="../object">Object</a></code>
</h3> <a href="../object#%21%3ABool-instance-method" class="tooltip"> ! : Bool !</a>, <a href="../object#%21%3D%28other%29-instance-method" class="tooltip"> !=(other) !=</a>, <a href="../object#%21~%28other%29-instance-method" class="tooltip"> !~(other) !~</a>, <a href="../object#%3D%3D%28other%29-instance-method" class="tooltip"> ==(other) ==</a>, <a href="../object#%3D%3D%3D%28other%3AJSON%3A%3AAny%29-instance-method" class="tooltip"> ===(other : JSON::Any)<br>===(other : YAML::Any)<br>===(other) ===</a>, <a href="../object#%3D~%28other%29-instance-method" class="tooltip"> =~(other) =~</a>, <a href="../object#as%28type%3AClass%29-instance-method" class="tooltip"> as(type : Class) as</a>, <a href="../object#as%3F%28type%3AClass%29-instance-method" class="tooltip"> as?(type : Class) as?</a>, <a href="../object#class-instance-method" class="tooltip"> class class</a>, <a href="../object#dup-instance-method" class="tooltip"> dup dup</a>, <a href="../object#hash%28hasher%29-instance-method" class="tooltip"> hash(hasher)<br>hash hash</a>, <a href="../object#in%3F%28collection%3AObject%29%3ABool-instance-method" class="tooltip"> in?(collection : Object) : Bool<br>in?(*values : Object) : Bool in?</a>, <a href="../object#inspect%28io%3AIO%29%3ANil-instance-method" class="tooltip"> inspect(io : IO) : Nil<br>inspect : String inspect</a>, <a href="../object#is_a%3F%28type%3AClass%29%3ABool-instance-method" class="tooltip"> is_a?(type : Class) : Bool is_a?</a>, <a href="../object#itself-instance-method" class="tooltip"> itself itself</a>, <a href="../object#nil%3F%3ABool-instance-method" class="tooltip"> nil? : Bool nil?</a>, <a href="../object#not_nil%21-instance-method" class="tooltip"> not_nil! not_nil!</a>, <a href="../object#pretty_inspect%28width%3D79%2Cnewline%3D%22%5Cn%22%2Cindent%3D0%29%3AString-instance-method" class="tooltip"> pretty_inspect(width = 79, newline = "\n", indent = 0) : String pretty_inspect</a>, <a href="../object#pretty_print%28pp%3APrettyPrint%29%3ANil-instance-method" class="tooltip"> pretty_print(pp : PrettyPrint) : Nil pretty_print</a>, <a href="../object#responds_to%3F%28name%3ASymbol%29%3ABool-instance-method" class="tooltip"> responds_to?(name : Symbol) : Bool responds_to?</a>, <a href="../object#tap%28%26%29-instance-method" class="tooltip"> tap(&amp;) tap</a>, <a href="../object#to_json%28io%3AIO%29%3ANil-instance-method" class="tooltip"> to_json(io : IO) : Nil<br>to_json : String to_json</a>, <a href="../object#to_pretty_json%28indent%3AString%3D%22%22%29%3AString-instance-method" class="tooltip"> to_pretty_json(indent : String = " ") : String<br>to_pretty_json(io : IO, indent : String = " ") : Nil to_pretty_json</a>, <a href="../object#to_s%28io%3AIO%29%3ANil-instance-method" class="tooltip"> to_s(io : IO) : Nil<br>to_s : String to_s</a>, <a href="../object#to_yaml%28io%3AIO%29%3ANil-instance-method" class="tooltip"> to_yaml(io : IO) : Nil<br>to_yaml : String to_yaml</a>, <a href="../object#try%28%26%29-instance-method" class="tooltip"> try(&amp;) try</a>, <a href="../object#unsafe_as%28type%3AT.class%29forallT-instance-method" class="tooltip"> unsafe_as(type : T.class) forall T unsafe_as</a> <h3>Class methods inherited from class <code><a href="../object">Object</a></code>
</h3> <a href="../object#from_json%28string_or_io%2Croot%3AString%29-class-method" class="tooltip"> from_json(string_or_io, root : String)<br>from_json(string_or_io) from_json</a>, <a href="../object#from_yaml%28string_or_io%3AString%7CIO%29-class-method" class="tooltip"> from_yaml(string_or_io : String | IO) from_yaml</a> </div> <h2>  Constructor Detail </h2> <div class="entry-detail" id="new(password:String,salt:String,cost=DEFAULT_COST)-class-method"> <h3 class="signature">def self.<strong>new</strong>(password : <a href="../string">String</a>, salt : <a href="../string">String</a>, cost = DEFAULT_COST)<a href="https://github.com/crystal-lang/crystal/blob/994c70b10/src/crypto/bcrypt.cr#L72" target="_blank" class="view-source">Source</a>
</h3> <div class="doc"> <p>Creates a new <code><a href="bcrypt">Crypto::Bcrypt</a></code> object from the given <em>password</em> with <em>salt</em> and <em>cost</em>.</p> <pre data-language="crystal">require "crypto/bcrypt"

password = Crypto::Bcrypt.new "secret", "salt_of_16_chars"
password.digest</pre> </div>   </div> <div class="entry-detail" id="new(password:Bytes,salt:Bytes,cost:Int32=DEFAULT_COST)-class-method"> <h3 class="signature">def self.<strong>new</strong>(password : <a href="../bytes">Bytes</a>, salt : <a href="../bytes">Bytes</a>, cost : <a href="../int32">Int32</a> = DEFAULT_COST)<a href="https://github.com/crystal-lang/crystal/blob/994c70b10/src/crypto/bcrypt.cr#L91" target="_blank" class="view-source">Source</a>
</h3> <div class="doc"> <p>Creates a new <code><a href="bcrypt">Crypto::Bcrypt</a></code> object from the given <em>password</em> with <em>salt</em> in bytes and <em>cost</em>.</p> <pre data-language="crystal">require "crypto/bcrypt"

password = Crypto::Bcrypt.new "secret".to_slice, "salt_of_16_chars".to_slice
password.digest</pre> </div>   </div> <h2>  Class Method Detail </h2> <div class="entry-detail" id="hash_secret(password,cost=DEFAULT_COST):String-class-method"> <h3 class="signature">def self.<strong>hash_secret</strong>(password, cost = DEFAULT_COST) : <a href="../string">String</a><a href="https://github.com/crystal-lang/crystal/blob/994c70b10/src/crypto/bcrypt.cr#L57" target="_blank" class="view-source">Source</a>
</h3> <div class="doc"> <p>Hashes the <em>password</em> using bcrypt algorithm using salt obtained via <code><a href="../random/secure#random_bytes%28buf%3ABytes%29%3ANil-instance-method">Random::Secure.random_bytes(SALT_SIZE)</a></code>.</p> <pre data-language="crystal">require "crypto/bcrypt"

Crypto::Bcrypt.hash_secret "secret"</pre> </div>   </div> <h2>  Instance Method Detail </h2> <div class="entry-detail" id="cost:Int32-instance-method"> <h3 class="signature">def <strong>cost</strong> : <a href="../int32">Int32</a><a href="https://github.com/crystal-lang/crystal/blob/994c70b10/src/crypto/bcrypt.cr#L81" target="_blank" class="view-source">Source</a>
</h3>   </div> <div class="entry-detail" id="digest:Bytes-instance-method"> <h3 class="signature">def <strong>digest</strong> : <a href="../bytes">Bytes</a><a href="https://github.com/crystal-lang/crystal/blob/994c70b10/src/crypto/bcrypt.cr#L99" target="_blank" class="view-source">Source</a>
</h3>   </div> <div class="entry-detail" id="inspect(io:IO):Nil-instance-method"> <h3 class="signature">def <strong>inspect</strong>(io : <a href="../io">IO</a>) : <a href="../nil">Nil</a><a href="https://github.com/crystal-lang/crystal/blob/994c70b10/src/crypto/bcrypt.cr#L117" target="_blank" class="view-source">Source</a>
</h3> <div class="doc"> <div class="doc-inherited"> Description copied from class <a href="../reference">Reference</a> </div> <p>Appends a String representation of this object which includes its class name, its object address and the values of all instance variables.</p> <pre data-language="crystal">class Person
  def initialize(@name : String, @age : Int32)
  end
end

Person.new("John", 32).inspect # =&gt; #&lt;Person:0x10fd31f20 @name="John", @age=32&gt;</pre> </div>   </div> <div class="entry-detail" id="password:Bytes-instance-method"> <h3 class="signature">def <strong>password</strong> : <a href="../bytes">Bytes</a><a href="https://github.com/crystal-lang/crystal/blob/994c70b10/src/crypto/bcrypt.cr#L79" target="_blank" class="view-source">Source</a>
</h3>   </div> <div class="entry-detail" id="salt:Bytes-instance-method"> <h3 class="signature">def <strong>salt</strong> : <a href="../bytes">Bytes</a><a href="https://github.com/crystal-lang/crystal/blob/994c70b10/src/crypto/bcrypt.cr#L80" target="_blank" class="view-source">Source</a>
</h3>   </div> <div class="entry-detail" id="to_s(io:IO):Nil-instance-method"> <h3 class="signature">def <strong>to_s</strong>(io : <a href="../io">IO</a>) : <a href="../nil">Nil</a><a href="https://github.com/crystal-lang/crystal/blob/994c70b10/src/crypto/bcrypt.cr#L113" target="_blank" class="view-source">Source</a>
</h3> <div class="doc"> <div class="doc-inherited"> Description copied from class <a href="../reference">Reference</a> </div> <p>Appends a short String representation of this object which includes its class name and its object address.</p> <pre data-language="crystal">class Person
  def initialize(@name : String, @age : Int32)
  end
end

Person.new("John", 32).to_s # =&gt; #&lt;Person:0x10a199f20&gt;</pre> </div>   </div> <div class="entry-detail" id="to_s:String-instance-method"> <h3 class="signature">def <strong>to_s</strong> : <a href="../string">String</a><a href="https://github.com/crystal-lang/crystal/blob/994c70b10/src/crypto/bcrypt.cr#L105" target="_blank" class="view-source">Source</a>
</h3> <div class="doc"> <div class="doc-inherited"> Description copied from class <a href="../object">Object</a> </div> <p>Returns a string representation of this object.</p> <p>Descendants must usually <strong>not</strong> override this method. Instead, they must override <code><a href="bcrypt#to_s%28io%3AIO%29%3ANil-instance-method">#to_s(io)</a></code>, which must append to the given IO object.</p> </div>   </div> <div class="entry-detail" id="to_slice(*args,**options)-instance-method"> <h3 class="signature">def <strong>to_slice</strong>(*args, **options)<a href="https://github.com/crystal-lang/crystal/blob/994c70b10/src/crypto/bcrypt.cr#L121" target="_blank" class="view-source">Source</a>
</h3>   </div> <div class="entry-detail" id="to_slice(*args,**options,&amp;)-instance-method"> <h3 class="signature">def <strong>to_slice</strong>(*args, **options, &amp;)<a href="https://github.com/crystal-lang/crystal/blob/994c70b10/src/crypto/bcrypt.cr#L121" target="_blank" class="view-source">Source</a>
</h3>   </div><div class="_attribution">
  <p class="_attribution-p">
    <a href="https://crystal-lang.org/api/1.5.0/Crypto/Bcrypt.html" class="_attribution-link" target="_blank">https://crystal-lang.org/api/1.5.0/Crypto/Bcrypt.html</a>
  </p>
</div>
