 <h1 id="cross-compilation">Cross-compilation</h1> <p>Crystal supports a basic form of <a href="http://en.wikipedia.org/wiki/Cross_compiler">cross compilation</a>.</p> <p>In order to achieve this, the compiler executable provides two flags:</p> <ul> <li>
<code>--cross-compile</code>: When given enables cross compilation mode</li> <li>
<code>--target</code>: the <a href="http://llvm.org/docs/LangRef.html#target-triple">LLVM Target Triple</a> to use and set the default <a href="compile_time_flags">compile-time flags</a> from</li> </ul> <p>To get the <code>--target</code> flags you can execute <code>llvm-config --host-target</code> using an installed LLVM 3.5. For example on a Linux it could say "x86_64-unknown-linux-gnu".</p> <p>If you need to set any compile-time flags not set implicitly through <code>--target</code>, you can use the <code>-D</code> command line flag.</p> <p>Using these two, we can compile a program in a Mac that will run on that Linux like this:</p> <div class="highlight"><pre data-language="crystal">crystal build your_program.cr --cross-compile --target "x86_64-unknown-linux-gnu"
</pre></div> <p>This will generate a <code>.o</code> (<a href="http://en.wikipedia.org/wiki/Object_file">Object file</a>) and will print a line with a command to execute on the system we are trying to cross-compile to. For example:</p> <div class="highlight"><pre data-language="crystal">cc your_program.o -o your_program -lpcre -lrt -lm -lgc -lunwind
</pre></div> <p>You must copy this <code>.o</code> file to that system and execute those commands. Once you do this the executable will be available in that target system.</p> <p>This procedure is usually done with the compiler itself to port it to new platforms where a compiler is not yet available. Because in order to compile a Crystal compiler we need an older Crystal compiler, the only two ways to generate a compiler for a system where there isn't a compiler yet are:</p> <ul> <li>We checkout the latest version of the compiler written in Ruby, and from that compiler we compile the next versions until the current one.</li> <li>We create a <code>.o</code> file in the target system and from that file we create a compiler.</li> </ul> <p>The first alternative is long and cumbersome, while the second one is much easier.</p> <p>Cross-compiling can be done for other executables, but its main target is the compiler. If Crystal isn't available in some system you can try cross-compiling it there.</p><div class="_attribution">
  <p class="_attribution-p">
    <a href="https://crystal-lang.org/reference/syntax_and_semantics/cross-compilation.html" class="_attribution-link" target="_blank">https://crystal-lang.org/reference/syntax_and_semantics/cross-compilation.html</a>
  </p>
</div>
