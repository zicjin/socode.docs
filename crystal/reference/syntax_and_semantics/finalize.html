 <h1 id="finalize">finalize</h1> <p>If a class defines a <code>finalize</code> method, when an instance of that class is garbage-collected that method will be invoked:</p> <div class="crystal highlight"><pre data-language="crystal">class Foo
  def finalize
    # Invoked when Foo is garbage-collected
    # Use to release non-managed resources (ie. C libraries, structs)
  end
end
</pre></div> <p>Use this method to release resources allocated by external libraries that are not directly managed by Crystal garbage collector.</p> <p>Examples of this can be found in <a href="https://crystal-lang.org/api/latest/IO/FileDescriptor.html#finalize-instance-method"><code>IO::FileDescriptor#finalize</code></a> or <a href="https://crystal-lang.org/api/latest/OpenSSL/Digest.html#finalize-instance-method"><code>OpenSSL::Digest#finalize</code></a>.</p> <p><strong>Notes</strong>:</p> <ul> <li> <p>The <code>finalize</code> method will only be invoked once the object has been fully initialized via the <code>initialize</code> method. If an exception is raised inside the <code>initialize</code> method, <code>finalize</code> won't be invoked. If your class defines a <code>finalize</code> method, be sure to catch any exceptions that might be raised in the <code>initialize</code> methods and free resources.</p> </li> <li> <p>Allocating any new object instances during garbage-collection might result in undefined behavior and most likely crashing your program.</p> </li> </ul><div class="_attribution">
  <p class="_attribution-p">
    <a href="https://crystal-lang.org/reference/syntax_and_semantics/finalize.html" class="_attribution-link" target="_blank">https://crystal-lang.org/reference/syntax_and_semantics/finalize.html</a>
  </p>
</div>
