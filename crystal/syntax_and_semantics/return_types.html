 <h1 id="return-types">Return types</h1> <p>A method's return type is always inferred by the compiler. However, you might want to specify it for two reasons:</p> <ol> <li>To make sure that the method returns the type that you want</li> <li>To make it appear in documentation comments</li> </ol> <p>For example:</p> <div class="crystal highlight"><pre data-language="crystal">def some_method : String
  "hello"
end
</pre></div> <p>The return type follows the <a href="type_grammar">type grammar</a>.</p> <h2 id="nil-return-type">Nil return type</h2> <p>Marking a method as returning <code>Nil</code> will make it return <code>nil</code> regardless of what it actually returns:</p> <div class="crystal highlight"><pre data-language="crystal">def some_method : Nil
  1 + 2
end

some_method # =&gt; nil
</pre></div> <p>This is useful for two reasons:</p> <ol> <li>Making sure a method returns <code>nil</code> without needing to add an extra <code>nil</code> at the end, or at every return point</li> <li>Documenting that the method's return value is of no interest</li> </ol> <p>These methods usually imply a side effect.</p> <p>Using <code>Void</code> is the same, but <code>Nil</code> is more idiomatic: <code>Void</code> is preferred in C bindings.</p> <h2 id="noreturn-return-type">NoReturn return type</h2> <p>Some expressions won't return to the current scope and therefore have no return type. This is expressed as the special return type <code>NoReturn</code>.</p> <p>Typical examples for non-returning methods and keywords are <code>return</code>, <code>exit</code>, <code>raise</code>, <code>next</code>, and <code>break</code>.</p> <p>This is for example useful for deconstructing union types:</p> <div class="crystal highlight"><pre data-language="crystal">string = STDIN.gets
typeof(string)                        # =&gt; String?
typeof(raise "Empty input")           # =&gt; NoReturn
typeof(string || raise "Empty input") # =&gt; String
</pre></div> <p>The compiler recognizes that in case <code>string</code> is <code>Nil</code>, the right hand side of the expression <code>string || raise</code> will be evaluated. Since <code>typeof(raise "Empty input")</code> is <code>NoReturn</code> the execution would not return to the current scope in that case. That leaves only <code>String</code> as resulting type of the expression.</p> <p>Every expression whose code paths all result in <code>NoReturn</code> will be <code>NoReturn</code> as well. <code>NoReturn</code> does not show up in a union type because it would essentially be included in every expression's type. It is only used when an expression will never return to the current scope.</p> <p><code>NoReturn</code> can be explicitly set as return type of a method or function definition but will usually be inferred by the compiler.</p><div class="_attribution">
  <p class="_attribution-p">
    <a href="https://crystal-lang.org/reference/1.3/syntax_and_semantics/return_types.html" class="_attribution-link" target="_blank">https://crystal-lang.org/reference/1.3/syntax_and_semantics/return_types.html</a>
  </p>
</div>
