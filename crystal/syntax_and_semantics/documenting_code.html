 <h1 id="documenting-code">Documenting code</h1> <p>Documentation for API features can be written in code comments directly preceding the definition of the respective feature.</p> <p>By default, all public methods, macros, types and constants are considered part of the API documentation.</p> <div class="admonition tip"> <p class="admonition-title">Tip</p> <p>The compiler command <a href="../using_the_compiler/index#crystal-docs"><code>crystal docs</code></a> automatically extracts the API documentation and generates a website to present it.</p> </div> <h2 id="association">Association</h2> <p>Doc comments must be positioned directly above the definition of the documented feature. Consecutive comment lines are combined into a single comment block. Any empty line breaks the association to the documented feature.</p> <div class="crystal highlight"><pre data-language="crystal"># This comment is not associated with the class.

# First line of documentation for class Unicorn.
# Second line of documentation for class Unicorn.
class Unicorn
end
</pre></div> <h2 id="format">Format</h2> <p>Doc comments support <a href="https://daringfireball.net/projects/markdown/">Markdown</a> formatting.</p> <p>The first paragraph of a doc comment is considered its summary. It should concisely define the purpose and functionality.</p> <p>Supplementary details and usages instructions should follow in subsequent paragraphs.</p> <p>For instance:</p> <div class="crystal highlight"><pre data-language="crystal"># Returns the number of horns this unicorn has.
#
# Always returns `1`.
def horns
  1
end
</pre></div> <div class="admonition tip"> <p class="admonition-title">Tip</p> <p>It is generally advised to use descriptive, third person present tense: <code>Returns the number of horns this unicorn has</code> (instead of an imperative <code>Return the number of horns this unicorn has</code>).</p> </div> <h2 id="markup">Markup</h2> <h3 id="linking">Linking</h3> <p>References to other API features can be enclosed in single backticks. They are automatically resolved and converted into links to the respective feature.</p> <div class="crystal highlight"><pre data-language="crystal">class Unicorn
  # Creates a new `Unicorn` instance.
  def initialize
  end
end
</pre></div> <p>The same lookup rules apply as in Crystal code. Features in the currently documented namespace can be accessed with relative names:</p> <ul> <li>Instance methods are referenced with a hash prefix: <code>#horns</code>.</li> <li>Class methods are referenced with a dot prefix: <code>.new</code>.</li> <li>Constants and types are referenced by their name: <code>Unicorn</code>.</li> </ul> <p>Features in other namespaces are referenced with the fully-qualified type path: <code>Unicorn#horns</code>, <code>Unicorn.new</code>, <code>Unicorn::CONST</code>.</p> <p>Different overloads of a method can be identified by the full signature <code>.new(name)</code>, <code>.new(name, age)</code>.</p> <h3 id="parameters">Parameters</h3> <p>When refering to parameters, it is recommended to write their name <em>italicized</em> (<code>*italicized*</code>):</p> <div class="crystal highlight"><pre data-language="crystal"># Creates a unicorn with the specified number of *horns*.
def initialize(@horns = 1)
  raise "Not a unicorn" if @horns != 1
end
</pre></div> <h3 id="code-examples">Code Examples</h3> <p>Code examples can be placed in Markdown code blocks. If no language tag is given, the code block is considered to be Crystal code.</p> <div class="crystal highlight"><pre data-language="crystal"># Example:
# ```
# unicorn = Unicorn.new
# unicorn.horns # =&gt; 1
# ```
class Unicorn
end
</pre></div> <p>To designate a code block as plain text, it must be explicitly tagged.</p> <div class="crystal highlight"><pre data-language="crystal"># Output:
# ```plain
# "I'm a unicorn"
# ```
def say
  puts "I'm a unicorn"
end
</pre></div> <p>Other language tags can also be used.</p> <p>To show the value of an expression inside code blocks, use <code># =&gt;</code>.</p> <div class="crystal highlight"><pre data-language="crystal">1 + 2             # =&gt; 3
Unicorn.new.speak # =&gt; "I'm a unicorn"
</pre></div> <h3 id="admonitions">Admonitions</h3> <p>Several admonition keywords are supported to visually highlight problems, notes and/or possible issues.</p> <ul> <li><code>BUG</code></li> <li><code>DEPRECATED</code></li> <li><code>EXPERIMENTAL</code></li> <li><code>FIXME</code></li> <li><code>NOTE</code></li> <li><code>OPTIMIZE</code></li> <li><code>TODO</code></li> <li><code>WARNING</code></li> </ul> <p>Admonition keywords must be the first word in their respective line and must be in all caps. An optional trailing colon is preferred for readability.</p> <div class="crystal highlight"><pre data-language="crystal"># Makes the unicorn speak to STDOUT
#
# NOTE: Although unicorns don't normally talk, this one is special
# TODO: Check if unicorn is asleep and raise exception if not able to speak
# TODO: Create another `speak` method that takes and prints a string
def speak
  puts "I'm a unicorn"
end

# Makes the unicorn talk to STDOUT
#
# DEPRECATED: Use `speak`
def talk
  puts "I'm a unicorn"
end
</pre></div> <p>The compiler implicitly adds some admonitions to doc comments:</p> <ul> <li>The <a href="https://crystal-lang.org/api/1.3.2/Deprecated.html"><code>@[Deprecated]</code></a> annotation adds a <code>DEPRECATED</code> admonition.</li> <li>The <a href="https://crystal-lang.org/api/1.3.2/Experimental.html"><code>@[Experimental]</code></a> annotation adds an <code>EXPERIMENTAL</code> admonition.</li> </ul> <h2 id="directives">Directives</h2> <p>Directives tell the documentation generator how to treat documentation for a specific feature.</p> <h3 id="ditto"><code>ditto</code></h3> <p>If two consecutively defined features have the same documentation, <code>:ditto:</code> can be used to copy the same doc comment from the previous definition.</p> <div class="crystal highlight"><pre data-language="crystal"># Returns the number of horns.
def horns
  horns
end

# :ditto:
def number_of_horns
  horns
end
</pre></div> <p>The directive needs to be on a separate line but further documentation can be added in other lines. The <code>:ditto:</code> directive is simply replaced by the content of the previous doc comment.</p> <h3 id="nodoc"><code>nodoc</code></h3> <p>Public features can be hidden from the API docs with the <code>:nodoc:</code> directive. Private and protected features are always hidden.</p> <div class="crystal highlight"><pre data-language="crystal"># :nodoc:
class InternalHelper
end
</pre></div> <p>This directive needs to be the first line in a doc comment. Leading whitespace if optional. Following comment lines can be used for internal documentation.</p> <h3 id="inherit"><code>inherit</code></h3> <p>See <a href="#Inheriting%20Documentation"><em>Inheriting Documentation</em></a>.</p> <h2 id="inheriting-documentation">Inheriting Documentation</h2> <p>When an instance method has no doc comment, but a method with the same signature exists in a parent type, the documentation is inherited from the parent method.</p> <p>For example:</p> <div class="crystal highlight"><pre data-language="crystal">abstract class Animal
  # Returns the name of `self`.
  abstract def name : String
end

class Unicorn &lt; Animal
  def name : String
    "unicorn"
  end
end
</pre></div> <p>The documentation for <code>Unicorn#name</code> would be:</p> <div class="highlight"><pre data-language="crystal">Description copied from class `Animal`

Returns the name of `self`.
</pre></div> <p>The child method can use <code>:inherit:</code> to explicitly copy the parent's documentation, without the <code>Description copied from ...</code> text. <code>:inherit:</code> can also be used to inject the parent's documentation into additional documentation on the child.</p> <p>For example:</p> <div class="crystal highlight"><pre data-language="crystal">abstract class Parent
  # Some documentation common to every *id*.
  abstract def id : Int32
end

class Child &lt; Parent
  # Some documentation specific to *id*'s usage within `Child`.
  #
  # :inherit:
  def id : Int32
    -1
  end
end
</pre></div> <p>The documentation for <code>Child#id</code> would be:</p> <div class="highlight"><pre data-language="crystal">Some documentation specific to *id*'s usage within `Child`.

Some documentation common to every *id*.
</pre></div> <div class="admonition note"> <p class="admonition-title">Note</p> <p>Inheriting documentation only works on <em>instance</em>, non-constructor methods.</p> </div> <h2 id="a-complete-example">A Complete Example</h2> <div class="crystal highlight"><pre data-language="crystal"># A unicorn is a **legendary animal** (see the `Legendary` module) that has been
# described since antiquity as a beast with a large, spiraling horn projecting
# from its forehead.
#
# To create a unicorn:
#
# ```
# unicorn = Unicorn.new
# unicorn.speak
# ```
#
# The above produces:
#
# ```text
# "I'm a unicorn"
# ```
#
# Check the number of horns with `#horns`.
class Unicorn
  include Legendary

  # Creates a unicorn with the specified number of *horns*.
  def initialize(@horns = 1)
    raise "Not a unicorn" if @horns != 1
  end

  # Returns the number of horns this unicorn has
  #
  # ```
  # Unicorn.new.horns # =&gt; 1
  # ```
  def horns
    @horns
  end

  # :ditto:
  def number_of_horns
    horns
  end

  # Makes the unicorn speak to STDOUT
  def speak
    puts "I'm a unicorn"
  end

  # :nodoc:
  class Helper
  end
end
</pre></div><div class="_attribution">
  <p class="_attribution-p">
    <a href="https://crystal-lang.org/reference/1.3/syntax_and_semantics/documenting_code.html" class="_attribution-link" target="_blank">https://crystal-lang.org/reference/1.3/syntax_and_semantics/documenting_code.html</a>
  </p>
</div>
