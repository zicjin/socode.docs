 <h1 id="typeof">typeof</h1> <p>The <code>typeof</code> expression returns the type of an expression:</p> <div class="crystal highlight"><pre data-language="crystal">a = 1
b = typeof(a) # =&gt; Int32
</pre></div> <p>It accepts multiple arguments, and the result is the union of the expression types:</p> <div class="crystal highlight"><pre data-language="crystal">typeof(1, "a", 'a') # =&gt; (Int32 | String | Char)
</pre></div> <p>It is often used in generic code, to make use of the compiler's type inference capabilities:</p> <div class="crystal highlight"><pre data-language="crystal">hash = {} of Int32 =&gt; String
another_hash = typeof(hash).new # :: Hash(Int32, String)
</pre></div> <p>Since <code>typeof</code> doesn't actually evaluate the expression, it can be used on methods at compile time, such as in this example, which recursively forms a union type out of nested generic types:</p> <div class="crystal highlight"><pre data-language="crystal">class Array
  def self.elem_type(typ)
    if typ.is_a?(Array)
      elem_type(typ.first)
    else
      typ
    end
  end
end

nest = [1, ["b", [:c, ['d']]]]
flat = Array(typeof(Array.elem_type(nest))).new
typeof(nest) # =&gt; Array(Int32 | Array(String | Array(Symbol | Array(Char))))
typeof(flat) # =&gt; Array(String | Int32 | Symbol | Char)
</pre></div> <p>This expression is also available in the <a href="type_grammar">type grammar</a>.</p><div class="_attribution">
  <p class="_attribution-p">
    <a href="https://crystal-lang.org/reference/1.5/syntax_and_semantics/typeof.html" class="_attribution-link" target="_blank">https://crystal-lang.org/reference/1.5/syntax_and_semantics/typeof.html</a>
  </p>
</div>
