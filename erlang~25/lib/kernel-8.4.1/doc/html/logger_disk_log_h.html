  <div class="innertube"> <h2 id="module" class="title-link" onmouseover="document.getElementById('ghlink-module-idm16521').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-module-idm16521').style.visibility = 'hidden';"> <div class="title-name">Module</div>  </h2> <p class="REFBODY module-body">logger_disk_log_h</p> </div> <div class="innertube"> <h2 id="module-summary" class="title-link" onmouseover="document.getElementById('ghlink-module-summary-idm16522').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-module-summary-idm16522').style.visibility = 'hidden';"> <div class="title-name">Module Summary</div>  </h2> <p class="REFBODY module-summary-body">A disk_log based handler for Logger</p> <h2 id="since" class="title-link" onmouseover="document.getElementById('ghlink-since-idm16522').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-since-idm16522').style.visibility = 'hidden';"> <div class="title-name">Since</div>  </h2> <p class="REFBODY module-since"> Module logger_disk_log_h was introduced in OTP 21.0. </p> </div> <section class="description"><div class="innertube"> <h2 id="description" class="title-link" onmouseover="document.getElementById('ghlink-description-idm16523').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-description-idm16523').style.visibility = 'hidden';"> <div class="title-name">Description</div>  </h2> 
<p>This is a handler for Logger that offers circular (wrapped) logs by using <code><a href="disk_log"><span class="code">disk_log</span></a></code>. Multiple instances of this handler can be added to Logger, and each instance prints to its own disk log file, created with the name and settings specified in the handler configuration.</p> <p>The default standard handler, <code><a href="logger_std_h"><span class="code">logger_std_h</span></a></code>, can be replaced by a disk_log handler at startup of the Kernel application. See an example of this below.</p> <p>The handler has an overload protection mechanism that keeps the handler process and the Kernel application alive during high loads of log events. How overload protection works, and how to configure it, is described in the <code><a href="logger_chapter#overload_protection"><span class="code">User's Guide</span> </a></code>.</p> <p>To add a new instance of the disk_log handler, use <code><a href="logger#add_handler-3"><span class="code">logger:add_handler/3</span> </a></code>. The handler configuration argument is a map which can contain general configuration parameters, as documented in the <code><a href="logger_chapter#handler_configuration"><span class="code">User's Guide</span> </a></code>, and handler specific parameters. The specific data is stored in a sub map with the key <code class="code">config</code>, and can contain the following parameters:</p> <dl> <dt><strong><code class="code">file</code></strong></dt> <dd> <p>This is the full name of the disk log file. The option corresponds to the <code class="code">name</code> property in the <code><a href="disk_log#open-1"><span class="code">dlog_option()</span></a></code> datatype.</p> <p>The value is set when the handler is added, and it cannot be changed in runtime.</p> <p>Defaults to the same name as the handler identity, in the current directory.</p> </dd> <dt><strong><code class="code">type</code></strong></dt> <dd> <p>This is the disk log type, <code class="code">wrap</code> or <code class="code">halt</code>. The option corresponds to the <code class="code">type</code> property in the <code><a href="disk_log#open-1"><span class="code">dlog_option()</span></a></code> datatype.</p> <p>The value is set when the handler is added, and it cannot be changed in runtime.</p> <p>Defaults to <code class="code">wrap</code>.</p> </dd> <dt><strong><code class="code">max_no_files</code></strong></dt> <dd> <p>This is the maximum number of files that disk_log uses for its circular logging. The option corresponds to the <code class="code">MaxNoFiles</code> element in the <code class="code">size</code> property in the <code><a href="disk_log#open-1"><span class="code">dlog_option()</span></a></code> datatype.</p> <p>The value is set when the handler is added, and it cannot be changed in runtime.</p> <p>Defaults to <code class="code">10</code>.</p> <p>The setting has no effect on a halt log.</p> </dd> <dt><strong><code class="code">max_no_bytes</code></strong></dt> <dd> <p>This is the maximum number of bytes that is written to a log file before disk_log proceeds with the next file in order, or generates an error in case of a full halt log. The option corresponds to the <code class="code">MaxNoBytes</code> element in the <code class="code">size</code> property in the <code><a href="disk_log#open-1"><span class="code">dlog_option()</span></a></code> datatype.</p> <p>The value is set when the handler is added, and it cannot be changed in runtime.</p> <p>Defaults to <code class="code">1048576</code> bytes for a wrap log, and <code class="code">infinity</code> for a halt log.</p> </dd> <dt><strong><code class="code">filesync_repeat_interval</code></strong></dt> <dd> <p>This value, in milliseconds, specifies how often the handler does a disk_log sync operation to write buffered data to disk. The handler attempts the operation repeatedly, but only performs a new sync if something has actually been logged.</p> <p>Defaults to <code class="code">5000</code> milliseconds.</p> <p>If <code class="code">no_repeat</code> is set as value, the repeated sync operation is disabled. The user can also call the <code><a href="logger_disk_log_h#filesync-1"><span class="code">filesync/1</span> </a></code> function to perform a disk_log sync.</p> </dd> </dl> <p>Other configuration parameters exist, to be used for customizing the overload protection behaviour. The same parameters are used both in the standard handler and the disk_log handler, and are documented in the <code><a href="logger_chapter#overload_protection"><span class="code">User's Guide</span> </a></code>.</p> <p>Notice that when changing the configuration of the handler in runtime, the disk_log options (<code class="code">file</code>, <code class="code">type</code>, <code class="code">max_no_files</code>, <code class="code">max_no_bytes</code>) must not be modified.</p> <p>Example of adding a disk_log handler:</p> <pre data-language="erlang">logger:add_handler(my_disk_log_h, logger_disk_log_h,
                   #{config =&gt; #{file =&gt; "./my_disk_log",
                                 type =&gt; wrap,
                                 max_no_files =&gt; 4,
                                 max_no_bytes =&gt; 10000,
                                 filesync_repeat_interval =&gt; 1000}}).</pre> <p>To use the disk_log handler instead of the default standard handler when starting an Erlang node, change the Kernel default logger to use <code class="code">logger_disk_log_h</code>. Example:</p> <pre data-language="erlang">erl -kernel logger '[{handler,default,logger_disk_log_h,
                      #{config =&gt; #{file =&gt; "./system_disk_log"}}}]'</pre>  </div></section> <div class="innertube"><h2 id="export" class="title-link" onmouseover="document.getElementById('ghlink-export-idm16608').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-export-idm16608').style.visibility = 'hidden';"> <div class="title-name">Exports</div>  </h2></div> <div class="exports-body"><article class="func"><h4 id="filesync-1" onmouseover="document.getElementById('ghlink-filesync-1-idp476').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-filesync-1-idp476').style.visibility = 'hidden';">  <span class="title-name">filesync(Name) -&gt; ok | {error, Reason}</span><div class="title-since"><span class="since">OTP 21.0</span></div> </h4>  <h2 id="types" class="func-types-title">Types</h2>    <div class="exports-tube"> <p>Write buffered data to disk.</p> </div></article></div> <section class="innertube"><h2 id="see-also" class="title-link" onmouseover="document.getElementById('ghlink-see-also-idm16614').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-see-also-idm16614').style.visibility = 'hidden';"> <div class="title-name">See Also</div>  </h2>  <p><code><a href="logger"><span class="code">logger(3)</span></a></code>, <code><a href="logger_std_h"><span class="code">logger_std_h(3)</span></a></code>, <code><a href="disk_log"><span class="code">disk_log(3)</span></a></code></p> </section> <div class="footer"> <hr> <p>Copyright Â© 1997-2022 Ericsson AB. All Rights Reserved.</p> </div><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2010&ndash;2022 Ericsson AB<br>Licensed under the Apache License, Version 2.0.<br>
    
  </p>
</div>
