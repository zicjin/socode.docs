  <div class="innertube"> <h2 id="module" class="title-link" onmouseover="document.getElementById('ghlink-module-idm16073').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-module-idm16073').style.visibility = 'hidden';"> <div class="title-name">Module</div>  </h2> <p class="REFBODY module-body">logger_formatter</p> </div> <div class="innertube"> <h2 id="module-summary" class="title-link" onmouseover="document.getElementById('ghlink-module-summary-idm16074').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-module-summary-idm16074').style.visibility = 'hidden';"> <div class="title-name">Module Summary</div>  </h2> <p class="REFBODY module-summary-body">Default formatter for Logger.</p> <h2 id="since" class="title-link" onmouseover="document.getElementById('ghlink-since-idm16074').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-since-idm16074').style.visibility = 'hidden';"> <div class="title-name">Since</div>  </h2> <p class="REFBODY module-since"> Module logger_formatter was introduced in OTP 21.0. </p> </div> <section class="description"><div class="innertube"> <h2 id="description" class="title-link" onmouseover="document.getElementById('ghlink-description-idm16075').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-description-idm16075').style.visibility = 'hidden';"> <div class="title-name">Description</div>  </h2> 
<p>Each Logger handler has a configured formatter specified as a module and a configuration term. The purpose of the formatter is to translate the log events to a final printable string (<code><span class="code">unicode:chardata()</span> </code>) which can be written to the output device of the handler. See sections <code><a href="logger_chapter#handlers">Handlers</a></code> and <code><a href="logger_chapter#formatters">Formatters</a></code> in the Kernel User's Guide for more information.</p> <p><code class="code">logger_formatter</code> is the default formatter used by Logger.</p>  </div></section> <div class="innertube"> <h2 id="data-types" class="title-link" onmouseover="document.getElementById('ghlink-data-types-idm16083').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-data-types-idm16083').style.visibility = 'hidden';"> <div class="title-name">Data Types</div>  </h2> <article class="data-types-body"><h4 id="type-config" class="title-link data-type-name" onmouseover="document.getElementById('ghlink-type-config').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-type-config').style.visibility = 'hidden';">  <div class="title-name"> <code>config() = <br id="type-config">    #{chars_limit =&gt; <span>integer() &gt;= 1</span> | unlimited,<br>      depth =&gt; <span>integer() &gt;= 1</span> | unlimited,<br>      legacy_header =&gt; <span>boolean()</span>,<br>      max_size =&gt; <span>integer() &gt;= 1</span> | unlimited,<br>      report_cb =&gt; <span><a href="logger#type-report_cb">logger:report_cb()</a></span>,<br>      single_line =&gt; <span>boolean()</span>,<br>      template =&gt; <span><a href="#type-template">template()</a></span>,<br>      time_designator =&gt; <span>byte()</span>,<br>      time_offset =&gt; <span>integer()</span> | [<span>byte()</span>]}</code><br> </div> </h4> <div class="data-type-desc"> <p>The configuration term for <code class="code">logger_formatter</code> is a <code>map</code>, and the following keys can be set as configuration parameters:</p> <dl> <dt><strong> <code class="code" id="chars_limit">chars_limit = integer() &gt; 0 | unlimited</code></strong></dt> <dd> <p>A positive integer representing the value of the option with the same name to be used when calling <code> <span class="code">io_lib:format/3</span></code>. This value limits the total number of characters printed for each log event. Notice that this is a soft limit. For a hard truncation limit, see option <code class="code">max_size</code>.</p> <p>Defaults to <code class="code">unlimited</code>.</p> </dd> <dt><strong><code class="code" id="depth">depth = integer() &gt; 0 | unlimited</code></strong></dt> <dd> <p>A positive integer representing the maximum depth to which terms shall be printed by this formatter. Format strings passed to this formatter are rewritten. The format controls ~p and ~w are replaced with ~P and ~W, respectively, and the value is used as the depth parameter. For details, see <code><span class="code">io:format/2,3</span></code> in STDLIB.</p> <p>Defaults to <code class="code">unlimited</code>.</p> </dd> <dt><strong><code class="code">legacy_header = boolean()</code></strong></dt> <dd> <p>If set to <code class="code">true</code> a header field is added to logger_formatter's part of <code class="code">Metadata</code>. The value of this field is a string similar to the header created by the old <code><a href="error_logger"><span class="code">error_logger</span></a></code> event handlers. It can be included in the log event by adding the list <code class="code">[logger_formatter,header]</code> to the template. See the description of the <code><a href="#type-template"><span class="code">template()</span></a></code> type for more information.</p> <p>Defaults to <code class="code">false</code>.</p> </dd> <dt><strong> <code class="code" id="max_size">max_size = integer() &gt; 0 | unlimited</code></strong></dt> <dd> <p>A positive integer representing the absolute maximum size a string returned from this formatter can have. If the formatted string is longer, after possibly being limited by <code class="code">chars_limit</code> or <code class="code">depth</code>, it is truncated.</p> <p>Defaults to <code class="code">unlimited</code>.</p> </dd> <dt><strong><code class="code">report_cb =</code><code><a href="logger#type-report_cb"> <span class="code">logger:report_cb()</span></a></code></strong></dt> <dd> <p>A report callback is used by the formatter to transform log messages on report form to a format string and arguments. The report callback can be specified in the metadata for the log event. If no report callback exists in metadata, <code class="code">logger_formatter</code> will use <code><a href="logger#format_report-1"> <span class="code">logger:format_report/1</span></a></code> as default callback.</p> <p>If this configuration parameter is set, it replaces both the default report callback, and any report callback found in metadata. That is, all reports are converted by this configured function.</p> </dd> <dt><strong><code class="code">single_line = boolean()</code></strong></dt> <dd> <p>If set to <code class="code">true</code>, each log event is printed as a single line. To achieve this, <code class="code">logger_formatter</code> sets the field width to <code class="code">0</code> for all <code class="code">~p</code> and <code class="code">~P</code> control sequences in the format a string (see <code> <span class="code">io:format/2</span></code>), and replaces all newlines in the message with <code class="code">", "</code>. White spaces following directly after newlines are removed. Notice that newlines added by the <code class="code">template</code> parameter are not replaced.</p> <p>Defaults to <code class="code">true</code>.</p> </dd> <dt><strong> <code class="code" id="template">template =</code><code><a href="#type-template"><span class="code">template()</span> </a></code></strong></dt> <dd> <p>The template describes how the formatted string is composed by combining different data values from the log event. See the description of the <code><a href="#type-template"><span class="code">template()</span></a></code> type for more information about this.</p> </dd> <dt><strong><code class="code">time_designator = byte()</code></strong></dt> <dd> <p>Timestamps are formatted according to RFC3339, and the time designator is the character used as date and time separator.</p> <p>Defaults to <code class="code">$T</code>.</p> <p>The value of this parameter is used as the <code class="code">time_designator</code> option to <code> <span class="code">calendar:system_time_to_rcf3339/2</span></code>.</p> </dd> <dt><strong><code class="code">time_offset = integer() | [byte()]</code></strong></dt> <dd> <p>The time offset, either a string or an integer, to be used when formatting the timestamp.</p> <p>An empty string is interpreted as local time. The values <code class="code">"Z"</code>, <code class="code">"z"</code> or <code class="code">0</code> are interpreted as Universal Coordinated Time (UTC).</p> <p>Strings, other than <code class="code">"Z"</code>, <code class="code">"z"</code>, or <code class="code">""</code>, must be on the form <code class="code">±[hh]:[mm]</code>, for example <code class="code">"-02:00"</code> or <code class="code">"+00:00"</code>.</p> <p>Integers must be in microseconds, meaning that the offset <code class="code">7200000000</code> is equivalent to <code class="code">"+02:00"</code>.</p> <p>Defaults to an empty string, meaning that timestamps are displayed in local time. However, for backwards compatibility, if the SASL configuration parameter <code> <span class="code">utc_log</span></code><code class="code">=true</code>, the default is changed to <code class="code">"Z"</code>, meaning that timestamps are displayed in UTC.</p> <p>The value of this parameter is used as the <code class="code">offset</code> option to <code> <span class="code">calendar:system_time_to_rcf3339/2</span></code>.</p> </dd> </dl> </div></article> <article class="data-types-body"><h4 id="type-metakey" class="title-link data-type-name" onmouseover="document.getElementById('ghlink-type-metakey').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-type-metakey').style.visibility = 'hidden';">  <div class="title-name"> <code>metakey() = <span id="type-metakey">atom()</span> | [<span>atom()</span>]</code><br> </div> </h4> </article> <article class="data-types-body"><h4 id="type-template" class="title-link data-type-name" onmouseover="document.getElementById('ghlink-type-template').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-type-template').style.visibility = 'hidden';">  <div class="title-name"> <code>template() = <br id="type-template">    [<span><a href="#type-metakey">metakey()</a></span> |<br>     {<span><a href="#type-metakey">metakey()</a></span>, <span><a href="#type-template">template()</a></span>, <span><a href="#type-template">template()</a></span>} |<br>     <span>unicode:chardata()</span>]</code><br> </div> </h4> <div class="data-type-desc"> <p>The template is a list of atoms, atom lists, tuples and strings. The atoms <code class="code">level</code> or <code class="code">msg</code>, are treated as placeholders for the severity level and the log message, respectively. Other atoms or atom lists are interpreted as placeholders for metadata, where atoms are expected to match top level keys, and atom lists represent paths to sub keys when the metadata is a nested map. For example the list <code class="code">[key1,key2]</code> is replaced by the value of the <code class="code">key2</code> field in the nested map below. The atom <code class="code">key1</code> on its own is replaced by the complete value of the <code class="code">key1</code> field. The values are converted to strings.</p> <pre data-language="erlang">#{key1 =&gt; #{key2 =&gt; my_value,
            ...}
  ...}</pre> <p>Tuples in the template express if-exist tests for metadata keys. For example, the following tuple says that if <code class="code">key1</code> exists in the metadata map, print <code class="code">"key1=Value"</code>, where <code class="code">Value</code> is the value that <code class="code">key1</code> is associated with in the metadata map. If <code class="code">key1</code> does not exist, print nothing.</p> <pre data-language="erlang">{key1, ["key1=",key1], []}</pre> <p>Strings in the template are printed literally.</p> <p>The default value for the <code class="code">template</code> configuration parameter depends on the value of the <code class="code">single_line</code> and <code class="code">legacy_header</code> configuration parameters as follows.</p> <p>The log event used in the examples is:</p> <pre data-language="erlang">?LOG_ERROR("name: ~p~nexit_reason: ~p", [my_name, "It crashed"])</pre> <dl> <dt><strong><code class="code">legacy_header = true, single_line = false</code></strong></dt> <dd> <p>Default template: <code class="code">[[logger_formatter,header],"\n",msg,"\n"]</code></p> <p>Example log entry:</p> <pre data-language="erlang">=ERROR REPORT==== 17-May-2018::18:30:19.453447 ===
name: my_name
exit_reason: "It crashed"</pre> <p>Notice that all eight levels can occur in the heading, not only <code class="code">ERROR</code>, <code class="code">WARNING</code> or <code class="code">INFO</code> as <code><a href="error_logger"><span class="code">error_logger</span></a></code> produces. And microseconds are added at the end of the timestamp.</p> </dd> <dt><strong><code class="code">legacy_header = true, single_line = true</code></strong></dt> <dd> <p>Default template: <code class="code">[[logger_formatter,header],"\n",msg,"\n"]</code></p> <p>Notice that the template is here the same as for <code class="code">single_line=false</code>, but the resulting log entry differs in that there is only one line after the heading:</p> <pre data-language="erlang">=ERROR REPORT==== 17-May-2018::18:31:06.952665 ===
name: my_name, exit_reason: "It crashed"</pre> </dd> <dt><strong><code class="code">legacy_header = false, single_line = true</code></strong></dt> <dd> <p>Default template: <code class="code">[time," ",level,": ",msg,"\n"]</code></p> <p>Example log entry:</p> <pre data-language="erlang">2018-05-17T18:31:31.152864+02:00 error: name: my_name, exit_reason: "It crashed"</pre> </dd> <dt><strong><code class="code">legacy_header = false, single_line = false</code></strong></dt> <dd> <p>Default template: <code class="code">[time," ",level,":\n",msg,"\n"]</code></p> <p>Example log entry:</p> <pre data-language="erlang">2018-05-17T18:32:20.105422+02:00 error:
name: my_name
exit_reason: "It crashed"</pre> </dd> </dl> </div></article> </div> <div class="innertube"><h2 id="export" class="title-link" onmouseover="document.getElementById('ghlink-export-idm16268').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-export-idm16268').style.visibility = 'hidden';"> <div class="title-name">Exports</div>  </h2></div> <div class="exports-body"> <article class="func"><h4 id="check_config-1" onmouseover="document.getElementById('ghlink-check_config-1-idp473').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-check_config-1-idp473').style.visibility = 'hidden';">  <span class="title-name">check_config(Config) -&gt; ok | {error, <code>term()</code>}</span><div class="title-since"><span class="since">OTP 21.0</span></div> </h4>  <h2 id="types" class="func-types-title">Types</h2>   <div class="exports-tube"> <p>The function is called by Logger when the formatter configuration for a handler is set or modified. It returns <code class="code">ok</code> if the configuration is valid, and <code class="code">{error,term()}</code> if it is faulty.</p> <p>The following Logger API functions can trigger this callback:</p> <ul> <li><code><a href="logger#add_handler-3"> <span class="code">logger:add_handler/3</span></a></code></li> <li><code><a href="logger#set_handler_config-2"> <span class="code">logger:set_handler_config/2,3</span></a></code></li> <li><code><a href="logger#update_handler_config-2"> <span class="code">logger:update_handler_config/2</span></a></code></li> <li><code><a href="logger#update_formatter_config-2"> <span class="code">logger:update_formatter_config/2</span></a></code></li> </ul> </div></article><article class="func"><h4 id="format-2" onmouseover="document.getElementById('ghlink-format-2-idp474').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-format-2-idp474').style.visibility = 'hidden';">  <span class="title-name">format(LogEvent, Config) -&gt; <code>unicode:chardata()</code></span><div class="title-since"><span class="since">OTP 21.0</span></div> </h4>  <h2 id="types" class="func-types-title">Types</h2>    <div class="exports-tube"> <p>This the formatter callback function to be called from handlers. The log event is processed as follows:</p> <ul> <li>If the message is on report form, it is converted to <code class="code">{Format,Args}</code> by calling the report callback. See section <code><a href="logger_chapter#log_message">Log Message</a></code> in the Kernel User's Guide for more information about report callbacks and valid forms of log messages.</li> <li>The message size is limited according to the values of configuration parameters <code><a href="#chars_limit"> <span class="code">chars_limit</span></a></code> and <code><a href="#depth"><span class="code">depth</span></a></code>.</li> <li>The full log entry is composed according to the <code><a href="#template"><span class="code">template</span></a></code>.</li> <li>If the final string is too long, it is truncated according to the value of configuration parameter <code><a href="#max_size"><span class="code">max_size</span></a></code>.</li> </ul> </div></article> </div> <section class="innertube"><h2 id="see-also" class="title-link" onmouseover="document.getElementById('ghlink-see-also-idm16310').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-see-also-idm16310').style.visibility = 'hidden';"> <div class="title-name">See Also</div>  </h2>  <p> <code><span class="code">calendar(3)</span></code>, <code><a href="error_logger"><span class="code">error_logger(3)</span></a></code>, <code><span class="code">io(3)</span></code>, <code><span class="code">io_lib(3)</span></code>, <code><a href="logger"><span class="code">logger(3)</span></a></code>, <code><span class="code">maps(3)</span></code>, <code><span class="code">sasl(6)</span></code>, <code><span class="code">unicode(3)</span></code> </p> </section> <div class="footer"> <hr> <p>Copyright © 1997-2022 Ericsson AB. All Rights Reserved.</p> </div><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2010&ndash;2022 Ericsson AB<br>Licensed under the Apache License, Version 2.0.<br>
    
  </p>
</div>
