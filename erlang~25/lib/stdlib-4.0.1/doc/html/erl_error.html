  <div class="innertube"> <h2 id="module" class="title-link" onmouseover="document.getElementById('ghlink-module-idm6616').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-module-idm6616').style.visibility = 'hidden';"> <div class="title-name">Module</div>  </h2> <p class="REFBODY module-body">erl_error</p> </div> <div class="innertube"> <h2 id="module-summary" class="title-link" onmouseover="document.getElementById('ghlink-module-summary-idm6617').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-module-summary-idm6617').style.visibility = 'hidden';"> <div class="title-name">Module Summary</div>  </h2> <p class="REFBODY module-summary-body">Utilities for reporting errors. </p> <h2 id="since" class="title-link" onmouseover="document.getElementById('ghlink-since-idm6617').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-since-idm6617').style.visibility = 'hidden';"> <div class="title-name">Since</div>  </h2> <p class="REFBODY module-since"> Module erl_error was introduced in OTP 24.0. </p> </div> <section class="description"><div class="innertube"> <h2 id="description" class="title-link" onmouseover="document.getElementById('ghlink-description-idm6618').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-description-idm6618').style.visibility = 'hidden';"> <div class="title-name">Description</div>  </h2> 
<p>This module provides functions for pretty-printing errors and exceptions. It is used by both the <code><span class="code">shell</span></code> and by <code><a href="proc_lib"><span class="code">proc_lib</span></a></code> to print exceptions.</p> <p>It is possible for the module raising an error to provide additional information by calling <code><span class="code">error/3</span></code> with extra error information. More details about this mechanism is described in <code><a href="https://www.erlang.org/erlang-enhancement-proposals/eep-0054.html">EEP-54</a></code>.</p>  </div></section> <div class="innertube"> <h2 id="data-types" class="title-link" onmouseover="document.getElementById('ghlink-data-types-idm6628').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-data-types-idm6628').style.visibility = 'hidden';"> <div class="title-name">Data Types</div>  </h2> <article class="data-types-body"><h4 id="type-format_options" class="title-link data-type-name" onmouseover="document.getElementById('ghlink-type-format_options').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-type-format_options').style.visibility = 'hidden';">  <div class="title-name"> <code>format_options() = <br id="type-format_options">    #{column =&gt; <span><a href="#type-column">column()</a></span>,<br>      stack_trim_fun =&gt; <span><a href="#type-stack_trim_fun">stack_trim_fun()</a></span>,<br>      format_fun =&gt; <span><a href="#type-format_fun">format_fun()</a></span>}</code><br> </div> </h4> <div class="data-type-desc"><p>A map with formatting options.</p></div></article> <article class="data-types-body"><h4 id="type-stack_trim_fun" class="title-link data-type-name" onmouseover="document.getElementById('ghlink-type-stack_trim_fun').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-type-stack_trim_fun').style.visibility = 'hidden';">  <div class="title-name"> <code>stack_trim_fun() = <br id="type-stack_trim_fun">    fun((<span>module()</span>, <span>atom()</span>, <span>arity()</span>) -&gt; <span>boolean()</span>)</code><br> </div> </h4> <div class="data-type-desc"> <p>A fun used to trim the end of the stacktrace. It is called with module, function, and arity from an entry from the stacktrace. The fun is to return <code class="code">true</code> if the entry should be trimmed, and <code class="code">false</code> otherwise. The default value is:</p> <pre data-language="erlang">
fun(_, _, _) -&gt; false end</pre> </div></article> <article class="data-types-body"><h4 id="type-format_fun" class="title-link data-type-name" onmouseover="document.getElementById('ghlink-type-format_fun').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-type-format_fun').style.visibility = 'hidden';">  <div class="title-name"> <code>format_fun() = fun((<span id="type-format_fun">term()</span>, <span><a href="#type-column">column()</a></span>) -&gt; <span>iolist()</span>)</code><br> </div> </h4> <div class="data-type-desc"> <p>A fun used to format function arguments for BIF and function calls. By default the following fun will be used:</p> <pre data-language="erlang">
fun(Term, I) -&gt; io_lib:print(Term, I, 80, 30) end</pre> </div></article> <article class="data-types-body"><h4 id="type-column" class="title-link data-type-name" onmouseover="document.getElementById('ghlink-type-column').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-type-column').style.visibility = 'hidden';">  <div class="title-name"> <code>column() = <span id="type-column">integer() &gt;= 1</span></code><br> </div> </h4> <div class="data-type-desc"><p>Start column number. Default is 1.</p></div></article> </div> <div class="innertube"><h2 id="export" class="title-link" onmouseover="document.getElementById('ghlink-export-idm6649').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-export-idm6649').style.visibility = 'hidden';"> <div class="title-name">Exports</div>  </h2></div> <div class="exports-body"><article class="func"><h4 id="format_exception-3" onmouseover="document.getElementById('ghlink-format_exception-3-idp304').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-format_exception-3-idp304').style.visibility = 'hidden';">  <span class="title-name">format_exception(Class, Reason, StackTrace) -&gt; <code><a href="unicode#type-chardata">unicode:chardata()</a></code></span><div class="title-since"><span class="since">OTP 24.0</span></div> </h4> <h4 id="format_exception-4" onmouseover="document.getElementById('ghlink-format_exception-4-idp305').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-format_exception-4-idp305').style.visibility = 'hidden';">  <span class="title-name">format_exception(Class, Reason, StackTrace, Options) -&gt;<br> <code><a href="unicode#type-chardata">unicode:chardata()</a></code></span><div class="title-since"><span class="since">OTP 24.0</span></div> </h4>  <h2 id="types" class="func-types-title">Types</h2>      <div class="exports-tube"> <p>Format the error reason and stack back-trace caught using <code class="code">try</code> ... <code class="code">catch</code> in the same style as the shell formats them.</p> <p>Example:</p> <pre data-language="erlang">try
    do_something()
catch
    C:R:Stk -&gt;
        Message = erl_error:format_exception(C, R, Stk),
        io:format(LogFile, "~ts\n", [Message])
end</pre> <p>If <code class="code">error_info</code> is provided with the exception, <code class="code">format_exception</code> will use that information to provide additional information about the exception.</p> <p>Example:</p> <pre data-language="erlang">try
  erlang:raise(badarg,[],[{error_info,#{}}])
catch
    C:R:Stk -&gt;
        Message = erl_error:format_exception(C, R, Stk),
        io:format(LogFile, "~ts\n", [Message])
end</pre> <p>See <code><span class="code">erlang:error/3</span></code> for details on how to raise an exception with <code class="code">error_info</code> included.</p> </div></article></div> <section class="innertube"><h2 id="callback-functions" class="title-link" onmouseover="document.getElementById('ghlink-callback-functions-idm6669').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-callback-functions-idm6669').style.visibility = 'hidden';"> <div class="title-name">Callback Functions</div>  </h2>  <p>The following functions are to be exported from an Error Info handler.</p> </section> <div class="innertube"><h2 id="export" class="title-link" onmouseover="document.getElementById('ghlink-export-idm6672').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-export-idm6672').style.visibility = 'hidden';"> <div class="title-name">Exports</div>  </h2></div> <div class="exports-body"><article class="func"><div><h4 id="Module:format_error-2" class="title-link" onmouseover="document.getElementById('ghlink-Module:format_error-2-idm6674').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-Module:format_error-2-idm6674').style.visibility = 'hidden';">  <div class="title-name">Module:format_error(Reason, StackTrace) -&gt; ErrorDescription</div> <div class="title-since"><span class="since">OTP 24.0</span></div> </h4></div> <div class="exports-tube">  <h2 id="types" class="func-types-title">Types</h2>          <p>This callback is called when <code><a href="#format_exception-4"><span class="code"> format_exception/4</span></a></code> or similar functionality wants to provide extra information about an error. The <code class="code">Module</code>:<code class="code">Function</code> called is the one specificed by the <code class="code">error_info</code> map.</p> <p>The function should return a map with additional information about what have caused the exception. The possible keys of the map are:</p> <dl> <dt><strong><code class="code">ArgumentPosition = pos_integer()</code></strong></dt> <dd>The position of the argument that caused the error starting at 1.</dd> <dt><strong><code class="code">general</code></strong></dt> <dd>An error that is not associated with any argument caused the error.</dd> <dt><strong><code class="code">reason</code></strong></dt> <dd>If the <code class="code">Reason</code> should be printed differently than the default way.</dd> </dl> <p>If the text returned includes new-lines, <code><a href="#format_exception-4"><span class="code">format_exception/4</span></a></code> will indent the text correctly.</p> <p>Example:</p> <pre data-language="erlang">-module(my_error_module).
-export([atom_to_string/1, format_error/2]).

atom_to_string(Arg) when is_atom(Arg) -&gt;
  atom_to_list(Arg);
atom_to_string(Arg) -&gt;
  erlang:error(badarg,[Arg],
               [{error_info,#{ module =&gt; ?MODULE,
                               cause =&gt; #{ 1 =&gt; "should be an atom" }}}]).

format_error(Reason, [{_M,_F,_As,Info}|_]) -&gt;
  ErrorInfo = proplists:get_value(error_info, Info, #{}),
  ErrorMap = maps:get(cause, ErrorInfo),
  ErrorMap#{ general =&gt; "optional general information",
             reason =&gt; io_lib:format("~p: ~p",[?MODULE, Reason]) }.</pre> <pre data-language="erlang">
1&gt; c(my_error_module).
{ok,my_error_module}
2&gt; my_error_module:atom_to_string(1).
** exception error: my_error_module: badarg
     in function  my_error_module:atom_to_string/1
        called as my_error_module:atom_to_string(1)
        *** argument 1: should be an atom
        *** optional general information</pre>  </div></article></div> <div class="footer"> <hr> <p>Copyright © 1997-2022 Ericsson AB. All Rights Reserved.</p> </div><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2010&ndash;2022 Ericsson AB<br>Licensed under the Apache License, Version 2.0.<br>
    
  </p>
</div>
