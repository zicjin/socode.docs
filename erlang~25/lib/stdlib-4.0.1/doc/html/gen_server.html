  <div class="innertube"> <h2 id="module" class="title-link" onmouseover="document.getElementById('ghlink-module-idm13612').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-module-idm13612').style.visibility = 'hidden';"> <div class="title-name">Module</div>  </h2> <p class="REFBODY module-body">gen_server</p> </div> <div class="innertube"> <h2 id="module-summary" class="title-link" onmouseover="document.getElementById('ghlink-module-summary-idm13613').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-module-summary-idm13613').style.visibility = 'hidden';"> <div class="title-name">Module Summary</div>  </h2> <p class="REFBODY module-summary-body">Generic server behavior.</p> </div> <section class="description"><div class="innertube"> <h2 id="description" class="title-link" onmouseover="document.getElementById('ghlink-description-idm13614').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-description-idm13614').style.visibility = 'hidden';"> <div class="title-name">Description</div>  </h2> 
<p>This behavior module provides the server of a client-server relation. A generic server process (<code class="code">gen_server</code>) implemented using this module has a standard set of interface functions and includes functionality for tracing and error reporting. It also fits into an OTP supervision tree. For more information, see section <code> gen_server Behaviour</code> in OTP Design Principles.</p> <p>A <code class="code">gen_server</code> process assumes all specific parts to be located in a callback module exporting a predefined set of functions. The relationship between the behavior functions and the callback functions is as follows:</p> <pre data-language="erlang">
gen_server module            Callback module
-----------------            ---------------
gen_server:start
gen_server:start_monitor
gen_server:start_link -----&gt; Module:init/1

gen_server:stop       -----&gt; Module:terminate/2

gen_server:call
gen_server:send_request
gen_server:multi_call -----&gt; Module:handle_call/3

gen_server:cast
gen_server:abcast     -----&gt; Module:handle_cast/2

-                     -----&gt; Module:handle_info/2

-                     -----&gt; Module:handle_continue/2

-                     -----&gt; Module:terminate/2

-                     -----&gt; Module:code_change/3</pre> <p>If a callback function fails or returns a bad value, the <code class="code">gen_server</code> process terminates.</p> <p>A <code class="code">gen_server</code> process handles system messages as described in <code><a href="sys"><span class="code">sys(3)</span></a></code>. The <code class="code">sys</code> module can be used for debugging a <code class="code">gen_server</code> process.</p> <p>Notice that a <code class="code">gen_server</code> process does not trap exit signals automatically, this must be explicitly initiated in the callback module.</p> <p>Unless otherwise stated, all functions in this module fail if the specified <code class="code">gen_server</code> process does not exist or if bad arguments are specified.</p> <p>The <code class="code">gen_server</code> process can go into hibernation (see <code> <span class="code">erlang:hibernate/3</span></code>) if a callback function specifies <code class="code">'hibernate'</code> instead of a time-out value. This can be useful if the server is expected to be idle for a long time. However, use this feature with care, as hibernation implies at least two garbage collections (when hibernating and shortly after waking up) and is not something you want to do between each call to a busy server.</p> <p>If the <code class="code">gen_server</code> process needs to perform an action immediately after initialization or to break the execution of a callback into multiple steps, it can return <code class="code">{continue,Continue}</code> in place of the time-out or hibernation value, which will immediately invoke the <code class="code">handle_continue/2</code> callback.</p> <p>If the <code class="code">gen_server</code> process terminates, e.g. as a result of a function in the callback module returning <code class="code">{stop,Reason,NewState}</code>, an exit signal with this <code class="code">Reason</code> is sent to linked processes and ports. See <code> Processes</code> in the Reference Manual for details regarding error handling using exit signals.</p>  </div></section> <div class="innertube"> <h2 id="data-types" class="title-link" onmouseover="document.getElementById('ghlink-data-types-idm13647').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-data-types-idm13647').style.visibility = 'hidden';"> <div class="title-name">Data Types</div>  </h2> <article class="data-types-body"><h4 id="type-server_name" class="title-link data-type-name" onmouseover="document.getElementById('ghlink-type-server_name').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-type-server_name').style.visibility = 'hidden';">  <div class="title-name"> <code>server_name() = <br id="type-server_name">    {local, LocalName :: <span>atom()</span>} |<br>    {global, GlobalName :: <span>term()</span>} |<br>    {via, RegMod :: <span>module()</span>, ViaName :: <span>term()</span>}</code><br> </div> </h4> <div class="data-type-desc"> <p> Name specification to use when starting a <code class="code">gen_server</code>. See functions <code><a href="#start-3"><span class="code">start/3,4</span></a></code>, <code><a href="#start_link-3"><span class="code">start_link/3,4</span></a></code>, <code><a href="#start_monitor-3"><span class="code">start_monitor/3,4</span></a></code>, <code><a href="#enter_loop-3"><span class="code">enter_loop/3,4,5</span></a></code>, and the type <code><a href="#type-server_ref"><span class="code">server_ref()</span></a></code> below. </p> <dl> <dt><strong><code class="code">{local,LocalName}</code></strong></dt> <dd> <p> Register the <code class="code">gen_server</code> locally as <code class="code">LocalName</code> using <code> <span class="code">register/2</span></code>. </p> </dd> <dt><strong><code class="code">{global,GlobalName}</code></strong></dt> <dd> <p> Register the <code class="code">gen_server</code> process id globally as <code class="code">GlobalName</code> using <code> <span class="code">global:register_name/2</span></code>. </p> </dd> <dt><strong><code class="code">{via,RegMod,ViaName}</code></strong></dt> <dd> <p> Register the <code class="code">gen_server</code> process with the registry represented by <code class="code">RegMod</code>. The <code class="code">RegMod</code> callback is to export the functions <code class="code">register_name/2</code>, <code class="code">unregister_name/1</code>, <code class="code">whereis_name/1</code>, and <code class="code">send/2</code>, which are to behave like the corresponding functions in <code><span class="code">global</span></code>. Thus, <code class="code">{via,global,GlobalName}</code> is a valid reference equivalent to <code class="code">{global,GlobalName}</code>. </p> </dd> </dl> </div></article> <article class="data-types-body"><h4 id="type-server_ref" class="title-link data-type-name" onmouseover="document.getElementById('ghlink-type-server_ref').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-type-server_ref').style.visibility = 'hidden';">  <div class="title-name"> <code>server_ref() = <br id="type-server_ref">    <span>pid()</span> |<br>    (LocalName :: <span>atom()</span>) |<br>    {Name :: <span>atom()</span>, Node :: <span>atom()</span>} |<br>    {global, GlobalName :: <span>term()</span>} |<br>    {via, RegMod :: <span>module()</span>, ViaName :: <span>term()</span>}</code><br> </div> </h4> <div class="data-type-desc"> <p> Server specification to use when addressing a <code class="code">gen_server</code>. See <code><a href="#call-2"><span class="code">call/2,3</span></a></code>, <code><a href="#cast-2"><span class="code">cast/2</span></a></code>, <code><a href="#send_request-2"><span class="code">send_request/2</span></a></code>, <code><a href="#check_response-2"><span class="code">check_response/2</span></a></code>, <code><a href="#wait_response-2"><span class="code">wait_response/2</span></a></code>, <code><a href="#stop-1"><span class="code">stop/2,3</span></a></code> and the type <code><a href="#type-server_name"><span class="code">server_name()</span></a></code> above. </p> <p>It can be:</p> <dl> <dt><strong><code class="code">pid()</code></strong></dt> <dd> <p> The <code class="code">gen_server</code>'s process identifier. </p> </dd> <dt><strong><code class="code">LocalName</code></strong></dt> <dd> <p> The <code class="code">gen_server</code> is locally registered as <code class="code">LocalName</code> with <code> <span class="code">register/2</span></code>. </p> </dd> <dt><strong><code class="code">{Name,Node}</code></strong></dt> <dd> <p> The <code class="code">gen_server</code> is locally registered on another node. </p> </dd> <dt><strong><code class="code">{global,GlobalName}</code></strong></dt> <dd> <p> The <code class="code">gen_server</code> is globally registered in <code><span class="code">global</span></code>. </p> </dd> <dt><strong><code class="code">{via,RegMod,ViaName}</code></strong></dt> <dd> <p> The <code class="code">gen_server</code> is registered in an alternative process registry. The registry callback module <code class="code">RegMod</code> is to export functions <code class="code">register_name/2</code>, <code class="code">unregister_name/1</code>, <code class="code">whereis_name/1</code>, and <code class="code">send/2</code>, which are to behave like the corresponding functions in <code><span class="code">global</span></code>. Thus, <code class="code">{via,global,GlobalName}</code> is the same as <code class="code">{global,GlobalName}</code>. </p> </dd> </dl> </div></article> <article class="data-types-body"><h4 id="type-start_opt" class="title-link data-type-name" onmouseover="document.getElementById('ghlink-type-start_opt').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-type-start_opt').style.visibility = 'hidden';">  <div class="title-name"> <code>start_opt() = <br id="type-start_opt">    {timeout, Timeout :: <span>timeout()</span>} |<br>    {spawn_opt, SpawnOptions :: [<span><a href="proc_lib#type-spawn_option">proc_lib:spawn_option()</a></span>]} |<br>    <span><a href="#type-enter_loop_opt">enter_loop_opt()</a></span></code><br> </div> </h4> <div class="data-type-desc"> <p> Options that can be used when starting a <code class="code">gen_server</code> server through, for example, <code><a href="#start_link-3"><span class="code">start_link/3,4</span></a></code>. </p> <dl> <dt><strong><code class="code">{timeout,Timeout}</code></strong></dt> <dd> <p> How many milliseconds the <code class="code">gen_server</code> process is allowed to spend initializing or it is terminated and the start function returns <code class="code">{error,timeout}</code>. </p> </dd> <dt><strong> <code class="code">{spawn_opt,SpawnOptions}</code> </strong></dt> <dd> <p> The <code class="code">SpawnOptions</code> option list is passed to the function used to spawn the <code class="code">gen_server</code>; see <code> <span class="code">spawn_opt/2</span></code>. </p> <div class="note"> <div class="label">Note</div> <div class="content">

<p> Using spawn option <code class="code">monitor</code> is not allowed, it causes a <code class="code">badarg</code> failure. </p> </div> </div> </dd> <dt><strong><code class="code">enter_loop_opt()</code></strong></dt> <dd> <p> See the type <code><a href="#type-enter_loop_opt"><span class="code">enter_loop_opt()</span></a></code> below for more start options that are also allowed by <code><a href="#enter_loop-3"><span class="code">enter_loop/3,4,5</span></a></code>. </p> </dd> </dl> </div></article> <article class="data-types-body"><h4 id="type-enter_loop_opt" class="title-link data-type-name" onmouseover="document.getElementById('ghlink-type-enter_loop_opt').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-type-enter_loop_opt').style.visibility = 'hidden';">  <div class="title-name"> <code>enter_loop_opt() = <br id="type-enter_loop_opt">    {hibernate_after, HibernateAfterTimeout :: <span>timeout()</span>} |<br>    {debug, Dbgs :: [<span><a href="sys#type-debug_option">sys:debug_option()</a></span>]}</code><br> </div> </h4> <div class="data-type-desc"> <p> Options that can be used when starting a <code class="code">gen_server</code> server through <code><a href="#enter_loop-3"><span class="code">enter_loop/3-5</span></a></code> or the start functions such as <code><a href="#start_link-3"><span class="code">start_link/3,4</span></a></code>. </p> <dl> <dt><strong><code class="code">{hibernate_after,HibernateAfterTimeout}</code></strong></dt> <dd> <p> Specifies that the <code class="code">gen_server</code> process awaits any message for <code class="code">HibernateAfterTimeout</code> milliseconds and if no message is received, the process goes into hibernation automatically (by calling <code><a href="proc_lib#hibernate-3"> <span class="code">proc_lib:hibernate/3</span></a></code>). </p> </dd> <dt><strong><code class="code">{debug,Dbgs}</code></strong></dt> <dd> <p> For every entry in <code class="code">Dbgs</code>, the corresponding function in <code><a href="sys"><span class="code">sys(3)</span></a></code> is called. </p> </dd> </dl> </div></article> <article class="data-types-body"><h4 id="type-start_ret" class="title-link data-type-name" onmouseover="document.getElementById('ghlink-type-start_ret').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-type-start_ret').style.visibility = 'hidden';">  <div class="title-name"> <code>start_ret() = <br id="type-start_ret">    {ok, Pid :: <span>pid()</span>} | ignore | {error, Reason :: <span>term()</span>}</code><br> </div> </h4> <div class="data-type-desc"> <p> Return value from the <code><a href="#start-3"><span class="code">start/3,4</span></a></code> and <code><a href="#start_link-3"><span class="code">start_link/3,4</span></a></code> functions. </p> <dl> <dt><strong><code class="code">{ok,Pid}</code></strong></dt> <dd> <p> The <code class="code">gen_server</code> process was succesfully created and initialized, with the process identifier <code class="code">Pid</code>. </p> </dd> <dt><strong><code class="code">{error,{already_started,OtherPid}}</code></strong></dt> <dd> <p> A process with the specified <code class="code">ServerName</code> exists already with the process identifier <code class="code">OtherPid</code>. This <code class="code">gen_server</code> was not started. </p> </dd> <dt><strong><code class="code">ignore</code></strong></dt> <dd> <p> <code><a href="#Module:init-1"><span class="code">Module:init/1</span></a></code> returned <code class="code">ignore</code>, the <code class="code">gen_server</code> process is terminated. An exit signal <code class="code">normal</code> is sent to linked processes and ports. </p> </dd> <dt><strong><code class="code">{error,Reason}</code></strong></dt> <dd> <p> <code><a href="#Module:init-1"><span class="code">Module:init/1</span></a></code> returned <code class="code">{stop,Reason}</code> or failed with <code class="code">Reason</code>. The <code class="code">gen_server</code> process is terminated and an exit signal with the same <code class="code">Reason</code> is sent to linked processes and ports. </p> </dd> </dl> </div></article> <article class="data-types-body"><h4 id="type-start_mon_ret" class="title-link data-type-name" onmouseover="document.getElementById('ghlink-type-start_mon_ret').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-type-start_mon_ret').style.visibility = 'hidden';">  <div class="title-name"> <code>start_mon_ret() = <br id="type-start_mon_ret">    {ok, {Pid :: <span>pid()</span>, MonRef :: <span>reference()</span>}} |<br>    ignore |<br>    {error, Reason :: <span>term()</span>}</code><br> </div> </h4> <div class="data-type-desc"> <p> Return value from the <code><a href="#start_monitor-3"><span class="code">start_monitor/3,4</span></a></code> functions. The same as type <code><a href="#type-start_ret"><span class="code">start_ret()</span></a></code> except that for a succesful start it returns both the process identifier <code class="code">Pid</code> and a <code><span class="code">monitor/2,3</span></code> <code class="code">reference()</code> <code class="code">MonRef</code>. </p> </div></article> <article class="data-types-body"><h4 id="type-from" class="title-link data-type-name" onmouseover="document.getElementById('ghlink-type-from').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-type-from').style.visibility = 'hidden';">  <div class="title-name"> <code>from() = {Client :: <span id="type-from">pid()</span>, Tag :: <span><a href="#type-reply_tag">reply_tag()</a></span>}</code><br> </div> </h4> <div class="data-type-desc"> <p> Destination, given to the <code class="code">gen_server</code> as the first argument to the callback function <code><a href="#Module:handle_call-3"><span class="code">Module:handle_call/3</span></a></code>, to be used by the when replying through <code><a href="#reply-2"><span class="code">reply/2</span></a></code> (instead of through the callback function's return value) to the process <code class="code">Client</code> that has called the <code class="code">gen_server</code> using <code><a href="#call-2"><span class="code">call/2,3</span></a></code>. <code class="code">Tag</code> is a term that is unique for this call/request instance. </p> </div></article> <article class="data-types-body"><h4 id="type-reply_tag" class="title-link data-type-name" onmouseover="document.getElementById('ghlink-type-reply_tag').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-type-reply_tag').style.visibility = 'hidden';">  <div class="title-name"> <code id="type-reply_tag">reply_tag()</code><br> </div> </h4> <div class="data-type-desc"> <p> A handle that associates a reply to the corresponding request. </p> </div></article> <article class="data-types-body"><h4 id="type-request_id" class="title-link data-type-name" onmouseover="document.getElementById('ghlink-type-request_id').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-type-request_id').style.visibility = 'hidden';">  <div class="title-name"> <code id="type-request_id">request_id()</code><br> </div> </h4> <div class="data-type-desc"> <p> An opaque request identifier. See <code><a href="#send_request-2"><span class="code">send_request/2</span></a></code> for details. </p> </div></article> <article class="data-types-body"><h4 id="type-request_id_collection" class="title-link data-type-name" onmouseover="document.getElementById('ghlink-type-request_id_collection').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-type-request_id_collection').style.visibility = 'hidden';">  <div class="title-name"> <code id="type-request_id_collection">request_id_collection()</code><br> </div> </h4> <div class="data-type-desc"> <p> An opaque collection of request identifiers (<code><a href="#type-request_id"><span class="code">request_id()</span></a></code>) where each request identifier can be associated with a label chosen by the user. For more information see <code><a href="#reqids_new-0"><span class="code">reqids_new/0</span></a></code>. </p> </div></article> <article class="data-types-body"><h4 id="type-response_timeout" class="title-link data-type-name" onmouseover="document.getElementById('ghlink-type-response_timeout').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-type-response_timeout').style.visibility = 'hidden';">  <div class="title-name"> <code>response_timeout() = <span id="type-response_timeout">timeout()</span> | {abs, <span>integer()</span>}</code><br> </div> </h4> <div class="data-type-desc"> <p> Used to set a time limit on how long to wait for a response using either <code><a href="#receive_response-2"><span class="code">receive_response/2</span></a></code>, <code><a href="#receive_response-3"><span class="code">receive_response/3</span></a></code>, <code><a href="#wait_response-2"><span class="code">wait_response/2</span></a></code>, or <code><a href="#wait_response-3"><span class="code">wait_response/3</span></a></code>. The time unit used is <code class="code">millisecond</code>. Currently valid values: </p> <dl> <dt><strong><code class="code">0..4294967295</code></strong></dt> <dd><p> Timeout relative to current time in milliseconds. </p></dd> <dt><strong><code class="code">infinity</code></strong></dt> <dd><p> Infinite timeout. That is, the operation will never time out. </p></dd> <dt><strong><code class="code">{abs, Timeout}</code></strong></dt> <dd><p> An absolute <code>Erlang monotonic time</code> timeout in milliseconds. That is, the operation will time out when <code><span class="code">erlang:monotonic_time(millisecond)</span></code> returns a value larger than or equal to <code class="code">Timeout</code>. <code class="code">Timeout</code> is not allowed to identify a time further into the future than <code class="code">4294967295</code> milliseconds. Identifying the timeout using an absolute timeout value is especially handy when you have a deadline for responses corresponding to a complete collection of requests (<code><a href="#type-request_id_collection"><span class="code">request_id_collection()</span></a></code>) , since you do not have to recalculate the relative time until the deadline over and over again. </p></dd> </dl> </div></article> </div> <div class="innertube"><h2 id="export" class="title-link" onmouseover="document.getElementById('ghlink-export-idm13969').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-export-idm13969').style.visibility = 'hidden';"> <div class="title-name">Exports</div>  </h2></div> <div class="exports-body"> <article class="func"><h4 id="abcast-2" onmouseover="document.getElementById('ghlink-abcast-2-idp590').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-abcast-2-idp590').style.visibility = 'hidden';">  <span class="title-name">abcast(Name :: <code>atom()</code>, Request :: <code>term()</code>) -&gt; abcast</span> </h4> <h4 id="abcast-3" onmouseover="document.getElementById('ghlink-abcast-3-idp591').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-abcast-3-idp591').style.visibility = 'hidden';">  <span class="title-name">abcast(Nodes :: [<code>node()</code>], Name :: <code>atom()</code>, Request :: <code>term()</code>) -&gt;<br> abcast</span> </h4> <div class="exports-tube"> <p> Sends an asynchronous request to the <code class="code">gen_server</code> processes locally registered as <code class="code">Name</code> at the specified nodes. The function returns immediately and ignores nodes that do not exist, or where the <code class="code">gen_server</code> <code class="code">Name</code> does not exist. The <code class="code">gen_server</code> processes call <code><a href="#Module:handle_cast-2"> <span class="code">Module:handle_cast/2</span> </a></code> to handle the request. </p> <p> For a description of the arguments, see <code><a href="#multi_call-2"><span class="code">multi_call/2,3,4</span></a></code>. </p> </div></article><article class="func"><h4 id="call-2" onmouseover="document.getElementById('ghlink-call-2-idp592').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-call-2-idp592').style.visibility = 'hidden';">  <span class="title-name">call(ServerRef :: <code><a href="#type-server_ref">server_ref()</a></code>, Request :: <code>term()</code>) -&gt;<br> Reply :: <code>term()</code></span> </h4> <h4 id="call-3" onmouseover="document.getElementById('ghlink-call-3-idp593').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-call-3-idp593').style.visibility = 'hidden';">  <span class="title-name">call(ServerRef :: <code><a href="#type-server_ref">server_ref()</a></code>,<br> Request :: <code>term()</code>,<br> Timeout :: <code>timeout()</code>) -&gt;<br> Reply :: <code>term()</code></span> </h4> <div class="exports-tube"> <p> Makes a synchronous call to the <code class="code">ServerRef</code> of the <code class="code">gen_server</code> process by sending a request and waiting until a reply arrives or a time-out occurs. The <code class="code">gen_server</code> process calls <code><a href="#Module:handle_call-3"> <span class="code">Module:handle_call/3</span> </a></code> to handle the request. </p> <p> See also <code class="code">ServerRef</code>'s type <code><a href="#type-server_ref"><span class="code">server_ref()</span></a></code>. </p> <p> <code class="code">Request</code> is any term that is passed as the first argument to <code class="code">Module:handle_call/3</code>. </p> <p> <code class="code">Timeout</code> is an integer that specifies how many milliseconds to wait for a reply, or the atom <code class="code">infinity</code> to wait indefinitely. Defaults to 5000. If no reply is received within the specified time, this function exits the calling process with an exit term containing <code class="code">Reason = timeout</code> as described below. </p> <div class="note"> <div class="label">Note</div> <div class="content">

<p> Before OTP 24, if the caller uses (<code class="code">try</code>...)<code class="code">catch</code> to avoid process exit, and the server happens to just be late with the reply, it may arrive to the process message queue any time later. The calling process must therefore after catching a time-out exit be prepared to receive garbage message(s) on the form <code class="code">{reference(), _}</code> and deal with them appropriately (discard them) so they do not clog the process message queue or gets mistaken for other messages. </p> <p> Starting with OTP 24, <code class="code">gen_server:call</code> uses process aliases, so late replies will not be received. </p> </div> </div> <p> The return value <code class="code">Reply</code> is passed from the return value of <code class="code">Module:handle_call/3</code>. </p> <p> This call may exit the calling process with an exit term on the form <code class="code">{Reason, Location}</code> where <code class="code">Location = {gen_server,call,ArgList}</code> and <code class="code">Reason</code> can be (at least) one of: </p> <dl> <dt><strong><code class="code">timeout</code></strong></dt> <dd> <p> The call was aborted after waiting <code class="code">Timeout</code> milliseconds for a reply, as described above. </p> </dd> <dt><strong><code class="code">noproc</code></strong></dt> <dd> <p> The <code class="code">ServerRef</code> refers to a server by name (it is not a <code class="code">pid()</code>) and looking up the server process failed, or the <code class="code">pid()</code> was already terminated. </p> </dd> <dt><strong><code class="code">{nodedown,Node}</code></strong></dt> <dd> <p> The <code class="code">ServerRef</code> refers to a server on the remote node <code class="code">Node</code> and the connection to that node failed. </p> </dd> <dt><strong><code class="code">calling_self</code></strong></dt> <dd> <p>A call to <code class="code">self()</code> would hang indefinitely.</p> </dd> <dt><strong> <code class="code">shutdown</code><br> </strong></dt> <dd> <p> The server was stopped during the call by its supervisor. See also <code><a href="#stop-3"><span class="code">stop/3</span></a></code>. </p> </dd> <dt><strong> <code class="code">normal</code><br> <code class="code">{shutdown,Term}</code><br> </strong></dt> <dd> <p> The server stopped during the call by returning <code class="code">{stop,Reason,_}</code> from its <code><a href="#Module:handle_call-3"> <span class="code">Module:handle_call/3</span> </a></code> callback, without replying. See also <code><a href="#stop-3"><span class="code">stop/3</span></a></code>. </p> </dd> <dt><strong><code class="code">_OtherTerm</code></strong></dt> <dd> <p> The server process exited during the call, with reason <code class="code">Reason</code>. Either by returning <code class="code">{stop,Reason,_}</code> from its <code><a href="#Module:handle_call-3"> <span class="code">Module:handle_call/3</span> </a></code> callback (without replying), by raising an exception, or due to getting an exit signal it did not trap. </p> </dd> </dl> </div></article><article class="func"><h4 id="cast-2" onmouseover="document.getElementById('ghlink-cast-2-idp594').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-cast-2-idp594').style.visibility = 'hidden';">  <span class="title-name">cast(ServerRef :: <code><a href="#type-server_ref">server_ref()</a></code>, Request :: <code>term()</code>) -&gt; ok</span> </h4> <div class="exports-tube"> <p> Sends an asynchronous request to the <code class="code">ServerRef</code> of the <code class="code">gen_server</code> process and returns <code class="code">ok</code> immediately, ignoring if the destination node or <code class="code">gen_server</code> process does not exist. The <code class="code">gen_server</code> process calls <code><a href="#Module:handle_cast-2"> <span class="code">Module:handle_cast/2</span> </a></code> to handle the request. </p> <p> See also <code class="code">ServerRef</code>'s type <code><a href="#type-server_ref"><span class="code">server_ref()</span></a></code>. </p> <p> <code class="code">Request</code> is any term that is passed as the first argument to <code class="code">Module:handle_cast/2</code>. </p> </div></article><article class="func"><h4 id="check_response-2" onmouseover="document.getElementById('ghlink-check_response-2-idp595').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-check_response-2-idp595').style.visibility = 'hidden';">  <span class="title-name">check_response(Msg, ReqId) -&gt; Result</span><div class="title-since"><span class="since">OTP 23.0</span></div> </h4>  <h2 id="types" class="func-types-title">Types</h2>      <div class="exports-tube"> <p> Check if <code class="code">Msg</code> is a response corresponding to the request identifier <code class="code">ReqId</code>. The request must have been made by <code><a href="#send_request-2"><span class="code">send_request/2</span></a></code>, and it must have been made by the same process calling this function. </p> <p> If <code class="code">Msg</code> is a response corresponding to <code class="code">ReqId</code> the response is returned; otherwise, <code class="code">no_reply</code> is returned and no cleanup is done, and thus the function must be invoked repeatedly until a response is returned. </p> <p> The return value <code class="code">Reply</code> is passed from the return value of <code class="code">Module:handle_call/3</code>. </p> <p> The function returns an error if the <code class="code">gen_server</code> died before a reply was sent. </p> </div></article><article class="func"><h4 id="check_response-3" onmouseover="document.getElementById('ghlink-check_response-3-idp596').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-check_response-3-idp596').style.visibility = 'hidden';">  <span class="title-name">check_response(Msg, ReqIdCollection, Delete) -&gt; Result</span><div class="title-since"><span class="since">OTP 25.0</span></div> </h4>  <h2 id="types" class="func-types-title">Types</h2>       <div class="exports-tube"> <p> Check if <code class="code">Msg</code> is a response corresponding to a request identifier saved in <code class="code">ReqIdCollection</code>. All request identifiers of <code class="code">ReqIdCollection</code> must correspond to requests that have been made using <code><a href="#send_request-2"><span class="code">send_request/2</span></a></code> or <code><a href="#send_request-4"><span class="code">send_request/4</span></a></code>, and all request must have been made by the process calling this function. </p> <p> The <code class="code">Label</code> in the response equals the <code class="code">Label</code> associated with the request identifier that the response corresponds to. The <code class="code">Label</code> of a request identifier is associated when <code><a href="#reqids_add-3">saving the request id</a></code> in a request identifier collection, or when sending the request using <code><a href="#send_request-4"><span class="code">send_request/4</span></a></code>. </p> <p> Compared to <code><a href="#check_response-2"><span class="code">check_response/2</span></a></code>, the returned result associated with a specific request identifier or an exception associated with a specific request identifier will be wrapped in a 3-tuple. The first element of this tuple equals the value that would have been produced by <code class="code">check_response/2</code>, the second element equals the <code class="code">Label</code> associated with the specific request identifier, and the third element <code class="code">NewReqIdCollection</code> is a possibly modified request identifier collection. </p> <p> If <code class="code">ReqIdCollection</code> is empty, the atom <code class="code">no_request</code> will be returned. If <code class="code">Msg</code> does not correspond to any of the request identifiers in <code class="code">ReqIdCollection</code>, the atom <code class="code">no_reply</code> is returned. </p> <p> If <code class="code">Delete</code> equals <code class="code">true</code>, the association with <code class="code">Label</code> will have been deleted from <code class="code">ReqIdCollection</code> in the resulting <code class="code">NewReqIdCollection</code>. If <code class="code">Delete</code> equals <code class="code">false</code>, <code class="code">NewReqIdCollection</code> will equal <code class="code">ReqIdCollection</code>. Note that deleting an association is not for free and that a collection containing already handled requests can still be used by subsequent calls to <code class="code">check_response/3</code>, <code><a href="#receive_response-3"><span class="code">receive_response/3</span></a></code>, and <code><a href="#wait_response-3"><span class="code">wait_response/3</span></a></code>. However, without deleting handled associations, the above calls will not be able to detect when there are no more outstanding requests to handle, so you will have to keep track of this some other way than relying on a <code class="code">no_request</code> return. Note that if you pass a collection only containing associations of already handled or abandoned requests to <code class="code">check_response/3</code>, it will always return <code class="code">no_reply</code>. </p> </div></article><article class="func"><h4 id="enter_loop-3" onmouseover="document.getElementById('ghlink-enter_loop-3-idp597').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-enter_loop-3-idp597').style.visibility = 'hidden';">  <span class="title-name">enter_loop(Module :: <code>module()</code>,<br> Options :: [<code><a href="#type-enter_loop_opt">enter_loop_opt()</a></code>],<br> State :: <code>term()</code>) -&gt;<br> <code>no_return()</code></span> </h4> <h4 id="enter_loop-4" onmouseover="document.getElementById('ghlink-enter_loop-4-idp598').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-enter_loop-4-idp598').style.visibility = 'hidden';">  <span class="title-name">enter_loop(Module :: <code>module()</code>,<br> Options :: [<code><a href="#type-enter_loop_opt">enter_loop_opt()</a></code>],<br> State :: <code>term()</code>,<br> ServerName :: <code><a href="#type-server_name">server_name()</a></code> | <code>pid()</code>) -&gt;<br> <code>no_return()</code></span> </h4> <h4 id="enter_loop-4" onmouseover="document.getElementById('ghlink-enter_loop-4-idp599').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-enter_loop-4-idp599').style.visibility = 'hidden';">  <span class="title-name">enter_loop(Module :: <code>module()</code>,<br> Options :: [<code><a href="#type-enter_loop_opt">enter_loop_opt()</a></code>],<br> State :: <code>term()</code>,<br> Timeout :: <code>timeout()</code>) -&gt;<br> <code>no_return()</code></span> </h4> <h4 id="enter_loop-4" onmouseover="document.getElementById('ghlink-enter_loop-4-idp600').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-enter_loop-4-idp600').style.visibility = 'hidden';">  <span class="title-name">enter_loop(Module :: <code>module()</code>,<br> Options :: [<code><a href="#type-enter_loop_opt">enter_loop_opt()</a></code>],<br> State :: <code>term()</code>,<br> Hibernate :: hibernate) -&gt;<br> <code>no_return()</code></span> </h4> <h4 id="enter_loop-4" onmouseover="document.getElementById('ghlink-enter_loop-4-idp601').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-enter_loop-4-idp601').style.visibility = 'hidden';">  <span class="title-name">enter_loop(Module :: <code>module()</code>,<br> Options :: [<code><a href="#type-enter_loop_opt">enter_loop_opt()</a></code>],<br> State :: <code>term()</code>,<br> Cont :: {continue, <code>term()</code>}) -&gt;<br> <code>no_return()</code></span> </h4> <h4 id="enter_loop-5" onmouseover="document.getElementById('ghlink-enter_loop-5-idp602').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-enter_loop-5-idp602').style.visibility = 'hidden';">  <span class="title-name">enter_loop(Module :: <code>module()</code>,<br> Options :: [<code><a href="#type-enter_loop_opt">enter_loop_opt()</a></code>],<br> State :: <code>term()</code>,<br> ServerName :: <code><a href="#type-server_name">server_name()</a></code> | <code>pid()</code>,<br> Timeout :: <code>timeout()</code>) -&gt;<br> <code>no_return()</code></span> </h4> <h4 id="enter_loop-5" onmouseover="document.getElementById('ghlink-enter_loop-5-idp603').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-enter_loop-5-idp603').style.visibility = 'hidden';">  <span class="title-name">enter_loop(Module :: <code>module()</code>,<br> Options :: [<code><a href="#type-enter_loop_opt">enter_loop_opt()</a></code>],<br> State :: <code>term()</code>,<br> ServerName :: <code><a href="#type-server_name">server_name()</a></code> | <code>pid()</code>,<br> Hibernate :: hibernate) -&gt;<br> <code>no_return()</code></span> </h4> <h4 id="enter_loop-5" onmouseover="document.getElementById('ghlink-enter_loop-5-idp604').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-enter_loop-5-idp604').style.visibility = 'hidden';">  <span class="title-name">enter_loop(Module :: <code>module()</code>,<br> Options :: [<code><a href="#type-enter_loop_opt">enter_loop_opt()</a></code>],<br> State :: <code>term()</code>,<br> ServerName :: <code><a href="#type-server_name">server_name()</a></code> | <code>pid()</code>,<br> Cont :: {continue, <code>term()</code>}) -&gt;<br> <code>no_return()</code></span> </h4> <div class="exports-tube"> <p> Makes an existing process a <code class="code">gen_server</code> process. Does not return, instead the calling process enters the <code class="code">gen_server</code> process receive loop and becomes a <code class="code">gen_server</code> process. The process <strong>must</strong> have been started using one of the start functions in <code><a href="proc_lib"><span class="code">proc_lib(3)</span></a></code>. The user is responsible for any initialization of the process, including registering a name for it. </p> <p> This function is useful when a more complex initialization procedure is needed than the <code class="code">gen_server</code> process behavior provides. </p> <p> <code class="code">Module</code>, <code class="code">Options</code>, and <code class="code">ServerName</code> have the same meanings as when calling <code><a href="#start_link-3"> <span class="code">start[_link|_monitor]/3,4</span> </a></code> or it can be <code class="code">self()</code> for an anonymous server, which is the same as calling an <code class="code">enter_loop/3,4</code> function without a <code class="code">ServerName</code> argument. However, if <code class="code">ServerName</code> is specified (and not as <code class="code">self()</code>), the process must have been registered accordingly <strong>before</strong> this function is called. </p> <p> <code class="code">State</code>, <code class="code">Timeout</code>, <code class="code">Hibernate</code> and <code class="code">Cont</code> have the same meanings as in the return value of <code><a href="#Module:init-1"><span class="code">Module:init/1</span></a></code>, which is <strong>not</strong> called when <code class="code">enter_loop/3,4,5</code> is used. Note that to adhere to the <code> gen_server Behaviour </code> such a callback function needs to be defined, and it might as well be the one used when starting the <code class="code">gen_server</code> process through <code class="code">proc_lib</code>, and then be the one that calls <code class="code">enter_loop/3,4,5</code>. But if such a <code class="code">Module:init/1</code> function in for example error cases cannot call <code class="code">enter_loop/3,4,5</code>, it should return a value that follows the type specification for <code class="code">Module:init/1</code> such as <code class="code">ignore</code>, although that value will be lost when returning to the spawning function. </p> <p> This function fails if the calling process was not started by a <code class="code">proc_lib</code> start function, or if it is not registered according to <code class="code">ServerName</code>. </p> </div></article><article class="func"><h4 id="multi_call-2" onmouseover="document.getElementById('ghlink-multi_call-2-idp605').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-multi_call-2-idp605').style.visibility = 'hidden';">  <span class="title-name">multi_call(Name :: <code>atom()</code>, Request :: <code>term()</code>) -&gt;<br> {Replies :: [{Node :: <code>node()</code>, Reply :: <code>term()</code>}],<br> BadNodes :: [<code>node()</code>]}</span> </h4> <h4 id="multi_call-3" onmouseover="document.getElementById('ghlink-multi_call-3-idp606').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-multi_call-3-idp606').style.visibility = 'hidden';">  <span class="title-name">multi_call(Nodes :: [<code>node()</code>], Name :: <code>atom()</code>, Request :: <code>term()</code>) -&gt;<br> {Replies :: [{Node :: <code>node()</code>, Reply :: <code>term()</code>}],<br> BadNodes :: [<code>node()</code>]}</span> </h4> <h4 id="multi_call-4" onmouseover="document.getElementById('ghlink-multi_call-4-idp607').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-multi_call-4-idp607').style.visibility = 'hidden';">  <span class="title-name">multi_call(Nodes :: [<code>node()</code>],<br> Name :: <code>atom()</code>,<br> Request :: <code>term()</code>,<br> Timeout :: <code>timeout()</code>) -&gt;<br> {Replies :: [{Node :: <code>node()</code>, Reply :: <code>term()</code>}],<br> BadNodes :: [<code>node()</code>]}</span> </h4> <div class="exports-tube"> <p> Makes a synchronous call to all <code class="code">gen_server</code> processes locally registered as <code class="code">Name</code> at the specified nodes, by first sending the request to the nodes, and then waiting for the replies. The <code class="code">gen_server</code> processes on the nodes call <code><a href="#Module:handle_call-3"> <span class="code">Module:handle_call/3</span> </a></code> to handle the request. </p> <p> The function returns a tuple <code class="code">{Replies,BadNodes}</code>, where <code class="code">Replies</code> is a list of <code class="code">{Node,Reply}</code> tuples, and <code class="code">BadNodes</code> is a list of nodes that either did not exist, where <code class="code">Name</code> was not a registered <code class="code">gen_server</code>, or where it did not reply. </p> <p> <code class="code">Nodes</code> is a list of node names to which the request is to be sent. Default value is the list of all known nodes <code class="code">[node()|nodes()]</code>. </p> <p> <code class="code">Name</code> is the locally registered name for each <code class="code">gen_server</code> process. </p> <p> <code class="code">Request</code> is any term that is passed as the first argument to <code class="code">Module:handle_call/3</code>. </p> <p> <code class="code">Timeout</code> is an integer that specifies how many milliseconds to wait for all replies, or the atom <code class="code">infinity</code> to wait indefinitely, which is the default. If no reply is received from a node within the specified time, the node is added to <code class="code">BadNodes</code>. </p> <p> When a reply <code class="code">Reply</code> is received from the <code class="code">gen_server</code> process at a node <code class="code">Node</code>, <code class="code">{Node,Reply}</code> is added to <code class="code">Replies</code>. <code class="code">Reply</code> is passed from the return value of <code class="code">Module:handle_call/3</code>. </p> <div class="warning"> <div class="label">Warning</div> <div class="content">

<p> If one of the nodes cannot process monitors, for example, C or Java nodes, and the <code class="code">gen_server</code> process is not started when the requests are sent, but starts within 2 seconds, this function waits the whole <code class="code">Timeout</code>, which may be infinity. </p> <p>This problem does not exist if all nodes are Erlang nodes.</p> </div> </div> <p> To prevent late answers (after the time-out) from polluting the message queue of the caller, a middleman process is used to do the calls. Late answers are then discarded when they arrive to a terminated process. </p> </div></article><article class="func"><h4 id="receive_response-2" onmouseover="document.getElementById('ghlink-receive_response-2-idp608').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-receive_response-2-idp608').style.visibility = 'hidden';">  <span class="title-name">receive_response(ReqId, Timeout) -&gt; Result</span><div class="title-since"><span class="since">OTP 24.0</span></div> </h4>  <h2 id="types" class="func-types-title">Types</h2>      <div class="exports-tube"> <p> Receive a response corresponding to the request identifier <code class="code">ReqId</code>. The request must have been made by <code><a href="#send_request-2"><span class="code">send_request/2</span></a></code>, and it must have been made by the same process calling this function. </p> <p> <code class="code">Timeout</code> specifies how long to wait for a response. If no response is received within the specified time, the function returns <code class="code">timeout</code>. Assuming that the server executes on a node supporting aliases (introduced in OTP 24) the request will also be abandoned. That is, no response will be received after a timeout. Otherwise, a stray response might be received at a later time. </p> <p> The return value <code class="code">Reply</code> is passed from the return value of <code class="code">Module:handle_call/3</code>. </p> <p> The function returns an error if the <code class="code">gen_server</code> died before a reply was sent. </p> <p> The difference between <code class="code">receive_response/2</code> and <code><a href="#wait_response-2"><span class="code">wait_response/2</span></a></code> is that <code class="code">receive_response/2</code> abandons the request at timeout so that a potential future response is ignored, while <code class="code">wait_response/2</code> does not. </p> </div></article><article class="func"><h4 id="receive_response-3" onmouseover="document.getElementById('ghlink-receive_response-3-idp609').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-receive_response-3-idp609').style.visibility = 'hidden';">  <span class="title-name">receive_response(ReqIdCollection, Timeout, Delete) -&gt; Result</span><div class="title-since"><span class="since">OTP 25.0</span></div> </h4>  <h2 id="types" class="func-types-title">Types</h2>       <div class="exports-tube"> <p> Receive a response corresponding to a request identifier saved in <code class="code">ReqIdCollection</code>. All request identifiers of <code class="code">ReqIdCollection</code> must correspond to requests that have been made using <code><a href="#send_request-2"><span class="code">send_request/2</span></a></code> or <code><a href="#send_request-4"><span class="code">send_request/4</span></a></code>, and all request must have been made by the process calling this function. </p> <p> The <code class="code">Label</code> in the response equals the <code class="code">Label</code> associated with the request identifier that the response corresponds to. The <code class="code">Label</code> of a request identifier is associated when <code><a href="#reqids_add-3">adding the request id</a></code> in a request identifier collection, or when sending the request using <code><a href="#send_request-4"><span class="code">send_request/4</span></a></code>. </p> <p> Compared to <code><a href="#receive_response-2"><span class="code">receive_response/2</span></a></code>, the returned result associated with a specific request identifier will be wrapped in a 3-tuple. The first element of this tuple equals the value that would have been produced by <code class="code">receive_response/2</code>, the second element equals the <code class="code">Label</code> associated with the specific request identifier, and the third element <code class="code">NewReqIdCollection</code> is a possibly modified request identifier collection. </p> <p> If <code class="code">ReqIdCollection</code> is empty, the atom <code class="code">no_request</code> will be returned. </p> <p> <code class="code">Timeout</code> specifies how long to wait for a response. If no response is received within the specified time, the function returns <code class="code">timeout</code>. Assuming that the server executes on a node supporting aliases (introduced in OTP 24) all requests identified by <code class="code">ReqIdCollection</code> will also be abandoned. That is, no responses will be received after a timeout. Otherwise, stray responses might be received at a later time. </p> <p> The difference between <code class="code">receive_response/3</code> and <code><a href="#wait_response-3"><span class="code">wait_response/3</span></a></code> is that <code class="code">receive_response/3</code> abandons the requests at timeout so that potential future responses are ignored, while <code class="code">wait_response/3</code> does not. </p> <p> If <code class="code">Delete</code> equals <code class="code">true</code>, the association with <code class="code">Label</code> will have been deleted from <code class="code">ReqIdCollection</code> in the resulting <code class="code">NewReqIdCollection</code>. If <code class="code">Delete</code> equals <code class="code">false</code>, <code class="code">NewReqIdCollection</code> will equal <code class="code">ReqIdCollection</code>. Note that deleting an association is not for free and that a collection containing already handled requests can still be used by subsequent calls to <code class="code">receive_response/3</code>, <code><a href="#check_response-3"><span class="code">check_response/3</span></a></code>, and <code><a href="#wait_response-3"><span class="code">wait_response/3</span></a></code>. However, without deleting handled associations, the above calls will not be able to detect when there are no more outstanding requests to handle, so you will have to keep track of this some other way than relying on a <code class="code">no_request</code> return. Note that if you pass a collection only containing associations of already handled or abandoned requests to <code class="code">receive_response/3</code>, it will always block until a timeout determined by <code class="code">Timeout</code> is triggered. </p> </div></article><article class="func"><h4 id="reply-2" onmouseover="document.getElementById('ghlink-reply-2-idp610').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-reply-2-idp610').style.visibility = 'hidden';">  <span class="title-name">reply(Client :: <code><a href="#type-from">from()</a></code>, Reply :: <code>term()</code>) -&gt; ok</span> </h4> <div class="exports-tube"> <p> This function can be used by a <code class="code">gen_server</code> process to explicitly send a reply to a client that called <code><a href="#call-2"><span class="code">call/2,3</span></a></code> or <code><a href="#multi_call-2"><span class="code">multi_call/2,3,4</span></a></code>, when the reply cannot be passed in the return value of <code><a href="#Module:handle_call-3"> <span class="code">Module:handle_call/3</span></a></code>. </p> <p> <code class="code">Client</code> must be the <code class="code">From</code> argument provided to the <code class="code">handle_call</code> callback function. <code class="code">Reply</code> is any term passed back to the client as the return value of <code class="code">call/2,3</code> or <code class="code">multi_call/2,3,4</code>. </p> </div></article><article class="func"><h4 id="reqids_add-3" onmouseover="document.getElementById('ghlink-reqids_add-3-idp611').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-reqids_add-3-idp611').style.visibility = 'hidden';">  <span class="title-name">reqids_add(ReqId :: <code><a href="#type-request_id">request_id()</a></code>,<br> Label :: <code>term()</code>,<br> ReqIdCollection :: <code><a href="#type-request_id_collection">request_id_collection()</a></code>) -&gt;<br> NewReqIdCollection :: <code><a href="#type-request_id_collection">request_id_collection()</a></code></span><div class="title-since"><span class="since">OTP 25.0</span></div> </h4> <div class="exports-tube"> <p> Saves <code class="code">ReqId</code> and associates a <code class="code">Label</code> with the request identifier by adding this information to <code class="code">ReqIdCollection</code> and returning the resulting request identifier collection. </p> </div></article><article class="func"><h4 id="reqids_new-0" onmouseover="document.getElementById('ghlink-reqids_new-0-idp612').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-reqids_new-0-idp612').style.visibility = 'hidden';">  <span class="title-name">reqids_new() -&gt; NewReqIdCollection :: <code><a href="#type-request_id_collection">request_id_collection()</a></code></span><div class="title-since"><span class="since">OTP 25.0</span></div> </h4> <div class="exports-tube"> <p> Returns a new empty request identifier collection. A request identifier collection can be utilized in order the handle multiple outstanding requests. </p> <p> Request identifiers of requests made by <code><a href="#send_request-2"><span class="code">send_request/2</span></a></code> can be saved in a request identifier collection using <code><a href="#reqids_add-3"><span class="code">reqids_add/3</span></a></code>. Such a collection of request identifiers can later be used in order to get one response corresponding to a request in the collection by passing the collection as argument to <code><a href="#receive_response-3"><span class="code">receive_response/3</span></a></code>, <code><a href="#wait_response-3"><span class="code">wait_response/3</span></a></code>, or, <code><a href="#check_response-3"><span class="code">check_response/3</span></a></code>. </p> <p> <code><a href="#reqids_size-1"><span class="code">reqids_size/1</span></a></code> can be used to determine the amount of request identifiers in a request identifier collection. </p> </div></article><article class="func"><h4 id="reqids_size-1" onmouseover="document.getElementById('ghlink-reqids_size-1-idp613').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-reqids_size-1-idp613').style.visibility = 'hidden';">  <span class="title-name">reqids_size(ReqIdCollection :: <code><a href="#type-request_id_collection">request_id_collection()</a></code>) -&gt;<br> <code>integer() &gt;= 0</code></span><div class="title-since"><span class="since">OTP 25.0</span></div> </h4> <div class="exports-tube"> <p> Returns the amount of request identifiers saved in <code class="code">ReqIdCollection</code>. </p> </div></article><article class="func"><h4 id="reqids_to_list-1" onmouseover="document.getElementById('ghlink-reqids_to_list-1-idp614').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-reqids_to_list-1-idp614').style.visibility = 'hidden';">  <span class="title-name">reqids_to_list(ReqIdCollection :: <code><a href="#type-request_id_collection">request_id_collection()</a></code>) -&gt;<br> [{ReqId :: <code><a href="#type-request_id">request_id()</a></code>, Label :: <code>term()</code>}]</span><div class="title-since"><span class="since">OTP 25.0</span></div> </h4> <div class="exports-tube"> <p> Returns a list of <code class="code">{ReqId, Label}</code> tuples which corresponds to all request identifiers with their associated labels present in the <code class="code">ReqIdCollection</code> collection. </p> </div></article><article class="func"><h4 id="send_request-2" onmouseover="document.getElementById('ghlink-send_request-2-idp615').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-send_request-2-idp615').style.visibility = 'hidden';">  <span class="title-name">send_request(ServerRef :: <code><a href="#type-server_ref">server_ref()</a></code>, Request :: <code>term()</code>) -&gt;<br> ReqId :: <code><a href="#type-request_id">request_id()</a></code></span><div class="title-since"><span class="since">OTP 23.0</span></div> </h4> <div class="exports-tube"> <p> Sends an asynchronous <code class="code">call</code> request <code class="code">Request</code> to the <code class="code">gen_server</code> process identified by <code class="code">ServerRef</code> and returns a request identifier <code class="code">ReqId</code>. The return value <code class="code">ReqId</code> shall later be used with <code><a href="#receive_response-2"> <span class="code">receive_response/2</span></a></code>, <code><a href="#wait_response-2"> <span class="code">wait_response/2</span></a></code>, or <code><a href="#check_response-2"> <span class="code">check_response/2</span></a></code> to fetch the actual result of the request. Besides passing the request identifier directly to these functions, it can also be saved in a request identifier collection using <code><a href="#reqids_add-3"><span class="code">reqids_add/3</span></a></code>. Such a collection of request identifiers can later be used in order to get one response corresponding to a request in the collection by passing the collection as argument to <code><a href="#receive_response-3"><span class="code">receive_response/3</span></a></code>, <code><a href="#wait_response-3"><span class="code">wait_response/3</span></a></code>, or <code><a href="#check_response-3"><span class="code">check_response/3</span></a></code>. If you are about to save the request identifier in a request identifier collection, you may want to consider using <code><a href="#send_request-4"><span class="code">send_request/4</span></a></code> instead. </p> <p> The call <code class="code">gen_server:receive_response(gen_server:send_request(ServerRef, Request), Timeout)</code> can be seen as equivalent to <code><a href="#call-3"><span class="code">gen_server:call(ServerRef, Request, Timeout)</span></a></code>, ignoring the error handling. </p> <p> The <code class="code">gen_server</code> process calls <code><a href="#Module:handle_call-3"> <span class="code">Module:handle_call/3</span> </a></code> to handle the request. </p> <p> See the type <code><a href="#type-server_ref"><span class="code">server_ref()</span></a></code> for the possible values for <code class="code">ServerRef</code>. </p> <p> <code class="code">Request</code> is any term that is passed as the first argument to <code class="code">Module:handle_call/3</code>. </p> </div></article><article class="func"><h4 id="send_request-4" onmouseover="document.getElementById('ghlink-send_request-4-idp616').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-send_request-4-idp616').style.visibility = 'hidden';">  <span class="title-name">send_request(ServerRef :: <code><a href="#type-server_ref">server_ref()</a></code>,<br> Request :: <code>term()</code>,<br> Label :: <code>term()</code>,<br> ReqIdCollection :: <code><a href="#type-request_id_collection">request_id_collection()</a></code>) -&gt;<br> NewReqIdCollection :: <code><a href="#type-request_id_collection">request_id_collection()</a></code></span><div class="title-since"><span class="since">OTP 25.0</span></div> </h4> <div class="exports-tube"> <p> Sends an asynchronous <code class="code">call</code> request <code class="code">Request</code> to the <code class="code">gen_server</code> process identified by <code class="code">ServerRef</code>. The <code class="code">Label</code> will be associated with the request identifier of the operation and added to the returned request identifier collection <code class="code">NewReqIdCollection</code>. The collection can later be used in order to get one response corresponding to a request in the collection by passing the collection as argument to <code><a href="#receive_response-3"><span class="code">receive_response/3</span></a></code>, <code><a href="#wait_response-3"><span class="code">wait_response/3</span></a></code>, or, <code><a href="#check_response-3"><span class="code">check_response/3</span></a></code>. </p> <p> The same as calling <code><a href="#reqids_add-3"><span class="code">gen_server:reqids_add</span></a></code>(<code><a href="#send_request-2"><span class="code">gen_server:send_request</span></a></code><code class="code">(ServerRef, Request), Label, ReqIdCollection)</code>, but calling <code class="code">send_request/4</code> is slightly more efficient. </p> </div></article><article class="func"><h4 id="start-3" onmouseover="document.getElementById('ghlink-start-3-idp617').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-start-3-idp617').style.visibility = 'hidden';">  <span class="title-name">start(Module :: <code>module()</code>,<br> Args :: <code>term()</code>,<br> Options :: [<code><a href="#type-start_opt">start_opt()</a></code>]) -&gt;<br> <code><a href="#type-start_ret">start_ret()</a></code></span> </h4> <h4 id="start-4" onmouseover="document.getElementById('ghlink-start-4-idp618').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-start-4-idp618').style.visibility = 'hidden';">  <span class="title-name">start(ServerName :: <code><a href="#type-server_name">server_name()</a></code>,<br> Module :: <code>module()</code>,<br> Args :: <code>term()</code>,<br> Options :: [<code><a href="#type-start_opt">start_opt()</a></code>]) -&gt;<br> <code><a href="#type-start_ret">start_ret()</a></code></span> </h4> <div class="exports-tube"> <p> Creates a standalone <code class="code">gen_server</code> process, that is, a <code class="code">gen_server</code> process that is not part of a supervision tree and thus has no supervisor.</p> <p> Other than that see <code><a href="#start_link-3"><span class="code">start_link/3,4</span></a></code>. </p> </div></article><article class="func"><h4 id="start_link-3" onmouseover="document.getElementById('ghlink-start_link-3-idp619').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-start_link-3-idp619').style.visibility = 'hidden';">  <span class="title-name">start_link(Module :: <code>module()</code>,<br> Args :: <code>term()</code>,<br> Options :: [<code><a href="#type-start_opt">start_opt()</a></code>]) -&gt;<br> <code><a href="#type-start_ret">start_ret()</a></code></span> </h4> <h4 id="start_link-4" onmouseover="document.getElementById('ghlink-start_link-4-idp620').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-start_link-4-idp620').style.visibility = 'hidden';">  <span class="title-name">start_link(ServerName :: <code><a href="#type-server_name">server_name()</a></code>,<br> Module :: <code>module()</code>,<br> Args :: <code>term()</code>,<br> Options :: [<code><a href="#type-start_opt">start_opt()</a></code>]) -&gt;<br> <code><a href="#type-start_ret">start_ret()</a></code></span> </h4> <div class="exports-tube"> <p> Creates a <code class="code">gen_server</code> process as part of a supervision tree. This function is to be called, directly or indirectly, by the supervisor. For example, it ensures that the <code class="code">gen_server</code> process is linked to the supervisor. </p> <p> The <code class="code">gen_server</code> process calls <code><a href="#Module:init-1"><span class="code">Module:init/1</span></a></code> to initialize. To ensure a synchronized startup procedure, <code class="code">start_link/3,4</code> does not return until <code class="code">Module:init/1</code> has returned. </p> <p> Using the argument <code class="code">ServerName</code> creates a <code class="code">gen_server</code> with a registered name. See type <code><a href="#type-server_name"><span class="code">server_name()</span></a></code> for different name registrations. If no <code class="code">ServerName</code> is provided, the <code class="code">gen_server</code> process is not registered. </p> <p> <code class="code">Module</code> is the name of the callback module. </p> <p> <code class="code">Args</code> is any term that is passed as the argument to <code><a href="#Module:init-1"><span class="code">Module:init/1</span></a></code>. </p> <p> See type <code><a href="#type-start_opt"><span class="code">start_opt()</span></a></code> for <code class="code">Options</code> when starting the <code class="code">gen_server</code> process. </p> <p> See type <code><a href="#type-start_ret"><span class="code">start_ret()</span></a></code> for a description this function's return values. </p> </div></article><article class="func"><h4 id="start_monitor-3" onmouseover="document.getElementById('ghlink-start_monitor-3-idp621').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-start_monitor-3-idp621').style.visibility = 'hidden';">  <span class="title-name">start_monitor(Module :: <code>module()</code>,<br> Args :: <code>term()</code>,<br> Options :: [<code><a href="#type-start_opt">start_opt()</a></code>]) -&gt;<br> <code><a href="#type-start_mon_ret">start_mon_ret()</a></code></span><div class="title-since"><span class="since">OTP 23.0</span></div> </h4> <h4 id="start_monitor-4" onmouseover="document.getElementById('ghlink-start_monitor-4-idp622').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-start_monitor-4-idp622').style.visibility = 'hidden';">  <span class="title-name">start_monitor(ServerName :: <code><a href="#type-server_name">server_name()</a></code>,<br> Module :: <code>module()</code>,<br> Args :: <code>term()</code>,<br> Options :: [<code><a href="#type-start_opt">start_opt()</a></code>]) -&gt;<br> <code><a href="#type-start_mon_ret">start_mon_ret()</a></code></span><div class="title-since"><span class="since">OTP 23.0</span></div> </h4> <div class="exports-tube"> <p> Creates a standalone <code class="code">gen_server</code> process, that is, a <code class="code">gen_server</code> process that is not part of a supervision tree (and thus has no supervisor) and atomically sets up a monitor to the newly created server. </p> <p> Other than that see <code><a href="#start_link-3"><span class="code">start_link/3,4</span></a></code>. Note that the return value for a successful start differs in that it returns a monitor <code class="code">reference</code>. See type <code><a href="#type-start_mon_ret"><span class="code">start_mon_ret()</span></a></code>. </p> <p> If the start is not successful, the caller will be blocked until the monitor's <code class="code">'DOWN'</code> message has been received and removed from the message queue. </p> </div></article><article class="func"><h4 id="stop-1" onmouseover="document.getElementById('ghlink-stop-1-idp623').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-stop-1-idp623').style.visibility = 'hidden';">  <span class="title-name">stop(ServerRef :: <code><a href="#type-server_ref">server_ref()</a></code>) -&gt; ok</span><div class="title-since"><span class="since">OTP 18.0</span></div> </h4> <h4 id="stop-3" onmouseover="document.getElementById('ghlink-stop-3-idp624').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-stop-3-idp624').style.visibility = 'hidden';">  <span class="title-name">stop(ServerRef :: <code><a href="#type-server_ref">server_ref()</a></code>,<br> Reason :: <code>term()</code>,<br> Timeout :: <code>timeout()</code>) -&gt;<br> ok</span><div class="title-since"><span class="since">OTP 18.0</span></div> </h4> <div class="exports-tube"> <p> Orders the generic server specified by <code class="code">ServerRef</code> to exit with the specified <code class="code">Reason</code>, default 'normal', and waits for it to terminate. The <code class="code">gen_server</code> process calls <code><a href="#Module:terminate-2"> <span class="code">Module:terminate/2</span> </a></code> before exiting. </p> <p> The function returns <code class="code">ok</code> if the server terminates with the expected reason. Any other reason than <code class="code">normal</code>, <code class="code">shutdown</code>, or <code class="code">{shutdown,Term}</code> causes an error report to be issued using <code><span class="code">logger(3)</span></code>. An exit signal with the same reason is sent to linked processes and ports. </p> <p> <code class="code">Timeout</code> is an integer that specifies how many milliseconds to wait for the server to terminate, or the atom <code class="code">infinity</code> to wait indefinitely, which is the default. If the server has not terminated within the specified time, the call exits the calling process with reason <code class="code">timeout</code>. </p> <p> If the process does not exist, the call exits the calling process with reason <code class="code">noproc</code>, and with reason <code class="code">{nodedown,Node}</code> if the connection fails to the remote <code class="code">Node</code> where the server runs. </p> </div></article><article class="func"><h4 id="wait_response-2" onmouseover="document.getElementById('ghlink-wait_response-2-idp625').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-wait_response-2-idp625').style.visibility = 'hidden';">  <span class="title-name">wait_response(ReqId, WaitTime) -&gt; Result</span><div class="title-since"><span class="since">OTP 23.0</span></div> </h4>  <h2 id="types" class="func-types-title">Types</h2>      <div class="exports-tube"> <p> Wait for a response corresponding to the request identifier <code class="code">ReqId</code>. The request must have been made by <code><a href="#send_request-2"><span class="code">send_request/2</span></a></code>, and it must have been made by the same process calling this function. </p> <p> <code class="code">WaitTime</code> specifies how long to wait for a reply. If no reply is received within the specified time, the function returns <code class="code">timeout</code> and no cleanup is done, and thus the function can be invoked repeatedly until a reply is returned. </p> <p> The return value <code class="code">Reply</code> is passed from the return value of <code class="code">Module:handle_call/3</code>. </p> <p> The function returns an error if the <code class="code">gen_server</code> died before a reply was sent. </p> <p> The difference between <code><a href="#receive_response-2"><span class="code">receive_response/2</span></a></code> and <code class="code">wait_response/2</code> is that <code class="code">receive_response/2</code> abandons the request at time-out so that a potential future response is ignored, while <code class="code">wait_response/2</code> does not. </p> </div></article><article class="func"><h4 id="wait_response-3" onmouseover="document.getElementById('ghlink-wait_response-3-idp626').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-wait_response-3-idp626').style.visibility = 'hidden';">  <span class="title-name">wait_response(ReqIdCollection, WaitTime, Delete) -&gt; Result</span><div class="title-since"><span class="since">OTP 25.0</span></div> </h4>  <h2 id="types" class="func-types-title">Types</h2>       <div class="exports-tube"> <p> Wait for a response corresponding to a request identifier saved in <code class="code">ReqIdCollection</code>. All request identifiers of <code class="code">ReqIdCollection</code> must correspond to requests that have been made using <code><a href="#send_request-2"><span class="code">send_request/2</span></a></code> or <code><a href="#send_request-4"><span class="code">send_request/4</span></a></code>, and all request must have been made by the process calling this function. </p> <p> The <code class="code">Label</code> in the response equals the <code class="code">Label</code> associated with the request identifier that the response corresponds to. The <code class="code">Label</code> of a request identifier is associated when <code><a href="#reqids_add-3">saving the request id</a></code> in a request identifier collection, or when sending the request using <code><a href="#send_request-4"><span class="code">send_request/4</span></a></code>. </p> <p> Compared to <code><a href="#wait_response-2"><span class="code">wait_response/2</span></a></code>, the returned result associated with a specific request identifier or an exception associated with a specific request identifier will be wrapped in a 3-tuple. The first element of this tuple equals the value that would have been produced by <code class="code">wait_response/2</code>, the second element equals the <code class="code">Label</code> associated with the specific request identifier, and the third element <code class="code">NewReqIdCollection</code> is a possibly modified request identifier collection. </p> <p> If <code class="code">ReqIdCollection</code> is empty, <code class="code">no_request</code> will be returned. If no response is received before the <code class="code">WaitTime</code> timeout has triggered, the atom <code class="code">timeout</code> is returned. It is valid to continue waiting for a response as many times as needed up until a response has been received and completed by <code class="code">check_response()</code>, <code class="code">receive_response()</code>, or <code class="code">wait_response()</code>. </p> <p> The difference between <code><a href="#receive_response-3"><span class="code">receive_response/3</span></a></code> and <code class="code">wait_response/3</code> is that <code class="code">receive_response/3</code> abandons requests at timeout so that a potential future responses are ignored, while <code class="code">wait_response/3</code> does not. </p> <p> If <code class="code">Delete</code> equals <code class="code">true</code>, the association with <code class="code">Label</code> will have been deleted from <code class="code">ReqIdCollection</code> in the resulting <code class="code">NewReqIdCollection</code>. If <code class="code">Delete</code> equals <code class="code">false</code>, <code class="code">NewReqIdCollection</code> will equal <code class="code">ReqIdCollection</code>. Note that deleting an association is not for free and that a collection containing already handled requests can still be used by subsequent calls to <code class="code">wait_response/3</code>, <code><a href="#check_response-3"><span class="code">check_response/3</span></a></code>, and <code><a href="#receive_response-3"><span class="code">receive_response/3</span></a></code>. However, without deleting handled associations, the above calls will not be able to detect when there are no more outstanding requests to handle, so you will have to keep track of this some other way than relying on a <code class="code">no_request</code> return. Note that if you pass a collection only containing associations of already handled or abandoned requests to <code class="code">wait_response/3</code>, it will always block until a timeout determined by <code class="code">WaitTime</code> is triggered and then return <code class="code">no_reply</code>. </p> </div></article> </div> <section class="innertube"><h2 id="callback-functions" class="title-link" onmouseover="document.getElementById('ghlink-callback-functions-idm14772').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-callback-functions-idm14772').style.visibility = 'hidden';"> <div class="title-name">Callback Functions</div>  </h2>  <p>The following functions are to be exported from a <code class="code">gen_server</code> callback module.</p> </section><div class="innertube"><h2 id="export" class="title-link" onmouseover="document.getElementById('ghlink-export-idm14771').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-export-idm14771').style.visibility = 'hidden';"> <div class="title-name">Exports</div>  </h2></div> <div class="exports-body"> <article class="func"><div><h4 id="Module:code_change-3" class="title-link" onmouseover="document.getElementById('ghlink-Module:code_change-3-idm14777').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-Module:code_change-3-idm14777').style.visibility = 'hidden';">  <div class="title-name">Module:code_change(OldVsn, State, Extra) -&gt; {ok, NewState} | {error, Reason}</div> </h4></div> <div class="exports-tube">  <h2 id="types" class="func-types-title">Types</h2>        <div class="note"> <div class="label">Note</div> <div class="content">

<p>This callback is optional, so callback modules need not export it. If a release upgrade/downgrade with <code class="code">Change={advanced,Extra}</code> specified in the <code class="code">appup</code> file is made when <code class="code">code_change/3</code> isn't implemented the process will crash with an <code class="code">undef</code> exit reason.</p> </div> </div> <p>This function is called by a <code class="code">gen_server</code> process when it is to update its internal state during a release upgrade/downgrade, that is, when the instruction <code class="code">{update,Module,Change,...}</code>, where <code class="code">Change={advanced,Extra}</code>, is specifed in the <code class="code">appup</code> file. For more information, see section <code> Release Handling Instructions</code> in OTP Design Principles.</p> <p>For an upgrade, <code class="code">OldVsn</code> is <code class="code">Vsn</code>, and for a downgrade, <code class="code">OldVsn</code> is <code class="code">{down,Vsn}</code>. <code class="code">Vsn</code> is defined by the <code class="code">vsn</code> attribute(s) of the old version of the callback module <code class="code">Module</code>. If no such attribute is defined, the version is the checksum of the Beam file.</p> <p><code class="code">State</code> is the internal state of the <code class="code">gen_server</code> process.</p> <p><code class="code">Extra</code> is passed "as is" from the <code class="code">{advanced,Extra}</code> part of the update instruction.</p> <p>If successful, the function must return the updated internal state.</p> <p>If the function returns <code class="code">{error,Reason}</code>, the ongoing upgrade fails and rolls back to the old release.</p>  </div></article><article class="func"><div><h4 id="Module:format_status-1" class="title-link" onmouseover="document.getElementById('ghlink-Module:format_status-1-idm14816').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-Module:format_status-1-idm14816').style.visibility = 'hidden';">  <div class="title-name">Module:format_status(Status) -&gt; NewStatus</div> <div class="title-since"><span class="since">OTP 25.0</span></div> </h4></div> <div class="exports-tube">  <h2 id="types" class="func-types-title">Types</h2>          <div class="note"> <div class="label">Note</div> <div class="content">

<p>This callback is optional, so callback modules need not export it. The <code class="code">gen_server</code> module provides a default implementation of this function that returns the callback module state.</p> <p> If this callback is exported but fails, to hide possibly sensitive data, the default function will instead return the fact that <code class="code">format_status/1</code> has crashed.</p> </div> </div> <p>This function is called by a <code class="code">gen_server</code> process in the following situations:</p> <ul> <li> <p><code><a href="sys#get_status-1"><span class="code">sys:get_status/1,2</span></a></code> is invoked to get the <code class="code">gen_server</code> status.</p> </li> <li> <p>The <code class="code">gen_server</code> process terminates abnormally and logs an error.</p> </li> </ul> <p>This callback is to be used to limit the status of the process before returned by <code><a href="sys#get_status-1"><span class="code">sys:get_status/1,2</span></a></code> or sent to <code><span class="code">logger</span></code>. The status of the server is passed as a map with the following associations: </p> <dl> <dt><strong><code class="code">state =&gt; term()</code></strong></dt> <dd>The internal state of the <code class="code">gen_server</code> process.</dd> <dt><strong><code class="code">message =&gt; term()</code></strong></dt> <dd>The message that caused the server to terminate.</dd> <dt><strong><code class="code">reason =&gt; term()</code></strong></dt> <dd>The reason that caused the server to terminate.</dd> <dt><strong><code class="code">log =&gt; [</code><code><a href="sys#type-system_event"><span class="code">sys:system_event/0</span></a></code><code class="code">]</code></strong></dt> <dd>The <code><a href="sys#log-2">sys log</a></code> of the server.</dd> </dl> <p>New associations may be added into the status map without prior notice.</p> <p>The function is to return <code class="code">NewStatus</code>, a map containing the same associations as the input map.</p> <p>Two possible use cases for this callback is to either remove sensitive information from the state so that it not printed in log files, or to remove large irrelevant terms of state that do clutter the logs.</p> <p>Example:</p> <pre data-language="erlang">format_status(Status) -&gt;
  maps:map(
    fun(state,State) -&gt;
            maps:remove(private_key, State);
       (message,{password, _Pass}) -&gt;
            {password, removed};
       (_,Value) -&gt;
            Value
    end, Status).</pre>  </div></article><article class="func"><div><h4 id="Module:format_status-2" class="title-link" onmouseover="document.getElementById('ghlink-Module:format_status-2-idm14875').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-Module:format_status-2-idm14875').style.visibility = 'hidden';">  <div class="title-name">Module:format_status(Opt, [PDict, State]) -&gt; Status</div> <div class="title-since"><span class="since">OTP R13B04</span></div> </h4></div> <div class="exports-tube">  <h2 id="types" class="func-types-title">Types</h2>       <div class="warning"> <div class="label">Warning</div> <div class="content">

<p>This callback is deprecated, in new code use <code><a href="#Module:format_status-1"> format_status/1</a></code>. If a <code><a href="#Module:format_status-1">format_status/1</a></code> callback exists, then this function will never be called.</p> </div> </div> <div class="note"> <div class="label">Note</div> <div class="content">

<p>This callback is optional, so callback modules need not export it. The <code class="code">gen_server</code> module provides a default implementation of this function that returns the callback module state.</p> </div> </div> <p>This function is called by a <code class="code">gen_server</code> process in the following situations:</p> <ul> <li> <p>One of <code><a href="sys#get_status-1"> <span class="code">sys:get_status/1,2</span></a></code> is invoked to get the <code class="code">gen_server</code> status. <code class="code">Opt</code> is set to the atom <code class="code">normal</code>.</p> </li> <li> <p>The <code class="code">gen_server</code> process terminates abnormally and logs an error. <code class="code">Opt</code> is set to the atom <code class="code">terminate</code>.</p> </li> </ul> <p>This function is useful for changing the form and appearance of the <code class="code">gen_server</code> status for these cases. A callback module wishing to change the <code class="code">sys:get_status/1,2</code> return value, as well as how its status appears in termination error logs, exports an instance of <code class="code">format_status/2</code> that returns a term describing the current status of the <code class="code">gen_server</code> process.</p> <p><code class="code">PDict</code> is the current value of the process dictionary of the <code class="code">gen_server</code> process..</p> <p><code class="code">State</code> is the internal state of the <code class="code">gen_server</code> process.</p> <p>The function is to return <code class="code">Status</code>, a term that changes the details of the current state and status of the <code class="code">gen_server</code> process. There are no restrictions on the form <code class="code">Status</code> can take, but for the <code class="code">sys:get_status/1,2</code> case (when <code class="code">Opt</code> is <code class="code">normal</code>), the recommended form for the <code class="code">Status</code> value is <code class="code">[{data, [{"State", Term}]}]</code>, where <code class="code">Term</code> provides relevant details of the <code class="code">gen_server</code> state. Following this recommendation is not required, but it makes the callback module status consistent with the rest of the <code class="code">sys:get_status/1,2</code> return value.</p> <p>One use for this function is to return compact alternative state representations to avoid that large state terms are printed in log files.</p>  </div></article><article class="func"><div><h4 id="Module:handle_call-3" class="title-link" onmouseover="document.getElementById('ghlink-Module:handle_call-3-idm14931').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-Module:handle_call-3-idm14931').style.visibility = 'hidden';">  <div class="title-name">Module:handle_call(Request, From, State) -&gt; Result</div> </h4></div> <div class="exports-tube">  <h2 id="types" class="func-types-title">Types</h2>                     <p>Whenever a <code class="code">gen_server</code> process receives a request sent using <code><a href="#call-2"><span class="code">call/2,3</span></a></code> or <code><a href="#multi_call-2"><span class="code">multi_call/2,3,4</span></a></code>, this function is called to handle the request.</p> <p><code class="code">State</code> is the internal state of the <code class="code">gen_server</code> process, and <code class="code">NewState</code> a possibly updated one.</p> <p><code class="code">Request</code> is passed from the same argument provided to <code class="code">call</code> or <code class="code">multi_call</code>.</p> <p>The return value <code class="code">Result</code> is interpreted as follows:</p> <dl> <dt><strong> <code class="code">{reply,Reply,NewState}</code><br> <code class="code">{reply,Reply,NewState,_}</code> </strong></dt> <dd> <p> The <code class="code">Reply</code> value is sent back to the client request and there becomes its return value. </p> <p> The <code class="code">gen_server</code> process continues executing with the possibly updated internal state <code class="code">NewState</code>. </p> </dd> <dt><strong> <code class="code">{noreply,NewState}</code><br> <code class="code">{noreply,NewState,_}</code> </strong></dt> <dd> <p> The <code class="code">gen_server</code> process continues executing with the possibly updated internal state <code class="code">NewState</code>. </p> <p> A reply to the client request has to be created by calling <code><a href="#reply-2"><span class="code">reply(From, Reply)</span></a></code>, either in this or in a later callback. </p> </dd> <dt><strong> <code class="code">{reply,_,_,Timeout}</code><br> <code class="code">{noreply,_,Timeout}</code> </strong></dt> <dd> <p> If an integer <code class="code">Timeout</code> is provided, a time-out occurs unless a request or a message is received within that many milliseconds. A time-out is represented by the atom <code class="code">timeout</code> to be handled by the <code><a href="#Module:handle_info-2"> <span class="code">Module:handle_info/2</span> </a></code> callback function. <code class="code">Timeout =:= infinity</code> can be used to wait indefinitely, which is the same as returning a value without a <code class="code">Timeout</code> member. </p> </dd> <dt><strong> <code class="code">{reply,_,_,hibernate}</code><br> <code class="code">{noreply,_,hibernate}</code> </strong></dt> <dd> <p> The process goes into hibernation waiting for the next message to arrive (by calling <code><a href="proc_lib#hibernate-3"> <span class="code">proc_lib:hibernate/3</span></a></code>). </p> </dd> <dt><strong> <code class="code">{reply,_,_,{continue,Continue}}</code><br> <code class="code">{noreply,_,{continue,Continue}}</code> </strong></dt> <dd> <p> The process will execute the <code><a href="#Module:handle_continue-2"> <span class="code">Module:handle_continue/2</span> </a></code> callback function, with <code class="code">Continue</code> as the first argument. </p> </dd> <dt><strong> <code class="code">{stop,Reason,NewState}</code><br> <code class="code">{stop,Reason,Reply,NewState}</code> </strong></dt> <dd> <p> The <code class="code">gen_server</code> process will call <code><a href="#Module:terminate-2"> <span class="code">Module:terminate(Reason,NewState)</span> </a></code> and then terminate. </p> <p> <code class="code">{stop,_,Reply,_}</code> will create a reply to the client request just as <code class="code">{reply,Reply,...}</code> while <code class="code">{stop,_,_}</code> will not, so just as for <code class="code">{noreply,NewState,...}</code> a reply has to be created by calling <code class="code">reply(From, Reply)</code> before returning <code class="code">{stop,_,_}</code>. </p> </dd> </dl>  </div></article><article class="func"><div><h4 id="Module:handle_cast-2" class="title-link" onmouseover="document.getElementById('ghlink-Module:handle_cast-2-idm15039').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-Module:handle_cast-2-idm15039').style.visibility = 'hidden';">  <div class="title-name">Module:handle_cast(Request, State) -&gt; Result</div> </h4></div> <div class="exports-tube">  <h2 id="types" class="func-types-title">Types</h2>              <p>Whenever a <code class="code">gen_server</code> process receives a request sent using <code><a href="#cast-2"><span class="code">cast/2</span></a></code> or <code><a href="#abcast-2"><span class="code">abcast/2,3</span></a></code>, this function is called to handle the request.</p> <p>For a description of the arguments and possible return values, see <code><a href="#Module:handle_call-3"> <span class="code">Module:handle_call/3</span></a></code>.</p>  </div></article><article class="func"><div><h4 id="Module:handle_continue-2" class="title-link" onmouseover="document.getElementById('ghlink-Module:handle_continue-2-idm15065').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-Module:handle_continue-2-idm15065').style.visibility = 'hidden';">  <div class="title-name">Module:handle_continue(Continue, State) -&gt; Result</div> <div class="title-since"><span class="since">OTP 21.0</span></div> </h4></div> <div class="exports-tube">  <h2 id="types" class="func-types-title">Types</h2>              <div class="note"> <div class="label">Note</div> <div class="content">

<p>This callback is optional, so callback modules need to export it only if they return one of the tuples containing <code class="code">{continue,Continue}</code> from another callback. If such a <code class="code">{continue,_}</code> tuple is used and the callback is not implemented, the process will exit with <code class="code">undef</code> error.</p> </div> </div> <p>This function is called by a <code class="code">gen_server</code> process whenever a previous callback returns one of the tuples containing <code class="code">{continue, Continue}</code>. <code class="code">handle_continue/2</code> is invoked immediately after the previous callback, which makes it useful for performing work after initialization or for splitting the work in a callback in multiple steps, updating the process state along the way.</p> <p>For a description of the other arguments and possible return values, see <code><a href="#Module:handle_call-3"> <span class="code">Module:handle_call/3</span></a></code>.</p>  </div></article><article class="func"><div><h4 id="Module:handle_info-2" class="title-link" onmouseover="document.getElementById('ghlink-Module:handle_info-2-idm15094').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-Module:handle_info-2-idm15094').style.visibility = 'hidden';">  <div class="title-name">Module:handle_info(Info, State) -&gt; Result</div> </h4></div> <div class="exports-tube">  <h2 id="types" class="func-types-title">Types</h2>             <div class="note"> <div class="label">Note</div> <div class="content">

<p>This callback is optional, so callback modules need not export it. The <code class="code">gen_server</code> module provides a default implementation of this function that logs about the unexpected <code class="code">Info</code> message, drops it and returns <code class="code">{noreply, State}</code>.</p> </div> </div> <p>This function is called by a <code class="code">gen_server</code> process when a time-out occurs or when it receives any other message than a synchronous or asynchronous request (or a system message).</p> <p><code class="code">Info</code> is either the atom <code class="code">timeout</code>, if a time-out has occurred, or the received message.</p> <p>For a description of the other arguments and possible return values, see <code><a href="#Module:handle_call-3"> <span class="code">Module:handle_call/3</span></a></code>.</p>  </div></article><article class="func"><div><h4 id="Module:init-1" class="title-link" onmouseover="document.getElementById('ghlink-Module:init-1-idm15123').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-Module:init-1-idm15123').style.visibility = 'hidden';">  <div class="title-name">Module:init(Args) -&gt; Result</div> </h4></div> <div class="exports-tube">  <h2 id="types" class="func-types-title">Types</h2>             <p>Whenever a <code class="code">gen_server</code> process is started using <code><a href="#start-3"><span class="code">start/3,4</span></a></code>, <code><a href="#start_monitor-3"><span class="code">start_monitor/3,4</span></a></code>, or <code><a href="#start_link-3"><span class="code">start_link/3,4</span></a></code>, this function is called by the new process to initialize.</p> <p><code class="code">Args</code> is the <code class="code">Args</code> argument provided to the start function.</p> <p>The return value <code class="code">Result</code> is interpreted as follows:</p> <dl> <dt><strong> <code class="code">{ok,State}</code><br> <code class="code">{ok,State,_}</code> </strong></dt> <dd> <p> Initialization was succesful and <code class="code">State</code> is the internal state of the <code class="code">gen_server</code> process. </p> </dd> <dt><strong> <code class="code">{ok,_,Timeout}</code><br> <code class="code">{ok,_,hibernate}</code><br> <code class="code">{ok,_,{continue,Continue}}</code> </strong></dt> <dd> <p> See the corresponding return values from <code><a href="#Module:handle_call-3"> <span class="code">Module:handle_call/3</span> </a></code> for a description of this tuple member. </p> </dd> <dt><strong> <code class="code">{stop,Reason}</code><br> <code class="code">ignore</code> </strong></dt> <dd> <p> Initialization failed. An exit signal with this <code class="code">Reason</code> (or with reason <code class="code">normal</code> if <code class="code">ignore</code> is returned) is sent to linked processes and ports, notably to the process starting the gen_server when <code><a href="#start_link-3"> <span class="code">start_link/3,4</span> </a></code> is used. </p> </dd> </dl>  </div></article><article class="func"><div><h4 id="Module:terminate-2" class="title-link" onmouseover="document.getElementById('ghlink-Module:terminate-2-idm15182').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-Module:terminate-2-idm15182').style.visibility = 'hidden';">  <div class="title-name">Module:terminate(Reason, State)</div> </h4></div> <div class="exports-tube">  <h2 id="types" class="func-types-title">Types</h2>     <div class="note"> <div class="label">Note</div> <div class="content">

<p>This callback is optional, so callback modules need not export it. The <code class="code">gen_server</code> module provides a default implementation without cleanup.</p> </div> </div> <p>This function is called by a <code class="code">gen_server</code> process when it is about to terminate. It is to be the opposite of <code><a href="#Module:init-1"><span class="code">Module:init/1</span></a></code> and do any necessary cleaning up. When it returns, the <code class="code">gen_server</code> process terminates with <code class="code">Reason</code>. The return value is ignored.</p> <p><code class="code">Reason</code> is a term denoting the stop reason and <code class="code">State</code> is the internal state of the <code class="code">gen_server</code> process.</p> <p><code class="code">Reason</code> depends on why the <code class="code">gen_server</code> process is terminating. If it is because another callback function has returned a stop tuple <code class="code">{stop,..}</code>, <code class="code">Reason</code> has the value specified in that tuple. If it is because of a failure, <code class="code">Reason</code> is the error reason.</p> <p>If the <code class="code">gen_server</code> process is part of a supervision tree and is ordered by its supervisor to terminate, this function is called with <code class="code">Reason=shutdown</code> if the following conditions apply:</p> <ul> <li> <p>The <code class="code">gen_server</code> process has been set to trap exit signals.</p> </li> <li> <p>The shutdown strategy as defined in the child specification of the supervisor is an integer time-out value, not <code class="code">brutal_kill</code>.</p> </li> </ul> <p>Even if the <code class="code">gen_server</code> process is <strong>not</strong> part of a supervision tree, this function is called if it receives an <code class="code">'EXIT'</code> message from its parent. <code class="code">Reason</code> is the same as in the <code class="code">'EXIT'</code> message.</p> <p>Otherwise, the <code class="code">gen_server</code> process terminates immediately.</p> <p> Notice that for any other reason than <code class="code">normal</code>, <code class="code">shutdown</code>, or <code class="code">{shutdown,Term}</code>, see <code><a href="#stop-3"><span class="code">stop/3</span></a></code>, the <code class="code">gen_server</code> process is assumed to terminate because of an error, and an error report is issued using <code><span class="code">logger(3)</span></code>. </p> <p>When the gen_server process exits, an exit signal with the same reason is sent to linked processes and ports.</p>  </div></article> </div> <section class="innertube"><h2 id="see-also" class="title-link" onmouseover="document.getElementById('ghlink-see-also-idm15235').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-see-also-idm15235').style.visibility = 'hidden';"> <div class="title-name">See Also</div>  </h2>  <p><code><a href="gen_event"><span class="code">gen_event(3)</span></a></code>, <code><a href="gen_statem"><span class="code">gen_statem(3)</span></a></code>, <code><a href="proc_lib"><span class="code">proc_lib(3)</span></a></code>, <code><a href="supervisor"><span class="code">supervisor(3)</span></a></code>, <code><a href="sys"><span class="code">sys(3)</span></a></code></p> </section> <div class="footer"> <hr> <p>Copyright © 1997-2022 Ericsson AB. All Rights Reserved.</p> </div><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2010&ndash;2022 Ericsson AB<br>Licensed under the Apache License, Version 2.0.<br>
    
  </p>
</div>
