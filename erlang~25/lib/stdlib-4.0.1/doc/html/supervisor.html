  <div class="innertube"> <h2 id="module" class="title-link" onmouseover="document.getElementById('ghlink-module-idm31662').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-module-idm31662').style.visibility = 'hidden';"> <div class="title-name">Module</div>  </h2> <p class="REFBODY module-body">supervisor</p> </div> <div class="innertube"> <h2 id="module-summary" class="title-link" onmouseover="document.getElementById('ghlink-module-summary-idm31663').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-module-summary-idm31663').style.visibility = 'hidden';"> <div class="title-name">Module Summary</div>  </h2> <p class="REFBODY module-summary-body">Generic supervisor behavior.</p> </div> <section class="description"><div class="innertube"> <h2 id="description" class="title-link" onmouseover="document.getElementById('ghlink-description-idm31664').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-description-idm31664').style.visibility = 'hidden';"> <div class="title-name">Description</div>  </h2> 
<p>This behavior module provides a supervisor, a process that supervises other processes called child processes. A child process can either be another supervisor or a worker process. Worker processes are normally implemented using one of the <code><a href="gen_event"><span class="code">gen_event</span></a></code>, <code><a href="gen_server"><span class="code">gen_server</span></a></code>, or <code><a href="gen_statem"><span class="code">gen_statem</span></a></code> behaviors. A supervisor implemented using this module has a standard set of interface functions and include functionality for tracing and error reporting. Supervisors are used to build a hierarchical process structure called a supervision tree, a nice way to structure a fault-tolerant application. For more information, see <code> Supervisor Behaviour</code> in OTP Design Principles.</p> <p>A supervisor expects the definition of which child processes to supervise to be specified in a callback module exporting a predefined set of functions.</p> <p>Unless otherwise stated, all functions in this module fail if the specified supervisor does not exist or if bad arguments are specified.</p>  </div></section> <section class="innertube"><h2 id="supervision-principles" class="title-link" onmouseover="document.getElementById('ghlink-supervision-principles-idm31675').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-supervision-principles-idm31675').style.visibility = 'hidden';"> <div class="title-name">Supervision Principles</div>  </h2>  <p>The supervisor is responsible for starting, stopping, and monitoring its child processes. The basic idea of a supervisor is that it must keep its child processes alive by restarting them when necessary.</p> <p>The children of a supervisor are defined as a list of <strong>child specifications</strong>. When the supervisor is started, the child processes are started in order from left to right according to this list. When the supervisor terminates, it first terminates its child processes in reversed start order, from right to left.</p> <section><h4 id="Supervisor flags">Supervisor flags</h4>   <p id="sup_flags">The supervisor properties are defined by the supervisor flags. The type definition for the supervisor flags is as follows:</p> <pre data-language="erlang">
sup_flags() = #{strategy =&gt; strategy(),           % optional
                intensity =&gt; non_neg_integer(),   % optional
                period =&gt; pos_integer(),          % optional
                auto_shutdown =&gt; auto_shutdown()} % optional</pre> <h5>Restart Strategies</h5> <p>A supervisor can have one of the following <strong>restart strategies</strong> specified with the <code class="code">strategy</code> key in the above map:</p> <ul> <li> <p><code class="code">one_for_one</code> - If one child process terminates and is to be restarted, only that child process is affected. This is the default restart strategy.</p> </li> <li> <p><code class="code">one_for_all</code> - If one child process terminates and is to be restarted, all other child processes are terminated and then all child processes are restarted.</p> </li> <li> <p><code class="code">rest_for_one</code> - If one child process terminates and is to be restarted, the 'rest' of the child processes (that is, the child processes after the terminated child process in the start order) are terminated. Then the terminated child process and all child processes after it are restarted.</p> </li> <li> <p><code class="code">simple_one_for_one</code> - A simplified <code class="code">one_for_one</code> supervisor, where all child processes are dynamically added instances of the same process type, that is, running the same code.</p> <p>Functions <code><a href="#delete_child-2"><span class="code">delete_child/2</span></a></code> and <code><a href="#restart_child-2"><span class="code">restart_child/2</span></a></code> are invalid for <code class="code">simple_one_for_one</code> supervisors and return <code class="code">{error,simple_one_for_one}</code> if the specified supervisor uses this restart strategy.</p> <p>Function <code><a href="#terminate_child-2"> <span class="code">terminate_child/2</span></a></code> can be used for children under <code class="code">simple_one_for_one</code> supervisors by specifying the child's <code class="code">pid()</code> as the second argument. If instead the child specification identifier is used, <code class="code">terminate_child/2</code> return <code class="code">{error,simple_one_for_one}</code>.</p> <p>As a <code class="code">simple_one_for_one</code> supervisor can have many children, it shuts them all down asynchronously. This means that the children do their cleanup in parallel, and therefore the order in which they are stopped is not defined.</p> </li> </ul> <h5>Restart intensity and period</h5> <p>To prevent a supervisor from getting into an infinite loop of child process terminations and restarts, a <strong>maximum restart intensity</strong> is defined using two integer values specified with keys <code class="code">intensity</code> and <code class="code">period</code> in the above map. Assuming the values <code class="code">MaxR</code> for <code class="code">intensity</code> and <code class="code">MaxT</code> for <code class="code">period</code>, then, if more than <code class="code">MaxR</code> restarts occur within <code class="code">MaxT</code> seconds, the supervisor terminates all child processes and then itself. The termination reason for the supervisor itself in that case will be <code class="code">shutdown</code>. <code class="code">intensity</code> defaults to <code class="code">1</code> and <code class="code">period</code> defaults to <code class="code">5</code>.</p> <h5>Automatic Shutdown</h5>  <p id="auto_shutdown">A supervisor can be configured to automatically shut itself down with exit reason <code class="code">shutdown</code> when <code><a href="#significant_child">significant children</a></code> terminate with the <code class="code">auto_shutdown</code> key in the above map:</p> <ul> <li> <p><code class="code">never</code> - Automic shutdown is disabled. This is the default setting.</p> <p>With <code class="code">auto_shutdown</code> set to <code class="code">never</code>, child specs with the <code class="code">significant</code> flag set to <code class="code">true</code> are considered invalid and will be rejected.</p> </li> <li> <p><code class="code">any_significant</code> - The supervisor will shut itself down when <strong>any</strong> significant child terminates, that is, when a <code class="code">transient</code> significant child terminates normally or when a <code class="code">temporary</code> significant child terminates normally or abnormally.</p> </li> <li> <p><code class="code">all_significant</code> - The supervisor will shut itself down when <strong>all</strong> significant children have terminated, that is, when the <strong>last active</strong> significant child terminates. The same rules as for <code class="code">any_significant</code> apply.</p> </li> </ul> <p>For more information, see the section <code>Automatic Shutdown</code> in Supervisor Behavior in OTP Design Principles.</p> <div class="warning"> <div class="label">Warning</div> <div class="content">

<p>The automatic shutdown feature appeared in OTP 24.0, but applications using this feature will also compile and run with older OTP versions.</p> <p>However, such applications, when compiled with an OTP version that predates the appearance of the automatic shutdown feature, will leak processes because the automatic shutdowns they rely on will not happen.</p> <p>It is up to implementors to take proper precautions if they expect that their applications may be compiled with older OTP versions.</p> </div> </div> </section> <section><h4 id="Child specification">Child specification</h4>   <p id="child_spec">The type definition of a child specification is as follows:</p> <pre data-language="erlang">
child_spec() = #{id =&gt; child_id(),             % mandatory
                 start =&gt; mfargs(),            % mandatory
                 restart =&gt; restart(),         % optional
                 significant =&gt; significant(), % optional
                 shutdown =&gt; shutdown(),       % optional
                 type =&gt; worker(),             % optional
                 modules =&gt; modules()}         % optional</pre> <p>The old tuple format is kept for backwards compatibility, see <code><a href="#type-child_spec">child_spec()</a></code>, but the map is preferred.</p> <ul> <li> <p><code class="code">id</code> is used to identify the child specification internally by the supervisor.</p> <p>The <code class="code">id</code> key is mandatory.</p> <p>Notice that this identifier on occations has been called "name". As far as possible, the terms "identifier" or "id" are now used but to keep backward compatibility, some occurences of "name" can still be found, for example in error messages.</p> </li> <li> <p><code class="code">start</code> defines the function call used to start the child process. It must be a module-function-arguments tuple <code class="code">{M,F,A}</code> used as <code class="code">apply(M,F,A)</code>.</p> <p>The start function <strong>must create and link to</strong> the child process, and must return <code class="code">{ok,Child}</code> or <code class="code">{ok,Child,Info}</code>, where <code class="code">Child</code> is the pid of the child process and <code class="code">Info</code> any term that is ignored by the supervisor.</p> <p>The start function can also return <code class="code">ignore</code> if the child process for some reason cannot be started, in which case the child specification is kept by the supervisor (unless it is a temporary child) but the non-existing child process is ignored.</p> <p>If something goes wrong, the function can also return an error tuple <code class="code">{error,Error}</code>.</p> <p>Notice that the <code class="code">start_link</code> functions of the different behavior modules fulfill the above requirements.</p> <p>The <code class="code">start</code> key is mandatory.</p> </li> <li>  <p id="restart"><code class="code">restart</code> defines when a terminated child process must be restarted. A <code class="code">permanent</code> child process is always restarted. A <code class="code">temporary</code> child process is never restarted (even when the supervisor's restart strategy is <code class="code">rest_for_one</code> or <code class="code">one_for_all</code> and a sibling's death causes the temporary process to be terminated). A <code class="code">transient</code> child process is restarted only if it terminates abnormally, that is, with another exit reason than <code class="code">normal</code>, <code class="code">shutdown</code>, or <code class="code">{shutdown,Term}</code>.</p> <p>The <code class="code">restart</code> key is optional. If it is not specified, it defaults to <code class="code">permanent</code>.</p> </li> <li>  <p id="significant_child"><code class="code">significant</code> defines if a child is considered significant for <code><a href="#auto_shutdown">automatic self-shutdown</a></code> of the supervisor.</p> <p>Setting this option to <code class="code">true</code> when the <code><a href="#restart">restart type</a></code> is <code class="code">permanent</code> is invalid. Also, it is considered invalid to start children with this option set to <code class="code">true</code> in a supervisor when the <code><a href="#auto_shutdown"><span class="code">auto_shutdown</span></a></code> supervisor flag is set to <code class="code">never</code>.</p> <p>The <code class="code">significant</code> key is optional. If it is not specified, it defaults to <code class="code">false</code>.</p> </li> <li> <p><code class="code">shutdown</code> defines how a child process must be terminated. <code class="code">brutal_kill</code> means that the child process is unconditionally terminated using <code class="code">exit(Child,kill)</code>. An integer time-out value means that the supervisor tells the child process to terminate by calling <code class="code">exit(Child,shutdown)</code> and then wait for an exit signal with reason <code class="code">shutdown</code> back from the child process. If no exit signal is received within the specified number of milliseconds, the child process is unconditionally terminated using <code class="code">exit(Child,kill)</code>.</p> <p>If the child process is another supervisor, the shutdown time must be set to <code class="code">infinity</code> to give the subtree ample time to shut down.</p> <div class="warning"> <div class="label">Warning</div> <div class="content">

<p>Setting the shutdown time to anything other than <code class="code">infinity</code> for a child of type <code class="code">supervisor</code> can cause a race condition where the child in question unlinks its own children, but fails to terminate them before it is killed.</p> </div> </div> <p>It is also allowed to set it to <code class="code">infinity</code>, if the child process is a worker.</p> <div class="warning"> <div class="label">Warning</div> <div class="content">

<p>Be careful when setting the shutdown time to <code class="code">infinity</code> when the child process is a worker. Because, in this situation, the termination of the supervision tree depends on the child process, it must be implemented in a safe way and its cleanup procedure must always return.</p> </div> </div> <p>Notice that all child processes implemented using the standard OTP behavior modules automatically adhere to the shutdown protocol.</p> <p>The <code class="code">shutdown</code> key is optional. If it is not specified, it defaults to <code class="code">5000</code> if the child is of type <code class="code">worker</code> and it defaults to <code class="code">infinity</code> if the child is of type <code class="code">supervisor</code>.</p> </li> <li> <p><code class="code">type</code> specifies if the child process is a supervisor or a worker.</p> <p>The <code class="code">type</code> key is optional. If it is not specified, it defaults to <code class="code">worker</code>.</p> </li> <li> <p><code class="code">modules</code> is used by the release handler during code replacement to determine which processes are using a certain module. As a rule of thumb, if the child process is a <code class="code">supervisor</code>, <code class="code">gen_server</code> or, <code class="code">gen_statem</code>, this is to be a list with one element <code class="code">[Module]</code>, where <code class="code">Module</code> is the callback module. If the child process is an event manager (<code class="code">gen_event</code>) with a dynamic set of callback modules, value <code class="code">dynamic</code> must be used. For more information about release handling, see <code> Release Handling</code> in OTP Design Principles.</p> <p>The <code class="code">modules</code> key is optional. If it is not specified, it defaults to <code class="code">[M]</code>, where <code class="code">M</code> comes from the child's start <code class="code">{M,F,A}</code>.</p> </li> <li> <p>Internally, the supervisor also keeps track of the pid <code class="code">Child</code> of the child process, or <code class="code">undefined</code> if no pid exists.</p> </li> </ul> </section> </section> <div class="innertube"> <h2 id="data-types" class="title-link" onmouseover="document.getElementById('ghlink-data-types-idm31888').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-data-types-idm31888').style.visibility = 'hidden';"> <div class="title-name">Data Types</div>  </h2> <article class="data-types-body"><h4 id="type-auto_shutdown" class="title-link data-type-name" onmouseover="document.getElementById('ghlink-type-auto_shutdown').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-type-auto_shutdown').style.visibility = 'hidden';">  <div class="title-name"> <code id="type-auto_shutdown">auto_shutdown() = never | any_significant | all_significant</code><br> </div> </h4> </article> <article class="data-types-body"><h4 id="type-child" class="title-link data-type-name" onmouseover="document.getElementById('ghlink-type-child').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-type-child').style.visibility = 'hidden';">  <div class="title-name"> <code>child() = undefined | <span id="type-child">pid()</span></code><br> </div> </h4> </article> <article class="data-types-body"><h4 id="type-child_id" class="title-link data-type-name" onmouseover="document.getElementById('ghlink-type-child_id').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-type-child_id').style.visibility = 'hidden';">  <div class="title-name"> <code>child_id() = <span id="type-child_id">term()</span></code><br> </div> </h4> <div class="data-type-desc"><p>Not a <code class="code">pid()</code>.</p></div></article> <article class="data-types-body"><h4 id="type-child_spec" class="title-link data-type-name" onmouseover="document.getElementById('ghlink-type-child_spec').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-type-child_spec').style.visibility = 'hidden';">  <div class="title-name"> <code>child_spec() = <br id="type-child_spec">    #{id := <span><a href="#type-child_id">child_id()</a></span>,<br>      start := <span><a href="#type-mfargs">mfargs()</a></span>,<br>      restart =&gt; <span><a href="#type-restart">restart()</a></span>,<br>      significant =&gt; <span><a href="#type-significant">significant()</a></span>,<br>      shutdown =&gt; <span><a href="#type-shutdown">shutdown()</a></span>,<br>      type =&gt; <span><a href="#type-worker">worker()</a></span>,<br>      modules =&gt; <span><a href="#type-modules">modules()</a></span>} |<br>    {Id :: <span><a href="#type-child_id">child_id()</a></span>,<br>     StartFunc :: <span><a href="#type-mfargs">mfargs()</a></span>,<br>     Restart :: <span><a href="#type-restart">restart()</a></span>,<br>     Shutdown :: <span><a href="#type-shutdown">shutdown()</a></span>,<br>     Type :: <span><a href="#type-worker">worker()</a></span>,<br>     Modules :: <span><a href="#type-modules">modules()</a></span>}</code><br> </div> </h4> <div class="data-type-desc"><p>The tuple format is kept for backward compatibility only. A map is preferred; see more details <code><a href="#child_spec">above</a></code>.</p></div></article> <article class="data-types-body"><h4 id="type-mfargs" class="title-link data-type-name" onmouseover="document.getElementById('ghlink-type-mfargs').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-type-mfargs').style.visibility = 'hidden';">  <div class="title-name"> <code>mfargs() = <br id="type-mfargs">    {M :: <span>module()</span>, F :: <span>atom()</span>, A :: [<span>term()</span>] | undefined}</code><br> </div> </h4> <div class="data-type-desc"> <p>Value <code class="code">undefined</code> for <code class="code">A</code> (the argument list) is only to be used internally in <code class="code">supervisor</code>. If the restart type of the child is <code class="code">temporary</code>, the process is never to be restarted and therefore there is no need to store the real argument list. Value <code class="code">undefined</code> is then stored instead.</p> </div></article> <article class="data-types-body"><h4 id="type-modules" class="title-link data-type-name" onmouseover="document.getElementById('ghlink-type-modules').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-type-modules').style.visibility = 'hidden';">  <div class="title-name"> <code>modules() = [<span id="type-modules">module()</span>] | dynamic</code><br> </div> </h4> </article> <article class="data-types-body"><h4 id="type-restart" class="title-link data-type-name" onmouseover="document.getElementById('ghlink-type-restart').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-type-restart').style.visibility = 'hidden';">  <div class="title-name"> <code id="type-restart">restart() = permanent | transient | temporary</code><br> </div> </h4> </article> <article class="data-types-body"><h4 id="type-shutdown" class="title-link data-type-name" onmouseover="document.getElementById('ghlink-type-shutdown').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-type-shutdown').style.visibility = 'hidden';">  <div class="title-name"> <code>shutdown() = brutal_kill | <span id="type-shutdown">timeout()</span></code><br> </div> </h4> </article> <article class="data-types-body"><h4 id="type-significant" class="title-link data-type-name" onmouseover="document.getElementById('ghlink-type-significant').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-type-significant').style.visibility = 'hidden';">  <div class="title-name"> <code>significant() = <span id="type-significant">boolean()</span></code><br> </div> </h4> </article> <article class="data-types-body"><h4 id="type-startchild_err" class="title-link data-type-name" onmouseover="document.getElementById('ghlink-type-startchild_err').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-type-startchild_err').style.visibility = 'hidden';">  <div class="title-name"> <code>startchild_err() = <br id="type-startchild_err">    already_present | {already_started, Child :: <span><a href="#type-child">child()</a></span>} | <span>term()</span></code><br> </div> </h4> </article> <article class="data-types-body"><h4 id="type-startchild_ret" class="title-link data-type-name" onmouseover="document.getElementById('ghlink-type-startchild_ret').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-type-startchild_ret').style.visibility = 'hidden';">  <div class="title-name"> <code>startchild_ret() = <br id="type-startchild_ret">    {ok, Child :: <span><a href="#type-child">child()</a></span>} |<br>    {ok, Child :: <span><a href="#type-child">child()</a></span>, Info :: <span>term()</span>} |<br>    {error, <span><a href="#type-startchild_err">startchild_err()</a></span>}</code><br> </div> </h4> </article> <article class="data-types-body"><h4 id="type-startlink_err" class="title-link data-type-name" onmouseover="document.getElementById('ghlink-type-startlink_err').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-type-startlink_err').style.visibility = 'hidden';">  <div class="title-name"> <code>startlink_err() = <br id="type-startlink_err">    {already_started, <span>pid()</span>} | {shutdown, <span>term()</span>} | <span>term()</span></code><br> </div> </h4> </article> <article class="data-types-body"><h4 id="type-startlink_ret" class="title-link data-type-name" onmouseover="document.getElementById('ghlink-type-startlink_ret').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-type-startlink_ret').style.visibility = 'hidden';">  <div class="title-name"> <code>startlink_ret() = <br id="type-startlink_ret">    {ok, <span>pid()</span>} | ignore | {error, <span><a href="#type-startlink_err">startlink_err()</a></span>}</code><br> </div> </h4> </article> <article class="data-types-body"><h4 id="type-strategy" class="title-link data-type-name" onmouseover="document.getElementById('ghlink-type-strategy').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-type-strategy').style.visibility = 'hidden';">  <div class="title-name"> <code>strategy() = <br id="type-strategy">    one_for_all | one_for_one | rest_for_one | simple_one_for_one</code><br> </div> </h4> </article> <article class="data-types-body"><h4 id="type-sup_flags" class="title-link data-type-name" onmouseover="document.getElementById('ghlink-type-sup_flags').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-type-sup_flags').style.visibility = 'hidden';">  <div class="title-name"> <code>sup_flags() = <br id="type-sup_flags">    #{strategy =&gt; <span><a href="#type-strategy">strategy()</a></span>,<br>      intensity =&gt; <span>integer() &gt;= 0</span>,<br>      period =&gt; <span>integer() &gt;= 1</span>,<br>      auto_shutdown =&gt; <span><a href="#type-auto_shutdown">auto_shutdown()</a></span>} |<br>    {RestartStrategy :: <span><a href="#type-strategy">strategy()</a></span>,<br>     Intensity :: <span>integer() &gt;= 0</span>,<br>     Period :: <span>integer() &gt;= 1</span>}</code><br> </div> </h4> <div class="data-type-desc"><p>The tuple format is kept for backward compatibility only. A map is preferred; see more details <code><a href="#sup_flags">above</a></code>.</p></div></article> <article class="data-types-body"><h4 id="type-sup_ref" class="title-link data-type-name" onmouseover="document.getElementById('ghlink-type-sup_ref').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-type-sup_ref').style.visibility = 'hidden';">  <div class="title-name"> <code>sup_ref() = <br id="type-sup_ref">    (Name :: <span>atom()</span>) |<br>    {Name :: <span>atom()</span>, Node :: <span>node()</span>} |<br>    {global, Name :: <span>term()</span>} |<br>    {via, Module :: <span>module()</span>, Name :: <span>any()</span>} |<br>    <span>pid()</span></code><br> </div> </h4> </article> <article class="data-types-body"><h4 id="type-worker" class="title-link data-type-name" onmouseover="document.getElementById('ghlink-type-worker').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-type-worker').style.visibility = 'hidden';">  <div class="title-name"> <code id="type-worker">worker() = worker | supervisor</code><br> </div> </h4> </article> </div> <div class="innertube"><h2 id="export" class="title-link" onmouseover="document.getElementById('ghlink-export-idm31940').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-export-idm31940').style.visibility = 'hidden';"> <div class="title-name">Exports</div>  </h2></div> <div class="exports-body"> <article class="func"><h4 id="check_childspecs-1" onmouseover="document.getElementById('ghlink-check_childspecs-1-idp1309').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-check_childspecs-1-idp1309').style.visibility = 'hidden';">  <span class="title-name">check_childspecs(ChildSpecs) -&gt; Result</span> </h4> <h4 id="check_childspecs-2" onmouseover="document.getElementById('ghlink-check_childspecs-2-idp1310').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-check_childspecs-2-idp1310').style.visibility = 'hidden';">  <span class="title-name">check_childspecs(ChildSpecs, AutoShutdown) -&gt; Result</span><div class="title-since"><span class="since">OTP 24.0</span></div> </h4>  <h2 id="types" class="func-types-title">Types</h2>     <div class="exports-tube"> <p>Takes a list of child specification as argument and returns <code class="code">ok</code> if all of them are syntactically correct, otherwise <code class="code">{error,Error}</code>.</p> <p>If the optional <code class="code">AutoShutdown</code> argument is given and not <code class="code">undefined</code>, also checks if the child specifications are allowed for the given <code><a href="#auto_shutdown">auto_shutdown</a></code> option.</p> </div></article><article class="func"><h4 id="count_children-1" onmouseover="document.getElementById('ghlink-count_children-1-idp1311').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-count_children-1-idp1311').style.visibility = 'hidden';">  <span class="title-name">count_children(SupRef) -&gt; PropListOfCounts</span><div class="title-since"><span class="since">OTP R13B04</span></div> </h4>  <h2 id="types" class="func-types-title">Types</h2>     <div class="exports-tube"> <p>Returns a property list (see <code><a href="proplists"> <span class="code">proplists</span></a></code>) containing the counts for each of the following elements of the supervisor's child specifications and managed processes:</p> <ul> <li> <p><code class="code">specs</code> - The total count of children, dead or alive.</p> </li> <li> <p><code class="code">active</code> - The count of all actively running child processes managed by this supervisor. For a <code class="code">simple_one_for_one</code> supervisors, no check is done to ensure that each child process is still alive, although the result provided here is likely to be very accurate unless the supervisor is heavily overloaded.</p> </li> <li> <p><code class="code">supervisors</code> - The count of all children marked as <code class="code">child_type = supervisor</code> in the specification list, regardless if the child process is still alive.</p> </li> <li> <p><code class="code">workers</code> - The count of all children marked as <code class="code">child_type = worker</code> in the specification list, regardless if the child process is still alive.</p> </li> </ul> <p>For a description of <code class="code">SupRef</code>, see <code><a href="#SupRef"><span class="code">start_child/2</span></a></code>.</p> </div></article><article class="func"><h4 id="delete_child-2" onmouseover="document.getElementById('ghlink-delete_child-2-idp1312').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-delete_child-2-idp1312').style.visibility = 'hidden';">  <span class="title-name">delete_child(SupRef, Id) -&gt; Result</span> </h4>  <h2 id="types" class="func-types-title">Types</h2>      <div class="exports-tube"> <p>Tells supervisor <code class="code">SupRef</code> to delete the child specification identified by <code class="code">Id</code>. The corresponding child process must not be running. Use <code><a href="#terminate_child-2"> <span class="code">terminate_child/2</span></a></code> to terminate it.</p> <p>For a description of <code class="code">SupRef</code>, see <code><a href="#SupRef"><span class="code">start_child/2</span></a></code>.</p> <p>If successful, the function returns <code class="code">ok</code>. If the child specification identified by <code class="code">Id</code> exists but the corresponding child process is running or is about to be restarted, the function returns <code class="code">{error,running}</code> or <code class="code">{error,restarting}</code>, respectively. If the child specification identified by <code class="code">Id</code> does not exist, the function returns <code class="code">{error,not_found}</code>.</p> </div></article><article class="func"><h4 id="get_childspec-2" onmouseover="document.getElementById('ghlink-get_childspec-2-idp1313').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-get_childspec-2-idp1313').style.visibility = 'hidden';">  <span class="title-name">get_childspec(SupRef, Id) -&gt; Result</span><div class="title-since"><span class="since">OTP 18.0</span></div> </h4>  <h2 id="types" class="func-types-title">Types</h2>      <div class="exports-tube"> <p>Returns the child specification map for the child identified by <code class="code">Id</code> under supervisor <code class="code">SupRef</code>. The returned map contains all keys, both mandatory and optional.</p> <p>For a description of <code class="code">SupRef</code>, see <code><a href="#SupRef"><span class="code">start_child/2</span></a></code>.</p> </div></article><article class="func"><h4 id="restart_child-2" onmouseover="document.getElementById('ghlink-restart_child-2-idp1314').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-restart_child-2-idp1314').style.visibility = 'hidden';">  <span class="title-name">restart_child(SupRef, Id) -&gt; Result</span> </h4>  <h2 id="types" class="func-types-title">Types</h2>      <div class="exports-tube"> <p>Tells supervisor <code class="code">SupRef</code> to restart a child process corresponding to the child specification identified by <code class="code">Id</code>. The child specification must exist, and the corresponding child process must not be running.</p> <p>Notice that for temporary children, the child specification is automatically deleted when the child terminates; thus, it is not possible to restart such children.</p> <p>For a description of <code class="code">SupRef</code>, see <code><a href="#SupRef"><span class="code">start_child/2</span></a></code>.</p> <p>If the child specification identified by <code class="code">Id</code> does not exist, the function returns <code class="code">{error,not_found}</code>. If the child specification exists but the corresponding process is already running, the function returns <code class="code">{error,running}</code>.</p> <p>If the child process start function returns <code class="code">{ok,Child}</code> or <code class="code">{ok,Child,Info}</code>, the pid is added to the supervisor and the function returns the same value.</p> <p>If the child process start function returns <code class="code">ignore</code>, the pid remains set to <code class="code">undefined</code> and the function returns <code class="code">{ok,undefined}</code>.</p> <p>If the child process start function returns an error tuple or an erroneous value, or if it fails, the function returns <code class="code">{error,Error}</code>, where <code class="code">Error</code> is a term containing information about the error.</p> </div></article><article class="func"><h4 id="start_child-2" onmouseover="document.getElementById('ghlink-start_child-2-idp1315').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-start_child-2-idp1315').style.visibility = 'hidden';">  <span class="title-name">start_child(SupRef, ChildSpec) -&gt; <code><a href="#type-startchild_ret">startchild_ret()</a></code></span> </h4>  <h2 id="types" class="func-types-title">Types</h2>      <div class="exports-tube"> <p>Dynamically adds a child specification to supervisor <code class="code">SupRef</code>, which starts the corresponding child process.</p> <p><code class="code" id="SupRef">SupRef</code> can be any of the following:</p> <ul> <li>The pid</li> <li> <code class="code">Name</code>, if the supervisor is locally registered</li> <li> <code class="code">{Name,Node}</code>, if the supervisor is locally registered at another node</li> <li> <code class="code">{global,Name}</code>, if the supervisor is globally registered</li> <li> <code class="code">{via,Module,Name}</code>, if the supervisor is registered through an alternative process registry</li> </ul> <p><code class="code">ChildSpec</code> must be a valid child specification (unless the supervisor is a <code class="code">simple_one_for_one</code> supervisor; see below). The child process is started by using the start function as defined in the child specification.</p> <p>For a <code class="code">simple_one_for_one</code> supervisor, the child specification defined in <code class="code">Module:init/1</code> is used, and <code class="code">ChildSpec</code> must instead be an arbitrary list of terms <code class="code">List</code>. The child process is then started by appending <code class="code">List</code> to the existing start function arguments, that is, by calling <code class="code">apply(M, F, A++List)</code>, where <code class="code">{M,F,A}</code> is the start function defined in the child specification.</p> <ul> <li> <p>If there already exists a child specification with the specified identifier, <code class="code">ChildSpec</code> is discarded, and the function returns <code class="code">{error,already_present}</code> or <code class="code">{error,{already_started,Child}}</code>, depending on if the corresponding child process is running or not.</p> </li> <li> <p>If the child process start function returns <code class="code">{ok,Child}</code> or <code class="code">{ok,Child,Info}</code>, the child specification and pid are added to the supervisor and the function returns the same value.</p> </li> <li> <p>If the child process start function returns <code class="code">ignore</code>, the child specification is added to the supervisor (unless the supervisor is a <code class="code">simple_one_for_one</code> supervisor, see below), the pid is set to <code class="code">undefined</code>, and the function returns <code class="code">{ok,undefined}</code>.</p> </li> </ul> <p>For a <code class="code">simple_one_for_one</code> supervisor, when a child process start function returns <code class="code">ignore</code>, the functions returns <code class="code">{ok,undefined}</code> and no child is added to the supervisor.</p> <p>If the child process start function returns an error tuple or an erroneous value, or if it fails, the child specification is discarded, and the function returns <code class="code">{error,Error}</code>, where <code class="code">Error</code> is a term containing information about the error and child specification.</p> </div></article><article class="func"><h4 id="start_link-2" onmouseover="document.getElementById('ghlink-start_link-2-idp1316').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-start_link-2-idp1316').style.visibility = 'hidden';">  <span class="title-name">start_link(Module, Args) -&gt; <code><a href="#type-startlink_ret">startlink_ret()</a></code></span> </h4> <h4 id="start_link-3" onmouseover="document.getElementById('ghlink-start_link-3-idp1317').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-start_link-3-idp1317').style.visibility = 'hidden';">  <span class="title-name">start_link(SupName, Module, Args) -&gt; <code><a href="#type-startlink_ret">startlink_ret()</a></code></span> </h4>  <h2 id="types" class="func-types-title">Types</h2>        <div class="exports-tube"> <p>Creates a supervisor process as part of a supervision tree. For example, the function ensures that the supervisor is linked to the calling process (its supervisor).</p> <p>The created supervisor process calls <code class="code">Module:init/1</code> to find out about restart strategy, maximum restart intensity, and child processes. To ensure a synchronized startup procedure, <code class="code">start_link/2,3</code> does not return until <code class="code">Module:init/1</code> has returned and all child processes have been started.</p> <ul> <li> <p>If <code class="code">SupName={local,Name}</code>, the supervisor is registered locally as <code class="code">Name</code> using <code class="code">register/2</code>.</p> </li> <li> <p>If <code class="code">SupName={global,Name}</code>, the supervisor is registered globally as <code class="code">Name</code> using <code> <span class="code">global:register_name/2</span></code>.</p> </li> <li> <p>If <code class="code">SupName={via,Module,Name}</code>, the supervisor is registered as <code class="code">Name</code> using the registry represented by <code class="code">Module</code>. The <code class="code">Module</code> callback must export the functions <code class="code">register_name/2</code>, <code class="code">unregister_name/1</code>, and <code class="code">send/2</code>, which must behave like the corresponding functions in <code><span class="code">global</span></code>. Thus, <code class="code">{via,global,Name}</code> is a valid reference.</p> </li> </ul> <p>If no name is provided, the supervisor is not registered.</p> <p><code class="code">Module</code> is the name of the callback module.</p> <p><code class="code">Args</code> is any term that is passed as the argument to <code class="code">Module:init/1</code>.</p> <ul> <li> <p>If the supervisor and its child processes are successfully created (that is, if all child process start functions return <code class="code">{ok,Child}</code>, <code class="code">{ok,Child,Info}</code>, or <code class="code">ignore</code>), the function returns <code class="code">{ok,Pid}</code>, where <code class="code">Pid</code> is the pid of the supervisor.</p> </li> <li> <p>If there already exists a process with the specified <code class="code">SupName</code>, the function returns <code class="code">{error,{already_started,Pid}}</code>, where <code class="code">Pid</code> is the pid of that process.</p> </li> <li> <p>If <code class="code">Module:init/1</code> returns <code class="code">ignore</code>, this function returns <code class="code">ignore</code> as well, and the supervisor terminates with reason <code class="code">normal</code>.</p> </li> <li> <p>If <code class="code">Module:init/1</code> fails or returns an incorrect value, this function returns <code class="code">{error,Term}</code>, where <code class="code">Term</code> is a term with information about the error, and the supervisor terminates with reason <code class="code">Term</code>.</p> </li> <li> <p>If any child process start function fails or returns an error tuple or an erroneous value, the supervisor first terminates all already started child processes with reason <code class="code">shutdown</code> and then terminate itself and returns <code class="code">{error, {shutdown, Reason}}</code>.</p> </li> </ul> </div></article><article class="func"><h4 id="terminate_child-2" onmouseover="document.getElementById('ghlink-terminate_child-2-idp1318').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-terminate_child-2-idp1318').style.visibility = 'hidden';">  <span class="title-name">terminate_child(SupRef, Id) -&gt; Result</span> </h4>  <h2 id="types" class="func-types-title">Types</h2>      <div class="exports-tube"> <p>Tells supervisor <code class="code">SupRef</code> to terminate the specified child.</p> <p>If the supervisor is not <code class="code">simple_one_for_one</code>, <code class="code">Id</code> must be the child specification identifier. The process, if any, is terminated and, unless it is a temporary child, the child specification is kept by the supervisor. The child process can later be restarted by the supervisor. The child process can also be restarted explicitly by calling <code><a href="#restart_child-2"><span class="code">restart_child/2</span></a></code>. Use <code><a href="#delete_child-2"><span class="code">delete_child/2</span></a></code> to remove the child specification.</p> <p>If the child is temporary, the child specification is deleted as soon as the process terminates. This means that <code class="code">delete_child/2</code> has no meaning and <code class="code">restart_child/2</code> cannot be used for these children.</p> <p>If the supervisor is <code class="code">simple_one_for_one</code>, <code class="code">Id</code> must be the <code class="code">pid()</code> of the child process. If the specified process is alive, but is not a child of the specified supervisor, the function returns <code class="code">{error,not_found}</code>. If the child specification identifier is specified instead of a <code class="code">pid()</code>, the function returns <code class="code">{error,simple_one_for_one}</code>.</p> <p>If successful, the function returns <code class="code">ok</code>. If there is no child specification with the specified <code class="code">Id</code>, the function returns <code class="code">{error,not_found}</code>.</p> <p>For a description of <code class="code">SupRef</code>, see <code><a href="#SupRef"><span class="code">start_child/2</span></a></code>.</p> </div></article><article class="func"><h4 id="which_children-1" onmouseover="document.getElementById('ghlink-which_children-1-idp1319').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-which_children-1-idp1319').style.visibility = 'hidden';">  <span class="title-name">which_children(SupRef) -&gt; [{Id, Child, Type, Modules}]</span> </h4>  <h2 id="types" class="func-types-title">Types</h2>       <div class="exports-tube"> <p>Returns a newly created list with information about all child specifications and child processes belonging to supervisor <code class="code">SupRef</code>.</p> <p>Notice that calling this function when supervising many children under low memory conditions can cause an out of memory exception.</p> <p>For a description of <code class="code">SupRef</code>, see <code><a href="#SupRef"><span class="code">start_child/2</span></a></code>.</p> <p>The following information is given for each child specification/process:</p> <ul> <li> <p><code class="code">Id</code> - As defined in the child specification or <code class="code">undefined</code> for a <code class="code">simple_one_for_one</code> supervisor.</p> </li> <li> <p><code class="code">Child</code> - The pid of the corresponding child process, the atom <code class="code">restarting</code> if the process is about to be restarted, or <code class="code">undefined</code> if there is no such process.</p> </li> <li> <p><code class="code">Type</code> - As defined in the child specification.</p> </li> <li> <p><code class="code">Modules</code> - As defined in the child specification.</p> </li> </ul> </div></article> </div> <section class="innertube"><h2 id="callback-functions" class="title-link" onmouseover="document.getElementById('ghlink-callback-functions-idm32280').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-callback-functions-idm32280').style.visibility = 'hidden';"> <div class="title-name">Callback Functions</div>  </h2>  <p>The following function must be exported from a <code class="code">supervisor</code> callback module.</p> </section><div class="innertube"><h2 id="export" class="title-link" onmouseover="document.getElementById('ghlink-export-idm32279').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-export-idm32279').style.visibility = 'hidden';"> <div class="title-name">Exports</div>  </h2></div> <div class="exports-body"><article class="func"><div><h4 id="Module:init-1" class="title-link" onmouseover="document.getElementById('ghlink-Module:init-1-idm32285').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-Module:init-1-idm32285').style.visibility = 'hidden';">  <div class="title-name">Module:init(Args) -&gt; Result</div> </h4></div> <div class="exports-tube">  <h2 id="types" class="func-types-title">Types</h2>       <p>Whenever a supervisor is started using <code><a href="#start_link-2"><span class="code">start_link/2,3</span></a></code>, this function is called by the new process to find out about restart strategy, maximum restart intensity, and child specifications.</p> <p><code class="code">Args</code> is the <code class="code">Args</code> argument provided to the start function.</p> <p><code class="code">SupFlags</code> is the supervisor flags defining the restart strategy and maximum restart intensity for the supervisor. <code class="code">[ChildSpec]</code> is a list of valid child specifications defining which child processes the supervisor must start and monitor. See the discussion in section <code><a href="#supervision_princ"> <span class="code">Supervision Principles</span></a></code> earlier.</p> <p>Notice that when the restart strategy is <code class="code">simple_one_for_one</code>, the list of child specifications must be a list with one child specification only. (The child specification identifier is ignored.) No child process is then started during the initialization phase, but all children are assumed to be started dynamically using <code><a href="#start_child-2"><span class="code">start_child/2</span></a></code>.</p> <p>The function can also return <code class="code">ignore</code>.</p> <p>Notice that this function can also be called as a part of a code upgrade procedure. Therefore, the function is not to have any side effects. For more information about code upgrade of supervisors, see section <code>Changing a Supervisor</code> in OTP Design Principles.</p>  </div></article></div> <section class="innertube"><h2 id="see-also" class="title-link" onmouseover="document.getElementById('ghlink-see-also-idm32316').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-see-also-idm32316').style.visibility = 'hidden';"> <div class="title-name">See Also</div>  </h2>  <p><code><a href="gen_event"><span class="code">gen_event(3)</span></a></code>, <code><a href="gen_statem"><span class="code">gen_statem(3)</span></a></code>, <code><a href="gen_server"><span class="code">gen_server(3)</span></a></code>, <code><a href="sys"><span class="code">sys(3)</span></a></code></p> </section> <div class="footer"> <hr> <p>Copyright © 1997-2022 Ericsson AB. All Rights Reserved.</p> </div><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2010&ndash;2022 Ericsson AB<br>Licensed under the Apache License, Version 2.0.<br>
    
  </p>
</div>
