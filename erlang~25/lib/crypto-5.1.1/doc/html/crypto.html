  <div class="innertube"> <h2 id="module" class="title-link" onmouseover="document.getElementById('ghlink-module-idm1288').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-module-idm1288').style.visibility = 'hidden';"> <div class="title-name">Module</div>  </h2> <p class="REFBODY module-body">crypto</p> </div> <div class="innertube"> <h2 id="module-summary" class="title-link" onmouseover="document.getElementById('ghlink-module-summary-idm1289').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-module-summary-idm1289').style.visibility = 'hidden';"> <div class="title-name">Module Summary</div>  </h2> <p class="REFBODY module-summary-body">Crypto Functions</p> </div> <section class="description"><div class="innertube"> <h2 id="description" class="title-link" onmouseover="document.getElementById('ghlink-description-idm1290').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-description-idm1290').style.visibility = 'hidden';"> <div class="title-name">Description</div>  </h2> 
<p>This module provides a set of cryptographic functions. </p> <dl> <dt><strong>Hash functions</strong></dt> <dd>  <dl> <dt><strong>SHA1, SHA2</strong></dt> <dd> <code><a href="https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.180-4.pdf"> Secure Hash Standard [FIPS PUB 180-4] </a></code> </dd> <dt><strong>SHA3</strong></dt> <dd> <code><a href="https://www.nist.gov/publications/sha-3-standard-permutation-based-hash-and-extendable-output-functions?pub_id=919061"> SHA-3 Standard: Permutation-Based Hash and Extendable-Output Functions [FIPS PUB 202] </a></code> </dd> <dt><strong>BLAKE2</strong></dt> <dd> <code><a href="https://blake2.net/">BLAKE2 — fast secure hashing</a></code> </dd> <dt><strong>MD5</strong></dt> <dd> <code><a href="http://www.ietf.org/rfc/rfc1321.txt">The MD5 Message Digest Algorithm [RFC 1321]</a></code> </dd> <dt><strong>MD4</strong></dt> <dd> <code><a href="http://www.ietf.org/rfc/rfc1320.txt">The MD4 Message Digest Algorithm [RFC 1320]</a></code> </dd> </dl>  </dd> <dt><strong>MACs - Message Authentication Codes</strong></dt> <dd>  <dl> <dt><strong>Hmac functions</strong></dt> <dd> <code><a href="http://www.ietf.org/rfc/rfc2104.txt"> Keyed-Hashing for Message Authentication [RFC 2104] </a></code> </dd> <dt><strong>Cmac functions</strong></dt> <dd> <code><a href="http://www.ietf.org/rfc/rfc4493.txt"> The AES-CMAC Algorithm [RFC 4493] </a></code> </dd> <dt><strong>POLY1305</strong></dt> <dd> <code><a href="http://www.ietf.org/rfc/rfc7539.txt"> ChaCha20 and Poly1305 for IETF Protocols [RFC 7539] </a></code> </dd> </dl>  </dd> <dt><strong>Symmetric Ciphers</strong></dt> <dd>  <dl> <dt><strong>DES, 3DES and AES</strong></dt> <dd> <code><a href="https://csrc.nist.gov/projects/block-cipher-techniques">Block Cipher Techniques [NIST]</a></code> </dd> <dt><strong>Blowfish</strong></dt> <dd> <code><a href="https://www.schneier.com/academic/archives/1994/09/description_of_a_new.html"> Fast Software Encryption, Cambridge Security Workshop Proceedings (December 1993), Springer-Verlag, 1994, pp. 191-204. </a></code> </dd> <dt><strong>Chacha20</strong></dt> <dd> <code><a href="http://www.ietf.org/rfc/rfc7539.txt"> ChaCha20 and Poly1305 for IETF Protocols [RFC 7539] </a></code> </dd> <dt><strong>Chacha20_poly1305</strong></dt> <dd> <code><a href="http://www.ietf.org/rfc/rfc7539.txt"> ChaCha20 and Poly1305 for IETF Protocols [RFC 7539] </a></code> </dd> </dl>  </dd> <dt><strong>Modes</strong></dt> <dd>  <dl> <dt><strong>ECB, CBC, CFB, OFB and CTR</strong></dt> <dd> <code><a href="https://csrc.nist.gov/publications/detail/sp/800-38a/final"> Recommendation for Block Cipher Modes of Operation: Methods and Techniques [NIST SP 800-38A] </a></code> </dd> <dt><strong>GCM</strong></dt> <dd> <code><a href="https://csrc.nist.gov/publications/detail/sp/800-38d/final"> Recommendation for Block Cipher Modes of Operation: Galois/Counter Mode (GCM) and GMAC [NIST SP 800-38D] </a></code> </dd> <dt><strong>CCM</strong></dt> <dd> <code><a href="https://nvlpubs.nist.gov/nistpubs/legacy/sp/nistspecialpublication800-38c.pdf"> Recommendation for Block Cipher Modes of Operation: The CCM Mode for Authentication and Confidentiality [NIST SP 800-38C] </a></code> </dd> </dl>  </dd> <dt><strong>Asymmetric Ciphers - Public Key Techniques</strong></dt> <dd>  <dl> <dt><strong>RSA</strong></dt> <dd> <code><a href="http://www.ietf.org/rfc/rfc3447.txt"> PKCS #1: RSA Cryptography Specifications [RFC 3447] </a></code> </dd> <dt><strong>DSS</strong></dt> <dd> <code><a href="https://csrc.nist.gov/publications/detail/fips/186/4/final"> Digital Signature Standard (DSS) [FIPS 186-4] </a></code> </dd> <dt><strong>ECDSA</strong></dt> <dd> <code><a href="http://csrc.nist.gov/groups/STM/cavp/documents/dss2/ecdsa2vs.pdf"> Elliptic Curve Digital Signature Algorithm [ECDSA] </a></code> </dd> <dt><strong>SRP</strong></dt> <dd> <code><a href="http://www.ietf.org/rfc/rfc2945.txt"> The SRP Authentication and Key Exchange System [RFC 2945] </a></code> </dd> </dl>  </dd> </dl> <div class="note"> <div class="label">Note</div> <div class="content">

<p>The actual supported algorithms and features depends on their availability in the actual libcrypto used. See the <code>crypto (App)</code> about dependencies. </p> <p>Enabling FIPS mode will also disable algorithms and features. </p> </div> </div> <p>The <code><a href="users_guide">CRYPTO User's Guide</a></code> has more information on FIPS, Engines and Algorithm Details like key lengths. </p>  </div></section> <div class="innertube"> <h2 id="data-types" class="title-link" onmouseover="document.getElementById('ghlink-data-types-idm1381').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-data-types-idm1381').style.visibility = 'hidden';"> <div class="title-name">Data Types</div>  </h2> <h4 id="Ciphers" class="title-link" onmouseover="document.getElementById('ghlink-Ciphers-idm1382').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-Ciphers-idm1382').style.visibility = 'hidden';"> <div class="title-name">Ciphers</div>  </h4> <article class="data-types-body"><h4 id="type-cipher" class="title-link data-type-name" onmouseover="document.getElementById('ghlink-type-cipher').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-type-cipher').style.visibility = 'hidden';">  <div class="title-name"> <code>cipher() = <span id="type-cipher"><a href="#type-cipher_no_iv">cipher_no_iv()</a></span> | <span><a href="#type-cipher_iv">cipher_iv()</a></span> | <span><a href="#type-cipher_aead">cipher_aead()</a></span></code><br> </div> </h4> </article> <article class="data-types-body"><h4 id="type-cipher_no_iv" class="title-link data-type-name" onmouseover="document.getElementById('ghlink-type-cipher_no_iv').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-type-cipher_no_iv').style.visibility = 'hidden';">  <div class="title-name"> <code>cipher_no_iv() = <br id="type-cipher_no_iv">    aes_128_ecb | aes_192_ecb | aes_256_ecb | aes_ecb |<br>    blowfish_ecb | des_ecb | rc4</code><br> </div> </h4> </article> <article class="data-types-body"><h4 id="type-cipher_iv" class="title-link data-type-name" onmouseover="document.getElementById('ghlink-type-cipher_iv').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-type-cipher_iv').style.visibility = 'hidden';">  <div class="title-name"> <code>cipher_iv() = <br id="type-cipher_iv">    aes_128_cbc | aes_192_cbc | aes_256_cbc | aes_cbc |<br>    aes_128_ofb | aes_192_ofb | aes_256_ofb | aes_128_cfb128 |<br>    aes_192_cfb128 | aes_256_cfb128 | aes_cfb128 | aes_128_cfb8 |<br>    aes_192_cfb8 | aes_256_cfb8 | aes_cfb8 | aes_128_ctr |<br>    aes_192_ctr | aes_256_ctr | aes_ctr | blowfish_cbc |<br>    blowfish_cfb64 | blowfish_ofb64 | chacha20 | des_ede3_cbc |<br>    des_ede3_cfb | des_cbc | des_cfb | rc2_cbc</code><br> </div> </h4> </article> <article class="data-types-body"><h4 id="type-cipher_aead" class="title-link data-type-name" onmouseover="document.getElementById('ghlink-type-cipher_aead').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-type-cipher_aead').style.visibility = 'hidden';">  <div class="title-name"> <code>cipher_aead() = <br id="type-cipher_aead">    aes_128_ccm | aes_192_ccm | aes_256_ccm | aes_ccm |<br>    aes_128_gcm | aes_192_gcm | aes_256_gcm | aes_gcm |<br>    chacha20_poly1305</code><br> </div> </h4> <div class="data-type-desc"> <p>Ciphers known by the CRYPTO application.</p> <p>Note that this list might be reduced if the underlying libcrypto does not support all of them.</p> </div></article> <article class="data-types-body"><h4 id="type-crypto_opts" class="title-link data-type-name" onmouseover="document.getElementById('ghlink-type-crypto_opts').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-type-crypto_opts').style.visibility = 'hidden';">  <div class="title-name"> <code>crypto_opts() = <span id="type-crypto_opts">boolean()</span> | [<span><a href="#type-crypto_opt">crypto_opt()</a></span>]</code><br> <code>crypto_opt() = {encrypt, <span id="type-crypto_opt">boolean()</span>} | {padding, <span><a href="#type-padding">padding()</a></span>}</code><br> </div> </h4> <div class="data-type-desc"> <p>Selects encryption (<code class="code">{encrypt,true}</code>) or decryption (<code class="code">{encrypt,false}</code>). </p> </div></article> <article class="data-types-body"><h4 id="type-padding" class="title-link data-type-name" onmouseover="document.getElementById('ghlink-type-padding').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-type-padding').style.visibility = 'hidden';">  <div class="title-name"> <code>padding() = <span id="type-padding"><a href="#type-cryptolib_padding">cryptolib_padding()</a></span> | <span><a href="#type-otp_padding">otp_padding()</a></span></code><br> </div> </h4> <div class="data-type-desc"> <p>This option handles padding in the last block. If not set, no padding is done and any bytes in the last unfilled block is silently discarded. </p> </div></article> <article class="data-types-body"><h4 id="type-cryptolib_padding" class="title-link data-type-name" onmouseover="document.getElementById('ghlink-type-cryptolib_padding').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-type-cryptolib_padding').style.visibility = 'hidden';">  <div class="title-name"> <code id="type-cryptolib_padding">cryptolib_padding() = none | pkcs_padding</code><br> </div> </h4> <div class="data-type-desc"> <p>The <code class="code">cryptolib_padding</code> are paddings that may be present in the underlying cryptolib linked to the Erlang/OTP crypto app. </p> <p>For OpenSSL, see the <code><a href="http:www.openssl.org">OpenSSL documentation</a></code>. and find <code class="code">EVP_CIPHER_CTX_set_padding()</code> in cryptolib for your linked version. </p> </div></article> <article class="data-types-body"><h4 id="type-otp_padding" class="title-link data-type-name" onmouseover="document.getElementById('ghlink-type-otp_padding').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-type-otp_padding').style.visibility = 'hidden';">  <div class="title-name"> <code id="type-otp_padding">otp_padding() = zero | random</code><br> </div> </h4> <div class="data-type-desc"> <p>Erlang/OTP adds a either padding of zeroes or padding with random bytes.</p> </div></article> <h4 id="Digests and hash" class="title-link" onmouseover="document.getElementById('ghlink-Digests and hash-idm1420').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-Digests and hash-idm1420').style.visibility = 'hidden';"> <div class="title-name">Digests and hash</div>  </h4> <article class="data-types-body"><h4 id="type-hash_algorithm" class="title-link data-type-name" onmouseover="document.getElementById('ghlink-type-hash_algorithm').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-type-hash_algorithm').style.visibility = 'hidden';">  <div class="title-name"> <code>hash_algorithm() = <br id="type-hash_algorithm">    <span><a href="#type-sha1">sha1()</a></span> |<br>    <span><a href="#type-sha2">sha2()</a></span> |<br>    <span><a href="#type-sha3">sha3()</a></span> |<br>    <span><a href="#type-blake2">blake2()</a></span> |<br>    ripemd160 |<br>    <span><a href="#type-compatibility_only_hash">compatibility_only_hash()</a></span></code><br> </div> </h4> </article> <article class="data-types-body"><h4 id="type-hmac_hash_algorithm" class="title-link data-type-name" onmouseover="document.getElementById('ghlink-type-hmac_hash_algorithm').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-type-hmac_hash_algorithm').style.visibility = 'hidden';">  <div class="title-name"> <code>hmac_hash_algorithm() = <br id="type-hmac_hash_algorithm">    <span><a href="#type-sha1">sha1()</a></span> | <span><a href="#type-sha2">sha2()</a></span> | <span><a href="#type-sha3">sha3()</a></span> | <span><a href="#type-compatibility_only_hash">compatibility_only_hash()</a></span></code><br> </div> </h4> </article> <article class="data-types-body"><h4 id="type-cmac_cipher_algorithm" class="title-link data-type-name" onmouseover="document.getElementById('ghlink-type-cmac_cipher_algorithm').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-type-cmac_cipher_algorithm').style.visibility = 'hidden';">  <div class="title-name"> <code>cmac_cipher_algorithm() = <br id="type-cmac_cipher_algorithm">    aes_128_cbc | aes_192_cbc | aes_256_cbc | aes_cbc |<br>    aes_128_cfb128 | aes_192_cfb128 | aes_256_cfb128 |<br>    aes_cfb128 | aes_128_cfb8 | aes_192_cfb8 | aes_256_cfb8 |<br>    aes_cfb8 | blowfish_cbc | des_cbc | des_ede3_cbc | rc2_cbc</code><br> </div> </h4> </article> <article class="data-types-body"><h4 id="type-rsa_digest_type" class="title-link data-type-name" onmouseover="document.getElementById('ghlink-type-rsa_digest_type').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-type-rsa_digest_type').style.visibility = 'hidden';">  <div class="title-name"> <code>rsa_digest_type() = <span id="type-rsa_digest_type"><a href="#type-sha1">sha1()</a></span> | <span><a href="#type-sha2">sha2()</a></span> | md5 | ripemd160</code><br> </div> </h4> </article> <article class="data-types-body"><h4 id="type-dss_digest_type" class="title-link data-type-name" onmouseover="document.getElementById('ghlink-type-dss_digest_type').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-type-dss_digest_type').style.visibility = 'hidden';">  <div class="title-name"> <code>dss_digest_type() = <span id="type-dss_digest_type"><a href="#type-sha1">sha1()</a></span> | <span><a href="#type-sha2">sha2()</a></span></code><br> </div> </h4> </article> <article class="data-types-body"><h4 id="type-ecdsa_digest_type" class="title-link data-type-name" onmouseover="document.getElementById('ghlink-type-ecdsa_digest_type').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-type-ecdsa_digest_type').style.visibility = 'hidden';">  <div class="title-name"> <code>ecdsa_digest_type() = <span id="type-ecdsa_digest_type"><a href="#type-sha1">sha1()</a></span> | <span><a href="#type-sha2">sha2()</a></span></code><br> </div> </h4> </article> <article class="data-types-body"><h4 id="type-sha1" class="title-link data-type-name" onmouseover="document.getElementById('ghlink-type-sha1').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-type-sha1').style.visibility = 'hidden';">  <div class="title-name"> <code id="type-sha1">sha1() = sha</code><br> <code id="type-sha2">sha2() = sha224 | sha256 | sha384 | sha512</code><br> <code id="type-sha3">sha3() = sha3_224 | sha3_256 | sha3_384 | sha3_512</code><br> <code id="type-blake2">blake2() = blake2b | blake2s</code><br> </div> </h4> </article> <article class="data-types-body"><h4 id="type-compatibility_only_hash" class="title-link data-type-name" onmouseover="document.getElementById('ghlink-type-compatibility_only_hash').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-type-compatibility_only_hash').style.visibility = 'hidden';">  <div class="title-name"> <code id="type-compatibility_only_hash">compatibility_only_hash() = md5 | md4</code><br> </div> </h4> <div class="data-type-desc"> <p>The <code class="code">compatibility_only_hash()</code> algorithms are recommended only for compatibility with existing applications.</p> </div></article> <h4 id="Elliptic Curves" class="title-link" onmouseover="document.getElementById('ghlink-Elliptic Curves-idm1450').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-Elliptic Curves-idm1450').style.visibility = 'hidden';"> <div class="title-name">Elliptic Curves</div>  </h4> <article class="data-types-body"><h4 id="type-ec_named_curve" class="title-link data-type-name" onmouseover="document.getElementById('ghlink-type-ec_named_curve').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-type-ec_named_curve').style.visibility = 'hidden';">  <div class="title-name"> <code>ec_named_curve() = <br id="type-ec_named_curve">    brainpoolP160r1 | brainpoolP160t1 | brainpoolP192r1 |<br>    brainpoolP192t1 | brainpoolP224r1 | brainpoolP224t1 |<br>    brainpoolP256r1 | brainpoolP256t1 | brainpoolP320r1 |<br>    brainpoolP320t1 | brainpoolP384r1 | brainpoolP384t1 |<br>    brainpoolP512r1 | brainpoolP512t1 | c2pnb163v1 | c2pnb163v2 |<br>    c2pnb163v3 | c2pnb176v1 | c2pnb208w1 | c2pnb272w1 |<br>    c2pnb304w1 | c2pnb368w1 | c2tnb191v1 | c2tnb191v2 |<br>    c2tnb191v3 | c2tnb239v1 | c2tnb239v2 | c2tnb239v3 |<br>    c2tnb359v1 | c2tnb431r1 | ipsec3 | ipsec4 | prime192v1 |<br>    prime192v2 | prime192v3 | prime239v1 | prime239v2 |<br>    prime239v3 | prime256v1 | secp112r1 | secp112r2 | secp128r1 |<br>    secp128r2 | secp160k1 | secp160r1 | secp160r2 | secp192k1 |<br>    secp192r1 | secp224k1 | secp224r1 | secp256k1 | secp256r1 |<br>    secp384r1 | secp521r1 | sect113r1 | sect113r2 | sect131r1 |<br>    sect131r2 | sect163k1 | sect163r1 | sect163r2 | sect193r1 |<br>    sect193r2 | sect233k1 | sect233r1 | sect239k1 | sect283k1 |<br>    sect283r1 | sect409k1 | sect409r1 | sect571k1 | sect571r1 |<br>    wtls1 | wtls10 | wtls11 | wtls12 | wtls3 | wtls4 | wtls5 |<br>    wtls6 | wtls7 | wtls8 | wtls9</code><br> <code id="type-edwards_curve_dh">edwards_curve_dh() = x25519 | x448</code><br> <code id="type-edwards_curve_ed">edwards_curve_ed() = ed25519 | ed448</code><br> </div> </h4> <div class="data-type-desc"> <p>Note that some curves are disabled if FIPS is enabled.</p> </div></article> <article class="data-types-body"><h4 id="type-ec_explicit_curve" class="title-link data-type-name" onmouseover="document.getElementById('ghlink-type-ec_explicit_curve').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-type-ec_explicit_curve').style.visibility = 'hidden';">  <div class="title-name"> <code>ec_explicit_curve() = <br id="type-ec_explicit_curve">    {Field :: <span><a href="#type-ec_field">ec_field()</a></span>,<br>     Curve :: <span><a href="#type-ec_curve">ec_curve()</a></span>,<br>     BasePoint :: <span>binary()</span>,<br>     Order :: <span>binary()</span>,<br>     CoFactor :: none | <span>binary()</span>}</code><br> <code>ec_field() = <span id="type-ec_field"><a href="#type-ec_prime_field">ec_prime_field()</a></span> | <span><a href="#type-ec_characteristic_two_field">ec_characteristic_two_field()</a></span></code><br> <code>ec_curve() = <br id="type-ec_curve">    {A :: <span>binary()</span>, B :: <span>binary()</span>, Seed :: none | <span>binary()</span>}</code><br> </div> </h4> <div class="data-type-desc"> <p>Parametric curve definition.</p> </div></article> <article class="data-types-body"><h4 id="type-ec_prime_field" class="title-link data-type-name" onmouseover="document.getElementById('ghlink-type-ec_prime_field').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-type-ec_prime_field').style.visibility = 'hidden';">  <div class="title-name"> <code>ec_prime_field() = {prime_field, Prime :: <span id="type-ec_prime_field">integer()</span>}</code><br> <code>ec_characteristic_two_field() = <br id="type-ec_characteristic_two_field">    {characteristic_two_field,<br>     M :: <span>integer()</span>,<br>     Basis :: <span><a href="#type-ec_basis">ec_basis()</a></span>}</code><br> <code>ec_basis() = <br id="type-ec_basis">    {tpbasis, K :: <span>integer() &gt;= 0</span>} |<br>    {ppbasis,<br>     K1 :: <span>integer() &gt;= 0</span>,<br>     K2 :: <span>integer() &gt;= 0</span>,<br>     K3 :: <span>integer() &gt;= 0</span>} |<br>    onbasis</code><br> </div> </h4> <div class="data-type-desc"> <p>Curve definition details.</p> </div></article> <h4 id="Keys" class="title-link" onmouseover="document.getElementById('ghlink-Keys-idm1469').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-Keys-idm1469').style.visibility = 'hidden';"> <div class="title-name">Keys</div>  </h4> <article class="data-types-body"><h4 id="type-key_integer" class="title-link data-type-name" onmouseover="document.getElementById('ghlink-type-key_integer').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-type-key_integer').style.visibility = 'hidden';">  <div class="title-name"> <code>key_integer() = <span id="type-key_integer">integer()</span> | <span>binary()</span></code><br> </div> </h4> <div class="data-type-desc"> <p>Always <code class="code">binary()</code> when used as return value</p> </div></article> <h4 id="Public/Private Keys" class="title-link" onmouseover="document.getElementById('ghlink-Public/Private Keys-idm1475').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-Public/Private Keys-idm1475').style.visibility = 'hidden';"> <div class="title-name">Public/Private Keys</div>  </h4> <article class="data-types-body"><h4 id="type-rsa_public" class="title-link data-type-name" onmouseover="document.getElementById('ghlink-type-rsa_public').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-type-rsa_public').style.visibility = 'hidden';">  <div class="title-name"> <code>rsa_public() = [<span id="type-rsa_public"><a href="#type-key_integer">key_integer()</a></span>]</code><br> <code>rsa_private() = [<span id="type-rsa_private"><a href="#type-key_integer">key_integer()</a></span>]</code><br> <code>rsa_params() = <br id="type-rsa_params">    {ModulusSizeInBits :: <span>integer()</span>,<br>     PublicExponent :: <span><a href="#type-key_integer">key_integer()</a></span>}</code><br> </div> </h4> <div class="data-type-desc"> <pre data-language="erlang">rsa_public() = [E, N]</pre> <pre data-language="erlang">rsa_private() = [E, N, D] | [E, N, D, P1, P2, E1, E2, C]</pre> <p>Where E is the public exponent, N is public modulus and D is the private exponent. The longer key format contains redundant information that will make the calculation faster. P1 and P2 are first and second prime factors. E1 and E2 are first and second exponents. C is the CRT coefficient. The terminology is taken from <code><a href="http://www.ietf.org/rfc/rfc3447.txt"> RFC 3447</a></code>.</p> </div></article> <article class="data-types-body"><h4 id="type-dss_public" class="title-link data-type-name" onmouseover="document.getElementById('ghlink-type-dss_public').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-type-dss_public').style.visibility = 'hidden';">  <div class="title-name"> <code>dss_public() = [<span id="type-dss_public"><a href="#type-key_integer">key_integer()</a></span>]</code><br> <code>dss_private() = [<span id="type-dss_private"><a href="#type-key_integer">key_integer()</a></span>]</code><br> </div> </h4> <div class="data-type-desc"> <pre data-language="erlang">dss_public() = [P, Q, G, Y] </pre> <p>Where P, Q and G are the dss parameters and Y is the public key.</p> <pre data-language="erlang">dss_private() = [P, Q, G, X] </pre> <p>Where P, Q and G are the dss parameters and X is the private key.</p> </div></article> <article class="data-types-body"><h4 id="type-ecdsa_public" class="title-link data-type-name" onmouseover="document.getElementById('ghlink-type-ecdsa_public').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-type-ecdsa_public').style.visibility = 'hidden';">  <div class="title-name"> <code>ecdsa_public() = <span id="type-ecdsa_public"><a href="#type-key_integer">key_integer()</a></span></code><br> <code>ecdsa_private() = <span id="type-ecdsa_private"><a href="#type-key_integer">key_integer()</a></span></code><br> <code>ecdsa_params() = <span id="type-ecdsa_params"><a href="#type-ec_named_curve">ec_named_curve()</a></span> | <span><a href="#type-ec_explicit_curve">ec_explicit_curve()</a></span></code><br> </div> </h4> </article> <article class="data-types-body"><h4 id="type-eddsa_public" class="title-link data-type-name" onmouseover="document.getElementById('ghlink-type-eddsa_public').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-type-eddsa_public').style.visibility = 'hidden';">  <div class="title-name"> <code>eddsa_public() = <span id="type-eddsa_public"><a href="#type-key_integer">key_integer()</a></span></code><br> <code>eddsa_private() = <span id="type-eddsa_private"><a href="#type-key_integer">key_integer()</a></span></code><br> <code>eddsa_params() = <span id="type-eddsa_params"><a href="#type-edwards_curve_ed">edwards_curve_ed()</a></span></code><br> </div> </h4> </article> <article class="data-types-body"><h4 id="type-srp_public" class="title-link data-type-name" onmouseover="document.getElementById('ghlink-type-srp_public').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-type-srp_public').style.visibility = 'hidden';">  <div class="title-name"> <code>srp_public() = <span id="type-srp_public"><a href="#type-key_integer">key_integer()</a></span></code><br> <code>srp_private() = <span id="type-srp_private"><a href="#type-key_integer">key_integer()</a></span></code><br> </div> </h4> <div class="data-type-desc"> <pre data-language="erlang">srp_public() = key_integer() </pre> <p>Where is <code class="code">A</code> or <code class="code">B</code> from <code><a href="http://srp.stanford.edu/design.html">SRP design</a></code></p> <pre data-language="erlang">srp_private() = key_integer() </pre> <p>Where is <code class="code">a</code> or <code class="code">b</code> from <code><a href="http://srp.stanford.edu/design.html">SRP design</a></code></p> </div></article> <article class="data-types-body"><h4 id="type-srp_gen_params" class="title-link data-type-name" onmouseover="document.getElementById('ghlink-type-srp_gen_params').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-type-srp_gen_params').style.visibility = 'hidden';">  <div class="title-name"> <code>srp_gen_params() = <br id="type-srp_gen_params">    {user, <span><a href="#type-srp_user_gen_params">srp_user_gen_params()</a></span>} | {host, <span><a href="#type-srp_host_gen_params">srp_host_gen_params()</a></span>}</code><br> <code>srp_comp_params() = <br id="type-srp_comp_params">    {user, <span><a href="#type-srp_user_comp_params">srp_user_comp_params()</a></span>} |<br>    {host, <span><a href="#type-srp_host_comp_params">srp_host_comp_params()</a></span>}</code><br><div><h4 id="type-srp_user_gen_params" class="title-link" onmouseover="document.getElementById('ghlink-type-srp_user_gen_params-idm1520').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-type-srp_user_gen_params-idm1520').style.visibility = 'hidden';">  <div class="title-name">srp_user_gen_params() = [DerivedKey::binary(), Prime::binary(), Generator::binary(), Version::atom()]</div> </h4></div> <div><h4 id="type-srp_host_gen_params" class="title-link" onmouseover="document.getElementById('ghlink-type-srp_host_gen_params-idm1521').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-type-srp_host_gen_params-idm1521').style.visibility = 'hidden';">  <div class="title-name">srp_host_gen_params() = [Verifier::binary(), Prime::binary(), Version::atom() ]</div> </h4></div> <div><h4 id="type-srp_user_comp_params" class="title-link" onmouseover="document.getElementById('ghlink-type-srp_user_comp_params-idm1522').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-type-srp_user_comp_params-idm1522').style.visibility = 'hidden';">  <div class="title-name">srp_user_comp_params() = [DerivedKey::binary(), Prime::binary(), Generator::binary(), Version::atom() | ScramblerArg::list()]</div> </h4></div> <div><h4 id="type-srp_host_comp_params" class="title-link" onmouseover="document.getElementById('ghlink-type-srp_host_comp_params-idm1523').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-type-srp_host_comp_params-idm1523').style.visibility = 'hidden';">  <div class="title-name">srp_host_comp_params() = [Verifier::binary(), Prime::binary(), Version::atom() | ScramblerArg::list()]</div> </h4></div> </div> </h4> <div class="data-type-desc"> <p>Where Verifier is <code class="code">v</code>, Generator is <code class="code">g</code> and Prime is<code class="code">N</code>, DerivedKey is <code class="code">X</code>, and Scrambler is <code class="code">u</code> (optional will be generated if not provided) from <code><a href="http://srp.stanford.edu/design.html">SRP design</a></code> Version = '3' | '6' | '6a' </p> </div></article> <h4 id="Public Key Ciphers" class="title-link" onmouseover="document.getElementById('ghlink-Public Key Ciphers-idm1532').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-Public Key Ciphers-idm1532').style.visibility = 'hidden';"> <div class="title-name">Public Key Ciphers</div>  </h4> <article class="data-types-body"><h4 id="type-pk_encrypt_decrypt_algs" class="title-link data-type-name" onmouseover="document.getElementById('ghlink-type-pk_encrypt_decrypt_algs').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-type-pk_encrypt_decrypt_algs').style.visibility = 'hidden';">  <div class="title-name"> <code id="type-pk_encrypt_decrypt_algs">pk_encrypt_decrypt_algs() = rsa</code><br> </div> </h4> <div class="data-type-desc"> <p>Algorithms for public key encrypt/decrypt. Only RSA is supported.</p> </div></article> <article class="data-types-body"><h4 id="type-pk_encrypt_decrypt_opts" class="title-link data-type-name" onmouseover="document.getElementById('ghlink-type-pk_encrypt_decrypt_opts').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-type-pk_encrypt_decrypt_opts').style.visibility = 'hidden';">  <div class="title-name"> <code>pk_encrypt_decrypt_opts() = [<span id="type-pk_encrypt_decrypt_opts"><a href="#type-rsa_opt">rsa_opt()</a></span>] | <span><a href="#type-rsa_compat_opts">rsa_compat_opts()</a></span></code><br> <code>rsa_opt() = <br id="type-rsa_opt">    {rsa_padding, <span><a href="#type-rsa_padding">rsa_padding()</a></span>} |<br>    {signature_md, <span>atom()</span>} |<br>    {rsa_mgf1_md, sha} |<br>    {rsa_oaep_label, <span>binary()</span>} |<br>    {rsa_oaep_md, sha}</code><br> <code>rsa_padding() = <br id="type-rsa_padding">    rsa_pkcs1_padding | rsa_pkcs1_oaep_padding |<br>    rsa_sslv23_padding | rsa_x931_padding | rsa_no_padding</code><br> </div> </h4> <div class="data-type-desc"> <p>Options for public key encrypt/decrypt. Only RSA is supported.</p> <div class="warning"> <div class="label">Warning</div> <div class="content">

<p>The RSA options are experimental. </p> <p>The exact set of options and there syntax <strong>may</strong> be changed without prior notice.</p> </div> </div> </div></article> <article class="data-types-body"><h4 id="type-rsa_compat_opts" class="title-link data-type-name" onmouseover="document.getElementById('ghlink-type-rsa_compat_opts').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-type-rsa_compat_opts').style.visibility = 'hidden';">  <div class="title-name"> <code>rsa_compat_opts() = [{rsa_pad, <span id="type-rsa_compat_opts"><a href="#type-rsa_padding">rsa_padding()</a></span>}] | <span><a href="#type-rsa_padding">rsa_padding()</a></span></code><br> </div> </h4> <div class="data-type-desc"> <p>Those option forms are kept only for compatibility and should not be used in new code.</p> </div></article> <h4 id="Public Key Sign and Verify" class="title-link" onmouseover="document.getElementById('ghlink-Public Key Sign and Verify-idm1551').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-Public Key Sign and Verify-idm1551').style.visibility = 'hidden';"> <div class="title-name">Public Key Sign and Verify</div>  </h4> <article class="data-types-body"><h4 id="type-pk_sign_verify_algs" class="title-link data-type-name" onmouseover="document.getElementById('ghlink-type-pk_sign_verify_algs').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-type-pk_sign_verify_algs').style.visibility = 'hidden';">  <div class="title-name"> <code id="type-pk_sign_verify_algs">pk_sign_verify_algs() = rsa | dss | ecdsa | eddsa</code><br> </div> </h4> <div class="data-type-desc"> <p>Algorithms for sign and verify.</p> </div></article> <article class="data-types-body"><h4 id="type-pk_sign_verify_opts" class="title-link data-type-name" onmouseover="document.getElementById('ghlink-type-pk_sign_verify_opts').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-type-pk_sign_verify_opts').style.visibility = 'hidden';">  <div class="title-name"> <code>pk_sign_verify_opts() = [<span id="type-pk_sign_verify_opts"><a href="#type-rsa_sign_verify_opt">rsa_sign_verify_opt()</a></span>]</code><br> <code>rsa_sign_verify_opt() = <br id="type-rsa_sign_verify_opt">    {rsa_padding, <span><a href="#type-rsa_sign_verify_padding">rsa_sign_verify_padding()</a></span>} |<br>    {rsa_pss_saltlen, <span>integer()</span>} |<br>    {rsa_mgf1_md, <span><a href="#type-sha2">sha2()</a></span>}</code><br> <code>rsa_sign_verify_padding() = <br id="type-rsa_sign_verify_padding">    rsa_pkcs1_padding | rsa_pkcs1_pss_padding | rsa_x931_padding |<br>    rsa_no_padding</code><br> </div> </h4> <div class="data-type-desc"> <p>Options for sign and verify.</p> <div class="warning"> <div class="label">Warning</div> <div class="content">

<p>The RSA options are experimental. </p> <p>The exact set of options and there syntax <strong>may</strong> be changed without prior notice.</p> </div> </div> </div></article> <h4 id="Diffie-Hellman Keys and parameters" class="title-link" onmouseover="document.getElementById('ghlink-Diffie-Hellman Keys and parameters-idm1566').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-Diffie-Hellman Keys and parameters-idm1566').style.visibility = 'hidden';"> <div class="title-name">Diffie-Hellman Keys and parameters</div>  </h4> <article class="data-types-body"><h4 id="type-dh_public" class="title-link data-type-name" onmouseover="document.getElementById('ghlink-type-dh_public').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-type-dh_public').style.visibility = 'hidden';">  <div class="title-name"> <code>dh_public() = <span id="type-dh_public"><a href="#type-key_integer">key_integer()</a></span></code><br> <code>dh_private() = <span id="type-dh_private"><a href="#type-key_integer">key_integer()</a></span></code><br> </div> </h4> </article> <article class="data-types-body"><h4 id="type-dh_params" class="title-link data-type-name" onmouseover="document.getElementById('ghlink-type-dh_params').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-type-dh_params').style.visibility = 'hidden';">  <div class="title-name"> <code>dh_params() = [<span id="type-dh_params"><a href="#type-key_integer">key_integer()</a></span>]</code><br> </div> </h4> <div class="data-type-desc"> <pre data-language="erlang">dh_params() = [P, G] | [P, G, PrivateKeyBitLength]</pre> </div></article> <article class="data-types-body"><h4 id="type-ecdh_public" class="title-link data-type-name" onmouseover="document.getElementById('ghlink-type-ecdh_public').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-type-ecdh_public').style.visibility = 'hidden';">  <div class="title-name"> <code>ecdh_public() = <span id="type-ecdh_public"><a href="#type-key_integer">key_integer()</a></span></code><br> <code>ecdh_private() = <span id="type-ecdh_private"><a href="#type-key_integer">key_integer()</a></span></code><br> <code>ecdh_params() = <br id="type-ecdh_params">    <span><a href="#type-ec_named_curve">ec_named_curve()</a></span> | <span><a href="#type-edwards_curve_dh">edwards_curve_dh()</a></span> | <span><a href="#type-ec_explicit_curve">ec_explicit_curve()</a></span></code><br> </div> </h4> </article> <h4 id="Types for Engines" class="title-link" onmouseover="document.getElementById('ghlink-Types for Engines-idm1580').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-Types for Engines-idm1580').style.visibility = 'hidden';"> <div class="title-name">Types for Engines</div>  </h4> <article class="data-types-body"><h4 id="type-engine_key_ref" class="title-link data-type-name" onmouseover="document.getElementById('ghlink-type-engine_key_ref').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-type-engine_key_ref').style.visibility = 'hidden';">  <div class="title-name"> <code>engine_key_ref() = <br id="type-engine_key_ref">    #{engine := <span><a href="#type-engine_ref">engine_ref()</a></span>,<br>      key_id := <span><a href="#type-key_id">key_id()</a></span>,<br>      password =&gt; <span><a href="#type-password">password()</a></span>,<br>      <span>term()</span> =&gt; <span>term()</span>}</code><br> <code>engine_ref() = <span id="type-engine_ref">term()</span></code><br> </div> </h4> <div class="data-type-desc"> <p>The result of a call to <code><a href="#engine_load-3">engine_load/3</a></code>. </p> </div></article> <article class="data-types-body"><h4 id="type-key_id" class="title-link data-type-name" onmouseover="document.getElementById('ghlink-type-key_id').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-type-key_id').style.visibility = 'hidden';">  <div class="title-name"> <code>key_id() = <span id="type-key_id">string()</span> | <span>binary()</span></code><br> </div> </h4> <div class="data-type-desc"> <p>Identifies the key to be used. The format depends on the loaded engine. It is passed to the <code class="code">ENGINE_load_(private|public)_key</code> functions in libcrypto. </p> </div></article> <article class="data-types-body"><h4 id="type-password" class="title-link data-type-name" onmouseover="document.getElementById('ghlink-type-password').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-type-password').style.visibility = 'hidden';">  <div class="title-name"> <code>password() = <span id="type-password">string()</span> | <span>binary()</span></code><br> </div> </h4> <div class="data-type-desc"> <p>The password of the key stored in an engine. </p> </div></article> <article class="data-types-body"><h4 id="type-engine_method_type" class="title-link data-type-name" onmouseover="document.getElementById('ghlink-type-engine_method_type').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-type-engine_method_type').style.visibility = 'hidden';">  <div class="title-name"> <code>engine_method_type() = <br id="type-engine_method_type">    engine_method_rsa | engine_method_dsa | engine_method_dh |<br>    engine_method_rand | engine_method_ecdh |<br>    engine_method_ecdsa | engine_method_ciphers |<br>    engine_method_digests | engine_method_store |<br>    engine_method_pkey_meths | engine_method_pkey_asn1_meths |<br>    engine_method_ec</code><br> </div> </h4> </article> <article class="data-types-body"><h4 id="type-engine_cmnd" class="title-link data-type-name" onmouseover="document.getElementById('ghlink-type-engine_cmnd').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-type-engine_cmnd').style.visibility = 'hidden';">  <div class="title-name"> <code>engine_cmnd() = {<span id="type-engine_cmnd">unicode:chardata()</span>, <span>unicode:chardata()</span>}</code><br> </div> </h4> <div class="data-type-desc"> <p>Pre and Post commands for <code><a href="#engine_load-3">engine_load/3 and /4</a></code>. </p> </div></article> <h4 id="Internal data types" class="title-link" onmouseover="document.getElementById('ghlink-Internal data types-idm1603').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-Internal data types-idm1603').style.visibility = 'hidden';"> <div class="title-name">Internal data types</div>  </h4> <article class="data-types-body"><h4 id="type-crypto_state" class="title-link data-type-name" onmouseover="document.getElementById('ghlink-type-crypto_state').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-type-crypto_state').style.visibility = 'hidden';">  <div class="title-name"> <code id="type-crypto_state">crypto_state()</code><br> <code id="type-hash_state">hash_state()</code><br> <code id="type-mac_state">mac_state()</code><br> </div> </h4> <div class="data-type-desc"> <p>Contexts with an internal state that should not be manipulated but passed between function calls. </p> </div></article> </div> <section class="innertube"><h2 id="exceptions" class="title-link" onmouseover="document.getElementById('ghlink-exceptions-idm1610').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-exceptions-idm1610').style.visibility = 'hidden';"> <div class="title-name">Exceptions</div>  </h2>  <section><h4 id="Atoms - the older style">Atoms - the older style</h4>   <p id="error_old">The exception <code class="code">error:badarg</code> signifies that one or more arguments are of wrong data type, or are otherwise badly formed. </p> <p>The exception <code class="code">error:notsup</code> signifies that the algorithm is known but is not supported by current underlying libcrypto or explicitly disabled when building that. </p> <p>For a list of supported algorithms, see <code><a href="#supports-1">supports(ciphers)</a></code>. </p> </section> <section><h4 id="3-tuples - the new style">3-tuples - the new style</h4>   <p id="error_3tup">The exception is:</p> <pre data-language="erlang">
error:{Tag, C_FileInfo, Description}

Tag = badarg | notsup | error
C_FileInfo = term()    % Usually only useful for the OTP maintainer
Description = string() % Clear text, sometimes only useful for the OTP maintainer
      </pre> <p>The exception tags are:</p> <dl> <dt><strong><code class="code">badarg</code></strong></dt> <dd> <p>Signifies that one or more arguments are of wrong data type or are otherwise badly formed.</p> </dd> <dt><strong><code class="code">notsup</code></strong></dt> <dd> <p>Signifies that the algorithm is known but is not supported by current underlying libcrypto or explicitly disabled when building that one.</p> </dd> <dt><strong><code class="code">error</code></strong></dt> <dd> <p>An error condition that should not occur, for example a memory allocation failed or the underlying cryptolib returned an error code, for example <code class="code">"Can't initialize context, step 1"</code>. Those text usually needs searching the C-code to be understood.</p> </dd> </dl> <p>Usually there are more information in the call stack about which argument caused the exception and what the values where.</p> <p>To catch the exception, use for example:</p> <pre data-language="erlang">try crypto:crypto_init(Ciph, Key, IV, true)
    catch
        error:{Tag, _C_FileInfo, Description} -&gt;
            do_something(......)
         .....
end</pre> </section> </section> <div class="innertube"><h2 id="export" class="title-link" onmouseover="document.getElementById('ghlink-export-idm1644').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-export-idm1644').style.visibility = 'hidden';"> <div class="title-name">Exports</div>  </h2></div> <div class="exports-body"> <article class="func"><h4 id="crypto_init-3" onmouseover="document.getElementById('ghlink-crypto_init-3-idp1').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-crypto_init-3-idp1').style.visibility = 'hidden';">  <span class="title-name">crypto_init(Cipher, Key, FlagOrOptions) -&gt; State</span><div class="title-since"><span class="since">OTP 22.0</span></div> </h4>  <h2 id="types" class="func-types-title">Types</h2>      <div class="exports-tube"> <p>Uses the <code><a href="#error_3tup">3-tuple style</a></code> for error handling.</p> <p>Equivalent to the call <code><a href="#crypto_init-4"><span class="code">crypto_init(Cipher, Key, &lt;&lt;&gt;&gt;, FlagOrOptions)</span></a></code>. It is intended for ciphers without an IV (nounce). </p> </div></article><article class="func"><h4 id="crypto_init-4" onmouseover="document.getElementById('ghlink-crypto_init-4-idp2').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-crypto_init-4-idp2').style.visibility = 'hidden';">  <span class="title-name">crypto_init(Cipher, Key, IV, FlagOrOptions) -&gt; State</span><div class="title-since"><span class="since">OTP 22.0</span></div> </h4>  <h2 id="types" class="func-types-title">Types</h2>       <div class="exports-tube"> <p>Uses the <code><a href="#error_3tup">3-tuple style</a></code> for error handling.</p> <p> Initializes a series of encryptions or decryptions and creates an internal state with a reference that is returned. </p> <p>If <code class="code">IV = &lt;&lt;&gt;&gt;</code>, no IV is used. This is intended for ciphers without an IV (nounce). See <code><a href="#crypto_init-3">crypto_init/3</a></code>. </p> <p> If <code class="code">IV = undefined</code>, the IV must be added by calls to <code><a href="crypto#crypto_dyn_iv_update-3">crypto_dyn_iv_update/3</a></code>. This is intended for cases where the IV (nounce) need to be changed for each encryption and decryption. See <code><a href="#crypto_dyn_iv_init-3">crypto_dyn_iv_init/3</a></code>. </p> <p> The actual encryption or decryption is done by <code><a href="crypto#crypto_update-2">crypto_update/2</a></code> (or <code><a href="crypto#crypto_dyn_iv_update-3">crypto_dyn_iv_update/3</a></code> ). </p> <p>For encryption, set the <code class="code">FlagOrOptions</code> to <code class="code">true</code> or <code class="code">[{encrypt,true}]</code>. For decryption, set it to <code class="code">false</code> or <code class="code">[{encrypt,false}]</code>. </p> <p>Padding could be enabled with the option <code><a href="#type-padding">{padding,Padding}</a></code>. The <code><a href="#type-cryptolib_padding">cryptolib_padding</a></code> enables <code class="code">pkcs_padding</code> or no padding (<code class="code">none</code>). The paddings <code class="code">zero</code> or <code class="code">random</code> fills the last part of the last block with zeroes or random bytes. If the last block is already full, nothing is added. </p> <p>In decryption, the <code><a href="#type-cryptolib_padding">cryptolib_padding</a></code> removes such padding, if present. The <code><a href="#type-otp_padding">otp_padding</a></code> is not removed - it has to be done elsewhere. </p> <p>If padding is <code class="code">{padding,none}</code> or not specified and the total data from all subsequent <code><a href="crypto#crypto_update-2">crypto_updates</a></code> does not fill the last block fully, that last data is lost. In case of <code class="code">{padding,none}</code> there will be an error in this case. If padding is not specified, the bytes of the unfilled block is silently discarded. </p> <p>The actual padding is performed by <code><a href="crypto#crypto_final-1">crypto_final/1</a></code>. </p> <p> For blocksizes call <code><a href="#cipher_info-1">cipher_info/1</a></code>. </p> <p>See <code> examples in the User's Guide.</code> </p> </div></article><article class="func"><h4 id="crypto_update-2" onmouseover="document.getElementById('ghlink-crypto_update-2-idp3').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-crypto_update-2-idp3').style.visibility = 'hidden';">  <span class="title-name">crypto_update(State, Data) -&gt; Result</span><div class="title-since"><span class="since">OTP 22.0</span></div> </h4>  <h2 id="types" class="func-types-title">Types</h2>     <div class="exports-tube"> <p>Uses the <code><a href="#error_3tup">3-tuple style</a></code> for error handling.</p> <p> It does an actual crypto operation on a part of the full text. If the part is less than a number of full blocks, only the full blocks (possibly none) are encrypted or decrypted and the remaining bytes are saved to the next <code class="code">crypto_update</code> operation. The <code class="code">State</code> should be created with <code><a href="crypto#crypto_init-3">crypto_init/3</a></code> or <code><a href="crypto#crypto_init-4">crypto_init/4</a></code>. </p> <p>See <code> examples in the User's Guide.</code> </p> </div></article><article class="func"><h4 id="crypto_dyn_iv_init-3" onmouseover="document.getElementById('ghlink-crypto_dyn_iv_init-3-idp4').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-crypto_dyn_iv_init-3-idp4').style.visibility = 'hidden';">  <span class="title-name">crypto_dyn_iv_init(Cipher, Key, FlagOrOptions) -&gt; State</span><div class="title-since"><span class="since">OTP 22.0</span></div> </h4>  <h2 id="types" class="func-types-title">Types</h2>      <div class="exports-tube"> <p>Uses the <code><a href="#error_3tup">3-tuple style</a></code> for error handling.</p> <p>Initializes a series of encryptions or decryptions where the IV is provided later. The actual encryption or decryption is done by <code><a href="crypto#crypto_dyn_iv_update-3">crypto_dyn_iv_update/3</a></code>. </p> <p>The function is equivalent to <code><a href="#crypto_init-4"><span class="code">crypto_init(Cipher, Key, undefined, FlagOrOptions)</span></a></code>. </p> </div></article><article class="func"><h4 id="crypto_final-1" onmouseover="document.getElementById('ghlink-crypto_final-1-idp5').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-crypto_final-1-idp5').style.visibility = 'hidden';">  <span class="title-name">crypto_final(State) -&gt; FinalResult</span><div class="title-since"><span class="since">OTP 23.0</span></div> </h4>  <h2 id="types" class="func-types-title">Types</h2>    <div class="exports-tube"> <p>Uses the <code><a href="#error_3tup">3-tuple style</a></code> for error handling.</p> <p> Finalizes a series of encryptions or decryptions and delivers the final bytes of the final block. The data returned from this function may be empty if no padding was enabled in <code><a href="#crypto_init-3">crypto_init/3,4</a></code> or <code><a href="#crypto_dyn_iv_init-3">crypto_dyn_iv_init/3</a></code>. </p> </div></article><article class="func"><h4 id="crypto_get_data-1" onmouseover="document.getElementById('ghlink-crypto_get_data-1-idp6').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-crypto_get_data-1-idp6').style.visibility = 'hidden';">  <span class="title-name">crypto_get_data(State) -&gt; Result</span><div class="title-since"><span class="since">OTP 23.0</span></div> </h4>  <h2 id="types" class="func-types-title">Types</h2>    <div class="exports-tube"> <p>Uses the <code><a href="#error_3tup">3-tuple style</a></code> for error handling.</p> <p> Returns information about the State in the argument. The information is the form of a map, which currently contains at least: </p> <dl> <dt><strong><code class="code">size</code></strong></dt> <dd>The number of bytes encrypted or decrypted so far. </dd> <dt><strong><code class="code">padding_size</code></strong></dt> <dd>After a call to <code><a href="#crypto_final-1">crypto_final/1</a></code> it contains the number of bytes padded. Otherwise 0. </dd> <dt><strong><code class="code">padding_type</code></strong></dt> <dd>The type of the padding as provided in the call to <code><a href="#crypto_init-3">crypto_init/3,4</a></code>. </dd> <dt><strong><code class="code">encrypt</code></strong></dt> <dd>Is <code class="code">true</code> if encryption is performed. It is <code class="code">false</code> otherwise. </dd> </dl> </div></article><article class="func"><h4 id="crypto_dyn_iv_update-3" onmouseover="document.getElementById('ghlink-crypto_dyn_iv_update-3-idp7').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-crypto_dyn_iv_update-3-idp7').style.visibility = 'hidden';">  <span class="title-name">crypto_dyn_iv_update(State, Data, IV) -&gt; Result</span><div class="title-since"><span class="since">OTP 22.0</span></div> </h4>  <h2 id="types" class="func-types-title">Types</h2>      <div class="exports-tube"> <p>Uses the <code><a href="#error_3tup">3-tuple style</a></code> for error handling.</p> <p> Do an actual crypto operation on a part of the full text and the IV is supplied for each part. The <code class="code">State</code> should be created with <code><a href="crypto#crypto_dyn_iv_init-3">crypto_dyn_iv_init/3</a></code>. </p> </div></article><article class="func"><h4 id="crypto_one_time-4" onmouseover="document.getElementById('ghlink-crypto_one_time-4-idp8').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-crypto_one_time-4-idp8').style.visibility = 'hidden';">  <span class="title-name">crypto_one_time(Cipher, Key, Data, FlagOrOptions) -&gt; Result</span><div class="title-since"><span class="since">OTP 22.0</span></div> </h4>  <h2 id="types" class="func-types-title">Types</h2>       <div class="exports-tube"> <p>Uses the <code><a href="#error_3tup">3-tuple style</a></code> for error handling.</p> <p>As <code><a href="#crypto_one_time-5">crypto_one_time/5</a></code> but for ciphers without IVs.</p> </div></article><article class="func"><h4 id="crypto_one_time-5" onmouseover="document.getElementById('ghlink-crypto_one_time-5-idp9').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-crypto_one_time-5-idp9').style.visibility = 'hidden';">  <span class="title-name">crypto_one_time(Cipher, Key, IV, Data, FlagOrOptions) -&gt; Result</span><div class="title-since"><span class="since">OTP 22.0</span></div> </h4>  <h2 id="types" class="func-types-title">Types</h2>        <div class="exports-tube"> <p>Uses the <code><a href="#error_3tup">3-tuple style</a></code> for error handling.</p> <p> Do a complete encrypt or decrypt of the full text in the argument <code class="code">Data</code>. </p> <p>For encryption, set the <code class="code">FlagOrOptions</code> to <code class="code">true</code>. For decryption, set it to <code class="code">false</code>. For setting other options, see <code><a href="crypto#crypto_init-4">crypto_init/4</a></code>. </p> <p>See <code>examples in the User's Guide.</code> </p> </div></article><article class="func"><h4 id="crypto_one_time_aead-6" onmouseover="document.getElementById('ghlink-crypto_one_time_aead-6-idp10').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-crypto_one_time_aead-6-idp10').style.visibility = 'hidden';">  <span class="title-name">crypto_one_time_aead(Cipher, Key, IV, InText, AAD,<br> EncFlag :: true) -&gt;<br> Result</span><div class="title-since"><span class="since">OTP 22.0</span></div> </h4> <h4 id="crypto_one_time_aead-7" onmouseover="document.getElementById('ghlink-crypto_one_time_aead-7-idp11').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-crypto_one_time_aead-7-idp11').style.visibility = 'hidden';">  <span class="title-name">crypto_one_time_aead(Cipher, Key, IV, InText, AAD, TagOrTagLength,<br> EncFlag) -&gt;<br> Result</span><div class="title-since"><span class="since">OTP 22.0</span></div> </h4>  <h2 id="types" class="func-types-title">Types</h2>                 <div class="exports-tube"> <p>Uses the <code><a href="#error_3tup">3-tuple style</a></code> for error handling.</p> <p> Do a complete encrypt or decrypt with an AEAD cipher of the full text. </p> <p>For encryption, set the <code class="code">EncryptFlag</code> to <code class="code">true</code> and set the <code class="code">TagOrTagLength</code> to the wanted size (in bytes) of the tag, that is, the tag length. If the default length is wanted, the <code class="code">crypto_aead/6</code> form may be used. </p> <p>For decryption, set the <code class="code">EncryptFlag</code> to <code class="code">false</code> and put the tag to be checked in the argument <code class="code">TagOrTagLength</code>. </p> <p>See <code>examples in the User's Guide.</code> </p> </div></article><article class="func"><h4 id="supports-1" onmouseover="document.getElementById('ghlink-supports-1-idp12').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-supports-1-idp12').style.visibility = 'hidden';">  <span class="title-name">supports(Type) -&gt; Support</span><div class="title-since"><span class="since">OTP 22.0</span></div> </h4>  <h2 id="types" class="func-types-title">Types</h2>          <div class="exports-tube"> <p> Can be used to determine which crypto algorithms that are supported by the underlying libcrypto library</p> <p>See <code><a href="#hash_info-1">hash_info/1</a></code> and <code><a href="#cipher_info-1">cipher_info/1</a></code> for information about the hash and cipher algorithms. </p> </div></article><article class="func"><h4 id="mac-3" onmouseover="document.getElementById('ghlink-mac-3-idp13').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-mac-3-idp13').style.visibility = 'hidden';">  <span class="title-name">mac(Type :: poly1305, Key, Data) -&gt; Mac</span><div class="title-since"><span class="since">OTP 22.1</span></div> </h4>  <h2 id="types" class="func-types-title">Types</h2>     <div class="exports-tube"> <p>Uses the <code><a href="#error_3tup">3-tuple style</a></code> for error handling.</p> <p>Short for <code><a href="#mac-4">mac(Type, undefined, Key, Data)</a></code>. </p> </div></article><article class="func"><h4 id="mac-4" onmouseover="document.getElementById('ghlink-mac-4-idp14').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-mac-4-idp14').style.visibility = 'hidden';">  <span class="title-name">mac(Type, SubType, Key, Data) -&gt; Mac</span><div class="title-since"><span class="since">OTP 22.1</span></div> </h4>  <h2 id="types" class="func-types-title">Types</h2>       <div class="exports-tube"> <p>Uses the <code><a href="#error_3tup">3-tuple style</a></code> for error handling.</p> <p>Computes a MAC (Message Authentication Code) of type <code class="code">Type</code> from <code class="code">Data</code>. </p> <p><code class="code">SubType</code> depends on the MAC <code class="code">Type</code>: </p> <ul> <li>For <code class="code">hmac</code> it is a hash algorithm, see <code><a href="algorithm_details#hmac">Algorithm Details</a></code> in the User's Guide. </li> <li>For <code class="code">cmac</code> it is a cipher suitable for cmac, see <code><a href="algorithm_details#cmac">Algorithm Details</a></code> in the User's Guide. </li> <li>For <code class="code">poly1305</code> it should be set to <code class="code">undefined</code> or the <code><a href="#mac_init-2">mac/2</a></code> function could be used instead, see <code><a href="algorithm_details#poly1305">Algorithm Details</a></code> in the User's Guide. </li> </ul> <p><code class="code">Key</code> is the authentication key with a length according to the <code class="code">Type</code> and <code class="code">SubType</code>. The key length could be found with the <code><a href="#hash_info-1">hash_info/1</a></code> (<code class="code">hmac</code>) for and <code><a href="#cipher_info-1">cipher_info/1</a></code> (<code class="code">cmac</code>) functions. For <code class="code">poly1305</code> the key length is 32 bytes. Note that the cryptographic quality of the key is not checked. </p> <p>The <code class="code">Mac</code> result will have a default length depending on the <code class="code">Type</code> and <code class="code">SubType</code>. To set a shorter length, use <code><a href="#macN-4">macN/4</a></code> or <code><a href="#macN-5">macN/5</a></code> instead. The default length is documented in <code><a href="algorithm_details#message-authentication-codes--macs-">Algorithm Details</a></code> in the User's Guide. </p> </div></article><article class="func"><h4 id="macN-4" onmouseover="document.getElementById('ghlink-macN-4-idp15').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-macN-4-idp15').style.visibility = 'hidden';">  <span class="title-name">macN(Type :: poly1305, Key, Data, MacLength) -&gt; Mac</span><div class="title-since"><span class="since">OTP 22.1</span></div> </h4>  <h2 id="types" class="func-types-title">Types</h2>      <div class="exports-tube"> <p>Uses the <code><a href="#error_3tup">3-tuple style</a></code> for error handling.</p> <p>Short for <code><a href="#macN-5">macN(Type, undefined, Key, Data, MacLength)</a></code>. </p> </div></article><article class="func"><h4 id="macN-5" onmouseover="document.getElementById('ghlink-macN-5-idp16').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-macN-5-idp16').style.visibility = 'hidden';">  <span class="title-name">macN(Type, SubType, Key, Data, MacLength) -&gt; Mac</span><div class="title-since"><span class="since">OTP 22.1</span></div> </h4>  <h2 id="types" class="func-types-title">Types</h2>        <div class="exports-tube"> <p>Computes a MAC (Message Authentication Code) as <code><a href="#mac-3">mac/3</a></code> and <code><a href="#mac-4">mac/4</a></code> but <code class="code">MacLength</code> will limit the size of the resultant <code class="code">Mac</code> to at most <code class="code">MacLength</code> bytes. Note that if <code class="code">MacLength</code> is greater than the actual number of bytes returned from the underlying hash, the returned hash will have that shorter length instead. </p> <p>The max <code class="code">MacLength</code> is documented in <code><a href="algorithm_details#message-authentication-codes--macs-">Algorithm Details</a></code> in the User's Guide. </p> </div></article><article class="func"><h4 id="mac_init-2" onmouseover="document.getElementById('ghlink-mac_init-2-idp17').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-mac_init-2-idp17').style.visibility = 'hidden';">  <span class="title-name">mac_init(Type :: poly1305, Key) -&gt; State</span><div class="title-since"><span class="since">OTP 22.1</span></div> </h4>  <h2 id="types" class="func-types-title">Types</h2>    <div class="exports-tube"> <p>Uses the <code><a href="#error_3tup">3-tuple style</a></code> for error handling.</p> <p>Short for <code><a href="#mac_init-3">mac_init(Type, undefined, Key)</a></code>. </p> </div></article><article class="func"><h4 id="mac_init-3" onmouseover="document.getElementById('ghlink-mac_init-3-idp18').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-mac_init-3-idp18').style.visibility = 'hidden';">  <span class="title-name">mac_init(Type, SubType, Key) -&gt; State</span><div class="title-since"><span class="since">OTP 22.1</span></div> </h4>  <h2 id="types" class="func-types-title">Types</h2>      <div class="exports-tube"> <p>Uses the <code><a href="#error_3tup">3-tuple style</a></code> for error handling.</p> <p>Initializes the context for streaming MAC operations. </p> <p><code class="code">Type</code> determines which mac algorithm to use in the MAC operation. </p> <p><code class="code">SubType</code> depends on the MAC <code class="code">Type</code>: </p> <ul> <li>For <code class="code">hmac</code> it is a hash algorithm, see <code><a href="algorithm_details#hmac">Algorithm Details</a></code> in the User's Guide. </li> <li>For <code class="code">cmac</code> it is a cipher suitable for cmac, see <code><a href="algorithm_details#cmac">Algorithm Details</a></code> in the User's Guide. </li> <li>For <code class="code">poly1305</code> it should be set to <code class="code">undefined</code> or the <code><a href="#mac_init-2">mac/2</a></code> function could be used instead, see <code><a href="algorithm_details#poly1305">Algorithm Details</a></code> in the User's Guide. </li> </ul> <p><code class="code">Key</code> is the authentication key with a length according to the <code class="code">Type</code> and <code class="code">SubType</code>. The key length could be found with the <code><a href="#hash_info-1">hash_info/1</a></code> (<code class="code">hmac</code>) for and <code><a href="#cipher_info-1">cipher_info/1</a></code> (<code class="code">cmac</code>) functions. For <code class="code">poly1305</code> the key length is 32 bytes. Note that the cryptographic quality of the key is not checked. </p> <p>The returned <code class="code">State</code> should be used in one or more subsequent calls to <code><a href="#mac_update-2">mac_update/2</a></code>. The MAC value is finally returned by calling <code><a href="#mac_final-1">mac_final/1</a></code> or <code><a href="#mac_finalN-2">mac_finalN/2</a></code>. </p> <p>See <code> examples in the User's Guide.</code> </p> </div></article><article class="func"><h4 id="mac_update-2" onmouseover="document.getElementById('ghlink-mac_update-2-idp19').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-mac_update-2-idp19').style.visibility = 'hidden';">  <span class="title-name">mac_update(State0, Data) -&gt; State</span><div class="title-since"><span class="since">OTP 22.1</span></div> </h4>  <h2 id="types" class="func-types-title">Types</h2>     <div class="exports-tube"> <p>Uses the <code><a href="#error_3tup">3-tuple style</a></code> for error handling.</p> <p>Updates the MAC represented by <code class="code">State0</code> using the given <code class="code">Data</code> which could be of any length. </p> <p>The <code class="code">State0</code> is the State value originally from a MAC init function, that is <code><a href="#mac_init-2">mac_init/2</a></code>, <code><a href="#mac_init-3">mac_init/3</a></code> or a previous call of <code class="code">mac_update/2</code>. The value <code class="code">State0</code> is returned unchanged by the function as <code class="code">State</code>. </p> </div></article><article class="func"><h4 id="mac_final-1" onmouseover="document.getElementById('ghlink-mac_final-1-idp20').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-mac_final-1-idp20').style.visibility = 'hidden';">  <span class="title-name">mac_final(State) -&gt; Mac</span><div class="title-since"><span class="since">OTP 22.1</span></div> </h4>  <h2 id="types" class="func-types-title">Types</h2>    <div class="exports-tube"> <p>Uses the <code><a href="#error_3tup">3-tuple style</a></code> for error handling.</p> <p>Finalizes the MAC operation referenced by <code class="code">State</code>. The <code class="code">Mac</code> result will have a default length depending on the <code class="code">Type</code> and <code class="code">SubType</code> in the <code><a href="#mac_init-3">mac_init/2,3</a></code> call. To set a shorter length, use <code><a href="#mac_finalN-2">mac_finalN/2</a></code> instead. The default length is documented in <code><a href="algorithm_details#message-authentication-codes--macs-">Algorithm Details</a></code> in the User's Guide. </p> </div></article><article class="func"><h4 id="mac_finalN-2" onmouseover="document.getElementById('ghlink-mac_finalN-2-idp21').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-mac_finalN-2-idp21').style.visibility = 'hidden';">  <span class="title-name">mac_finalN(State, MacLength) -&gt; Mac</span><div class="title-since"><span class="since">OTP 22.1</span></div> </h4>  <h2 id="types" class="func-types-title">Types</h2>     <div class="exports-tube"> <p>Uses the <code><a href="#error_3tup">3-tuple style</a></code> for error handling.</p> <p>Finalizes the MAC operation referenced by <code class="code">State</code>. </p> <p><code class="code">Mac</code> will be a binary with at most <code class="code">MacLength</code> bytes. Note that if <code class="code">MacLength</code> is greater than the actual number of bytes returned from the underlying hash, the returned hash will have that shorter length instead. </p> <p>The max <code class="code">MacLength</code> is documented in <code><a href="algorithm_details#message-authentication-codes--macs-">Algorithm Details</a></code> in the User's Guide. </p> </div></article><article class="func"><h4 id="bytes_to_integer-1" onmouseover="document.getElementById('ghlink-bytes_to_integer-1-idp22').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-bytes_to_integer-1-idp22').style.visibility = 'hidden';">  <span class="title-name">bytes_to_integer(Bin :: <code>binary()</code>) -&gt; <code>integer()</code></span><div class="title-since"><span class="since">OTP R16B01</span></div> </h4> <div class="exports-tube"> <p>Convert binary representation, of an integer, to an Erlang integer. </p> </div></article><article class="func"><h4 id="compute_key-4" onmouseover="document.getElementById('ghlink-compute_key-4-idp23').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-compute_key-4-idp23').style.visibility = 'hidden';">  <span class="title-name">compute_key(Type, OthersPublicKey, MyPrivateKey, Params) -&gt;<br> SharedSecret</span><div class="title-since"><span class="since">OTP R16B01</span></div> </h4>  <h2 id="types" class="func-types-title">Types</h2>       <div class="exports-tube"> <p>Uses the <code><a href="#error_3tup">3-tuple style</a></code> for error handling.</p> <p>Computes the shared secret from the private key and the other party's public key. See also <code>public_key:compute_key/2</code> </p> </div></article><article class="func"><h4 id="exor-2" onmouseover="document.getElementById('ghlink-exor-2-idp24').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-exor-2-idp24').style.visibility = 'hidden';">  <span class="title-name">exor(Bin1 :: <code>iodata()</code>, Bin2 :: <code>iodata()</code>) -&gt; <code>binary()</code></span> </h4> <div class="exports-tube"> <p>Performs bit-wise XOR (exclusive or) on the data supplied.</p> </div></article><article class="func"><h4 id="generate_key-2" onmouseover="document.getElementById('ghlink-generate_key-2-idp25').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-generate_key-2-idp25').style.visibility = 'hidden';">  <span class="title-name">generate_key(Type, Params) -&gt; {PublicKey, PrivKeyOut}</span><div class="title-since"><span class="since">OTP R16B01</span></div> </h4> <h4 id="generate_key-3" onmouseover="document.getElementById('ghlink-generate_key-3-idp26').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-generate_key-3-idp26').style.visibility = 'hidden';">  <span class="title-name">generate_key(Type, Params, PrivKeyIn) -&gt; {PublicKey, PrivKeyOut}</span><div class="title-since"><span class="since">OTP R16B01</span></div> </h4>  <h2 id="types" class="func-types-title">Types</h2>       <div class="exports-tube"> <p>Uses the <code><a href="#error_3tup">3-tuple style</a></code> for error handling.</p> <p>Generates a public key of type <code class="code">Type</code>. See also <code>public_key:generate_key/1</code>. </p> <div class="note"> <div class="label">Note</div> <div class="content">

<p>If the linked version of cryptolib is OpenSSL 3.0</p> <ul> <li> <p>and the <code class="code">Type</code> is <code class="code">dh</code> (diffie-hellman)</p> </li> <li> <p>and the parameter <code class="code">P</code> (in <code><a href="#type-dh_params">dh_params()</a></code>) is one of the MODP groups (see <code><a href="https://tools.ietf.org/html/rfc3526">RFC 3526</a></code>)</p> </li> <li> <p>and the optional <code class="code">PrivateKeyBitLength</code> parameter (in <code><a href="#type-dh_params">dh_params()</a></code>) is present,</p> </li> </ul> <p>then the optional key length parameter must be at least 224, 256, 302, 352 and 400 for group sizes of 2048, 3072, 4096, 6144 and 8192, respectively.</p> </div> </div> <div class="note"> <div class="label">Note</div> <div class="content">

<p>RSA key generation is only available if the runtime was built with dirty scheduler support. Otherwise, attempting to generate an RSA key will raise the exception <code class="code">error:notsup</code>.</p> </div> </div> </div></article><article class="func"><h4 id="hash-2" onmouseover="document.getElementById('ghlink-hash-2-idp27').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-hash-2-idp27').style.visibility = 'hidden';">  <span class="title-name">hash(Type, Data) -&gt; Digest</span><div class="title-since"><span class="since">OTP R15B02</span></div> </h4>  <h2 id="types" class="func-types-title">Types</h2>     <div class="exports-tube"> <p>Uses the <code><a href="#error_3tup">3-tuple style</a></code> for error handling.</p> <p>Computes a message digest of type <code class="code">Type</code> from <code class="code">Data</code>.</p> </div></article><article class="func"><h4 id="hash_init-1" onmouseover="document.getElementById('ghlink-hash_init-1-idp28').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-hash_init-1-idp28').style.visibility = 'hidden';">  <span class="title-name">hash_init(Type) -&gt; State</span><div class="title-since"><span class="since">OTP R15B02</span></div> </h4>  <h2 id="types" class="func-types-title">Types</h2>    <div class="exports-tube"> <p>Uses the <code><a href="#error_3tup">3-tuple style</a></code> for error handling.</p> <p>Initializes the context for streaming hash operations. <code class="code">Type</code> determines which digest to use. The returned context should be used as argument to <code><a href="#hash_update-2">hash_update</a></code>.</p> </div></article><article class="func"><h4 id="hash_update-2" onmouseover="document.getElementById('ghlink-hash_update-2-idp29').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-hash_update-2-idp29').style.visibility = 'hidden';">  <span class="title-name">hash_update(State, Data) -&gt; NewState</span><div class="title-since"><span class="since">OTP R15B02</span></div> </h4>  <h2 id="types" class="func-types-title">Types</h2>     <div class="exports-tube"> <p>Uses the <code><a href="#error_3tup">3-tuple style</a></code> for error handling.</p> <p>Updates the digest represented by <code class="code">Context</code> using the given <code class="code">Data</code>. <code class="code">Context</code> must have been generated using <code><a href="#hash_init-1">hash_init</a></code> or a previous call to this function. <code class="code">Data</code> can be any length. <code class="code">NewContext</code> must be passed into the next call to <code class="code">hash_update</code> or <code><a href="#hash_final-1">hash_final</a></code>.</p> </div></article><article class="func"><h4 id="hash_final-1" onmouseover="document.getElementById('ghlink-hash_final-1-idp30').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-hash_final-1-idp30').style.visibility = 'hidden';">  <span class="title-name">hash_final(State) -&gt; Digest</span><div class="title-since"><span class="since">OTP R15B02</span></div> </h4>  <h2 id="types" class="func-types-title">Types</h2>    <div class="exports-tube"> <p>Uses the <code><a href="#error_3tup">3-tuple style</a></code> for error handling.</p> <p>Finalizes the hash operation referenced by <code class="code">Context</code> returned from a previous call to <code><a href="#hash_update-2">hash_update</a></code>. The size of <code class="code">Digest</code> is determined by the type of hash function used to generate it.</p> </div></article><article class="func"><h4 id="info_fips-0" onmouseover="document.getElementById('ghlink-info_fips-0-idp31').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-info_fips-0-idp31').style.visibility = 'hidden';">  <span class="title-name">info_fips() -&gt; not_supported | not_enabled | enabled</span><div class="title-since"><span class="since">OTP 20.0</span></div> </h4> <div class="exports-tube"> <p>Provides information about the FIPS operating status of crypto and the underlying libcrypto library. If crypto was built with FIPS support this can be either <code class="code">enabled</code> (when running in FIPS mode) or <code class="code">not_enabled</code>. For other builds this value is always <code class="code">not_supported</code>. </p> <p>See <code><a href="#enable_fips_mode-1">enable_fips_mode/1</a></code> about how to enable FIPS mode. </p> <div class="warning"> <div class="label">Warning</div> <div class="content">

<p>In FIPS mode all non-FIPS compliant algorithms are disabled and raise exception <code class="code">error:notsup</code>. Check <code><a href="#supports-1">supports(ciphers)</a></code> that in FIPS mode returns the restricted list of available algorithms.</p> </div> </div> </div></article><article class="func"><h4 id="enable_fips_mode-1" onmouseover="document.getElementById('ghlink-enable_fips_mode-1-idp32').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-enable_fips_mode-1-idp32').style.visibility = 'hidden';">  <span class="title-name">enable_fips_mode(Enable) -&gt; Result</span><div class="title-since"><span class="since">OTP 21.1</span></div> </h4>  <h2 id="types" class="func-types-title">Types</h2>    <div class="exports-tube"> <p>Enables (<code class="code">Enable = true</code>) or disables (<code class="code">Enable = false</code>) FIPS mode. Returns <code class="code">true</code> if the operation was successful or <code class="code">false</code> otherwise. </p> <p>Note that to enable FIPS mode successfully, OTP must be built with the configure option <code class="code">--enable-fips</code>, and the underlying libcrypto must also support FIPS. </p> <p>See also <code><a href="#info_fips-0">info_fips/0</a></code>. </p> </div></article><article class="func"><h4 id="info-0" onmouseover="document.getElementById('ghlink-info-0-idp33').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-info-0-idp33').style.visibility = 'hidden';">  <span class="title-name">info() -&gt;<br> #{compile_type := normal | debug | valgrind | asan,<br> cryptolib_version_compiled =&gt; <code>string()</code> | undefined,<br> cryptolib_version_linked := <code>string()</code>,<br> link_type := dynamic | static,<br> otp_crypto_version := <code>string()</code>}</span><div class="title-since"><span class="since">OTP 24.2</span></div> </h4> <div class="exports-tube"> <p>Provides a map with information about the compilation and linking of crypto. </p> <p>Example:</p> <pre data-language="erlang">1&gt; crypto:info().
#{compile_type =&gt; normal,
  cryptolib_version_compiled =&gt; "OpenSSL 3.0.0 7 sep 2021",
  cryptolib_version_linked =&gt; "OpenSSL 3.0.0 7 sep 2021",
  link_type =&gt; dynamic,
  otp_crypto_version =&gt; "5.0.2"}
2&gt;</pre> <p>More association types than documented may be present in the map. </p> </div></article><article class="func"><h4 id="info_lib-0" onmouseover="document.getElementById('ghlink-info_lib-0-idp34').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-info_lib-0-idp34').style.visibility = 'hidden';">  <span class="title-name">info_lib() -&gt; [{Name, VerNum, VerStr}]</span> </h4>  <h2 id="types" class="func-types-title">Types</h2>     <div class="exports-tube"> <p>Provides the name and version of the libraries used by crypto.</p> <p><code class="code">Name</code> is the name of the library. <code class="code">VerNum</code> is the numeric version according to the library's own versioning scheme. <code class="code">VerStr</code> contains a text variant of the version.</p> <pre data-language="erlang">
&gt; info_lib().
[{&lt;&lt;"OpenSSL"&gt;&gt;,269484095,&lt;&lt;"OpenSSL 1.1.0c  10 Nov 2016""&gt;&gt;}]
        </pre> <div class="note"> <div class="label">Note</div> <div class="content">

<p> From OTP R16 the <strong>numeric version</strong> represents the version of the OpenSSL <strong>header files</strong> (<code class="code">openssl/opensslv.h</code>) used when crypto was compiled. The text variant represents the libcrypto library used at runtime. In earlier OTP versions both numeric and text was taken from the library. </p>
</div> </div> </div></article><article class="func"><h4 id="hash_info-1" onmouseover="document.getElementById('ghlink-hash_info-1-idp35').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-hash_info-1-idp35').style.visibility = 'hidden';">  <span class="title-name">hash_info(Type) -&gt; Result</span><div class="title-since"><span class="since">OTP 22.0</span></div> </h4>  <h2 id="types" class="func-types-title">Types</h2>    <div class="exports-tube"> <p>Provides a map with information about block_size, size and possibly other properties of the hash algorithm in question. </p> <p>For a list of supported hash algorithms, see <code><a href="#supports-1">supports(hashs)</a></code>. </p> </div></article><article class="func"><h4 id="cipher_info-1" onmouseover="document.getElementById('ghlink-cipher_info-1-idp36').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-cipher_info-1-idp36').style.visibility = 'hidden';">  <span class="title-name">cipher_info(Type) -&gt; Result</span><div class="title-since"><span class="since">OTP 22.0</span></div> </h4>  <h2 id="types" class="func-types-title">Types</h2>     <div class="exports-tube"> <p>Provides a map with information about block_size, key_length, iv_length, aead support and possibly other properties of the cipher algorithm in question. </p> <div class="note"> <div class="label">Note</div> <div class="content">

<p>The ciphers <code class="code">aes_cbc</code>, <code class="code">aes_cfb8</code>, <code class="code">aes_cfb128</code>, <code class="code">aes_ctr</code>, <code class="code">aes_ecb</code>, <code class="code">aes_gcm</code> and <code class="code">aes_ccm</code> has no keylength in the <code class="code">Type</code> as opposed to for example <code class="code">aes_128_ctr</code>. They adapt to the length of the key provided in the encrypt and decrypt function. Therefore it is impossible to return a valid keylength in the map.</p> <p>Always use a <code class="code">Type</code> with an explicit key length, </p> </div> </div> <p>For a list of supported cipher algorithms, see <code><a href="#supports-1">supports(ciphers)</a></code>. </p> </div></article><article class="func"><h4 id="mod_pow-3" onmouseover="document.getElementById('ghlink-mod_pow-3-idp37').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-mod_pow-3-idp37').style.visibility = 'hidden';">  <span class="title-name">mod_pow(N, P, M) -&gt; Result</span><div class="title-since"><span class="since">OTP R16B01</span></div> </h4>  <h2 id="types" class="func-types-title">Types</h2>      <div class="exports-tube"> <p>Computes the function <code class="code">N^P mod M</code>.</p> </div></article><article class="func"><h4 id="private_decrypt-4" onmouseover="document.getElementById('ghlink-private_decrypt-4-idp38').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-private_decrypt-4-idp38').style.visibility = 'hidden';">  <span class="title-name">private_decrypt(Algorithm, CipherText, PrivateKey, Options) -&gt;<br> PlainText</span><div class="title-since"><span class="since">OTP R16B01</span></div> </h4>  <h2 id="types" class="func-types-title">Types</h2>       <div class="exports-tube"> <p>Uses the <code><a href="#error_3tup">3-tuple style</a></code> for error handling.</p> <p>Decrypts the <code class="code">CipherText</code>, encrypted with <code><a href="#public_encrypt-4">public_encrypt/4</a></code> (or equivalent function) using the <code class="code">PrivateKey</code>, and returns the plaintext (message digest). This is a low level signature verification operation used for instance by older versions of the SSL protocol. See also <code>public_key:decrypt_private/[2,3]</code> </p> </div></article><article class="func"><h4 id="private_encrypt-4" onmouseover="document.getElementById('ghlink-private_encrypt-4-idp39').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-private_encrypt-4-idp39').style.visibility = 'hidden';">  <span class="title-name">private_encrypt(Algorithm, PlainText, PrivateKey, Options) -&gt;<br> CipherText</span><div class="title-since"><span class="since">OTP R16B01</span></div> </h4>  <h2 id="types" class="func-types-title">Types</h2>       <div class="exports-tube"> <p>Uses the <code><a href="#error_3tup">3-tuple style</a></code> for error handling.</p> <p>Encrypts the <code class="code">PlainText</code> using the <code class="code">PrivateKey</code> and returns the ciphertext. This is a low level signature operation used for instance by older versions of the SSL protocol. See also <code>public_key:encrypt_private/[2,3]</code> </p> </div></article><article class="func"><h4 id="public_decrypt-4" onmouseover="document.getElementById('ghlink-public_decrypt-4-idp40').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-public_decrypt-4-idp40').style.visibility = 'hidden';">  <span class="title-name">public_decrypt(Algorithm, CipherText, PublicKey, Options) -&gt;<br> PlainText</span><div class="title-since"><span class="since">OTP R16B01</span></div> </h4>  <h2 id="types" class="func-types-title">Types</h2>       <div class="exports-tube"> <p>Uses the <code><a href="#error_3tup">3-tuple style</a></code> for error handling.</p> <p>Decrypts the <code class="code">CipherText</code>, encrypted with <code><a href="#private_encrypt-4">private_encrypt/4</a></code>(or equivalent function) using the <code class="code">PrivateKey</code>, and returns the plaintext (message digest). This is a low level signature verification operation used for instance by older versions of the SSL protocol. See also <code>public_key:decrypt_public/[2,3]</code> </p> </div></article><article class="func"><h4 id="public_encrypt-4" onmouseover="document.getElementById('ghlink-public_encrypt-4-idp41').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-public_encrypt-4-idp41').style.visibility = 'hidden';">  <span class="title-name">public_encrypt(Algorithm, PlainText, PublicKey, Options) -&gt;<br> CipherText</span><div class="title-since"><span class="since">OTP R16B01</span></div> </h4>  <h2 id="types" class="func-types-title">Types</h2>       <div class="exports-tube"> <p>Uses the <code><a href="#error_3tup">3-tuple style</a></code> for error handling.</p> <p>Encrypts the <code class="code">PlainText</code> (message digest) using the <code class="code">PublicKey</code> and returns the <code class="code">CipherText</code>. This is a low level signature operation used for instance by older versions of the SSL protocol. See also <code>public_key:encrypt_public/[2,3]</code> </p> </div></article><article class="func"><h4 id="rand_seed-1" onmouseover="document.getElementById('ghlink-rand_seed-1-idp42').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-rand_seed-1-idp42').style.visibility = 'hidden';">  <span class="title-name">rand_seed(Seed :: <code>binary()</code>) -&gt; ok</span><div class="title-since"><span class="since">OTP 17.0</span></div> </h4> <div class="exports-tube"> <p>Set the seed for PRNG to the given binary. This calls the RAND_seed function from openssl. Only use this if the system you are running on does not have enough "randomness" built in. Normally this is when <code><a href="#strong_rand_bytes-1">strong_rand_bytes/1</a></code> raises <code class="code">error:low_entropy</code></p> </div></article><article class="func"><div><h4 id="rand_uniform-2" class="title-link" onmouseover="document.getElementById('ghlink-rand_uniform-2-idm2203').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-rand_uniform-2-idm2203').style.visibility = 'hidden';">  <div class="title-name">rand_uniform(Lo, Hi) -&gt; N</div> </h4></div> <div class="exports-tube">  <h2 id="types" class="func-types-title">Types</h2>    <p>Generate a random number <code class="code">N, Lo =&lt; N &lt; Hi.</code> Uses the <code class="code">crypto</code> library pseudo-random number generator. <code class="code">Hi</code> must be larger than <code class="code">Lo</code>.</p>  </div></article><article class="func"><h4 id="start-0" onmouseover="document.getElementById('ghlink-start-0-idp43').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-start-0-idp43').style.visibility = 'hidden';">  <span class="title-name">start() -&gt; ok | {error, Reason :: <code>term()</code>}</span> </h4> <div class="exports-tube"> <p> Equivalent to application:start(crypto).</p> </div></article><article class="func"><h4 id="stop-0" onmouseover="document.getElementById('ghlink-stop-0-idp44').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-stop-0-idp44').style.visibility = 'hidden';">  <span class="title-name">stop() -&gt; ok | {error, Reason :: <code>term()</code>}</span> </h4> <div class="exports-tube"> <p> Equivalent to application:stop(crypto).</p> </div></article><article class="func"><h4 id="strong_rand_bytes-1" onmouseover="document.getElementById('ghlink-strong_rand_bytes-1-idp45').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-strong_rand_bytes-1-idp45').style.visibility = 'hidden';">  <span class="title-name">strong_rand_bytes(N :: <code>integer() &gt;= 0</code>) -&gt; <code>binary()</code></span><div class="title-since"><span class="since">OTP R14B03</span></div> </h4> <div class="exports-tube"> <p>Generates N bytes randomly uniform 0..255, and returns the result in a binary. Uses a cryptographically secure prng seeded and periodically mixed with operating system provided entropy. By default this is the <code class="code">RAND_bytes</code> method from OpenSSL.</p> <p>May raise exception <code class="code">error:low_entropy</code> in case the random generator failed due to lack of secure "randomness".</p> </div></article><article class="func"><h4 id="rand_seed-0" onmouseover="document.getElementById('ghlink-rand_seed-0-idp46').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-rand_seed-0-idp46').style.visibility = 'hidden';">  <span class="title-name">rand_seed() -&gt; <code>rand:state()</code></span><div class="title-since"><span class="since">OTP 20.0</span></div> </h4> <div class="exports-tube"> <p> Creates state object for <code>random number generation</code>, in order to generate cryptographically strong random numbers (based on OpenSSL's <code class="code">BN_rand_range</code>), and saves it in the process dictionary before returning it as well. See also <code>rand:seed/1</code> and <code><a href="#rand_seed_s-0">rand_seed_s/0</a></code>. </p> <p> When using the state object from this function the <code>rand</code> functions using it may raise exception <code class="code">error:low_entropy</code> in case the random generator failed due to lack of secure "randomness". </p> <p><strong>Example</strong></p> <pre data-language="erlang">
_ = crypto:rand_seed(),
_IntegerValue = rand:uniform(42), % [1; 42]
_FloatValue = rand:uniform().     % [0.0; 1.0[</pre> </div></article><article class="func"><h4 id="rand_seed_s-0" onmouseover="document.getElementById('ghlink-rand_seed_s-0-idp47').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-rand_seed_s-0-idp47').style.visibility = 'hidden';">  <span class="title-name">rand_seed_s() -&gt; <code>rand:state()</code></span><div class="title-since"><span class="since">OTP 20.0</span></div> </h4> <div class="exports-tube"> <p> Creates state object for <code>random number generation</code>, in order to generate cryptographically strongly random numbers (based on OpenSSL's <code class="code">BN_rand_range</code>). See also <code>rand:seed_s/1</code>. </p> <p> When using the state object from this function the <code>rand</code> functions using it may raise exception <code class="code">error:low_entropy</code> in case the random generator failed due to lack of secure "randomness". </p> <div class="note"> <div class="label">Note</div> <div class="content">

<p> The state returned from this function cannot be used to get a reproducible random sequence as from the other <code>rand</code> functions, since reproducibility does not match cryptographically safe. </p> <p> The only supported usage is to generate one distinct random sequence from this start state. </p> </div> </div> </div></article><article class="func"><div><h4 id="rand_seed_alg-1" class="title-link" onmouseover="document.getElementById('ghlink-rand_seed_alg-1-idm2262').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-rand_seed_alg-1-idm2262').style.visibility = 'hidden';">  <div class="title-name">rand_seed_alg(Alg) -&gt; rand:state()</div> <div class="title-since"><span class="since">OTP 21.0</span></div> </h4></div> <div class="exports-tube">  <h2 id="types" class="func-types-title">Types</h2>     <p id="rand_seed_alg-1"> Creates state object for <code>random number generation</code>, in order to generate cryptographically strong random numbers, and saves it in the process dictionary before returning it as well. See also <code>rand:seed/1</code> and <code><a href="#rand_seed_alg_s-1">rand_seed_alg_s/1</a></code>. </p> <p> When using the state object from this function the <code>rand</code> functions using it may raise exception <code class="code">error:low_entropy</code> in case the random generator failed due to lack of secure "randomness". </p> <p><strong>Example</strong></p> <pre data-language="erlang">
_ = crypto:rand_seed_alg(crypto_cache),
_IntegerValue = rand:uniform(42), % [1; 42]
_FloatValue = rand:uniform().     % [0.0; 1.0[</pre>  </div></article><article class="func"><div><h4 id="rand_seed_alg-2" class="title-link" onmouseover="document.getElementById('ghlink-rand_seed_alg-2-idm2279').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-rand_seed_alg-2-idm2279').style.visibility = 'hidden';">  <div class="title-name">rand_seed_alg(Alg, Seed) -&gt; rand:state()</div> <div class="title-since"><span class="since">OTP-22.0</span></div> </h4></div> <div class="exports-tube">  <h2 id="types" class="func-types-title">Types</h2>     <p id="rand_seed_alg-2"> Creates a state object for <code>random number generation</code>, in order to generate cryptographically unpredictable random numbers, and saves it in the process dictionary before returning it as well. See also <code><a href="#rand_seed_alg_s-2">rand_seed_alg_s/2</a></code>. </p> <p><strong>Example</strong></p> <pre data-language="erlang">
_ = crypto:rand_seed_alg(crypto_aes, "my seed"),
IntegerValue = rand:uniform(42), % [1; 42]
FloatValue = rand:uniform(),     % [0.0; 1.0[
_ = crypto:rand_seed_alg(crypto_aes, "my seed"),
IntegerValue = rand:uniform(42), % Same values
FloatValue = rand:uniform().     % again
	</pre>  </div></article><article class="func"><div><h4 id="rand_seed_alg_s-1" class="title-link" onmouseover="document.getElementById('ghlink-rand_seed_alg_s-1-idm2292').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-rand_seed_alg_s-1-idm2292').style.visibility = 'hidden';">  <div class="title-name">rand_seed_alg_s(Alg) -&gt; rand:state()</div> <div class="title-since"><span class="since">OTP 21.0</span></div> </h4></div> <div class="exports-tube">  <h2 id="types" class="func-types-title">Types</h2>     <p id="rand_seed_alg_s-1"> Creates state object for <code>random number generation</code>, in order to generate cryptographically strongly random numbers. See also <code>rand:seed_s/1</code>. </p> <p> If <code class="code">Alg</code> is <code class="code">crypto</code> this function behaves exactly like <code><a href="#rand_seed_s-0">rand_seed_s/0</a></code>. </p> <p> If <code class="code">Alg</code> is <code class="code">crypto_cache</code> this function fetches random data with OpenSSL's <code class="code">RAND_bytes</code> and caches it for speed using an internal word size of 56 bits that makes calculations fast on 64 bit machines. </p> <p> When using the state object from this function the <code>rand</code> functions using it may raise exception <code class="code">error:low_entropy</code> in case the random generator failed due to lack of secure "randomness". </p> <p> The cache size can be changed from its default value using the <code><span> crypto app's </span></code> configuration parameter <code class="code">rand_cache_size</code>. </p> <p> When using the state object from this function the <code>rand</code> functions using it may throw exception <code class="code">low_entropy</code> in case the random generator failed due to lack of secure "randomness". </p> <div class="note"> <div class="label">Note</div> <div class="content">

<p> The state returned from this function cannot be used to get a reproducible random sequence as from the other <code>rand</code> functions, since reproducibility does not match cryptographically safe. </p> <p> In fact since random data is cached some numbers may get reproduced if you try, but this is unpredictable. </p> <p> The only supported usage is to generate one distinct random sequence from this start state. </p> </div> </div>  </div></article><article class="func"><div><h4 id="rand_seed_alg_s-2" class="title-link" onmouseover="document.getElementById('ghlink-rand_seed_alg_s-2-idm2324').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-rand_seed_alg_s-2-idm2324').style.visibility = 'hidden';">  <div class="title-name">rand_seed_alg_s(Alg, Seed) -&gt; rand:state()</div> <div class="title-since"><span class="since">OTP 22.0</span></div> </h4></div> <div class="exports-tube">  <h2 id="types" class="func-types-title">Types</h2>     <p id="rand_seed_alg_s-2"> Creates a state object for <code>random number generation</code>, in order to generate cryptographically unpredictable random numbers. See also <code><a href="#rand_seed_alg-1">rand_seed_alg/1</a></code>. </p> <p> To get a long period the Xoroshiro928 generator from the <code>rand</code> module is used as a counter (with period 2^928 - 1) and the generator states are scrambled through AES to create 58-bit pseudo random values. </p> <p> The result should be statistically completely unpredictable random values, since the scrambling is cryptographically strong and the period is ridiculously long. But the generated numbers are not to be regarded as cryptographically strong since there is no re-keying schedule. </p> <ul> <li> <p> If you need cryptographically strong random numbers use <code><a href="#rand_seed_alg_s-1">rand_seed_alg_s/1</a></code> with <code class="code">Alg =:= crypto</code> or <code class="code">Alg =:= crypto_cache</code>. </p> </li> <li> <p> If you need to be able to repeat the sequence use this function. </p> </li> <li> <p> If you do not need the statistical quality of this function, there are faster algorithms in the <code>rand</code> module. </p> </li> </ul> <p> Thanks to the used generator the state object supports the <code><span class="code">rand:jump/0,1</span></code> function with distance 2^512. </p> <p> Numbers are generated in batches and cached for speed reasons. The cache size can be changed from its default value using the <code><span> crypto app's </span></code> configuration parameter <code class="code">rand_cache_size</code>. </p>  </div></article><article class="func"><h4 id="ec_curves-0" onmouseover="document.getElementById('ghlink-ec_curves-0-idp48').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-ec_curves-0-idp48').style.visibility = 'hidden';">  <span class="title-name">ec_curves() -&gt; [EllipticCurve]</span><div class="title-since"><span class="since">OTP 17.0</span></div> </h4>  <h2 id="types" class="func-types-title">Types</h2>   <div class="exports-tube"> <p>Can be used to determine which named elliptic curves are supported.</p> </div></article><article class="func"><h4 id="ec_curve-1" onmouseover="document.getElementById('ghlink-ec_curve-1-idp49').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-ec_curve-1-idp49').style.visibility = 'hidden';">  <span class="title-name">ec_curve(CurveName) -&gt; ExplicitCurve</span><div class="title-since"><span class="since">OTP 17.0</span></div> </h4>  <h2 id="types" class="func-types-title">Types</h2>    <div class="exports-tube"> <p>Return the defining parameters of a elliptic curve.</p> </div></article><article class="func"><h4 id="sign-4" onmouseover="document.getElementById('ghlink-sign-4-idp50').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-sign-4-idp50').style.visibility = 'hidden';">  <span class="title-name">sign(Algorithm, DigestType, Msg, Key) -&gt; Signature</span><div class="title-since"><span class="since">OTP R16B01</span></div> </h4> <h4 id="sign-5" onmouseover="document.getElementById('ghlink-sign-5-idp51').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-sign-5-idp51').style.visibility = 'hidden';">  <span class="title-name">sign(Algorithm, DigestType, Msg, Key, Options) -&gt; Signature</span><div class="title-since"><span class="since">OTP 20.1</span></div> </h4>  <h2 id="types" class="func-types-title">Types</h2>        <div class="exports-tube"> <p>Uses the <code><a href="#error_3tup">3-tuple style</a></code> for error handling.</p> <p>Creates a digital signature.</p> <p>The msg is either the binary "cleartext" data to be signed or it is the hashed value of "cleartext" i.e. the digest (plaintext).</p> <p>Algorithm <code class="code">dss</code> can only be used together with digest type <code class="code">sha</code>.</p> <p>See also <code>public_key:sign/3</code>.</p> </div></article><article class="func"><h4 id="verify-5" onmouseover="document.getElementById('ghlink-verify-5-idp52').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-verify-5-idp52').style.visibility = 'hidden';">  <span class="title-name">verify(Algorithm, DigestType, Msg, Signature, Key) -&gt; Result</span><div class="title-since"><span class="since">OTP R16B01</span></div> </h4> <h4 id="verify-6" onmouseover="document.getElementById('ghlink-verify-6-idp53').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-verify-6-idp53').style.visibility = 'hidden';">  <span class="title-name">verify(Algorithm, DigestType, Msg, Signature, Key, Options) -&gt;<br> Result</span><div class="title-since"><span class="since">OTP 20.1</span></div> </h4>  <h2 id="types" class="func-types-title">Types</h2>         <div class="exports-tube"> <p>Uses the <code><a href="#error_3tup">3-tuple style</a></code> for error handling.</p> <p>Verifies a digital signature</p> <p>The msg is either the binary "cleartext" data to be signed or it is the hashed value of "cleartext" i.e. the digest (plaintext).</p> <p>Algorithm <code class="code">dss</code> can only be used together with digest type <code class="code">sha</code>.</p> <p>See also <code>public_key:verify/4</code>.</p> </div></article> </div> <section class="innertube"><h2 id="engine-api" class="title-link" onmouseover="document.getElementById('ghlink-engine-api-idm2392').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-engine-api-idm2392').style.visibility = 'hidden';"> <div class="title-name">Engine API</div>  </h2> </section><div class="innertube"><h2 id="export" class="title-link" onmouseover="document.getElementById('ghlink-export-idm2391').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-export-idm2391').style.visibility = 'hidden';"> <div class="title-name">Exports</div>  </h2></div> <div class="exports-body"> <article class="func"><h4 id="privkey_to_pubkey-2" onmouseover="document.getElementById('ghlink-privkey_to_pubkey-2-idp54').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-privkey_to_pubkey-2-idp54').style.visibility = 'hidden';">  <span class="title-name">privkey_to_pubkey(Type, EnginePrivateKeyRef) -&gt; PublicKey</span><div class="title-since"><span class="since">OTP 20.2</span></div> </h4>  <h2 id="types" class="func-types-title">Types</h2>     <div class="exports-tube"> <p>Fetches the corresponding public key from a private key stored in an Engine. The key must be of the type indicated by the Type parameter. </p> </div></article><article class="func"><h4 id="engine_get_all_methods-0" onmouseover="document.getElementById('ghlink-engine_get_all_methods-0-idp55').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-engine_get_all_methods-0-idp55').style.visibility = 'hidden';">  <span class="title-name">engine_get_all_methods() -&gt; Result</span><div class="title-since"><span class="since">OTP 20.2</span></div> </h4>  <h2 id="types" class="func-types-title">Types</h2>   <div class="exports-tube"> <p> Returns a list of all possible engine methods. </p> <p> May raise exception <code class="code">error:notsup</code> in case there is no engine support in the underlying OpenSSL implementation. </p> <p> See also the chapter <code>Engine Load</code> in the User's Guide. </p> </div></article><article class="func"><h4 id="engine_load-3" onmouseover="document.getElementById('ghlink-engine_load-3-idp56').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-engine_load-3-idp56').style.visibility = 'hidden';">  <span class="title-name">engine_load(EngineId, PreCmds, PostCmds) -&gt; Result</span><div class="title-since"><span class="since">OTP 20.2</span></div> </h4>  <h2 id="types" class="func-types-title">Types</h2>      <div class="exports-tube"> <p> Loads the OpenSSL engine given by <code class="code">EngineId</code> if it is available and then returns ok and an engine handle. This function is the same as calling <code class="code">engine_load/4</code> with <code class="code">EngineMethods</code> set to a list of all the possible methods. An error tuple is returned if the engine can't be loaded. </p> <p> The function raises a <code class="code">error:badarg</code> if the parameters are in wrong format. It may also raise the exception <code class="code">error:notsup</code> in case there is no engine support in the underlying OpenSSL implementation. </p> <p> See also the chapter <code>Engine Load</code> in the User's Guide. </p> </div></article><article class="func"><h4 id="engine_load-4" onmouseover="document.getElementById('ghlink-engine_load-4-idp57').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-engine_load-4-idp57').style.visibility = 'hidden';">  <span class="title-name">engine_load(EngineId, PreCmds, PostCmds, EngineMethods) -&gt; Result</span><div class="title-since"><span class="since">OTP 20.2</span></div> </h4>  <h2 id="types" class="func-types-title">Types</h2>       <div class="exports-tube"> <p> Loads the OpenSSL engine given by <code class="code">EngineId</code> if it is available and then returns ok and an engine handle. An error tuple is returned if the engine can't be loaded. </p> <p> The function raises a <code class="code">error:badarg</code> if the parameters are in wrong format. It may also raise the exception <code class="code">error:notsup</code> in case there is no engine support in the underlying OpenSSL implementation. </p> <p> See also the chapter <code>Engine Load</code> in the User's Guide. </p> </div></article><article class="func"><h4 id="engine_unload-1" onmouseover="document.getElementById('ghlink-engine_unload-1-idp58').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-engine_unload-1-idp58').style.visibility = 'hidden';">  <span class="title-name">engine_unload(Engine) -&gt; Result</span><div class="title-since"><span class="since">OTP 20.2</span></div> </h4>  <h2 id="types" class="func-types-title">Types</h2>    <div class="exports-tube"> <p> Unloads the OpenSSL engine given by <code class="code">Engine</code>. An error tuple is returned if the engine can't be unloaded. </p> <p> The function raises a <code class="code">error:badarg</code> if the parameter is in wrong format. It may also raise the exception <code class="code">error:notsup</code> in case there is no engine support in the underlying OpenSSL implementation. </p> <p> See also the chapter <code>Engine Load</code> in the User's Guide. </p> </div></article><article class="func"><h4 id="engine_by_id-1" onmouseover="document.getElementById('ghlink-engine_by_id-1-idp59').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-engine_by_id-1-idp59').style.visibility = 'hidden';">  <span class="title-name">engine_by_id(EngineId) -&gt; Result</span><div class="title-since"><span class="since">OTP 21.0.6</span></div> </h4>  <h2 id="types" class="func-types-title">Types</h2>    <div class="exports-tube"> <p> Get a reference to an already loaded engine with <code class="code">EngineId</code>. An error tuple is returned if the engine can't be unloaded. </p> <p> The function raises a <code class="code">error:badarg</code> if the parameter is in wrong format. It may also raise the exception <code class="code">error:notsup</code> in case there is no engine support in the underlying OpenSSL implementation. </p> <p> See also the chapter <code>Engine Load</code> in the User's Guide. </p> </div></article><article class="func"><h4 id="engine_ctrl_cmd_string-3" onmouseover="document.getElementById('ghlink-engine_ctrl_cmd_string-3-idp60').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-engine_ctrl_cmd_string-3-idp60').style.visibility = 'hidden';">  <span class="title-name">engine_ctrl_cmd_string(Engine, CmdName, CmdArg) -&gt; Result</span><div class="title-since"><span class="since">OTP 20.2</span></div> </h4>  <h2 id="types" class="func-types-title">Types</h2>      <div class="exports-tube"> <p> Sends ctrl commands to the OpenSSL engine given by <code class="code">Engine</code>. This function is the same as calling <code class="code">engine_ctrl_cmd_string/4</code> with <code class="code">Optional</code> set to <code class="code">false</code>. </p> <p> The function raises a <code class="code">error:badarg</code> if the parameters are in wrong format. It may also raise the exception <code class="code">error:notsup</code> in case there is no engine support in the underlying OpenSSL implementation. </p> </div></article><article class="func"><h4 id="engine_ctrl_cmd_string-4" onmouseover="document.getElementById('ghlink-engine_ctrl_cmd_string-4-idp61').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-engine_ctrl_cmd_string-4-idp61').style.visibility = 'hidden';">  <span class="title-name">engine_ctrl_cmd_string(Engine, CmdName, CmdArg, Optional) -&gt;<br> Result</span><div class="title-since"><span class="since">OTP 20.2</span></div> </h4>  <h2 id="types" class="func-types-title">Types</h2>       <div class="exports-tube"> <p> Sends ctrl commands to the OpenSSL engine given by <code class="code">Engine</code>. <code class="code">Optional</code> is a boolean argument that can relax the semantics of the function. If set to <code class="code">true</code> it will only return failure if the ENGINE supported the given command name but failed while executing it, if the ENGINE doesn't support the command name it will simply return success without doing anything. In this case we assume the user is only supplying commands specific to the given ENGINE so we set this to <code class="code">false</code>. </p> <p> The function raises a <code class="code">error:badarg</code> if the parameters are in wrong format. It may also raise the exception <code class="code">error:notsup</code> in case there is no engine support in the underlying OpenSSL implementation. </p> </div></article><article class="func"><h4 id="engine_add-1" onmouseover="document.getElementById('ghlink-engine_add-1-idp62').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-engine_add-1-idp62').style.visibility = 'hidden';">  <span class="title-name">engine_add(Engine) -&gt; Result</span><div class="title-since"><span class="since">OTP 21.0.6</span></div> </h4>  <h2 id="types" class="func-types-title">Types</h2>    <div class="exports-tube"> <p>Add the engine to OpenSSL's internal list.</p> <p> The function raises a <code class="code">error:badarg</code> if the parameters are in wrong format. It may also raise the exception <code class="code">error:notsup</code> in case there is no engine support in the underlying OpenSSL implementation. </p> </div></article><article class="func"><h4 id="engine_remove-1" onmouseover="document.getElementById('ghlink-engine_remove-1-idp63').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-engine_remove-1-idp63').style.visibility = 'hidden';">  <span class="title-name">engine_remove(Engine) -&gt; Result</span><div class="title-since"><span class="since">OTP 21.0.6</span></div> </h4>  <h2 id="types" class="func-types-title">Types</h2>    <div class="exports-tube"> <p>Remove the engine from OpenSSL's internal list.</p> <p> The function raises a <code class="code">error:badarg</code> if the parameters are in wrong format. It may also raise the exception <code class="code">error:notsup</code> in case there is no engine support in the underlying OpenSSL implementation. </p> </div></article><article class="func"><h4 id="engine_get_id-1" onmouseover="document.getElementById('ghlink-engine_get_id-1-idp64').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-engine_get_id-1-idp64').style.visibility = 'hidden';">  <span class="title-name">engine_get_id(Engine) -&gt; EngineId</span><div class="title-since"><span class="since">OTP 21.0.6</span></div> </h4>  <h2 id="types" class="func-types-title">Types</h2>    <div class="exports-tube"> <p>Return the ID for the engine, or an empty binary if there is no id set.</p> <p> The function raises a <code class="code">error:badarg</code> if the parameters are in wrong format. It may also raise the exception <code class="code">error:notsup</code> in case there is no engine support in the underlying OpenSSL implementation. </p> </div></article><article class="func"><h4 id="engine_get_name-1" onmouseover="document.getElementById('ghlink-engine_get_name-1-idp65').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-engine_get_name-1-idp65').style.visibility = 'hidden';">  <span class="title-name">engine_get_name(Engine) -&gt; EngineName</span><div class="title-since"><span class="since">OTP 21.0.6</span></div> </h4>  <h2 id="types" class="func-types-title">Types</h2>    <div class="exports-tube"> <p>Return the name (eg a description) for the engine, or an empty binary if there is no name set.</p> <p> The function raises a <code class="code">error:badarg</code> if the parameters are in wrong format. It may also raise the exception <code class="code">error:notsup</code> in case there is no engine support in the underlying OpenSSL implementation. </p> </div></article><article class="func"><h4 id="engine_list-0" onmouseover="document.getElementById('ghlink-engine_list-0-idp66').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-engine_list-0-idp66').style.visibility = 'hidden';">  <span class="title-name">engine_list() -&gt; Result</span><div class="title-since"><span class="since">OTP 20.2</span></div> </h4>  <h2 id="types" class="func-types-title">Types</h2>   <div class="exports-tube"> <p>List the id's of all engines in OpenSSL's internal list.</p> <p> It may also raise the exception <code class="code">error:notsup</code> in case there is no engine support in the underlying OpenSSL implementation. </p> <p> See also the chapter <code>Engine Load</code> in the User's Guide. </p> <p> May raise exception <code class="code">error:notsup</code> in case engine functionality is not supported by the underlying OpenSSL implementation. </p> </div></article><article class="func"><h4 id="ensure_engine_loaded-2" onmouseover="document.getElementById('ghlink-ensure_engine_loaded-2-idp67').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-ensure_engine_loaded-2-idp67').style.visibility = 'hidden';">  <span class="title-name">ensure_engine_loaded(EngineId, LibPath) -&gt; Result</span><div class="title-since"><span class="since">OTP 21.0.6</span></div> </h4> <h4 id="ensure_engine_loaded-3" onmouseover="document.getElementById('ghlink-ensure_engine_loaded-3-idp68').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-ensure_engine_loaded-3-idp68').style.visibility = 'hidden';">  <span class="title-name">ensure_engine_loaded(EngineId, LibPath, EngineMethods) -&gt; Result</span><div class="title-since"><span class="since">OTP 21.0.6</span></div> </h4>  <h2 id="types" class="func-types-title">Types</h2>      <div class="exports-tube"> <p> Loads an engine given by <code class="code">EngineId</code> and the path to the dynamic library implementing the engine. If the function with arity three is used, one can specify which engine methods it should handle. An error tuple is returned if the engine can't be loaded. </p> <p> This function differs from the normal engine_load in the sense that it also add the engine id to OpenSSL's internal engine list. The reference from the first call holds a functional reference to the engine. Then in the following calls to the function just fetch a structural reference by looking up the EngineId in OpenSSL's internal engine list. Therefor there is a difference when unloading the references, see <code class="code">ensure_engine_unloaded</code>. </p> <p> The function raises a <code class="code">error:badarg</code> if the parameters are in wrong format. It may also raise the exception <code class="code">error:notsup</code> in case there is no engine support in the underlying OpenSSL implementation. </p> <p> See also the chapter <code>Engine Load</code> in the User's Guide. </p> </div></article><article class="func"><h4 id="ensure_engine_unloaded-1" onmouseover="document.getElementById('ghlink-ensure_engine_unloaded-1-idp69').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-ensure_engine_unloaded-1-idp69').style.visibility = 'hidden';">  <span class="title-name">ensure_engine_unloaded(Engine) -&gt; Result</span><div class="title-since"><span class="since">OTP 21.0.6</span></div> </h4> <h4 id="ensure_engine_unloaded-2" onmouseover="document.getElementById('ghlink-ensure_engine_unloaded-2-idp70').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-ensure_engine_unloaded-2-idp70').style.visibility = 'hidden';">  <span class="title-name">ensure_engine_unloaded(Engine, EngineMethods) -&gt; Result</span><div class="title-since"><span class="since">OTP 21.0.6</span></div> </h4>  <h2 id="types" class="func-types-title">Types</h2>     <div class="exports-tube"> <p> Unloads an engine loaded with the <code class="code">ensure_engine_loaded</code> functions. The variant with arity two is used when the engine was loaded with <code class="code">ensure_engine_loaded/3</code> and the second parameter is the method list (same as when loaded). </p> <p> Exactly what happens differ a bit on the reference, if it's the first reference got by <code class="code">ensure_engine_loaded</code> it both removes the label from OpenSSL's internal engine list and unloads the engine. If it's not the reference from the first call it just removes that refence. </p> <p> The function raises a <code class="code">error:badarg</code> if the parameters are in wrong format. It may also raise the exception <code class="code">error:notsup</code> in case there is no engine support in the underlying OpenSSL implementation. </p> <p> See also the chapter <code>Engine Load</code> in the User's Guide. </p> </div></article><article class="func"><h4 id="hash_equals-2" onmouseover="document.getElementById('ghlink-hash_equals-2-idp71').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-hash_equals-2-idp71').style.visibility = 'hidden';">  <span class="title-name">hash_equals(BinA, BinB) -&gt; Result</span><div class="title-since"><span class="since">OTP 25.0</span></div> </h4>  <h2 id="types" class="func-types-title">Types</h2>     <div class="exports-tube"> <p> Constant time memory comparison for fixed length binaries, such as results of HMAC computations. </p> <p> Returns true if the binaries are identical, false if they are of the same length but not identical. The function raises an <code class="code">error:badarg</code> exception if the binaries are of different size. </p> </div></article><article class="func"><h4 id="pbkdf2_hmac-5" onmouseover="document.getElementById('ghlink-pbkdf2_hmac-5-idp72').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-pbkdf2_hmac-5-idp72').style.visibility = 'hidden';">  <span class="title-name">pbkdf2_hmac(Digest, Pass, Salt, Iter, KeyLen) -&gt; Result</span><div class="title-since"><span class="since">OTP 24.2</span></div> </h4>  <h2 id="types" class="func-types-title">Types</h2>        <div class="exports-tube"> <p>Uses the <code><a href="#error_3tup">3-tuple style</a></code> for error handling.</p> <p> PKCS #5 PBKDF2 (Password-Based Key Derivation Function 2) in combination with HMAC. </p> </div></article> </div> <div class="footer"> <hr> <p>Copyright © 1999-2022 Ericsson AB. All Rights Reserved.</p> </div><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2010&ndash;2022 Ericsson AB<br>Licensed under the Apache License, Version 2.0.<br>
    
  </p>
</div>
