<div class="innertube"> <h1 id="Algorithm Details">5 Algorithm Details</h1> <p> This chapter describes details of algorithms in the crypto application. </p> <p>The tables only documents the supported cryptos and key lengths. The user should not draw any conclusion on security from the supplied tables. </p> <h2 id="ciphers" class="title-link" onmouseover="document.getElementById('ghlink-ciphers-idm266').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-ciphers-idm266').style.visibility = 'hidden';"> <div class="title-name">5.1 Ciphers</div>  </h2> <p>A <code><a href="crypto#type-cipher">cipher</a></code> in the <code>new api</code> is categorized as either <code><a href="crypto#type-cipher_no_iv">cipher_no_iv()</a></code>, <code><a href="crypto#type-cipher_iv">cipher_iv()</a></code> or <code><a href="crypto#type-cipher_aead">cipher_aead()</a></code>. The letters IV are short for <i>Initialization Vector</i> and AEAD is an abbreviation of <i>Authenticated Encryption with Associated Data</i>. </p> <p>Due to irregular naming conventions, some cipher names in the old api are substituted by new names in the new api. For a list of retired names, see <code>Retired cipher names</code>. </p> <p>To dynamically check availability, check that the name in the <i>Cipher and Mode</i> column is present in the list returned by <code><a href="crypto#supports-1">crypto:supports(ciphers)</a></code>. </p> <h4 id="ciphers-without-an-iv---cipher_no_iv--" class="title-link" onmouseover="document.getElementById('ghlink-ciphers-without-an-iv---cipher_no_iv---idm281').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-ciphers-without-an-iv---cipher_no_iv---idm281').style.visibility = 'hidden';"> <div class="title-name">Ciphers without an IV - cipher_no_iv()</div>  </h4> <p>To be used with: </p> <ul> <li><code><a href="crypto#crypto_one_time-4">crypto_one_time/4</a></code></li> <li><code><a href="crypto#crypto_init-3">crypto_init/3</a></code></li> </ul> <p>The ciphers are: </p> <div class="doc-table-wrapper"> <table class="doc-table"> <tr> <td><strong>Cipher and Mode</strong></td> <td> <strong>Key length</strong><br><strong>[bytes]</strong> </td> <td> <strong>Block size</strong><br><strong>[bytes]</strong> </td> </tr> <tr> <td><code class="code">aes_128_ecb</code></td> <td>16</td> <td>16</td> </tr> <tr> <td><code class="code">aes_192_ecb</code></td> <td>24</td> <td>16</td> </tr> <tr> <td><code class="code">aes_256_ecb</code></td> <td>32</td> <td>16</td> </tr> <tr> <td><code class="code">blowfish_ecb</code></td> <td>16</td> <td> 8</td> </tr> <tr> <td><code class="code">des_ecb</code></td> <td> 8</td> <td> 8</td> </tr> <tr> <td><code class="code">rc4</code></td> <td>16</td> <td> 1</td> </tr> </table> <p class="doc-table-caption">Table 5.1: Ciphers without IV</p> </div> <h4 id="ciphers-with-an-iv---cipher_iv--" class="title-link" onmouseover="document.getElementById('ghlink-ciphers-with-an-iv---cipher_iv---idm333').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-ciphers-with-an-iv---cipher_iv---idm333').style.visibility = 'hidden';"> <div class="title-name">Ciphers with an IV - cipher_iv()</div>  </h4> <p>To be used with: </p> <ul> <li><code><a href="crypto#crypto_one_time-5">crypto_one_time/5</a></code></li> <li><code><a href="crypto#crypto_init-4">crypto_init/4</a></code></li> <li><code><a href="crypto#crypto_dyn_iv_init-3">crypto_dyn_iv_init/3</a></code></li> </ul> <p>The ciphers are: </p> <div class="doc-table-wrapper"> <table class="doc-table"> <tr> <td><strong>Cipher and Mode</strong></td> <td> <strong>Key length</strong><br><strong>[bytes]</strong> </td> <td> <strong>IV length</strong><br><strong>[bytes]</strong> </td> <td> <strong>Block size</strong><br><strong>[bytes]</strong> </td> <td> <strong>Limited to</strong><br><strong>OpenSSL versions</strong> </td> </tr> <tr> <td><code class="code">aes_128_cbc</code></td> <td>16</td> <td>16</td> <td>16</td> <td></td> </tr> <tr> <td><code class="code">aes_192_cbc</code></td> <td>24</td> <td>16</td> <td>16</td> <td></td> </tr> <tr> <td><code class="code">aes_256_cbc</code></td> <td>32</td> <td>16</td> <td>16</td> <td></td> </tr> <tr> <td><code class="code">aes_128_cfb8</code></td> <td>16</td> <td>16</td> <td> 1</td> <td></td> </tr> <tr> <td><code class="code">aes_192_cfb8</code></td> <td>24</td> <td>16</td> <td> 1</td> <td></td> </tr> <tr> <td><code class="code">aes_256_cfb8</code></td> <td>32</td> <td>16</td> <td> 1</td> <td></td> </tr> <tr> <td><code class="code">aes_128_cfb128</code></td> <td>16</td> <td>16</td> <td> 1</td> <td></td> </tr> <tr> <td><code class="code">aes_192_cfb128</code></td> <td>24</td> <td>16</td> <td> 1</td> <td></td> </tr> <tr> <td><code class="code">aes_256_cfb128</code></td> <td>32</td> <td>16</td> <td> 1</td> <td></td> </tr> <tr> <td><code class="code">aes_128_ctr</code></td> <td>16</td> <td>16</td> <td> 1</td> <td></td> </tr> <tr> <td><code class="code">aes_192_ctr</code></td> <td>24</td> <td>16</td> <td> 1</td> <td></td> </tr> <tr> <td><code class="code">aes_256_ctr</code></td> <td>32</td> <td>16</td> <td> 1</td> <td></td> </tr> <tr> <td><code class="code">aes_128_ofb</code></td> <td>16</td> <td>16</td> <td> 1</td> <td></td> </tr> <tr> <td><code class="code">aes_192_ofb</code></td> <td>24</td> <td>16</td> <td> 1</td> <td></td> </tr> <tr> <td><code class="code">aes_256_ofb</code></td> <td>32</td> <td>16</td> <td> 1</td> <td></td> </tr> <tr> <td><code class="code">blowfish_cbc</code></td> <td>16</td> <td> 8</td> <td> 8</td> <td></td> </tr> <tr> <td><code class="code">blowfish_cfb64</code></td> <td>16</td> <td> 8</td> <td> 1</td> <td></td> </tr> <tr> <td><code class="code">blowfish_ofb64</code></td> <td>16</td> <td> 8</td> <td> 1</td> <td></td> </tr> <tr> <td><code class="code">chacha20</code></td> <td>32</td> <td>16</td> <td> 1</td> <td>≥1.1.0d</td> </tr> <tr> <td><code class="code">des_cbc</code></td> <td> 8</td> <td> 8</td> <td> 8</td> <td></td> </tr> <tr> <td><code class="code">des_ede3_cbc</code></td> <td>24</td> <td> 8</td> <td> 8</td> <td></td> </tr> <tr> <td><code class="code">des_cfb</code></td> <td> 8</td> <td> 8</td> <td> 1</td> <td></td> </tr> <tr> <td><code class="code">des_ede3_cfb</code></td> <td>24</td> <td> 8</td> <td> 1</td> <td></td> </tr> <tr> <td><code class="code">rc2_cbc</code></td> <td>16</td> <td> 8</td> <td> 8</td> <td></td> </tr> </table> <p class="doc-table-caption">Table 5.2: Ciphers with IV</p> </div> <h4 id="ciphers-with-aead---cipher_aead--" class="title-link" onmouseover="document.getElementById('ghlink-ciphers-with-aead---cipher_aead---idm533').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-ciphers-with-aead---cipher_aead---idm533').style.visibility = 'hidden';"> <div class="title-name">Ciphers with AEAD - cipher_aead()</div>  </h4> <p>To be used with: </p> <ul> <li><code><a href="crypto#crypto_one_time_aead-6">crypto_one_time_aead/6</a></code></li> <li><code><a href="crypto#crypto_one_time_aead-7">crypto_one_time_aead/7</a></code></li> </ul> <p>The ciphers are: </p> <div class="doc-table-wrapper"> <table class="doc-table"> <tr> <td><strong>Cipher and Mode</strong></td> <td> <strong>Key length</strong><br><strong>[bytes]</strong> </td> <td> <strong>IV length</strong><br><strong>[bytes]</strong> </td> <td> <strong>AAD length</strong><br><strong>[bytes]</strong> </td> <td> <strong>Tag length</strong><br><strong>[bytes]</strong> </td> <td> <strong>Block size</strong><br><strong>[bytes]</strong> </td> <td> <strong>Limited to</strong><br><strong>OpenSSL versions</strong> </td> </tr> <tr> <td><code class="code">aes_128_ccm</code></td> <td>16</td> <td>7-13</td> <td>any</td> <td>even 4-16<br>default: 12</td> <td>any</td> <td>≥1.0.1</td> </tr> <tr> <td><code class="code">aes_192_ccm</code></td> <td>24</td> <td>7-13</td> <td>any</td> <td>even 4-16<br>default: 12</td> <td>any</td> <td>≥1.0.1</td> </tr> <tr> <td><code class="code">aes_256_ccm</code></td> <td>32</td> <td>7-13</td> <td>any</td> <td>even 4-16<br>default: 12</td> <td>any</td> <td>≥1.0.1</td> </tr> <tr> <td><code class="code">aes_128_gcm</code></td> <td>16</td> <td>≥1</td> <td>any</td> <td>1-16<br>default: 16</td> <td>any</td> <td>≥1.0.1</td> </tr> <tr> <td><code class="code">aes_192_gcm</code></td> <td>24</td> <td>≥1</td> <td>any</td> <td>1-16<br>default: 16</td> <td>any</td> <td>≥1.0.1</td> </tr> <tr> <td><code class="code">aes_256_gcm</code></td> <td>32</td> <td>≥1</td> <td>any</td> <td>1-16<br>default: 16</td> <td>any</td> <td>≥1.0.1</td> </tr> <tr> <td><code class="code">chacha20_poly1305</code></td> <td>32</td> <td>1-16</td> <td>any</td> <td>16</td> <td>any</td> <td>≥1.1.0</td> </tr> </table> <p class="doc-table-caption">Table 5.3: AEAD ciphers</p> </div> <h2 id="message-authentication-codes--macs-" class="title-link" onmouseover="document.getElementById('ghlink-message-authentication-codes--macs--idm640').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-message-authentication-codes--macs--idm640').style.visibility = 'hidden';"> <div class="title-name">5.2 Message Authentication Codes (MACs)</div>  </h2> <p>To be used in <code><a href="crypto#mac-4">mac/4</a></code> and <code>related functions</code>. </p> <h4 id="cmac" class="title-link" onmouseover="document.getElementById('ghlink-cmac-idm645').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-cmac-idm645').style.visibility = 'hidden';"> <div class="title-name">CMAC</div>  </h4> <p>CMAC with the following ciphers are available with OpenSSL 1.0.1 or later if not disabled by configuration. </p> <p>To dynamically check availability, check that the name <code class="code">cmac</code> is present in the list returned by <code><a href="crypto#supports-1">crypto:supports(macs)</a></code>. Also check that the name in the <i>Cipher and Mode</i> column is present in the list returned by <code><a href="crypto#supports-1">crypto:supports(ciphers)</a></code>. </p> <div class="doc-table-wrapper"> <table class="doc-table"> <tr> <td><strong>Cipher and Mode</strong></td> <td> <strong>Key length</strong><br><strong>[bytes]</strong> </td> <td> <strong>Max Mac Length</strong><br><strong>(= default length)</strong><br><strong>[bytes]</strong> </td> </tr> <tr> <td><code class="code">aes_128_cbc</code></td> <td>16</td> <td>16</td> </tr> <tr> <td><code class="code">aes_192_cbc</code></td> <td>24</td> <td>16</td> </tr> <tr> <td><code class="code">aes_256_cbc</code></td> <td>32</td> <td>16</td> </tr> <tr> <td><code class="code">aes_128_ecb</code></td> <td>16</td> <td>16</td> </tr> <tr> <td><code class="code">aes_192_ecb</code></td> <td>24</td> <td>16</td> </tr> <tr> <td><code class="code">aes_256_ecb</code></td> <td>32</td> <td>16</td> </tr> <tr> <td><code class="code">blowfish_cbc</code></td> <td>16</td> <td> 8</td> </tr> <tr> <td><code class="code">blowfish_ecb</code></td> <td>16</td> <td> 8</td> </tr> <tr> <td><code class="code">des_cbc</code></td> <td> 8</td> <td> 8</td> </tr> <tr> <td><code class="code">des_ecb</code></td> <td> 8</td> <td> 8</td> </tr> <tr> <td><code class="code">des_ede3_cbc</code></td> <td>24</td> <td> 8</td> </tr> <tr> <td><code class="code">rc2_cbc</code></td> <td>16</td> <td> 8</td> </tr> </table> <p class="doc-table-caption">Table 5.4: CMAC cipher key lengths</p> </div> <h4 id="hmac" class="title-link" onmouseover="document.getElementById('ghlink-hmac-idm728').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-hmac-idm728').style.visibility = 'hidden';"> <div class="title-name">HMAC</div>  </h4> <p>Available in all OpenSSL compatible with Erlang CRYPTO if not disabled by configuration. </p> <p>To dynamically check availability, check that the name <code class="code">hmac</code> is present in the list returned by <code><a href="crypto#supports-1">crypto:supports(macs)</a></code> and that the hash name is present in the list returned by <code><a href="crypto#supports-1">crypto:supports(hashs)</a></code>. </p> <div class="doc-table-wrapper"> <table class="doc-table"> <tr> <td><strong>Hash</strong></td> <td> <strong>Max Mac Length</strong><br><strong>(= default length)</strong><br><strong>[bytes]</strong> </td> </tr> <tr> <td><code class="code">sha</code></td> <td>20</td> </tr> <tr> <td><code class="code">sha224</code></td> <td>28</td> </tr> <tr> <td><code class="code">sha256</code></td> <td>32</td> </tr> <tr> <td><code class="code">sha384</code></td> <td>48</td> </tr> <tr> <td><code class="code">sha512</code></td> <td>64</td> </tr> <tr> <td><code class="code">sha3_224</code></td> <td>28</td> </tr> <tr> <td><code class="code">sha3_256</code></td> <td>32</td> </tr> <tr> <td><code class="code">sha3_384</code></td> <td>48</td> </tr> <tr> <td><code class="code">sha3_512</code></td> <td>64</td> </tr> <tr> <td><code class="code">blake2b</code></td> <td>64</td> </tr> <tr> <td><code class="code">blake2s</code></td> <td>32</td> </tr> <tr> <td><code class="code">md4</code></td> <td>16</td> </tr> <tr> <td><code class="code">md5</code></td> <td>16</td> </tr> <tr> <td><code class="code">ripemd160</code></td> <td>20</td> </tr> </table> <p class="doc-table-caption">Table 5.5: HMAC output sizes</p> </div> <h4 id="poly1305" class="title-link" onmouseover="document.getElementById('ghlink-poly1305-idm802').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-poly1305-idm802').style.visibility = 'hidden';"> <div class="title-name">POLY1305</div>  </h4> <p>POLY1305 is available with OpenSSL 1.1.1 or later if not disabled by configuration. </p> <p>To dynamically check availability, check that the name <code class="code">poly1305</code> is present in the list returned by <code><a href="crypto#supports-1">crypto:supports(macs)</a></code>. </p> <p>The poly1305 mac wants an 32 bytes key and produces a 16 byte MAC by default. </p> <h2 id="hash" class="title-link" onmouseover="document.getElementById('ghlink-hash-idm809').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-hash-idm809').style.visibility = 'hidden';"> <div class="title-name">5.3 Hash</div>  </h2> <p>To dynamically check availability, check that the wanted name in the <i>Names</i> column is present in the list returned by <code><a href="crypto#supports-1">crypto:supports(hashs)</a></code>. </p> <div class="doc-table-wrapper"> <table class="doc-table"> <tr> <td><strong>Type</strong></td> <td><strong>Names</strong></td> <td> <strong>Limitated to</strong><br><strong>OpenSSL versions</strong> </td> </tr> <tr> <td>SHA1</td> <td>sha</td> <td></td> </tr> <tr> <td>SHA2</td> <td>sha224, sha256, sha384, sha512</td> <td></td> </tr> <tr> <td>SHA3</td> <td>sha3_224, sha3_256, sha3_384, sha3_512</td> <td>≥1.1.1</td> </tr> <tr> <td>MD4</td> <td>md4</td> <td></td> </tr> <tr> <td>MD5</td> <td>md5</td> <td></td> </tr> <tr> <td>RIPEMD</td> <td>ripemd160</td> <td></td> </tr> </table> <p class="doc-table-caption">Table 5.6: </p> </div> <h2 id="public-key-cryptography" class="title-link" onmouseover="document.getElementById('ghlink-public-key-cryptography-idm849').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-public-key-cryptography-idm849').style.visibility = 'hidden';"> <div class="title-name">5.4 Public Key Cryptography</div>  </h2> <h4 id="rsa" class="title-link" onmouseover="document.getElementById('ghlink-rsa-idm851').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-rsa-idm851').style.visibility = 'hidden';"> <div class="title-name">RSA</div>  </h4> <p>RSA is available with all OpenSSL versions compatible with Erlang CRYPTO if not disabled by configuration. To dynamically check availability, check that the atom <code class="code">rsa</code> is present in the list returned by <code><a href="crypto#supports-1">crypto:supports(public_keys)</a></code>. </p> <div class="warning"> <div class="label">Warning</div> <div class="content">

<p>The RSA options are experimental. </p> <p>The exact set of options and there syntax <strong>may</strong> be changed without prior notice.</p> </div> </div> <div class="doc-table-wrapper"> <table class="doc-table"> <tr> <td><strong>Option</strong></td> <td><strong>sign/verify</strong></td> <td> <strong>public encrypt</strong><br><strong>private decrypt</strong> </td> <td> <strong>private encrypt</strong><br><strong>public decrypt</strong> </td> </tr> <tr> <td>{rsa_padding,rsa_x931_padding}</td> <td>x</td> <td></td> <td>x</td> </tr> <tr> <td>{rsa_padding,rsa_pkcs1_padding}</td> <td>x</td> <td>x</td> <td>x</td> </tr> <tr> <td>{rsa_padding,rsa_pkcs1_pss_padding}<br> {rsa_pss_saltlen, -2..}<br> {rsa_mgf1_md, atom()} </td> <td>x (2)<br> x (2)<br> x (2)</td> <td></td> <td></td> </tr> <tr> <td>{rsa_padding,rsa_pkcs1_oaep_padding}<br> {rsa_mgf1_md, atom()}<br> {rsa_oaep_label, binary()}}<br> {rsa_oaep_md, atom()} </td> <td></td> <td>x (2)<br> x (2)<br> x (3)<br> x (3) </td> <td></td> </tr> <tr> <td>{rsa_padding,rsa_no_padding}</td> <td>x (1)</td> <td></td> <td></td> </tr> </table> <p class="doc-table-caption">Table 5.7: </p> </div> <p>Notes:</p> <ol> <li>(1) OpenSSL ≤ 1.0.0</li> <li>(2) OpenSSL ≥ 1.0.1</li> <li>(3) OpenSSL ≥ 1.1.0</li> </ol> <h4 id="dss" class="title-link" onmouseover="document.getElementById('ghlink-dss-idm915').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-dss-idm915').style.visibility = 'hidden';"> <div class="title-name">DSS</div>  </h4> <p>DSS is available with OpenSSL versions compatible with Erlang CRYPTO if not disabled by configuration. To dynamically check availability, check that the atom <code class="code">dss</code> is present in the list returned by <code><a href="crypto#supports-1">crypto:supports(public_keys)</a></code>. </p> <h4 id="ecdsa" class="title-link" onmouseover="document.getElementById('ghlink-ecdsa-idm920').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-ecdsa-idm920').style.visibility = 'hidden';"> <div class="title-name">ECDSA</div>  </h4> <p>ECDSA is available with OpenSSL 0.9.8o or later if not disabled by configuration. To dynamically check availability, check that the atom <code class="code">ecdsa</code> is present in the list returned by <code><a href="crypto#supports-1">crypto:supports(public_keys)</a></code>. If the atom <code class="code">ec_gf2m</code> also is present, the characteristic two field curves are available. </p> <p>The actual supported named curves could be checked by examining the list returned by <code><a href="crypto#supports-1">crypto:supports(curves)</a></code>. </p> <h4 id="eddsa" class="title-link" onmouseover="document.getElementById('ghlink-eddsa-idm928').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-eddsa-idm928').style.visibility = 'hidden';"> <div class="title-name">EdDSA</div>  </h4> <p>EdDSA is available with OpenSSL 1.1.1 or later if not disabled by configuration. To dynamically check availability, check that the atom <code class="code">eddsa</code> is present in the list returned by <code><a href="crypto#supports-1">crypto:supports(public_keys)</a></code>. </p> <p>Support for the curves ed25519 and ed448 is implemented. The actual supported named curves could be checked by examining the list with the list returned by <code><a href="crypto#supports-1">crypto:supports(curves)</a></code>. </p> <h4 id="diffie-hellman" class="title-link" onmouseover="document.getElementById('ghlink-diffie-hellman-idm935').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-diffie-hellman-idm935').style.visibility = 'hidden';"> <div class="title-name">Diffie-Hellman</div>  </h4> <p>Diffie-Hellman computations are available with OpenSSL versions compatible with Erlang CRYPTO if not disabled by configuration. To dynamically check availability, check that the atom <code class="code">dh</code> is present in the list returned by <code><a href="crypto#supports-1">crypto:supports(public_keys)</a></code>. </p> <h4 id="elliptic-curve-diffie-hellman" class="title-link" onmouseover="document.getElementById('ghlink-elliptic-curve-diffie-hellman-idm940').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-elliptic-curve-diffie-hellman-idm940').style.visibility = 'hidden';"> <div class="title-name">Elliptic Curve Diffie-Hellman</div>  </h4> <p>Elliptic Curve Diffie-Hellman is available with OpenSSL 0.9.8o or later if not disabled by configuration. To dynamically check availability, check that the atom <code class="code">ecdh</code> is present in the list returned by <code><a href="crypto#supports-1">crypto:supports(public_keys)</a></code>. </p> <p>The Edward curves <code class="code">x25519</code> and <code class="code">x448</code> are supported with OpenSSL 1.1.1 or later if not disabled by configuration. </p> <p>The actual supported named curves could be checked by examining the list returned by <code><a href="crypto#supports-1">crypto:supports(curves)</a></code>. </p> </div> <div class="footer"> <hr> <p>Copyright © 1999-2022 Ericsson AB. All Rights Reserved.</p> </div><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2010&ndash;2022 Ericsson AB<br>Licensed under the Apache License, Version 2.0.<br>
    
  </p>
</div>
