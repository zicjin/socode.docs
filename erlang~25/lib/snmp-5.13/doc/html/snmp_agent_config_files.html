<div class="innertube"> <h1 id="Definition of Agent Configuration Files">6 Definition of Agent Configuration Files</h1> <p>All configuration data must be included in configuration files that are located in the configuration directory. The name of this directory is given in the <code class="code">config_dir</code> configuration parameter. These files are read at start-up, and are used to initialize the SNMPv2-MIB or STANDARD-MIB, SNMP-FRAMEWORK-MIB, SNMP-MPD-MIB, SNMP-VIEW-BASED-ACM-MIB, SNMP-COMMUNITY-MIB, SNMP-USER-BASED-SM-MIB (adjusted according to SNMP-USM-HMAC-SHA2-MIB), SNMP-TARGET-MIB and SNMP-NOTIFICATION-MIB (refer to the <code><a href="snmp_agent_funct_descr#management">Management of the Agent</a></code> for a description of the MIBs). </p> <p>The files are: </p> <ul> <li> <p><code class="code">agent.conf</code>: see <code><a href="#agent_information">Agent Information</a></code></p> </li> <li> <p><code class="code">standard.conf</code>: see <code><a href="#system_information">System Information</a></code></p> </li> <li> <p><code class="code">context.conf</code>: see <code><a href="#context">Contexts</a></code></p> </li> <li> <p><code class="code">community.conf</code>: see <code><a href="#community">Communities</a></code></p> </li> <li> <p><code class="code">target_addr.conf</code>: see <code><a href="#target_addr">Target Address Definitions</a></code></p> </li> <li> <p><code class="code">target_params.conf</code>: see <code><a href="#target_params">Target Parameters Definitions</a></code></p> </li> <li> <p><code class="code">vacm.conf</code>: see <code><a href="#vacm">MIB Views for VACM</a></code></p> </li> <li> <p><code class="code">usm.conf</code>: see <code><a href="#usm">Security data for USM</a></code></p> </li> <li> <p><code class="code">notify.conf</code>: see <code><a href="#notify">Notify Definitions</a></code></p> </li> </ul> <p>The directory where the configuration files are found is given as a parameter to the agent. </p> <p>The entry format in all files are Erlang terms, separated by a '<strong>.</strong>' and a <strong>newline</strong>. In the following sections, the formats of these terms are described. Comments may be specified as ordinary Erlang comments. </p> <p>Syntax errors in these files are discovered and reported with the function <code class="code">config_err/2</code> of the error report module at start-up. </p>  <h2 id="agent-information" class="title-link" onmouseover="document.getElementById('ghlink-agent-information-idm1782').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-agent-information-idm1782').style.visibility = 'hidden';"> <div class="title-name">6.1 Agent Information</div>  </h2> <p>The agent information should be stored in a file called <code class="code">agent.conf</code>. </p> <p>Each entry is a tuple of size two:</p> <p><code class="code">{AgentVariable, Value}.</code></p> <ul> <li> <p><code class="code">AgentVariable</code> is one of the variables in SNMP-FRAMEWORK-MIB or one of the internal variables <code class="code">intAgentUDPPort</code>, which defines which UDP port the agent listens to, or <code class="code">intAgentTransports</code>, which defines the transport domains and addresses of the agent. </p> </li> <li> <p><code class="code">Value</code> is the value for the variable.</p> </li> </ul> <p>The following example shows an <code class="code">agent.conf</code> file: </p> <pre data-language="erlang">
{intAgentUDPPort, 4000}.
{intAgentTransports,
 [{transportDomainUdpIpv4, {141,213,11,24}},
  {transportDomainUdpIpv6, {0,0,0,0,0,0,0,1}}]}.
{snmpEngineID, "mbj's engine"}.
{snmpEngineMaxPacketSize, 484}.
    </pre> <p>These are the supported entries and their value types: </p> <pre data-language="erlang">
{snmpEngine,               string()}.             % Mandatory
{snmpEngineMaxMessageSize, non_neg_integer()}.    % Mandatory
{intAgentUDPPort,          pos_integer()}.        % Optional
{intAgentTransports,       intAgentTransports()}. % Mandatory
    </pre> <p>And here are the transport value types: </p> <pre data-language="erlang">
      intAgentTransports() :: [intAgentTransport()].
      intAgentTransport()  :: {TDomain, Addr} |
                              {TDomain, EAddr, Kind} |
{TDomain, EAddr, Opts} |
{TDomain, EAddr, Kind, Opts}
      TDomain      :: transportDomainUdpIpv4 | transportDomainUdpIpv6.
      Addr         :: {IpAddr, IpPort} | IpAddr.
      IpAddr       :: inet:ip_address() | snmpIpAddr().
      snmpIpAddr() :: [non_neg_integer()].
      IpPort       :: pos_integer().
      EAddr        :: {inet:ip_address(), PortInfo}.
      PortInfo     :: pos_integer() | system | range() | ranges().
      range()      :: {Min :: pos_integer(), Max :: pos_integer()}, Min &lt; Max
      ranges()     :: [pos_integer() | range()].
      Kind         :: req_responder | trap_sender.
      Opts         :: list().
    </pre> <p>If a "traditional" transport is specified (without explicit <code class="code">Kind</code>, handling both requests and traps) for a transport domain, its <strong>not</strong> possible to also specify a transport (for that domain) with a specific <code class="code">Kind</code>. This is for example <strong>not</strong> allowed:</p> <pre data-language="erlang">
[{transportDomainUdpIpv4, {{141,213,11,24}, 4000}},
 {transportDomainUdpIpv4, {{141,213,11,24}, 4001}, trap_sender}].
   </pre> <p>Note that only one transport per kind for each transport domain can be configured. </p> <p><code class="code">PortInfo</code> <code class="code">system</code> is used to indicate that the 'system' should choose (the way port number '0' (zero) is normally used). Port info '0' (zero) cannot be used for this, since it is (internally) used to represent the 'default' port number. </p> <p>In the traditional transport entries, when the <code class="code">Addr</code> value does not contain a port number, the value of <code class="code">intAgentUDPPort</code> is used.</p> <p>Note that the (new) extended transport entries (including <code class="code">Kind</code> and <code class="code">Opts</code>) <strong>must</strong> specify port-info as they ignore any value specified by <code class="code">intAgentUDPPort</code>.</p> <p><code class="code">Opts</code> is the same as for the <code><a href="snmp_config#agent_ni_opts">net-if</a></code> process <strong>and</strong> takes precedence (for that transport) if present. The point is that each transport can have its own socket options. </p> <p>The value of <code class="code">snmpEngineID</code> is a string, which for a deployed agent should have a very specific structure. See RFC 2271/2571 for details.</p> <div class="note"> <div class="label">Note</div> <div class="content">

<p>The legacy and intermediate variables <code class="code">intAgentIpAddress</code> and <code class="code">intAgentTransportDomain</code> are still supported so old <code class="code">agent.conf</code> files will work.</p> <p>But they <strong>cannot</strong> be combined with intAgentTransports.</p> </div> </div>  <h2 id="contexts" class="title-link" onmouseover="document.getElementById('ghlink-contexts-idm1841').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-contexts-idm1841').style.visibility = 'hidden';"> <div class="title-name">6.2 Contexts</div>  </h2> <p>The context information should be stored in a file called <code class="code">context.conf</code>. The default context <code class="code">""</code> need not be present.</p> <p>Each row defines a context in the agent. This information is used in the table <code class="code">vacmContextTable</code> in the SNMP-VIEW-BASED-ACM-MIB.</p> <p>Each entry is a term:</p> <p><code class="code">ContextName.</code></p> <ul> <li> <p><code class="code">ContextName</code> is a string.</p> </li> </ul>  <h2 id="system-information" class="title-link" onmouseover="document.getElementById('ghlink-system-information-idm1856').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-system-information-idm1856').style.visibility = 'hidden';"> <div class="title-name">6.3 System Information</div>  </h2> <p>The system information should be stored in a file called <code class="code">standard.conf</code>.</p> <p>Each entry is a tuple of size two:</p> <p><code class="code">{SystemVariable, Value}.</code></p> <ul> <li> <p><code class="code">SystemVariable</code> is one of the variables in the system group, or <code class="code">snmpEnableAuthenTraps</code>. </p> </li> <li> <p><code class="code">Value</code> is the value for the variable. </p> </li> </ul> <p>The following example shows a valid <code class="code">standard.conf</code> file: </p> <pre data-language="erlang">
{sysDescr, "Erlang SNMP agent"}.
{sysObjectID, [1,2,3]}.
{sysContact, "(mbj,eklas)@erlang.ericsson.se"}.
{sysName, "test"}.
{sysServices, 72}.
{snmpEnableAuthenTraps, enabled}.
    </pre> <p>A value must be provided for all variables, which lack default values in the MIB. </p>  <h2 id="communities" class="title-link" onmouseover="document.getElementById('ghlink-communities-idm1876').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-communities-idm1876').style.visibility = 'hidden';"> <div class="title-name">6.4 Communities</div>  </h2> <p>The community information should be stored in a file called <code class="code">community.conf</code>. It must be present if the agent is configured for SNMPv1 or SNMPv2c. </p> <p>An SNMP <strong>community</strong> is a relationship between an SNMP agent and a set of SNMP managers that defines authentication, access control and proxy characteristics. </p> <p>The corresponding table is <code class="code">snmpCommunityTable</code> in the SNMP-COMMUNITY-MIB. </p> <p>Each entry is a term: </p> <p><code class="code">{CommunityIndex, CommunityName, SecurityName, ContextName, TransportTag}.</code> </p> <ul> <li> <p><code class="code">CommunityIndex</code> is a non-empty string.</p> </li> <li> <p><code class="code">CommunityName</code> is a string.</p> </li> <li> <p><code class="code">SecurityName</code> is a string.</p> </li> <li> <p><code class="code">ContextName</code> is a string.</p> </li> <li> <p><code class="code">TransportTag</code> is a string.</p> </li> </ul>  <h2 id="mib-views-for-vacm" class="title-link" onmouseover="document.getElementById('ghlink-mib-views-for-vacm-idm1904').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-mib-views-for-vacm-idm1904').style.visibility = 'hidden';"> <div class="title-name">6.5 MIB Views for VACM</div>  </h2> <p>The information about MIB Views for VACM should be stored in a file called <code class="code">vacm.conf</code>.</p> <p>The corresponding tables are <code class="code">vacmSecurityToGroupTable</code>, <code class="code">vacmAccessTable</code> and <code class="code">vacmViewTreeFamilyTable</code> in the SNMP-VIEW-BASED-ACM-MIB.</p> <p>Each entry is one of the terms, one entry corresponds to one row in one of the tables.</p> <p><code class="code">{vacmSecurityToGroup, SecModel, SecName, GroupName}.</code></p> <p><code class="code">{vacmAccess, GroupName, Prefix, SecModel, SecLevel, Match, ReadView, WriteView, NotifyView}.</code></p> <p><code class="code">{vacmViewTreeFamily, ViewIndex, ViewSubtree, ViewStatus, ViewMask}.</code></p> <ul> <li> <p><code class="code">SecModel</code> is <code class="code">any</code>, <code class="code">v1</code>, <code class="code">v2c</code>, or <code class="code">usm</code>.</p> </li> <li> <p><code class="code">SecName</code> is a string.</p> </li> <li> <p><code class="code">GroupName</code> is a string.</p> </li> <li> <p><code class="code">Prefix</code> is a string.</p> </li> <li> <p><code class="code">SecLevel</code> is <code class="code">noAuthNoPriv</code>, <code class="code">authNoPriv</code>, or <code class="code">authPriv</code></p> </li> <li> <p><code class="code">Match</code> is <code class="code">prefix</code> or <code class="code">exact</code>.</p> </li> <li> <p><code class="code">ReadView</code> is a string.</p> </li> <li> <p><code class="code">WriteView</code> is a string.</p> </li> <li> <p><code class="code">NotifyView</code> is a string.</p> </li> <li> <p><code class="code">ViewIndex</code> is an integer.</p> </li> <li> <p><code class="code">ViewSubtree</code> is a list of integer.</p> </li> <li> <p><code class="code">ViewStatus</code> is either <code class="code">included</code> or <code class="code">excluded</code></p> </li> <li> <p><code class="code">ViewMask</code> is either <code class="code">null</code> or a list of ones and zeros. Ones nominate that an exact match is used for this sub-identifier. Zeros are wild-cards which match any sub-identifier. If the mask is shorter than the sub-tree, the tail is regarded as all ones. <code class="code">null</code> is shorthand for a mask with all ones. </p> </li> </ul>  <h2 id="security-data-for-usm" class="title-link" onmouseover="document.getElementById('ghlink-security-data-for-usm-idm1973').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-security-data-for-usm-idm1973').style.visibility = 'hidden';"> <div class="title-name">6.6 Security data for USM</div>  </h2> <p>The information about Security data for USM should be stored in a file called <code class="code">usm.conf</code>, which must be present if the agent is configured for SNMPv3. </p> <p>The corresponding table is <code class="code">usmUserTable</code> in the SNMP-USER-BASED-SM-MIB (adjusted according to SNMP-USM-HMAC-SHA2-MIB).</p> <p>Each entry is a term:</p> <p><code class="code">{EngineID, UserName, SecName, Clone, AuthP, AuthKeyC, OwnAuthKeyC, PrivP, PrivKeyC, OwnPrivKeyC, Public, AuthKey, PrivKey}.</code></p> <ul> <li> <p><code class="code">EngineID</code> is a string.</p> </li> <li> <p><code class="code">UserName</code> is a string.</p> </li> <li> <p><code class="code">SecName</code> is a string.</p> </li> <li> <p><code class="code">Clone</code> is <code class="code">zeroDotZero</code> or a list of integers.</p> </li> <li> <p><code class="code">AuthP</code> is a <code class="code">usmNoAuthProtocol</code>, <code class="code">usmHMACMD5AuthProtocol</code>, <code class="code">usmHMACSHAAuthProtocol</code>, <code class="code">usmHMAC128SHA224AuthProtocol</code>, <code class="code">usmHMAC192SH256AuthProtocol</code>, <code class="code">usmHMAC256SHA384AuthProtocol</code> or <code class="code">usmHMAC384SHA512AuthProtocol</code>.</p> </li> <li> <p><code class="code">AuthKeyC</code> is a string.</p> </li> <li> <p><code class="code">OwnAuthKeyC</code> is a string.</p> </li> <li> <p><code class="code">PrivP</code> is a <code class="code">usmNoPrivProtocol</code>, <code class="code">usmDESPrivProtocol</code> or <code class="code">usmAesCfb128Protocol</code>.</p> </li> <li> <p><code class="code">PrivKeyC</code> is a string.</p> </li> <li> <p><code class="code">OwnPrivKeyC</code> is a string.</p> </li> <li> <p><code class="code">Public</code> is a string.</p> </li> <li> <p><code class="code">AuthKey</code> is a list (of integer). This is the User's secret localized authentication key. It is not visible in the MIB. The length (number of octets) of this key needs to be:</p> <ul> <li> <p>16 if <code class="code">usmHMACMD5AuthProtocol</code>.</p> </li> <li> <p>20 if <code class="code">usmHMACSHAAuthProtocol</code>.</p> </li> <li> <p>28 if <code class="code">usmHMAC128SHA224AuthProtocol</code>.</p> </li> <li> <p>32 if <code class="code">usmHMAC192SHA256AuthProtocol</code>.</p> </li> <li> <p>48 if <code class="code">usmHMAC256SHA384AuthProtocol</code>.</p> </li> <li> <p>64 if <code class="code">usmHMAC384SHA512AuthProtocol</code>.</p> </li> </ul> </li> <li> <p><code class="code">PrivKey</code> is a list (of integer). This is the User's secret localized encryption key. It is not visible in the MIB. The length of this key needs to be 16 if <code class="code">usmDESPrivProtocol</code> or <code class="code">usmAesCfb128Protocol</code> is used. </p> </li> </ul>  <h2 id="notify-definitions" class="title-link" onmouseover="document.getElementById('ghlink-notify-definitions-idm2055').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-notify-definitions-idm2055').style.visibility = 'hidden';"> <div class="title-name">6.7 Notify Definitions</div>  </h2> <p>The information about Notify Definitions should be stored in a file called <code class="code">notify.conf</code>. </p> <p>The corresponding table is <code class="code">snmpNotifyTable</code> in the SNMP-NOTIFICATION-MIB.</p> <p>Each entry is a term:</p> <p><code class="code">{NotifyName, Tag, Type}.</code></p> <ul> <li> <p><code class="code">NotifyName</code> is a unique non-empty string.</p> </li> <li> <p><code class="code">Tag</code> is a string.</p> </li> <li> <p><code class="code">Type</code> is <code class="code">trap</code> or <code class="code">inform</code>.</p> </li> </ul>  <h2 id="target-address-definitions" class="title-link" onmouseover="document.getElementById('ghlink-target-address-definitions-idm2077').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-target-address-definitions-idm2077').style.visibility = 'hidden';"> <div class="title-name">6.8 Target Address Definitions</div>  </h2> <p>The information about Target Address Definitions should be stored in a file called <code class="code">target_addr.conf</code>. </p> <p>The corresponding tables are <code class="code">snmpTargetAddrTable</code> in the SNMP-TARGET-MIB and <code class="code">snmpTargetAddrExtTable</code> in the SNMP-COMMUNITY-MIB. </p> <p>Each entry is a term: </p> <p><code class="code">{TargetName, Domain, Addr, Timeout, RetryCount, TagList, ParamsName, EngineId}.</code> <br> or <br> <code class="code">{TargetName, Domain, Addr, Timeout, RetryCount, TagList, ParamsName, EngineId, TMask, MaxMessageSize}.</code> </p> <ul> <li> <p><code class="code">TargetName</code> is a unique non-empty string. </p> </li> <li> <p><code class="code">Domain</code> is one of the atoms: <code class="code">transportDomainUdpIpv4</code> | <code class="code">transportDomainUdpIpv6</code>. </p> </li> <li> <p><code class="code">Addr</code> is either an <code class="code">IpAddr</code> or an <code class="code">{IpAddr, IpPort}</code> tuple. <code class="code">IpAddr</code> is either a regular Erlang/OTP <code><span class="code">ip_address()</span></code> or a traditional SNMP integer list, and <code class="code">IpPort</code> is an integer.</p> <p>If <code class="code">IpPort</code> is omitted <code class="code">162</code> is used.</p> </li> <li> <p><code class="code">Timeout</code> is an integer. </p> </li> <li> <p><code class="code">RetryCount</code> is an integer. </p> </li> <li> <p><code class="code">TagList</code> is a string. </p> </li> <li> <p><code class="code">ParamsName</code> is a string. </p> </li> <li> <p><code class="code">EngineId</code> is a string or the atom <code class="code">discovery</code>. </p> </li> <li> <p><code class="code">TMask</code> is specified just as <code class="code">Addr</code> or as <code class="code">[]</code>. Note in particular that using a list of 6 bytes for IPv4 or 8 words plus 2 bytes for IPv6 are still valid address formats so old configurations will work.</p> </li> <li> <p><code class="code">MaxMessageSize</code> is an integer (default: 2048). </p> </li> </ul> <p>The old tuple formats with <code class="code">Ip</code> address and <code class="code">Udp</code> port number found in old configurations still work.</p> <p>Note that if <code class="code">EngineId</code> has the value <code class="code">discovery</code>, the agent cannot send <code class="code">inform</code> messages to that manager until it has performed the <strong>discovery</strong> process with that manager. </p>  <h2 id="target-parameters-definitions" class="title-link" onmouseover="document.getElementById('ghlink-target-parameters-definitions-idm2144').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-target-parameters-definitions-idm2144').style.visibility = 'hidden';"> <div class="title-name">6.9 Target Parameters Definitions</div>  </h2> <p>The information about Target Parameters Definitions should be stored in a file called <code class="code">target_params.conf</code>. </p> <p>The corresponding table is <code class="code">snmpTargetParamsTable</code> in the SNMP-TARGET-MIB. </p> <p>Each entry is a term: </p> <p><code class="code">{ParamsName, MPModel, SecurityModel, SecurityName, SecurityLevel}.</code></p> <ul> <li> <p><code class="code">ParamsName</code> is a unique non-empty string. </p> </li> <li> <p><code class="code">MPModel</code> is <code class="code">v1</code>, <code class="code">v2c</code> or <code class="code">v3</code></p> </li> <li> <p><code class="code">SecurityModel</code> is <code class="code">v1</code>, <code class="code">v2c</code>, or <code class="code">usm</code>.</p> </li> <li> <p><code class="code">SecurityName</code> is a string.</p> </li> <li> <p><code class="code">SecurityLevel</code> is <code class="code">noAuthNoPriv</code>, <code class="code">authNoPriv</code> or <code class="code">authPriv</code>. </p> </li> </ul> </div> <div class="footer"> <hr> <p>Copyright © 1997-2022 Ericsson AB. All Rights Reserved.</p> </div><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2010&ndash;2022 Ericsson AB<br>Licensed under the Apache License, Version 2.0.<br>
    
  </p>
</div>
