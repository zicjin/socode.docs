  <div class="innertube"> <h2 id="c-library" class="title-link" onmouseover="document.getElementById('ghlink-c-library-idm330').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-c-library-idm330').style.visibility = 'hidden';"> <div class="title-name">C Library</div>  </h2> <p class="REFBODY c-library-body">ei</p> </div> <div class="innertube"> <h2 id="library-summary" class="title-link" onmouseover="document.getElementById('ghlink-library-summary-idm331').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-library-summary-idm331').style.visibility = 'hidden';"> <div class="title-name">Library Summary</div>  </h2> <p class="REFBODY library-summary-body">Routines for handling the Erlang binary term format.</p> </div> <section class="description"><div class="innertube"> <h2 id="description" class="title-link" onmouseover="document.getElementById('ghlink-description-idm332').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-description-idm332').style.visibility = 'hidden';"> <div class="title-name">Description</div>  </h2> 
<p>The library <code class="code">ei</code> contains macros and functions to encode and decode the Erlang binary term format.</p> <p><code class="code">ei</code> allows you to convert atoms, lists, numbers, and binaries to and from the binary format. This is useful when writing port programs and drivers. <code class="code">ei</code> uses a given buffer, no dynamic memory (except <code class="code">ei_decode_fun()</code>) and is often quite fast.</p> <p><code class="code">ei</code> also handles C-nodes, C-programs that talks Erlang distribution with Erlang nodes (or other C-nodes) using the Erlang distribution format.The <code class="code">ei</code> library is thread safe, and using threads, one process can handle multiple C-nodes.</p> <p>The decode and encode functions use a buffer and an index into the buffer, which points at the point where to encode and decode. The index is updated to point right after the term encoded/decoded. No checking is done whether the term fits in the buffer or not. If encoding goes outside the buffer, the program can crash.</p> <p>All functions take two parameters:</p> <ul> <li> <p><code class="code">buf</code> is a pointer to the buffer where the binary data is or will be.</p> </li> <li> <p><code class="code">index</code> is a pointer to an index into the buffer. This parameter is incremented with the size of the term decoded/encoded.</p> </li> </ul> <p>The data is thus at <code class="code">buf[*index]</code> when an <code class="code">ei</code> function is called.</p> <p>All encode functions assume that the <code class="code">buf</code> and <code class="code">index</code> parameters point to a buffer large enough for the data. To get the size of an encoded term, without encoding it, pass <code class="code">NULL</code> instead of a buffer pointer. Parameter <code class="code">index</code> is incremented, but nothing will be encoded. This is the way in <code class="code">ei</code> to "preflight" term encoding.</p> <p>There are also encode functions that use a dynamic buffer. It is often more convenient to use these to encode data. All encode functions comes in two versions; those starting with <code class="code">ei_x_</code> use a dynamic buffer of type <code><a href="#ei_x_buff"><span class="code">ei_x_buff</span></a></code>. </p> <p>All functions return <code class="code">0</code> if successful, otherwise <code class="code">-1</code> (for example, if a term is not of the expected type, or the data to decode is an invalid Erlang term).</p> <p>Some of the decode functions need a pre-allocated buffer. This buffer must be allocated large enough, and for non-compound types the <code><a href="#ei_get_type"><span class="code">ei_get_type()</span></a></code> function returns the size required (notice that for strings an extra byte is needed for the <code class="code">NULL</code>-terminator).</p>  </div></section> <section class="innertube"><h2 id="data-types" class="title-link" onmouseover="document.getElementById('ghlink-data-types-idm371').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-data-types-idm371').style.visibility = 'hidden';"> <div class="title-name">Data Types</div>  </h2>  <dl> <dt><strong><code class="code" id="ei_term">ei_term</code></strong></dt> <dd> <pre data-language="erlang">typedef struct {
    char ei_type;
    int arity;
    int size;
    union {
	long i_val;
	double d_val;
	char atom_name[MAXATOMLEN_UTF8];
	erlang_pid pid;
	erlang_port port;
	erlang_ref ref;
    } value;
} ei_term;</pre> <p>Structure written by <code><a href="#ei_decode_ei_term"><span class="code">ei_decode_ei_term()</span></a></code>. The <code class="code">ei_type</code> field is the type of the term which equals to what <code><a href="#ei_get_type"><span class="code">ei_get_type()</span></a></code> sets <code class="code">*type</code> to. </p> </dd> <dt><strong><code class="code" id="ei_x_buff">ei_x_buff</code></strong></dt> <dd> <p>A dynamically resized buffer. It is a <code class="code">struct</code> with two fields of interest for the user: </p> <dl> <dt><strong><code class="code">char *buff</code></strong></dt> <dd> <p>Pointer to the dynamically allocated buffer.</p> </dd> <dt><strong><code class="code">int index</code></strong></dt> <dd> <p>Offset to the next byte to write which also equals the amount of bytes currently written.</p> </dd> </dl> <p> An <code class="code">ei_x_buff</code> is initialized by calling either <code><a href="#ei_x_new"><span class="code">ei_x_new()</span></a></code> or <code><a href="#ei_x_new_with_version"><span class="code">ei_x_new_with_version()</span></a></code>. The memory used by an initialized <code class="code">ei_x_buff</code> is released by calling <code><a href="#ei_x_free"><span class="code">ei_x_free()</span></a></code>. </p> </dd> <dt><strong><code class="code" id="erlang_char_encoding">erlang_char_encoding</code></strong></dt> <dd> <pre data-language="erlang">typedef enum {
    ERLANG_ASCII = 1,
    ERLANG_LATIN1 = 2,
    ERLANG_UTF8 = 4
} erlang_char_encoding;</pre> <p>The character encodings used for atoms. <code class="code">ERLANG_ASCII</code> represents 7-bit ASCII. Latin-1 and UTF-8 are different extensions of 7-bit ASCII. All 7-bit ASCII characters are valid Latin-1 and UTF-8 characters. ASCII and Latin-1 both represent each character by one byte. An UTF-8 character can consist of 1-4 bytes. Notice that these constants are bit-flags and can be combined with bitwise OR.</p> </dd> <dt><strong><code class="code" id="erlang_fun">erlang_fun</code></strong></dt> <dd> <p>Opaque data type representing an Erlang fun.</p> </dd> <dt><strong><code class="code" id="erlang_pid">erlang_pid</code></strong></dt> <dd> <p>Opaque data type representing an Erlang process identifier.</p> </dd> <dt><strong><code class="code" id="erlang_port">erlang_port</code></strong></dt> <dd> <p>Opaque data type representing an Erlang port identifier.</p> </dd> <dt><strong><code class="code" id="erlang_ref">erlang_ref</code></strong></dt> <dd> <p>Opaque data type representing an Erlang reference.</p> </dd> <dt><strong><code class="code" id="erlang_trace">erlang_trace</code></strong></dt> <dd> <p>Opaque data type representing an Erlang sequential trace token.</p> </dd> </dl> </section> <div class="innertube"><h2 id="export" class="title-link" onmouseover="document.getElementById('ghlink-export-idm442').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-export-idm442').style.visibility = 'hidden';"> <div class="title-name">Exports</div>  </h2></div> <div class="exports-body"> <article class="func"><div><h4 id="ei_cmp_pids" class="title-link" onmouseover="document.getElementById('ghlink-ei_cmp_pids-idm444').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-ei_cmp_pids-idm444').style.visibility = 'hidden';">  <div class="title-name">int ei_cmp_pids(<br>erlang_pid *a,<br>erlang_pid *b)</div> <div class="title-since"><span class="since">OTP 23.0</span></div> </h4></div> <div class="exports-tube">  <h2 id="types" class="func-types-title">Types</h2>    <p> Compare two process identifiers. The comparison is done the same way as Erlang does. </p> <p> Returns <code class="code">0</code> if <code class="code">a</code> and <code class="code">b</code> are equal. Returns a value less than <code class="code">0</code> if <code class="code">a</code> compares as less than <code class="code">b</code>. Returns a value larger than <code class="code">0</code> if <code class="code">a</code> compares as larger than <code class="code">b</code>. </p>  </div></article><article class="func"><div><h4 id="ei_cmp_ports" class="title-link" onmouseover="document.getElementById('ghlink-ei_cmp_ports-idm465').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-ei_cmp_ports-idm465').style.visibility = 'hidden';">  <div class="title-name">int ei_cmp_ports(<br>erlang_port *a,<br>erlang_port *b)</div> <div class="title-since"><span class="since">OTP 23.0</span></div> </h4></div> <div class="exports-tube">  <h2 id="types" class="func-types-title">Types</h2>    <p> Compare two port identifiers. The comparison is done the same way as Erlang does. </p> <p> Returns <code class="code">0</code> if <code class="code">a</code> and <code class="code">b</code> are equal. Returns a value less than <code class="code">0</code> if <code class="code">a</code> compares as less than <code class="code">b</code>. Returns a value larger than <code class="code">0</code> if <code class="code">a</code> compares as larger than <code class="code">b</code>. </p>  </div></article><article class="func"><div><h4 id="ei_cmp_refs" class="title-link" onmouseover="document.getElementById('ghlink-ei_cmp_refs-idm486').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-ei_cmp_refs-idm486').style.visibility = 'hidden';">  <div class="title-name">int ei_cmp_refs(<br>erlang_ref *a,<br>erlang_ref *b)</div> <div class="title-since"><span class="since">OTP 23.0</span></div> </h4></div> <div class="exports-tube">  <h2 id="types" class="func-types-title">Types</h2>    <p> Compare two references. The comparison is done the same way as Erlang does. </p> <p> Returns <code class="code">0</code> if <code class="code">a</code> and <code class="code">b</code> are equal. Returns a value less than <code class="code">0</code> if <code class="code">a</code> compares as less than <code class="code">b</code>. Returns a value larger than <code class="code">0</code> if <code class="code">a</code> compares as larger than <code class="code">b</code>. </p>  </div></article><article class="func"><div><h4 id="ei_decode_atom" class="title-link" onmouseover="document.getElementById('ghlink-ei_decode_atom-idm507').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-ei_decode_atom-idm507').style.visibility = 'hidden';">  <div class="title-name">int ei_decode_atom(<br>const char *buf,<br>int *index,<br>char *p)</div> </h4></div> <div class="exports-tube"> <p>Decodes an atom from the binary format. The <code class="code">NULL</code>-terminated name of the atom is placed at <code class="code">p</code>. At most <code class="code">MAXATOMLEN</code> bytes can be placed in the buffer.</p> </div></article><article class="func"><div><h4 id="ei_decode_atom_as" class="title-link" onmouseover="document.getElementById('ghlink-ei_decode_atom_as-idm517').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-ei_decode_atom_as-idm517').style.visibility = 'hidden';">  <div class="title-name">int ei_decode_atom_as(<br>const char *buf,<br>int *index,<br>char *p,<br>int plen,<br>erlang_char_encoding want,<br>erlang_char_encoding* was,<br>erlang_char_encoding* result)</div> <div class="title-since"><span class="since">OTP R16B</span></div> </h4></div> <div class="exports-tube">  <h2 id="types" class="func-types-title">Types</h2>    <p>Decodes an atom from the binary format. The <code class="code">NULL</code>-terminated name of the atom is placed in buffer at <code class="code">p</code> of length <code class="code">plen</code> bytes.</p> <p>The wanted string encoding is specified by <code><a href="#erlang_char_encoding"><span class="code">want</span></a></code>. The original encoding used in the binary format (Latin-1 or UTF-8) can be obtained from <code class="code">*was</code>. The encoding of the resulting string (7-bit ASCII, Latin-1, or UTF-8) can be obtained from <code class="code">*result</code>. Both <code class="code">was</code> and <code class="code">result</code> can be <code class="code">NULL</code>. <code class="code">*result</code> can differ from <code class="code">want</code> if <code class="code">want</code> is a bitwise OR'd combination like <code class="code">ERLANG_LATIN1|ERLANG_UTF8</code> or if <code class="code">*result</code> turns out to be pure 7-bit ASCII (compatible with both Latin-1 and UTF-8).</p> <p>This function fails if the atom is too long for the buffer or if it cannot be represented with encoding <code class="code">want</code>.</p> <p>This function was introduced in Erlang/OTP R16 as part of a first step to support UTF-8 atoms.</p>  </div></article><article class="func"><div><h4 id="ei_decode_bignum" class="title-link" onmouseover="document.getElementById('ghlink-ei_decode_bignum-idm547').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-ei_decode_bignum-idm547').style.visibility = 'hidden';">  <div class="title-name">int ei_decode_bignum(<br>const char *buf,<br>int *index,<br>mpz_t obj)</div> </h4></div> <div class="exports-tube"> <p>Decodes an integer in the binary format to a GMP <code class="code">mpz_t</code> integer. To use this function, the <code class="code">ei</code> library must be configured and compiled to use the GMP library.</p> </div></article><article class="func"><div><h4 id="ei_decode_binary" class="title-link" onmouseover="document.getElementById('ghlink-ei_decode_binary-idm556').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-ei_decode_binary-idm556').style.visibility = 'hidden';">  <div class="title-name">int ei_decode_binary(<br>const char *buf,<br>int *index,<br>void *p,<br>long *len)</div> </h4></div> <div class="exports-tube"> <p>Decodes a binary from the binary format. Parameter <code class="code">len</code> is set to the actual size of the binary. Notice that <code class="code">ei_decode_binary()</code> assumes that there is enough room for the binary. The size required can be fetched by <code><a href="#ei_get_type"><span class="code">ei_get_type()</span></a></code>.</p> </div></article><article class="func"><div><h4 id="ei_decode_bitstring" class="title-link" onmouseover="document.getElementById('ghlink-ei_decode_bitstring-idm567').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-ei_decode_bitstring-idm567').style.visibility = 'hidden';">  <div class="title-name">int ei_decode_bitstring(<br>const char *buf,<br>int *index,<br>const char **pp,<br>unsigned int *bitoffsp,<br>size_t *nbitsp)</div> <div class="title-since"><span class="since">OTP 22.0</span></div> </h4></div> <div class="exports-tube"> <p>Decodes a bit string from the binary format.</p> <dl> <dt><strong><code class="code">pp</code></strong></dt> <dd> <p>Either <code class="code">NULL</code> or <code class="code">*pp</code> returns a pointer to the first byte of the bit string. The returned bit string is readable as long as the buffer pointed to by <code class="code">buf</code> is readable and not written to.</p> </dd> <dt><strong><code class="code">bitoffsp</code></strong></dt> <dd> <p>Either <code class="code">NULL</code> or <code class="code">*bitoffsp</code> returns the number of unused bits in the first byte pointed to by <code class="code">*pp</code>. The value of <code class="code">*bitoffsp</code> is between 0 and 7. Unused bits in the first byte are the most significant bits.</p> </dd> <dt><strong><code class="code">nbitsp</code></strong></dt> <dd> <p>Either <code class="code">NULL</code> or <code class="code">*nbitsp</code> returns the length of the bit string in <strong>bits</strong>.</p> </dd> </dl> <p>Returns <code class="code">0</code> if it was a bit string term.</p> <p>The number of <strong>bytes</strong> pointed to by <code class="code">*pp</code>, which are part of the bit string, is <code class="code">(*bitoffsp + *nbitsp + 7)/8</code>. If <code class="code">(*bitoffsp + *bitsp)%8 &gt; 0</code> then only <code class="code">(*bitoffsp + *bitsp)%8</code> bits of the last byte are used. Unused bits in the last byte are the least significant bits.</p> <p>The values of unused bits in the first and last byte are undefined and cannot be relied on.</p> <p>Number of bits may be divisible by 8, which means a binary decodable by <code class="code">ei_decode_binary</code> is also decodable by <code class="code">ei_decode_bitstring</code>.</p> </div></article><article class="func"><div><h4 id="ei_decode_boolean" class="title-link" onmouseover="document.getElementById('ghlink-ei_decode_boolean-idm609').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-ei_decode_boolean-idm609').style.visibility = 'hidden';">  <div class="title-name">int ei_decode_boolean(<br>const char *buf,<br>int *index,<br>int *p)</div> </h4></div> <div class="exports-tube"> <p>Decodes a boolean value from the binary format. A boolean is actually an atom, <code class="code">true</code> decodes 1 and <code class="code">false</code> decodes 0.</p> </div></article><article class="func"><div><h4 id="ei_decode_char" class="title-link" onmouseover="document.getElementById('ghlink-ei_decode_char-idm618').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-ei_decode_char-idm618').style.visibility = 'hidden';">  <div class="title-name">int ei_decode_char(<br>const char *buf,<br>int *index,<br>char *p)</div> </h4></div> <div class="exports-tube"> <p>Decodes a char (8-bit) integer between 0-255 from the binary format. For historical reasons the returned integer is of type <code class="code">char</code>. Your C code is to consider the returned value to be of type <code class="code">unsigned char</code> even if the C compilers and system can define <code class="code">char</code> to be signed.</p> </div></article><article class="func"><div><h4 id="ei_decode_double" class="title-link" onmouseover="document.getElementById('ghlink-ei_decode_double-idm628').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-ei_decode_double-idm628').style.visibility = 'hidden';">  <div class="title-name">int ei_decode_double(<br>const char *buf,<br>int *index,<br>double *p)</div> </h4></div> <div class="exports-tube"> <p>Decodes a double-precision (64-bit) floating point number from the binary format.</p> </div></article><article class="func"><div><h4 id="ei_decode_ei_term" class="title-link" onmouseover="document.getElementById('ghlink-ei_decode_ei_term-idm635').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-ei_decode_ei_term-idm635').style.visibility = 'hidden';">  <div class="title-name">int ei_decode_ei_term(<br>const char* buf,<br>int* index,<br>ei_term* term)</div> </h4></div> <div class="exports-tube">  <h2 id="types" class="func-types-title">Types</h2>    <p>Decodes any term, or at least tries to. If the term pointed at by <code class="code">*index</code> in <code class="code">buf</code> fits in the <code class="code">term</code> union, it is decoded, and the appropriate field in <code class="code">term-&gt;value</code> is set, and <code class="code">*index</code> is incremented by the term size.</p> <p>The function returns <code class="code">1</code> on successful decoding, <code class="code">-1</code> on error, and <code class="code">0</code> if the term seems alright, but does not fit in the <code class="code">term</code> structure. If <code class="code">1</code> is returned, the <code class="code">index</code> is incremented, and <code class="code">term</code> contains the decoded term.</p> <p>The <code class="code">term</code> structure contains the arity for a tuple or list, size for a binary, string, or atom. It contains a term if it is any of the following: integer, float, atom, pid, port, or ref.</p>  </div></article><article class="func"><div><h4 id="ei_decode_fun" class="title-link" onmouseover="document.getElementById('ghlink-ei_decode_fun-idm661').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-ei_decode_fun-idm661').style.visibility = 'hidden';">  <div class="title-name">int ei_decode_fun(<br>const char *buf,<br>int *index,<br>erlang_fun *p)</div> </h4></div> <div><h4 id="free_fun" class="title-link" onmouseover="document.getElementById('ghlink-free_fun-idm664').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-free_fun-idm664').style.visibility = 'hidden';">  <div class="title-name">void free_fun(<br>erlang_fun* f)</div> </h4></div> <div class="exports-tube">  <h2 id="types" class="func-types-title">Types</h2>    <p>Decodes a fun from the binary format. Parameter <code class="code">p</code> is to be <code class="code">NULL</code> or point to an <code class="code">erlang_fun</code> structure. This is the only decode function that allocates memory. When the <code class="code">erlang_fun</code> is no longer needed, it is to be freed with <code class="code">free_fun</code>. (This has to do with the arbitrary size of the environment for a fun.)</p>  </div></article><article class="func"><div><h4 id="ei_decode_iodata" class="title-link" onmouseover="document.getElementById('ghlink-ei_decode_iodata-idm680').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-ei_decode_iodata-idm680').style.visibility = 'hidden';">  <div class="title-name">int ei_decode_iodata(<br>const char *buf,<br>int *index,<br>int *size,<br>char *outbuf)</div> <div class="title-since"><span class="since">OTP 23.0</span></div> </h4></div> <div class="exports-tube"> <p>Decodes a term of the type <code><span class="code">iodata()</span></code>. The <code class="code">iodata()</code> term will be flattened an written into the buffer pointed to by the <code class="code">outbuf</code> argument. The byte size of the <code class="code">iodata</code> is written into the integer variable pointed to by the <code class="code">size</code> argument. Both <code class="code">size</code> and <code class="code">outbuf</code> can be set to <code class="code">NULL</code>. The integer pointed to by the <code class="code">index</code> argument is updated to refer to the term following after the <code class="code">iodata()</code> term regardless of the the state of the <code class="code">size</code> and the <code class="code">outbuf</code> arguments. </p> <p>Note that the buffer pointed to by the <code class="code">outbuf</code> argument must be large enough if a non <code class="code">NULL</code> value is passed as <code class="code">outbuf</code>. You typically want to call <code class="code">ei_decode_iodata()</code> twice. First with a non <code class="code">NULL</code> <code class="code">size</code> argument and a <code class="code">NULL</code> <code class="code">outbuf</code> argument in order to determine the size of the buffer needed, and then once again in order to do the actual decoding. Note that the integer pointed to by <code class="code">index</code> will be updated by the call determining the size as well, so you need to reset it before the second call doing the actual decoding. </p> <p>Returns <code class="code">0</code> on success and <code class="code">-1</code> on failure. Failure might be either due to invalid encoding of the term or due to the term not being of the type <code class="code">iodata()</code>. On failure, the integer pointed to by the <code class="code">index</code> argument will be updated to refer to the sub term where the failure was detected.</p> </div></article><article class="func"><div><h4 id="ei_decode_list_header" class="title-link" onmouseover="document.getElementById('ghlink-ei_decode_list_header-idm715').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-ei_decode_list_header-idm715').style.visibility = 'hidden';">  <div class="title-name">int ei_decode_list_header(<br>const char *buf,<br>int *index,<br>int *arity)</div> </h4></div> <div class="exports-tube"> <p>Decodes a list header from the binary format. The number of elements is returned in <code class="code">arity</code>. The <code class="code">arity+1</code> elements follow (the last one is the tail of the list, normally an empty list). If <code class="code">arity</code> is <code class="code">0</code>, it is an empty list.</p> <p>Notice that lists are encoded as strings if they consist entirely of integers in the range 0..255. This function do not decode such strings, use <code class="code">ei_decode_string()</code> instead.</p> </div></article><article class="func"><div><h4 id="ei_decode_long" class="title-link" onmouseover="document.getElementById('ghlink-ei_decode_long-idm728').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-ei_decode_long-idm728').style.visibility = 'hidden';">  <div class="title-name">int ei_decode_long(<br>const char *buf,<br>int *index,<br>long *p)</div> </h4></div> <div class="exports-tube"> <p>Decodes a long integer from the binary format. If the code is 64 bits, the function <code class="code">ei_decode_long()</code> is the same as <code class="code">ei_decode_longlong()</code>.</p> </div></article><article class="func"><div><h4 id="ei_decode_longlong" class="title-link" onmouseover="document.getElementById('ghlink-ei_decode_longlong-idm737').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-ei_decode_longlong-idm737').style.visibility = 'hidden';">  <div class="title-name">int ei_decode_longlong(<br>const char *buf,<br>int *index,<br>long long *p)</div> </h4></div> <div class="exports-tube"> <p>Decodes a GCC <code class="code">long long</code> or Visual C++ <code class="code">__int64</code> (64-bit) integer from the binary format.</p> </div></article><article class="func"><div><h4 id="ei_decode_map_header" class="title-link" onmouseover="document.getElementById('ghlink-ei_decode_map_header-idm746').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-ei_decode_map_header-idm746').style.visibility = 'hidden';">  <div class="title-name">int ei_decode_map_header(<br>const char *buf,<br>int *index,<br>int *arity)</div> <div class="title-since"><span class="since">OTP 17.0</span></div> </h4></div> <div class="exports-tube"> <p>Decodes a map header from the binary format. The number of key-value pairs is returned in <code class="code">*arity</code>. Keys and values follow in this order: <code class="code">K1, V1, K2, V2, ..., Kn, Vn</code>. This makes a total of <code class="code">arity*2</code> terms. If <code class="code">arity</code> is zero, it is an empty map. A correctly encoded map does not have duplicate keys.</p> </div></article><article class="func"><div><h4 id="ei_decode_pid" class="title-link" onmouseover="document.getElementById('ghlink-ei_decode_pid-idm757').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-ei_decode_pid-idm757').style.visibility = 'hidden';">  <div class="title-name">int ei_decode_pid(<br>const char *buf,<br>int *index,<br>erlang_pid *p)</div> </h4></div> <div class="exports-tube">  <h2 id="types" class="func-types-title">Types</h2>    <p>Decodes a process identifier (pid) from the binary format.</p>  </div></article><article class="func"><div><h4 id="ei_decode_port" class="title-link" onmouseover="document.getElementById('ghlink-ei_decode_port-idm769').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-ei_decode_port-idm769').style.visibility = 'hidden';">  <div class="title-name">int ei_decode_port(<br>const char *buf,<br>int *index,<br>erlang_port *p)</div> </h4></div> <div class="exports-tube">  <h2 id="types" class="func-types-title">Types</h2>    <p>Decodes a port identifier from the binary format.</p>  </div></article><article class="func"><div><h4 id="ei_decode_ref" class="title-link" onmouseover="document.getElementById('ghlink-ei_decode_ref-idm780').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-ei_decode_ref-idm780').style.visibility = 'hidden';">  <div class="title-name">int ei_decode_ref(<br>const char *buf,<br>int *index,<br>erlang_ref *p)</div> </h4></div> <div class="exports-tube">  <h2 id="types" class="func-types-title">Types</h2>    <p>Decodes a reference from the binary format.</p>  </div></article><article class="func"><div><h4 id="ei_decode_string" class="title-link" onmouseover="document.getElementById('ghlink-ei_decode_string-idm791').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-ei_decode_string-idm791').style.visibility = 'hidden';">  <div class="title-name">int ei_decode_string(<br>const char *buf,<br>int *index,<br>char *p)</div> </h4></div> <div class="exports-tube"> <p>Decodes a string from the binary format. A string in Erlang is a list of integers between 0 and 255. Notice that as the string is just a list, sometimes lists are encoded as strings by <code class="code">term_to_binary/1</code>, even if it was not intended.</p> <p>The string is copied to <code class="code">p</code>, and enough space must be allocated. The returned string is <code class="code">NULL</code>-terminated, so you must add an extra byte to the memory requirement.</p> </div></article><article class="func"><div><h4 id="ei_decode_trace" class="title-link" onmouseover="document.getElementById('ghlink-ei_decode_trace-idm802').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-ei_decode_trace-idm802').style.visibility = 'hidden';">  <div class="title-name">int ei_decode_trace(<br>const char *buf,<br>int *index,<br>erlang_trace *p)</div> </h4></div> <div class="exports-tube">  <h2 id="types" class="func-types-title">Types</h2>    <p>Decodes an Erlang trace token from the binary format.</p>  </div></article><article class="func"><div><h4 id="ei_decode_tuple_header" class="title-link" onmouseover="document.getElementById('ghlink-ei_decode_tuple_header-idm813').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-ei_decode_tuple_header-idm813').style.visibility = 'hidden';">  <div class="title-name">int ei_decode_tuple_header(<br>const char *buf,<br>int *index,<br>int *arity)</div> </h4></div> <div class="exports-tube"> <p>Decodes a tuple header, the number of elements is returned in <code class="code">arity</code>. The tuple elements follow in order in the buffer.</p> </div></article><article class="func"><div><h4 id="ei_decode_ulong" class="title-link" onmouseover="document.getElementById('ghlink-ei_decode_ulong-idm821').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-ei_decode_ulong-idm821').style.visibility = 'hidden';">  <div class="title-name">int ei_decode_ulong(<br>const char *buf,<br>int *index,<br>unsigned long *p)</div> </h4></div> <div class="exports-tube"> <p>Decodes an unsigned long integer from the binary format. If the code is 64 bits, the function <code class="code">ei_decode_ulong()</code> is the same as <code class="code">ei_decode_ulonglong()</code>.</p> </div></article><article class="func"><div><h4 id="ei_decode_ulonglong" class="title-link" onmouseover="document.getElementById('ghlink-ei_decode_ulonglong-idm830').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-ei_decode_ulonglong-idm830').style.visibility = 'hidden';">  <div class="title-name">int ei_decode_ulonglong(<br>const char *buf,<br>int *index,<br>unsigned long long *p)</div> </h4></div> <div class="exports-tube"> <p>Decodes a GCC <code class="code">unsigned long long</code> or Visual C++ <code class="code">unsigned __int64</code> (64-bit) integer from the binary format.</p> </div></article><article class="func"><div><h4 id="ei_decode_version" class="title-link" onmouseover="document.getElementById('ghlink-ei_decode_version-idm839').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-ei_decode_version-idm839').style.visibility = 'hidden';">  <div class="title-name">int ei_decode_version(<br>const char *buf,<br>int *index,<br>int *version)</div> </h4></div> <div class="exports-tube"> <p>Decodes the version magic number for the Erlang binary term format. It must be the first token in a binary term.</p> </div></article><article class="func"><div><h4 id="ei_encode_atom" class="title-link" onmouseover="document.getElementById('ghlink-ei_encode_atom-idm847').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-ei_encode_atom-idm847').style.visibility = 'hidden';">  <div class="title-name">int ei_encode_atom(<br>char *buf,<br>int *index,<br>const char *p)</div> </h4></div> <div><h4 id="ei_encode_atom_len" class="title-link" onmouseover="document.getElementById('ghlink-ei_encode_atom_len-idm850').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-ei_encode_atom_len-idm850').style.visibility = 'hidden';">  <div class="title-name">int ei_encode_atom_len(<br>char *buf,<br>int *index,<br>const char *p,<br>int len)</div> </h4></div> <div><h4 id="ei_x_encode_atom" class="title-link" onmouseover="document.getElementById('ghlink-ei_x_encode_atom-idm853').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-ei_x_encode_atom-idm853').style.visibility = 'hidden';">  <div class="title-name">int ei_x_encode_atom(<br>ei_x_buff* x,<br>const char *p)</div> </h4></div> <div><h4 id="ei_x_encode_atom_len" class="title-link" onmouseover="document.getElementById('ghlink-ei_x_encode_atom_len-idm856').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-ei_x_encode_atom_len-idm856').style.visibility = 'hidden';">  <div class="title-name">int ei_x_encode_atom_len(<br>ei_x_buff* x,<br>const char *p,<br>int len)</div> </h4></div> <div class="exports-tube">  <h2 id="types" class="func-types-title">Types</h2>    <p>Encodes an atom in the binary format. Parameter <code class="code">p</code> is the name of the atom in Latin-1 encoding. Only up to <code class="code">MAXATOMLEN-1</code> bytes are encoded. The name is to be <code class="code">NULL</code>-terminated, except for the <code class="code">ei_x_encode_atom_len()</code> function.</p>  </div></article><article class="func"><div><h4 id="ei_encode_atom_as" class="title-link" onmouseover="document.getElementById('ghlink-ei_encode_atom_as-idm871').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-ei_encode_atom_as-idm871').style.visibility = 'hidden';">  <div class="title-name">int ei_encode_atom_as(<br>char *buf,<br>int *index,<br>const char *p,<br>erlang_char_encoding from_enc,<br>erlang_char_encoding to_enc)</div> <div class="title-since"><span class="since">OTP R16B</span></div> </h4></div> <div><h4 id="ei_encode_atom_len_as" class="title-link" onmouseover="document.getElementById('ghlink-ei_encode_atom_len_as-idm874').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-ei_encode_atom_len_as-idm874').style.visibility = 'hidden';">  <div class="title-name">int ei_encode_atom_len_as(<br>char *buf,<br>int *index,<br>const char *p,<br>int len,<br>erlang_char_encoding from_enc,<br>erlang_char_encoding to_enc)</div> <div class="title-since"><span class="since">OTP R16B</span></div> </h4></div> <div><h4 id="ei_x_encode_atom_as" class="title-link" onmouseover="document.getElementById('ghlink-ei_x_encode_atom_as-idm877').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-ei_x_encode_atom_as-idm877').style.visibility = 'hidden';">  <div class="title-name">int ei_x_encode_atom_as(<br>ei_x_buff* x,<br>const char *p,<br>erlang_char_encoding from_enc,<br>erlang_char_encoding to_enc)</div> <div class="title-since"><span class="since">OTP R16B</span></div> </h4></div> <div><h4 id="ei_x_encode_atom_len_as" class="title-link" onmouseover="document.getElementById('ghlink-ei_x_encode_atom_len_as-idm880').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-ei_x_encode_atom_len_as-idm880').style.visibility = 'hidden';">  <div class="title-name">int ei_x_encode_atom_len_as(<br>ei_x_buff* x,<br>const char *p,<br>int len,<br>erlang_char_encoding from_enc,<br>erlang_char_encoding to_enc)</div> <div class="title-since"><span class="since">OTP R16B</span></div> </h4></div> <div class="exports-tube">  <h2 id="types" class="func-types-title">Types</h2>     <p>Encodes an atom in the binary format. Parameter <code class="code">p</code> is the name of the atom with character encoding <code><a href="#erlang_char_encoding"><span class="code">from_enc</span></a></code> (ASCII, Latin-1, or UTF-8). The name must either be <code class="code">NULL</code>-terminated or a function variant with a <code class="code">len</code> parameter must be used.</p> <p>The encoding fails if <code class="code">p</code> is not a valid string in encoding <code class="code">from_enc</code>.</p> <p>Argument <code class="code">to_enc</code> is ignored. As from Erlang/OTP 20 the encoding is always done in UTF-8 which is readable by nodes as old as Erlang/OTP R16.</p>  </div></article><article class="func"><div><h4 id="ei_encode_bignum" class="title-link" onmouseover="document.getElementById('ghlink-ei_encode_bignum-idm904').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-ei_encode_bignum-idm904').style.visibility = 'hidden';">  <div class="title-name">int ei_encode_bignum(<br>char *buf,<br>int *index,<br>mpz_t obj)</div> </h4></div> <div><h4 id="ei_x_encode_bignum" class="title-link" onmouseover="document.getElementById('ghlink-ei_x_encode_bignum-idm907').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-ei_x_encode_bignum-idm907').style.visibility = 'hidden';">  <div class="title-name">int ei_x_encode_bignum(<br>ei_x_buff *x,<br>mpz_t obj)</div> </h4></div> <div class="exports-tube">  <h2 id="types" class="func-types-title">Types</h2>    <p>Encodes a GMP <code class="code">mpz_t</code> integer to binary format. To use this function, the <code class="code">ei</code> library must be configured and compiled to use the GMP library.</p>  </div></article><article class="func"><div><h4 id="ei_encode_binary" class="title-link" onmouseover="document.getElementById('ghlink-ei_encode_binary-idm920').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-ei_encode_binary-idm920').style.visibility = 'hidden';">  <div class="title-name">int ei_encode_binary(<br>char *buf,<br>int *index,<br>const void *p,<br>long len)</div> </h4></div> <div><h4 id="ei_x_encode_binary" class="title-link" onmouseover="document.getElementById('ghlink-ei_x_encode_binary-idm923').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-ei_x_encode_binary-idm923').style.visibility = 'hidden';">  <div class="title-name">int ei_x_encode_binary(<br>ei_x_buff* x,<br>const void *p,<br>long len)</div> </h4></div> <div class="exports-tube">  <h2 id="types" class="func-types-title">Types</h2>    <p>Encodes a binary in the binary format. The data is at <code class="code">p</code>, of <code class="code">len</code> bytes length.</p>  </div></article><article class="func"><div><h4 id="ei_encode_bitstring" class="title-link" onmouseover="document.getElementById('ghlink-ei_encode_bitstring-idm936').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-ei_encode_bitstring-idm936').style.visibility = 'hidden';">  <div class="title-name">int ei_encode_bitstring(<br>char *buf,<br>int *index,<br>const char *p,<br>size_t bitoffs,<br>size_t nbits)</div> <div class="title-since"><span class="since">OTP 22.0</span></div> </h4></div> <div><h4 id="ei_x_encode_bitstring" class="title-link" onmouseover="document.getElementById('ghlink-ei_x_encode_bitstring-idm939').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-ei_x_encode_bitstring-idm939').style.visibility = 'hidden';">  <div class="title-name">int ei_x_encode_bitstring(<br>ei_x_buff* x,<br>const char *p,<br>size_t bitoffs,<br>size_t nbits)</div> <div class="title-since"><span class="since">OTP 22.0</span></div> </h4></div> <div class="exports-tube">  <h2 id="types" class="func-types-title">Types</h2>    <p>Encodes a bit string in the binary format.</p> <p>The data is at <code class="code">p</code>. The length of the bit string is <code class="code">nbits</code> bits. The first <code class="code">bitoffs</code> bits of the data at <code class="code">p</code> are unused. The first byte which is part of the bit string is <code class="code">p[bitoffs/8]</code>. The <code class="code">bitoffs%8</code> most significant bits of the first byte <code class="code">p[bitoffs/8]</code> are unused.</p> <p>The number of bytes which is part of the bit string is <code class="code">(bitoffs + nbits + 7)/8</code>. If <code class="code">(bitoffs + nbits)%8 &gt; 0</code> then only <code class="code">(bitoffs + nbits)%8</code> bits of the last byte are used. Unused bits in the last byte are the least significant bits.</p> <p>The values of unused bits are disregarded and does not need to be cleared.</p>  </div></article><article class="func"><div><h4 id="ei_encode_boolean" class="title-link" onmouseover="document.getElementById('ghlink-ei_encode_boolean-idm963').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-ei_encode_boolean-idm963').style.visibility = 'hidden';">  <div class="title-name">int ei_encode_boolean(<br>char *buf,<br>int *index,<br>int p)</div> </h4></div> <div><h4 id="ei_x_encode_boolean" class="title-link" onmouseover="document.getElementById('ghlink-ei_x_encode_boolean-idm966').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-ei_x_encode_boolean-idm966').style.visibility = 'hidden';">  <div class="title-name">int ei_x_encode_boolean(<br>ei_x_buff* x,<br>int p)</div> </h4></div> <div class="exports-tube">  <h2 id="types" class="func-types-title">Types</h2>    <p>Encodes a boolean value as the atom <code class="code">true</code> if <code class="code">p</code> is not zero, or <code class="code">false</code> if <code class="code">p</code> is zero.</p>  </div></article><article class="func"><div><h4 id="ei_encode_char" class="title-link" onmouseover="document.getElementById('ghlink-ei_encode_char-idm981').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-ei_encode_char-idm981').style.visibility = 'hidden';">  <div class="title-name">int ei_encode_char(<br>char *buf,<br>int *index,<br>char p)</div> </h4></div> <div><h4 id="ei_x_encode_char" class="title-link" onmouseover="document.getElementById('ghlink-ei_x_encode_char-idm984').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-ei_x_encode_char-idm984').style.visibility = 'hidden';">  <div class="title-name">int ei_x_encode_char(<br>ei_x_buff* x,<br>char p)</div> </h4></div> <div class="exports-tube">  <h2 id="types" class="func-types-title">Types</h2>    <p>Encodes a char (8-bit) as an integer between 0-255 in the binary format. For historical reasons the integer argument is of type <code class="code">char</code>. Your C code is to consider the specified argument to be of type <code class="code">unsigned char</code> even if the C compilers and system may define <code class="code">char</code> to be signed.</p>  </div></article><article class="func"><div><h4 id="ei_encode_double" class="title-link" onmouseover="document.getElementById('ghlink-ei_encode_double-idm998').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-ei_encode_double-idm998').style.visibility = 'hidden';">  <div class="title-name">int ei_encode_double(<br>char *buf,<br>int *index,<br>double p)</div> </h4></div> <div><h4 id="ei_x_encode_double" class="title-link" onmouseover="document.getElementById('ghlink-ei_x_encode_double-idm1001').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-ei_x_encode_double-idm1001').style.visibility = 'hidden';">  <div class="title-name">int ei_x_encode_double(<br>ei_x_buff* x,<br>double p)</div> </h4></div> <div class="exports-tube">  <h2 id="types" class="func-types-title">Types</h2>    <p>Encodes a double-precision (64-bit) floating point number in the binary format.</p> <p>Returns <code class="code">-1</code> if the floating point number is not finite.</p>  </div></article><article class="func"><div><h4 id="ei_encode_empty_list" class="title-link" onmouseover="document.getElementById('ghlink-ei_encode_empty_list-idm1014').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-ei_encode_empty_list-idm1014').style.visibility = 'hidden';">  <div class="title-name">int ei_encode_empty_list(<br>char* buf,<br>int* index)</div> </h4></div> <div><h4 id="ei_x_encode_empty_list" class="title-link" onmouseover="document.getElementById('ghlink-ei_x_encode_empty_list-idm1017').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-ei_x_encode_empty_list-idm1017').style.visibility = 'hidden';">  <div class="title-name">int ei_x_encode_empty_list(<br>ei_x_buff* x)</div> </h4></div> <div class="exports-tube">  <h2 id="types" class="func-types-title">Types</h2>    <p>Encodes an empty list. It is often used at the tail of a list.</p>  </div></article><article class="func"><div><h4 id="ei_encode_fun" class="title-link" onmouseover="document.getElementById('ghlink-ei_encode_fun-idm1029').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-ei_encode_fun-idm1029').style.visibility = 'hidden';">  <div class="title-name">int ei_encode_fun(<br>char *buf,<br>int *index,<br>const erlang_fun *p)</div> </h4></div> <div><h4 id="ei_x_encode_fun" class="title-link" onmouseover="document.getElementById('ghlink-ei_x_encode_fun-idm1032').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-ei_x_encode_fun-idm1032').style.visibility = 'hidden';">  <div class="title-name">int ei_x_encode_fun(<br>ei_x_buff* x,<br>const erlang_fun* fun)</div> </h4></div> <div class="exports-tube">  <h2 id="types" class="func-types-title">Types</h2>     <p>Encodes a fun in the binary format. Parameter <code class="code">p</code> points to an <code class="code">erlang_fun</code> structure. The <code class="code">erlang_fun</code> is not freed automatically, the <code class="code">free_fun</code> is to be called if the fun is not needed after encoding.</p>  </div></article><article class="func"><div><h4 id="ei_encode_list_header" class="title-link" onmouseover="document.getElementById('ghlink-ei_encode_list_header-idm1050').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-ei_encode_list_header-idm1050').style.visibility = 'hidden';">  <div class="title-name">int ei_encode_list_header(<br>char *buf,<br>int *index,<br>int arity)</div> </h4></div> <div><h4 id="ei_x_encode_list_header" class="title-link" onmouseover="document.getElementById('ghlink-ei_x_encode_list_header-idm1053').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-ei_x_encode_list_header-idm1053').style.visibility = 'hidden';">  <div class="title-name">int ei_x_encode_list_header(<br>ei_x_buff* x,<br>int arity)</div> </h4></div> <div class="exports-tube">  <h2 id="types" class="func-types-title">Types</h2>    <p>Encodes a list header, with a specified arity. The next <code class="code">arity+1</code> terms are the elements (actually its <code class="code">arity</code> cons cells) and the tail of the list. Lists and tuples are encoded recursively, so that a list can contain another list or tuple.</p> <p>For example, to encode the list <code class="code">[c, d, [e | f]]</code>:</p> <pre data-language="erlang">
ei_encode_list_header(buf, &amp;i, 3);
ei_encode_atom(buf, &amp;i, "c");
ei_encode_atom(buf, &amp;i, "d");
ei_encode_list_header(buf, &amp;i, 1);
ei_encode_atom(buf, &amp;i, "e");
ei_encode_atom(buf, &amp;i, "f");
ei_encode_empty_list(buf, &amp;i);</pre> <div class="note"> <div class="label">Note</div> <div class="content">

<p>It may seem that there is no way to create a list without knowing the number of elements in advance. But indeed there is a way. Notice that the list <code class="code">[a, b, c]</code> can be written as <code class="code">[a | [b | [c]]]</code>. Using this, a list can be written as conses.</p> </div> </div> <p>To encode a list, without knowing the arity in advance:</p> <pre data-language="erlang">
while (something()) {
    ei_x_encode_list_header(&amp;x, 1);
    ei_x_encode_ulong(&amp;x, i); /* just an example */
}
ei_x_encode_empty_list(&amp;x);</pre>  </div></article><article class="func"><div><h4 id="ei_encode_long" class="title-link" onmouseover="document.getElementById('ghlink-ei_encode_long-idm1075').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-ei_encode_long-idm1075').style.visibility = 'hidden';">  <div class="title-name">int ei_encode_long(<br>char *buf,<br>int *index,<br>long p)</div> </h4></div> <div><h4 id="ei_x_encode_long" class="title-link" onmouseover="document.getElementById('ghlink-ei_x_encode_long-idm1078').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-ei_x_encode_long-idm1078').style.visibility = 'hidden';">  <div class="title-name">int ei_x_encode_long(<br>ei_x_buff* x,<br>long p)</div> </h4></div> <div class="exports-tube">  <h2 id="types" class="func-types-title">Types</h2>    <p>Encodes a long integer in the binary format. If the code is 64 bits, the function <code class="code">ei_encode_long()</code> is the same as <code class="code">ei_encode_longlong()</code>.</p>  </div></article><article class="func"><div><h4 id="ei_encode_longlong" class="title-link" onmouseover="document.getElementById('ghlink-ei_encode_longlong-idm1091').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-ei_encode_longlong-idm1091').style.visibility = 'hidden';">  <div class="title-name">int ei_encode_longlong(<br>char *buf,<br>int *index,<br>long long p)</div> </h4></div> <div><h4 id="ei_x_encode_longlong" class="title-link" onmouseover="document.getElementById('ghlink-ei_x_encode_longlong-idm1094').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-ei_x_encode_longlong-idm1094').style.visibility = 'hidden';">  <div class="title-name">int ei_x_encode_longlong(<br>ei_x_buff* x,<br>long long p)</div> </h4></div> <div class="exports-tube">  <h2 id="types" class="func-types-title">Types</h2>    <p>Encodes a GCC <code class="code">long long</code> or Visual C++ <code class="code">__int64</code> (64-bit) integer in the binary format.</p>  </div></article><article class="func"><div><h4 id="ei_encode_map_header" class="title-link" onmouseover="document.getElementById('ghlink-ei_encode_map_header-idm1107').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-ei_encode_map_header-idm1107').style.visibility = 'hidden';">  <div class="title-name">int ei_encode_map_header(<br>char *buf,<br>int *index,<br>int arity)</div> <div class="title-since"><span class="since">OTP 17.0</span></div> </h4></div> <div><h4 id="ei_x_encode_map_header" class="title-link" onmouseover="document.getElementById('ghlink-ei_x_encode_map_header-idm1110').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-ei_x_encode_map_header-idm1110').style.visibility = 'hidden';">  <div class="title-name">int ei_x_encode_map_header(<br>ei_x_buff* x,<br>int arity)</div> <div class="title-since"><span class="since">OTP 17.0</span></div> </h4></div> <div class="exports-tube">  <h2 id="types" class="func-types-title">Types</h2>    <p>Encodes a map header, with a specified arity. The next <code class="code">arity*2</code> terms encoded will be the keys and values of the map encoded in the following order: <code class="code">K1, V1, K2, V2, ..., Kn, Vn</code>. </p> <p>For example, to encode the map <code class="code">#{a =&gt; "Apple", b =&gt; "Banana"}</code>:</p> <pre data-language="erlang">
ei_x_encode_map_header(&amp;x, 2);
ei_x_encode_atom(&amp;x, "a");
ei_x_encode_string(&amp;x, "Apple");
ei_x_encode_atom(&amp;x, "b");
ei_x_encode_string(&amp;x, "Banana");</pre> <p>A correctly encoded map cannot have duplicate keys.</p>  </div></article><article class="func"><div><h4 id="ei_encode_pid" class="title-link" onmouseover="document.getElementById('ghlink-ei_encode_pid-idm1127').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-ei_encode_pid-idm1127').style.visibility = 'hidden';">  <div class="title-name">int ei_encode_pid(<br>char *buf,<br>int *index,<br>const erlang_pid *p)</div> </h4></div> <div><h4 id="ei_x_encode_pid" class="title-link" onmouseover="document.getElementById('ghlink-ei_x_encode_pid-idm1130').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-ei_x_encode_pid-idm1130').style.visibility = 'hidden';">  <div class="title-name">int ei_x_encode_pid(<br>ei_x_buff* x,<br>const erlang_pid *p)</div> </h4></div> <div class="exports-tube">  <h2 id="types" class="func-types-title">Types</h2>     <p>Encodes an Erlang process identifier (pid) in the binary format. Parameter <code class="code">p</code> points to an <code class="code">erlang_pid</code> structure which should either have been obtained earlier with <code><a href="#ei_decode_pid"><span class="code">ei_decode_pid()</span></a></code>, <code><a href="ei_connect#ei_self"><span class="code">ei_self()</span></a></code> or created by <code><a href="ei_connect#ei_make_pid"><span class="code">ei_make_pid()</span></a></code>. </p>  </div></article><article class="func"><div><h4 id="ei_encode_port" class="title-link" onmouseover="document.getElementById('ghlink-ei_encode_port-idm1152').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-ei_encode_port-idm1152').style.visibility = 'hidden';">  <div class="title-name">int ei_encode_port(<br>char *buf,<br>int *index,<br>const erlang_port *p)</div> </h4></div> <div><h4 id="ei_x_encode_port" class="title-link" onmouseover="document.getElementById('ghlink-ei_x_encode_port-idm1155').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-ei_x_encode_port-idm1155').style.visibility = 'hidden';">  <div class="title-name">int ei_x_encode_port(<br>ei_x_buff* x,<br>const erlang_port *p)</div> </h4></div> <div class="exports-tube">  <h2 id="types" class="func-types-title">Types</h2>     <p>Encodes an Erlang port in the binary format. Parameter <code class="code">p</code> points to an <code class="code">erlang_port</code> structure which should have been obtained earlier with <code><a href="#ei_decode_port"><span class="code">ei_decode_port()</span></a></code>, </p>  </div></article><article class="func"><div><h4 id="ei_encode_ref" class="title-link" onmouseover="document.getElementById('ghlink-ei_encode_ref-idm1173').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-ei_encode_ref-idm1173').style.visibility = 'hidden';">  <div class="title-name">int ei_encode_ref(<br>char *buf,<br>int *index,<br>const erlang_ref *p)</div> </h4></div> <div><h4 id="ei_x_encode_ref" class="title-link" onmouseover="document.getElementById('ghlink-ei_x_encode_ref-idm1176').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-ei_x_encode_ref-idm1176').style.visibility = 'hidden';">  <div class="title-name">int ei_x_encode_ref(<br>ei_x_buff* x,<br>const erlang_ref *p)</div> </h4></div> <div class="exports-tube">  <h2 id="types" class="func-types-title">Types</h2>     <p>Encodes an Erlang reference in the binary format. Parameter <code class="code">p</code> points to an <code class="code">erlang_ref</code> structure which either should have been obtained earlier with <code><a href="#ei_decode_ref"><span class="code">ei_decode_ref()</span></a></code>, or created by <code><a href="ei_connect#ei_make_ref"><span class="code">ei_make_ref()</span></a></code>.</p>  </div></article><article class="func"><div><h4 id="ei_encode_string" class="title-link" onmouseover="document.getElementById('ghlink-ei_encode_string-idm1196').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-ei_encode_string-idm1196').style.visibility = 'hidden';">  <div class="title-name">int ei_encode_string(<br>char *buf,<br>int *index,<br>const char *p)</div> </h4></div> <div><h4 id="ei_encode_string_len" class="title-link" onmouseover="document.getElementById('ghlink-ei_encode_string_len-idm1199').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-ei_encode_string_len-idm1199').style.visibility = 'hidden';">  <div class="title-name">int ei_encode_string_len(<br>char *buf,<br>int *index,<br>const char *p,<br>int len)</div> </h4></div> <div><h4 id="ei_x_encode_string" class="title-link" onmouseover="document.getElementById('ghlink-ei_x_encode_string-idm1202').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-ei_x_encode_string-idm1202').style.visibility = 'hidden';">  <div class="title-name">int ei_x_encode_string(<br>ei_x_buff* x,<br>const char *p)</div> </h4></div> <div><h4 id="ei_x_encode_string_len" class="title-link" onmouseover="document.getElementById('ghlink-ei_x_encode_string_len-idm1205').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-ei_x_encode_string_len-idm1205').style.visibility = 'hidden';">  <div class="title-name">int ei_x_encode_string_len(<br>ei_x_buff* x,<br>const char* s,<br>int len)</div> </h4></div> <div class="exports-tube">  <h2 id="types" class="func-types-title">Types</h2>    <p>Encodes a string in the binary format. (A string in Erlang is a list, but is encoded as a character array in the binary format.) The string is to be <code class="code">NULL</code>-terminated, except for the <code class="code">ei_x_encode_string_len()</code> function.</p>  </div></article><article class="func"><div><h4 id="ei_encode_trace" class="title-link" onmouseover="document.getElementById('ghlink-ei_encode_trace-idm1218').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-ei_encode_trace-idm1218').style.visibility = 'hidden';">  <div class="title-name">int ei_encode_trace(<br>char *buf,<br>int *index,<br>const erlang_trace *p)</div> </h4></div> <div><h4 id="ei_x_encode_trace" class="title-link" onmouseover="document.getElementById('ghlink-ei_x_encode_trace-idm1221').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-ei_x_encode_trace-idm1221').style.visibility = 'hidden';">  <div class="title-name">int ei_x_encode_trace(<br>ei_x_buff* x,<br>const erlang_trace *p)</div> </h4></div> <div class="exports-tube">  <h2 id="types" class="func-types-title">Types</h2>     <p>Encodes an Erlang trace token in the binary format. Parameter <code class="code">p</code> points to a <code class="code">erlang_trace</code> structure which should have been obtained earlier with <code><a href="#ei_decode_trace"><span class="code">ei_decode_trace()</span></a></code>.</p>  </div></article><article class="func"><div><h4 id="ei_encode_tuple_header" class="title-link" onmouseover="document.getElementById('ghlink-ei_encode_tuple_header-idm1239').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-ei_encode_tuple_header-idm1239').style.visibility = 'hidden';">  <div class="title-name">int ei_encode_tuple_header(<br>char *buf,<br>int *index,<br>int arity)</div> </h4></div> <div><h4 id="ei_x_encode_tuple_header" class="title-link" onmouseover="document.getElementById('ghlink-ei_x_encode_tuple_header-idm1242').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-ei_x_encode_tuple_header-idm1242').style.visibility = 'hidden';">  <div class="title-name">int ei_x_encode_tuple_header(<br>ei_x_buff* x,<br>int arity)</div> </h4></div> <div class="exports-tube">  <h2 id="types" class="func-types-title">Types</h2>    <p>Encodes a tuple header, with a specified arity. The next <code class="code">arity</code> terms encoded will be the elements of the tuple. Tuples and lists are encoded recursively, so that a tuple can contain another tuple or list.</p> <p>For example, to encode the tuple <code class="code">{a, {b, {}}}</code>:</p> <pre data-language="erlang">
ei_encode_tuple_header(buf, &amp;i, 2);
ei_encode_atom(buf, &amp;i, "a");
ei_encode_tuple_header(buf, &amp;i, 2);
ei_encode_atom(buf, &amp;i, "b");
ei_encode_tuple_header(buf, &amp;i, 0);</pre>  </div></article><article class="func"><div><h4 id="ei_encode_ulong" class="title-link" onmouseover="document.getElementById('ghlink-ei_encode_ulong-idm1257').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-ei_encode_ulong-idm1257').style.visibility = 'hidden';">  <div class="title-name">int ei_encode_ulong(<br>char *buf,<br>int *index,<br>unsigned long p)</div> </h4></div> <div><h4 id="ei_x_encode_ulong" class="title-link" onmouseover="document.getElementById('ghlink-ei_x_encode_ulong-idm1260').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-ei_x_encode_ulong-idm1260').style.visibility = 'hidden';">  <div class="title-name">int ei_x_encode_ulong(<br>ei_x_buff* x,<br>unsigned long p)</div> </h4></div> <div class="exports-tube">  <h2 id="types" class="func-types-title">Types</h2>    <p>Encodes an unsigned long integer in the binary format. If the code is 64 bits, the function <code class="code">ei_encode_ulong()</code> is the same as <code class="code">ei_encode_ulonglong()</code>.</p>  </div></article><article class="func"><div><h4 id="ei_encode_ulonglong" class="title-link" onmouseover="document.getElementById('ghlink-ei_encode_ulonglong-idm1273').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-ei_encode_ulonglong-idm1273').style.visibility = 'hidden';">  <div class="title-name">int ei_encode_ulonglong(<br>char *buf,<br>int *index,<br>unsigned long long p)</div> </h4></div> <div><h4 id="ei_x_encode_ulonglong" class="title-link" onmouseover="document.getElementById('ghlink-ei_x_encode_ulonglong-idm1276').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-ei_x_encode_ulonglong-idm1276').style.visibility = 'hidden';">  <div class="title-name">int ei_x_encode_ulonglong(<br>ei_x_buff* x,<br>unsigned long long p)</div> </h4></div> <div class="exports-tube">  <h2 id="types" class="func-types-title">Types</h2>    <p>Encodes a GCC <code class="code">unsigned long long</code> or Visual C++ <code class="code">unsigned __int64</code> (64-bit) integer in the binary format.</p>  </div></article><article class="func"><div><h4 id="ei_encode_version" class="title-link" onmouseover="document.getElementById('ghlink-ei_encode_version-idm1289').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-ei_encode_version-idm1289').style.visibility = 'hidden';">  <div class="title-name">int ei_encode_version(<br>char *buf,<br>int *index)</div> </h4></div> <div><h4 id="ei_x_encode_version" class="title-link" onmouseover="document.getElementById('ghlink-ei_x_encode_version-idm1292').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-ei_x_encode_version-idm1292').style.visibility = 'hidden';">  <div class="title-name">int ei_x_encode_version(<br>ei_x_buff* x)</div> </h4></div> <div class="exports-tube">  <h2 id="types" class="func-types-title">Types</h2>    <p>Encodes a version magic number for the binary format. Must be the first token in a binary term.</p>  </div></article><article class="func"><div><h4 id="ei_get_type" class="title-link" onmouseover="document.getElementById('ghlink-ei_get_type-idm1303').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-ei_get_type-idm1303').style.visibility = 'hidden';">  <div class="title-name">int ei_get_type(<br>const char *buf,<br>const int *index,<br>int *type,<br>int *size)</div> </h4></div> <div class="exports-tube"> <p>Returns the type in <code class="code">*type</code> and size in <code class="code">*size</code> of the encoded term. For strings and atoms, size is the number of characters <strong>not</strong> including the terminating <code class="code">NULL</code>. For binaries and bitstrings, <code class="code">*size</code> is the number of bytes. For lists, tuples and maps, <code class="code">*size</code> is the arity of the object. For bignum integers, <code class="code">*size</code> is the number of bytes for the absolute value of the bignum. For other types, <code class="code">*size</code> is 0. In all cases, <code class="code">index</code> is left unchanged.</p> <p>Currently <code class="code">*type</code> is one of:</p> <dl> <dt><strong>ERL_ATOM_EXT</strong></dt> <dd><p> Decode using either <code><a href="#ei_decode_atom"><span class="code">ei_decode_atom()</span></a></code>, <code><a href="#ei_decode_atom_as"><span class="code">ei_decode_atom_as()</span></a></code>, or <code><a href="#ei_decode_boolean"><span class="code">ei_decode_boolean()</span></a></code>. </p></dd> <dt><strong>ERL_BINARY_EXT</strong></dt> <dd><p> Decode using either <code><a href="#ei_decode_binary"><span class="code">ei_decode_binary()</span></a></code>, <code><a href="#ei_decode_bitstring"><span class="code">ei_decode_bitstring()</span></a></code>, or <code><a href="#ei_decode_iodata"><span class="code">ei_decode_iodata()</span></a></code>. </p></dd> <dt><strong>ERL_BIT_BINARY_EXT</strong></dt> <dd><p> Decode using <code><a href="#ei_decode_bitstring"><span class="code">ei_decode_bitstring()</span></a></code>. </p></dd> <dt><strong>ERL_FLOAT_EXT</strong></dt> <dd><p> Decode using <code><a href="#ei_decode_double"><span class="code">ei_decode_double()</span></a></code>. </p></dd> <dt><strong>ERL_NEW_FUN_EXT<br>ERL_FUN_EXT<br>ERL_EXPORT_EXT</strong></dt> <dd><p> Decode using <code><a href="#ei_decode_fun"><span class="code">ei_decode_fun()</span></a></code>. </p></dd> <dt><strong>ERL_SMALL_INTEGER_EXT<br>ERL_INTEGER_EXT<br>ERL_SMALL_BIG_EXT<br>ERL_LARGE_BIG_EXT</strong></dt> <dd><p> Decode using either <code><a href="#ei_decode_char"><span class="code">ei_decode_char()</span></a></code>, <code><a href="#ei_decode_long"><span class="code">ei_decode_long()</span></a></code>, <code><a href="#ei_decode_longlong"><span class="code">ei_decode_longlong()</span></a></code>, <code><a href="#ei_decode_ulong"><span class="code">ei_decode_ulong()</span></a></code>, <code><a href="#ei_decode_ulonglong"><span class="code">ei_decode_ulonglong()</span></a></code>, or <code><a href="#ei_decode_bignum"><span class="code">ei_decode_bignum()</span></a></code>. </p></dd> <dt><strong>ERL_LIST_EXT<br>ERL_NIL_EXT</strong></dt> <dd><p> Decode using either <code><a href="#ei_decode_list_header"><span class="code">ei_decode_list_header()</span></a></code>, or <code><a href="#ei_decode_iodata"><span class="code">ei_decode_iodata()</span></a></code>. </p></dd> <dt><strong>ERL_STRING_EXT</strong></dt> <dd><p> Decode using either <code><a href="#ei_decode_string"><span class="code">ei_decode_string()</span></a></code>, or <code><a href="#ei_decode_iodata"><span class="code">ei_decode_iodata()</span></a></code>. </p></dd> <dt><strong>ERL_MAP_EXT</strong></dt> <dd><p> Decode using <code><a href="#ei_decode_map_header"><span class="code">ei_decode_map_header()</span></a></code>. </p></dd> <dt><strong>ERL_PID_EXT</strong></dt> <dd><p> Decode using <code><a href="#ei_decode_pid"><span class="code">ei_decode_pid()</span></a></code>. </p></dd> <dt><strong>ERL_PORT_EXT</strong></dt> <dd><p> Decode using <code><a href="#ei_decode_port"><span class="code">ei_decode_port()</span></a></code>. </p></dd> <dt><strong>ERL_NEW_REFERENCE_EXT</strong></dt> <dd><p> Decode using <code><a href="#ei_decode_ref"><span class="code">ei_decode_ref()</span></a></code>. </p></dd> <dt><strong>ERL_SMALL_TUPLE_EXT<br>ERL_LARGE_TUPLE_EXT</strong></dt> <dd><p> Decode using <code><a href="#ei_decode_tuple_header"><span class="code">ei_decode_tuple_header()</span></a></code>. </p></dd> </dl> <p>Instead of decoding a term you can also skipped past it if you are not interested in the data by usage of <code><a href="#ei_skip_term"><span class="code">ei_skip_term()</span></a></code>.</p> </div></article><article class="func"><div><h4 id="ei_init" class="title-link" onmouseover="document.getElementById('ghlink-ei_init-idm1419').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-ei_init-idm1419').style.visibility = 'hidden';">  <div class="title-name">int ei_init(void)</div> <div class="title-since"><span class="since">OTP 21.3</span></div> </h4></div> <div class="exports-tube"> <p>Initialize the <code class="code">ei</code> library. This function should be called once (and only once) before calling any other functionality in the <code class="code">ei</code> library.</p> <p>On success zero is returned. On failure a posix error code is returned.</p> </div></article><article class="func"><div><h4 id="ei_print_term" class="title-link" onmouseover="document.getElementById('ghlink-ei_print_term-idm1429').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-ei_print_term-idm1429').style.visibility = 'hidden';">  <div class="title-name">int ei_print_term(<br>FILE* fp,<br>const char* buf,<br>int* index)</div> </h4></div> <div><h4 id="ei_s_print_term" class="title-link" onmouseover="document.getElementById('ghlink-ei_s_print_term-idm1432').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-ei_s_print_term-idm1432').style.visibility = 'hidden';">  <div class="title-name">int ei_s_print_term(<br>char** s,<br>const char* buf,<br>int* index)</div> </h4></div> <div class="exports-tube"> <p>Prints a term, in clear text, to the file specified by <code class="code">fp</code>, or the buffer pointed to by <code class="code">s</code>. It tries to resemble the term printing in the Erlang shell.</p> <p>In <code class="code">ei_s_print_term()</code>, parameter <code class="code">s</code> is to point to a dynamically (malloc) allocated string of <code class="code">BUFSIZ</code> bytes or a <code class="code">NULL</code> pointer. The string can be reallocated (and <code class="code">*s</code> can be updated) by this function if the result is more than <code class="code">BUFSIZ</code> characters. The string returned is <code class="code">NULL</code>-terminated.</p> <p>The return value is the number of characters written to the file or string, or <code class="code">-1</code> if <code class="code">buf[index]</code> does not contain a valid term. Unfortunately, I/O errors on <code class="code">fp</code> is not checked.</p> <p>Argument <code class="code">index</code> is updated, that is, this function can be viewed as a decode function that decodes a term into a human-readable format.</p> </div></article><article class="func"><div><h4 id="ei_set_compat_rel" class="title-link" onmouseover="document.getElementById('ghlink-ei_set_compat_rel-idm1455').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-ei_set_compat_rel-idm1455').style.visibility = 'hidden';">  <div class="title-name">void ei_set_compat_rel(<br>unsigned release_number)</div> </h4></div> <div class="exports-tube">  <p id="ei_set_compat_rel">In general, the <code class="code">ei</code> library is guaranteed to be compatible with other Erlang/OTP components that are 2 major releases older or newer than the <code class="code">ei</code> library itself.</p> <p>Sometimes an exception to the above rule has to be made to make new features (or even bug fixes) possible. A call to <code class="code">ei_set_compat_rel(release_number)</code> sets the <code class="code">ei</code> library in compatibility mode of OTP release <code class="code">release_number</code>.</p> <p>The only useful value for <code class="code">release_number</code> is currently <code class="code">21</code>. This will only be useful and have an effect if <strong>bit strings</strong> or <strong>export funs</strong> are received from a connected node. Before OTP 22, bit strings and export funs were not supported by <code class="code">ei</code>. They were instead encoded using an undocumented fallback tuple format when sent from the emulator to <code class="code">ei</code>:</p> <dl> <dt><strong><code class="code">Bit string</code></strong></dt> <dd> <p>The term <code class="code">&lt;&lt;42, 1:1&gt;&gt;</code> was encoded as <code class="code">{&lt;&lt;42, 128&gt;&gt;, 1}</code>. The first element of the tuple is a binary and the second element denotes how many bits of the last bytes are part of the bit string. In this example only the most significant bit of the last byte (128) is part of the bit string.</p> </dd> <dt><strong><code class="code">Export fun</code></strong></dt> <dd> <p>The term <code class="code">fun lists:map/2</code> was encoded as <code class="code">{lists,map}</code>. A tuple with the module, function and a missing arity.</p> </dd> </dl> <p>If <code class="code">ei_set_compat_rel(21)</code> is <strong>not</strong> called then a connected emulator will send bit strings and export funs correctly encoded. The functions <code><a href="#ei_decode_bitstring"><span class="code">ei_decode_bitstring</span></a></code> and <code><a href="#ei_decode_fun"><span class="code">ei_decode_fun</span></a></code> has to be used to decode such terms. Calling <code class="code">ei_set_compat_rel(21)</code> should only be done as a workaround to keep an old implementation alive, which expects to receive the undocumented tuple formats for bit strings and/or export funs. </p> <div class="note"> <div class="label">Note</div> <div class="content">

<p>If this function is called, it can only be called once and must be called before any other functions in the <code class="code">ei</code> library are called.</p> </div> </div> </div></article><article class="func"><div><h4 id="ei_skip_term" class="title-link" onmouseover="document.getElementById('ghlink-ei_skip_term-idm1500').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-ei_skip_term-idm1500').style.visibility = 'hidden';">  <div class="title-name">int ei_skip_term(<br>const char* buf,<br>int* index)</div> </h4></div> <div class="exports-tube"> <p>Skips a term in the specified buffer; recursively skips elements of lists and tuples, so that a full term is skipped. This is a way to get the size of an Erlang term.</p> <p><code class="code">buf</code> is the buffer.</p> <p><code class="code">index</code> is updated to point right after the term in the buffer.</p> <div class="note"> <div class="label">Note</div> <div class="content">

<p>This can be useful when you want to hold arbitrary terms: skip them and copy the binary term data to some buffer.</p> </div> </div> <p>Returns <code class="code">0</code> on success, otherwise <code class="code">-1</code>.</p> </div></article><article class="func"><div><h4 id="ei_x_append" class="title-link" onmouseover="document.getElementById('ghlink-ei_x_append-idm1516').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-ei_x_append-idm1516').style.visibility = 'hidden';">  <div class="title-name">int ei_x_append(<br>ei_x_buff* x,<br>const ei_x_buff* x2)</div> </h4></div> <div><h4 id="ei_x_append_buf" class="title-link" onmouseover="document.getElementById('ghlink-ei_x_append_buf-idm1519').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-ei_x_append_buf-idm1519').style.visibility = 'hidden';">  <div class="title-name">int ei_x_append_buf(<br>ei_x_buff* x,<br>const char* buf,<br>int len)</div> </h4></div> <div class="exports-tube">  <h2 id="types" class="func-types-title">Types</h2>    <p>Appends data at the end of buffer <code class="code">x</code>.</p>  </div></article><article class="func"><div><h4 id="ei_x_format" class="title-link" onmouseover="document.getElementById('ghlink-ei_x_format-idm1531').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-ei_x_format-idm1531').style.visibility = 'hidden';">  <div class="title-name">int ei_x_format(<br>ei_x_buff* x,<br>const char* fmt,<br>...)</div> </h4></div> <div><h4 id="ei_x_format_wo_ver" class="title-link" onmouseover="document.getElementById('ghlink-ei_x_format_wo_ver-idm1534').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-ei_x_format_wo_ver-idm1534').style.visibility = 'hidden';">  <div class="title-name">int ei_x_format_wo_ver(<br>ei_x_buff* x,<br>const char *fmt,<br>... )</div> </h4></div> <div class="exports-tube">  <h2 id="types" class="func-types-title">Types</h2>     <p>Formats a term, given as a string, to a buffer. Works like a sprintf for Erlang terms. <code class="code">fmt</code> contains a format string, with arguments like <code class="code">~d</code>, to insert terms from variables. The following formats are supported (with the C types given):</p> <pre data-language="erlang">
~a  An atom, char*
~c  A character, char
~s  A string, char*
~i  An integer, int
~l  A long integer, long int
~u  A unsigned long integer, unsigned long int
~f  A float, float
~d  A double float, double float
~p  An Erlang pid, erlang_pid*</pre> <p>For example, to encode a tuple with some stuff:</p> <pre data-language="erlang">
ei_x_format("{~a,~i,~d}", "numbers", 12, 3.14159)
encodes the tuple {numbers,12,3.14159}</pre> <p><code class="code">ei_x_format_wo_ver()</code> formats into a buffer, without the initial version byte.</p>  </div></article><article class="func"><div><h4 id="ei_x_free" class="title-link" onmouseover="document.getElementById('ghlink-ei_x_free-idm1555').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-ei_x_free-idm1555').style.visibility = 'hidden';">  <div class="title-name">int ei_x_free(<br>ei_x_buff* x)</div> </h4></div> <div class="exports-tube">  <h2 id="types" class="func-types-title">Types</h2>    <p>Deallocates the dynamically allocated content of the buffer referred by <code class="code">x</code>. After deallocation, the <code class="code">buff</code> field is set to <code class="code">NULL</code>.</p>  </div></article><article class="func"><div><h4 id="ei_x_new" class="title-link" onmouseover="document.getElementById('ghlink-ei_x_new-idm1569').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-ei_x_new-idm1569').style.visibility = 'hidden';">  <div class="title-name">int ei_x_new(<br>ei_x_buff* x)</div> </h4></div> <div><h4 id="ei_x_new_with_version" class="title-link" onmouseover="document.getElementById('ghlink-ei_x_new_with_version-idm1572').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-ei_x_new_with_version-idm1572').style.visibility = 'hidden';">  <div class="title-name">int ei_x_new_with_version(<br>ei_x_buff* x)</div> </h4></div> <div class="exports-tube">  <h2 id="types" class="func-types-title">Types</h2>    <p>Initialize the dynamically realizable buffer referred to by <code class="code">x</code>. The fields of the structure pointed to by parameter <code class="code">x</code> is filled in, and a default buffer is allocated. <code class="code">ei_x_new_with_version()</code> also puts an initial version byte, which is used in the binary format (so that <code class="code">ei_x_encode_version()</code> will not be needed.)</p>  </div></article> </div> <section class="innertube"><h2 id="debug-information" class="title-link" onmouseover="document.getElementById('ghlink-debug-information-idm1586').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-debug-information-idm1586').style.visibility = 'hidden';"> <div class="title-name">Debug Information</div>  </h2>  <p>Some tips on what to check when the emulator does not seem to receive the terms that you send:</p> <ul> <li>Be careful with the version header, use <code class="code">ei_x_new_with_version()</code> when appropriate.</li> <li>Turn on distribution tracing on the Erlang node.</li> <li>Check the result codes from <code class="code">ei_decode_-calls</code>.</li> </ul> </section> <div class="footer"> <hr> <p>Copyright © 1998-2022 Ericsson AB. All Rights Reserved.</p> </div><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2010&ndash;2022 Ericsson AB<br>Licensed under the Apache License, Version 2.0.<br>
    
  </p>
</div>
