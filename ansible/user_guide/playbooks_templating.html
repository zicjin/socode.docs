<h1 id="playbooks-templating">Templating (Jinja2)</h1> <p id="templating-jinja2">Ansible uses Jinja2 templating to enable dynamic expressions and access to <a class="reference internal" href="playbooks_variables#playbooks-variables"><span class="std std-ref">variables</span></a> and <a class="reference internal" href="playbooks_vars_facts#vars-and-facts"><span class="std std-ref">facts</span></a>. You can use templating with the <a class="reference internal" href="../collections/ansible/builtin/template_module#template-module"><span class="std std-ref">template module</span></a>. For example, you can create a template for a configuration file, then deploy that configuration file to multiple environments and supply the correct data (IP address, hostname, version) for each environment. You can also use templating in playbooks directly, by templating task names and more. You can use all the <a class="reference external" href="https://jinja.palletsprojects.com/en/3.0.x/templates/#builtin-filters" title="(in Jinja v3.0.x)"><span class="xref std std-ref">standard filters and tests</span></a> included in Jinja2. Ansible includes additional specialized filters for selecting and transforming data, tests for evaluating template expressions, and <a class="reference internal" href="../plugins/lookup#lookup-plugins"><span class="std std-ref">Lookup plugins</span></a> for retrieving data from external sources such as files, APIs, and databases for use in templating.</p> <p>All templating happens on the Ansible controller <strong>before</strong> the task is sent and executed on the target machine. This approach minimizes the package requirements on the target (jinja2 is only required on the controller). It also limits the amount of data Ansible passes to the target machine. Ansible parses templates on the controller and passes only the information needed for each task to the target machine, instead of passing all the data on the controller and parsing it on the target.</p> <div class="admonition note"> <p class="admonition-title">Note</p> <p>Files and data used by the <a class="reference internal" href="../collections/ansible/builtin/template_module#template-module"><span class="std std-ref">template module</span></a> must be utf-8 encoded.</p> </div>     <ul> <li class="toctree-l1">
<a class="reference internal" href="playbooks_filters">Using filters to manipulate data</a><ul> <li class="toctree-l2"><a class="reference internal" href="playbooks_filters#handling-undefined-variables">Handling undefined variables</a></li> <li class="toctree-l2"><a class="reference internal" href="playbooks_filters#defining-different-values-for-true-false-null-ternary">Defining different values for true/false/null (ternary)</a></li> <li class="toctree-l2"><a class="reference internal" href="playbooks_filters#managing-data-types">Managing data types</a></li> <li class="toctree-l2"><a class="reference internal" href="playbooks_filters#formatting-data-yaml-and-json">Formatting data: YAML and JSON</a></li> <li class="toctree-l2"><a class="reference internal" href="playbooks_filters#combining-and-selecting-data">Combining and selecting data</a></li> <li class="toctree-l2"><a class="reference internal" href="playbooks_filters#randomizing-data">Randomizing data</a></li> <li class="toctree-l2"><a class="reference internal" href="playbooks_filters#managing-list-variables">Managing list variables</a></li> <li class="toctree-l2"><a class="reference internal" href="playbooks_filters#selecting-from-sets-or-lists-set-theory">Selecting from sets or lists (set theory)</a></li> <li class="toctree-l2"><a class="reference internal" href="playbooks_filters#calculating-numbers-math">Calculating numbers (math)</a></li> <li class="toctree-l2"><a class="reference internal" href="playbooks_filters#managing-network-interactions">Managing network interactions</a></li> <li class="toctree-l2"><a class="reference internal" href="playbooks_filters#hashing-and-encrypting-strings-and-passwords">Hashing and encrypting strings and passwords</a></li> <li class="toctree-l2"><a class="reference internal" href="playbooks_filters#manipulating-text">Manipulating text</a></li> <li class="toctree-l2"><a class="reference internal" href="playbooks_filters#manipulating-strings">Manipulating strings</a></li> <li class="toctree-l2"><a class="reference internal" href="playbooks_filters#managing-uuids">Managing UUIDs</a></li> <li class="toctree-l2"><a class="reference internal" href="playbooks_filters#handling-dates-and-times">Handling dates and times</a></li> <li class="toctree-l2"><a class="reference internal" href="playbooks_filters#getting-kubernetes-resource-names">Getting Kubernetes resource names</a></li> </ul> </li> <li class="toctree-l1">
<a class="reference internal" href="playbooks_tests">Tests</a><ul> <li class="toctree-l2"><a class="reference internal" href="playbooks_tests#test-syntax">Test syntax</a></li> <li class="toctree-l2"><a class="reference internal" href="playbooks_tests#testing-strings">Testing strings</a></li> <li class="toctree-l2"><a class="reference internal" href="playbooks_tests#vault">Vault</a></li> <li class="toctree-l2"><a class="reference internal" href="playbooks_tests#testing-truthiness">Testing truthiness</a></li> <li class="toctree-l2"><a class="reference internal" href="playbooks_tests#comparing-versions">Comparing versions</a></li> <li class="toctree-l2"><a class="reference internal" href="playbooks_tests#set-theory-tests">Set theory tests</a></li> <li class="toctree-l2"><a class="reference internal" href="playbooks_tests#testing-if-a-list-contains-a-value">Testing if a list contains a value</a></li> <li class="toctree-l2"><a class="reference internal" href="playbooks_tests#testing-if-a-list-value-is-true">Testing if a list value is True</a></li> <li class="toctree-l2"><a class="reference internal" href="playbooks_tests#testing-paths">Testing paths</a></li> <li class="toctree-l2"><a class="reference internal" href="playbooks_tests#testing-size-formats">Testing size formats</a></li> <li class="toctree-l2"><a class="reference internal" href="playbooks_tests#testing-task-results">Testing task results</a></li> </ul> </li> <li class="toctree-l1">
<a class="reference internal" href="playbooks_lookups">Lookups</a><ul> <li class="toctree-l2"><a class="reference internal" href="playbooks_lookups#using-lookups-in-variables">Using lookups in variables</a></li> </ul> </li> <li class="toctree-l1">
<a class="reference internal" href="playbooks_python_version">Python3 in templates</a><ul> <li class="toctree-l2"><a class="reference internal" href="playbooks_python_version#dictionary-views">Dictionary views</a></li> <li class="toctree-l2"><a class="reference internal" href="playbooks_python_version#dict-iteritems">dict.iteritems()</a></li> </ul> </li> </ul>   <h2 id="templating-now">Get the current time</h2> <div class="versionadded" id="get-the-current-time"> <p><span class="versionmodified added">New in version 2.8.</span></p> </div> <p>The <code>now()</code> Jinja2 function retrieves a Python datetime object or a string representation for the current time.</p> <p>The <code>now()</code> function supports 2 arguments:</p> <dl class="simple"> <dt>utc</dt>
<dd>
<p>Specify <code>True</code> to get the current time in UTC. Defaults to <code>False</code>.</p> </dd> <dt>fmt</dt>
<dd>
<p>Accepts a <a class="reference external" href="https://docs.python.org/3/library/datetime.html#strftime-strptime-behavior">strftime</a> string that returns a formatted date time string.</p> </dd> </dl> <div class="admonition seealso"> <p class="admonition-title">See also</p> <dl class="simple"> <dt><a class="reference internal" href="playbooks_intro#playbooks-intro"><span class="std std-ref">Intro to playbooks</span></a></dt>
<dd>
<p>An introduction to playbooks</p> </dd> <dt><a class="reference internal" href="playbooks_conditionals#playbooks-conditionals"><span class="std std-ref">Conditionals</span></a></dt>
<dd>
<p>Conditional statements in playbooks</p> </dd> <dt><a class="reference internal" href="playbooks_loops#playbooks-loops"><span class="std std-ref">Loops</span></a></dt>
<dd>
<p>Looping in playbooks</p> </dd> <dt><a class="reference internal" href="playbooks_reuse_roles#playbooks-reuse-roles"><span class="std std-ref">Roles</span></a></dt>
<dd>
<p>Playbook organization by roles</p> </dd> <dt><a class="reference internal" href="playbooks_best_practices#playbooks-best-practices"><span class="std std-ref">Tips and tricks</span></a></dt>
<dd>
<p>Tips and tricks for playbooks</p> </dd> <dt><a class="reference external" href="https://jinja.palletsprojects.com/en/master/templates/">Jinja2 Docs</a></dt>
<dd>
<p>Jinja2 documentation, includes the syntax and semantics of the templates</p> </dd> <dt><a class="reference external" href="https://groups.google.com/group/ansible-devel">User Mailing List</a></dt>
<dd>
<p>Have a question? Stop by the google group!</p> </dd> <dt><a class="reference internal" href="https://docs.ansible.com/ansible/latest/community/communication.html#communication-irc"><span class="std std-ref">Real-time chat</span></a></dt>
<dd>
<p>How to join Ansible chat channels</p> </dd> </dl> </div><div class="_attribution">
  <p class="_attribution-p">
    <a href="https://docs.ansible.com/ansible/latest/user_guide/playbooks_templating.html" class="_attribution-link" target="_blank">https://docs.ansible.com/ansible/latest/user_guide/playbooks_templating.html</a>
  </p>
</div>
