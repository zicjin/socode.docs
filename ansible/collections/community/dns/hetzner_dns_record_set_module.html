<h1 id="community-dns-hetzner-dns-record-set-add-or-delete-record-sets-in-hetzner-dns-service">community.dns.hetzner_dns_record_set – Add or delete record sets in Hetzner DNS service</h1> <div class="admonition note"> <p class="admonition-title">Note</p> <p>This plugin is part of the <a class="reference external" href="https://galaxy.ansible.com/community/dns">community.dns collection</a> (version 2.0.3).</p> <p>You might already have this collection installed if you are using the <code>ansible</code> package. It is not included in <code>ansible-core</code>. To check whether it is installed, run <code>ansible-galaxy collection list</code>.</p> <p>To install it, use: <code>ansible-galaxy collection install community.dns</code>.</p> <p>To use it in a playbook, specify: <code>community.dns.hetzner_dns_record_set</code>.</p> </div> <div class="versionadded"> <p><span class="versionmodified added">New in version 2.0.0: </span>of community.dns</p> </div>  <ul class="simple"> <li><a class="reference internal" href="#synopsis" id="id1">Synopsis</a></li> <li><a class="reference internal" href="#parameters" id="id2">Parameters</a></li> <li><a class="reference internal" href="#notes" id="id3">Notes</a></li> <li><a class="reference internal" href="#examples" id="id4">Examples</a></li> <li><a class="reference internal" href="#return-values" id="id5">Return Values</a></li> </ul>   <h2 id="synopsis">Synopsis</h2> <ul class="simple"> <li>Creates and deletes DNS record sets in Hetzner DNS service.</li> </ul>   <h2 id="parameters">Parameters</h2> <table class="documentation-table"> <tr> <th colspan="1">Parameter</th> <th>Choices/Defaults</th> <th width="100%">Comments</th> </tr> <tr> <td colspan="1">  <b>bulk_operation_threshold</b>  <div> <span>integer</span> </div> </td> <td> <b>Default:</b><br><div>2</div> </td> <td> <div>Determines the threshold from when on bulk operations are used.</div> <div>The default value 2 means that if 2 or more operations of a kind are planned, and the API supports bulk operations for this kind of operation, they will be used.</div> </td> </tr> <tr> <td colspan="1">  <b>hetzner_token</b>  <div> <span>string</span> / <span>required</span> </div> </td> <td> </td> <td> <div>The token for the Hetzner API.</div> <div>If not provided, will be read from the environment variable <code>HETZNER_DNS_TOKEN</code>.</div> <div>
<br>aliases: api_token</div> </td> </tr> <tr> <td colspan="1">  <b>on_existing</b>  <div> <span>string</span> </div> </td> <td> <ul>
<b>Choices:</b> <li><div>
<b>replace</b> ←</div></li> <li>keep_and_fail</li> <li>keep_and_warn</li> <li>keep</li> </ul> </td> <td> <div>This option defines the behavior if the record set already exists, but differs from the specified record set. For this comparison, <em>value</em> and <em>ttl</em> are used for all records of type <em>type</em> matching the <em>prefix</em> resp. <em>record</em>.</div> <div>If set to <code>replace</code>, the record will be updated (<em>state=present</em>) or removed (<em>state=absent</em>). This is the old <em>overwrite=true</em> behavior.</div> <div>If set to <code>keep_and_fail</code>, the module will fail and not modify the records. This is the old <em>overwrite=false</em> behavior if <em>state=present</em>.</div> <div>If set to <code>keep_and_warn</code>, the module will warn and not modify the records.</div> <div>If set to <code>keep</code>, the module will not modify the records. This is the old <em>overwrite=false</em> behavior if <em>state=absent</em>.</div> <div>If <em>state=absent</em> and the value is not <code>replace</code>, <em>value</em> must be specified.</div> </td> </tr> <tr> <td colspan="1">  <b>prefix</b>  <div> <span>string</span> </div> <div> added in 0.2.0 of community.dns </div> </td> <td> </td> <td> <div>The prefix of the DNS record.</div> <div>This is the part of <em>record</em> before <em>zone_name</em>. For example, if the record to be modified is <code>www.example.com</code> for the zone <code>example.com</code>, the prefix is <code>www</code>. If the record in this example would be <code>example.com</code>, the prefix would be <code>''</code> (empty string).</div> <div>Exactly one of <em>record</em> and <em>prefix</em> must be specified.</div> <div>
<br>aliases: name</div> </td> </tr> <tr> <td colspan="1">  <b>record</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>The full DNS record to create or delete.</div> <div>Exactly one of <em>record</em> and <em>prefix</em> must be specified.</div> </td> </tr> <tr> <td colspan="1">  <b>state</b>  <div> <span>string</span> / <span>required</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>present</li> <li>absent</li> </ul> </td> <td> <div>Specifies the state of the resource record.</div> </td> </tr> <tr> <td colspan="1">  <b>ttl</b>  <div> <span>integer</span> </div> </td> <td> </td> <td> <div>The TTL to give the new record, in seconds.</div> <div>Will be ignored if <em>state=absent</em> and <em>on_existing=replace</em>.</div> </td> </tr> <tr> <td colspan="1">  <b>txt_transformation</b>  <div> <span>string</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>api</li> <li>quoted</li> <li><div>
<b>unquoted</b> ←</div></li> </ul> </td> <td> <div>Determines how TXT entry values are converted between the API and this module's input and output.</div> <div>The value <code>api</code> means that values are returned from this module as they are returned from the API, and pushed to the API as they have been passed to this module. For idempotency checks, the input string will be compared to the strings returned by the API. The API might automatically transform some values, like splitting long values or adding quotes, which can cause problems with idempotency.</div> <div>The value <code>unquoted</code> automatically transforms values so that you can pass in unquoted values, and the module will return unquoted values. If you pass in quoted values, they will be double-quoted.</div> <div>The value <code>quoted</code> automatically transforms values so that you must use quoting for values that contain spaces, characters such as quotation marks and backslashes, and that are longer than 255 bytes. It also makes sure to return values from the API in a normalized encoding.</div> <div>The default value, <code>unquoted</code>, ensures that you can work with values without having to care about how to correctly quote for DNS. Most users should use one of <code>unquoted</code> or <code>quoted</code>, but not <code>api</code>.</div> <div>
<b>Note:</b> the conversion code assumes UTF-8 encoding for values. If you need another encoding use <em>txt_transformation=api</em> and handle the encoding yourself.</div> </td> </tr> <tr> <td colspan="1">  <b>type</b>  <div> <span>string</span> / <span>required</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>A</li> <li>AAAA</li> <li>CAA</li> <li>CNAME</li> <li>DANE</li> <li>DS</li> <li>HINFO</li> <li>MX</li> <li>NS</li> <li>RP</li> <li>SOA</li> <li>SRV</li> <li>TLSA</li> <li>TXT</li> </ul> </td> <td> <div>The type of DNS record to create or delete.</div> </td> </tr> <tr> <td colspan="1">  <b>value</b>  <div> <span>list</span> / <span>elements=string</span> </div> </td> <td> </td> <td> <div>The new value when creating a DNS record.</div> <div>YAML lists or multiple comma-spaced values are allowed.</div> <div>When deleting a record all values for the record must be specified or it will not be deleted.</div> <div>Must be specified if <em>state=present</em> or when <em>on_existing</em> is not <code>replace</code>.</div> <div>Will be ignored if <em>state=absent</em> and <em>on_existing=replace</em>.</div> </td> </tr> <tr> <td colspan="1">  <b>zone_id</b>  <div> <span>string</span> </div> <div> added in 0.2.0 of community.dns </div> </td> <td> </td> <td> <div>The ID of the DNS zone to modify.</div> <div>Exactly one of <em>zone_name</em> and <em>zone_id</em> must be specified.</div> </td> </tr> <tr> <td colspan="1">  <b>zone_name</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>The DNS zone to modify.</div> <div>Exactly one of <em>zone_name</em> and <em>zone_id</em> must be specified.</div> <div>
<br>aliases: zone</div> </td> </tr> </table> <br>  <h2 id="notes">Notes</h2> <div class="admonition note"> <p class="admonition-title">Note</p> <ul class="simple"> <li>Supports <code>check_mode</code> and <code>--diff</code>.</li> </ul> </div>   <h2 id="examples">Examples</h2> <pre data-language="yaml+jinja">- name: Add new.foo.com as an A record with 3 IPs
  community.dns.hetzner_dns_record_set:
    state: present
    zone: foo.com
    record: new.foo.com
    type: A
    ttl: 7200
    value: 1.1.1.1,2.2.2.2,3.3.3.3
    hetzner_token: access_token

- name: Update new.foo.com as an A record with a list of 3 IPs
  community.dns.hetzner_dns_record_set:
    state: present
    zone: foo.com
    record: new.foo.com
    type: A
    ttl: 7200
    value:
      - 1.1.1.1
      - 2.2.2.2
      - 3.3.3.3
    hetzner_token: access_token

- name: Retrieve the details for new.foo.com
  community.dns.hetzner_dns_record_set_info:
    zone: foo.com
    record: new.foo.com
    type: A
    hetzner_token: access_token
  register: rec

- name: Delete new.foo.com A record using the results from the facts retrieval command
  community.dns.hetzner_dns_record_set:
    state: absent
    zone: foo.com
    record: "{{ rec.set.record }}"
    ttl: "{{ rec.set.ttl }}"
    type: "{{ rec.set.type }}"
    value: "{{ rec.set.value }}"
    hetzner_token: access_token

- name: Add an AAAA record
  # Note that because there are colons in the value that the IPv6 address must be quoted!
  community.dns.hetzner_dns_record_set:
    state: present
    zone: foo.com
    record: localhost.foo.com
    type: AAAA
    ttl: 7200
    value: "::1"
    hetzner_token: access_token

- name: Add a TXT record
  community.dns.hetzner_dns_record_set:
    state: present
    zone: foo.com
    record: localhost.foo.com
    type: TXT
    ttl: 7200
    value: 'bar'
    hetzner_token: access_token

- name: Remove the TXT record
  community.dns.hetzner_dns_record_set:
    state: absent
    zone: foo.com
    record: localhost.foo.com
    type: TXT
    ttl: 7200
    value: 'bar'
    hetzner_token: access_token

- name: Add a CAA record
  community.dns.hetzner_dns_record_set:
    state: present
    zone: foo.com
    record: foo.com
    type: CAA
    ttl: 3600
    value:
    - "128 issue letsencrypt.org"
    - "128 iodef mailto:webmaster@foo.com"
    hetzner_token: access_token

- name: Add an MX record
  community.dns.hetzner_dns_record_set:
    state: present
    zone: foo.com
    record: foo.com
    type: MX
    ttl: 3600
    value:
    - "10 mail.foo.com"
    hetzner_token: access_token

- name: Add a CNAME record
  community.dns.hetzner_dns_record_set:
    state: present
    zone: bla.foo.com
    record: foo.com
    type: CNAME
    ttl: 3600
    value:
    - foo.foo.com
    hetzner_token: access_token

- name: Add a PTR record
  community.dns.hetzner_dns_record_set:
    state: present
    zone: foo.foo.com
    record: foo.com
    type: PTR
    ttl: 3600
    value:
    - foo.foo.com
    hetzner_token: access_token

- name: Add an SPF record
  community.dns.hetzner_dns_record_set:
    state: present
    zone: foo.com
    record: foo.com
    type: SPF
    ttl: 3600
    value:
    - "v=spf1 a mx ~all"
    hetzner_token: access_token

- name: Add a PTR record
  community.dns.hetzner_dns_record_set:
    state: present
    zone: foo.com
    record: foo.com
    type: PTR
    ttl: 3600
    value:
    - "10 100 3333 service.foo.com"
    hetzner_token: access_token
</pre>   <h2 id="return-values">Return Values</h2> <p>Common return values are documented <a class="reference internal" href="../../../reference_appendices/common_return_values#common-return-values"><span class="std std-ref">here</span></a>, the following are the fields unique to this module:</p> <table class="documentation-table"> <tr> <th colspan="1">Key</th> <th>Returned</th> <th width="100%">Description</th> </tr> <tr> <td colspan="1">  <b>zone_id</b>  <div> <span>string</span> </div> </td> <td>success</td> <td> <div>The ID of the zone.</div> <br> <div><b>Sample:</b></div> <div>23</div> </td> </tr> </table> <br><br> <h3 id="authors">Authors</h3> <ul class="simple"> <li>Markus Bergholz (@markuman) &lt;<a class="reference external" href="https://docs.ansible.com/cdn-cgi/l/email-protection#0b666a79607e666a6520787b6a66696e6764656c787f646c64646c676e2d28383c302d283e39302d283f33306c666a62672d283f3d30686466">markuman+spambelongstogoogle<span>@</span>gmail<span>.</span>com</a>&gt;</li> <li>Felix Fontein (@felixfontein)</li> </ul><div class="_attribution">
  <p class="_attribution-p">
    <a href="https://docs.ansible.com/ansible/latest/collections/community/dns/hetzner_dns_record_set_module.html" class="_attribution-link" target="_blank">https://docs.ansible.com/ansible/latest/collections/community/dns/hetzner_dns_record_set_module.html</a>
  </p>
</div>
