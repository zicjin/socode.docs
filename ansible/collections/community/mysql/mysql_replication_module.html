<section id="community-mysql-mysql-replication-module-manage-mysql-replication"> <h1>community.mysql.mysql_replication module – Manage MySQL replication</h1> <div class="admonition note"> <p class="admonition-title">Note</p> <p>This module is part of the <a class="reference external" href="https://galaxy.ansible.com/community/mysql">community.mysql collection</a> (version 3.3.0).</p> <p>You might already have this collection installed if you are using the <code>ansible</code> package. It is not included in <code>ansible-core</code>. To check whether it is installed, run <code>ansible-galaxy collection list</code>.</p> <p>To install it, use: <code>ansible-galaxy collection install community.mysql</code>.</p> <p>To use it in a playbook, specify: <code>community.mysql.mysql_replication</code>.</p> </div>  <ul class="simple"> <li><a class="reference internal" href="#synopsis" id="id1">Synopsis</a></li> <li><a class="reference internal" href="#requirements" id="id2">Requirements</a></li> <li><a class="reference internal" href="#parameters" id="id3">Parameters</a></li> <li><a class="reference internal" href="#notes" id="id4">Notes</a></li> <li><a class="reference internal" href="#see-also" id="id5">See Also</a></li> <li><a class="reference internal" href="#examples" id="id6">Examples</a></li> <li><a class="reference internal" href="#return-values" id="id7">Return Values</a></li> </ul>  <section id="synopsis"> <h2>Synopsis</h2> <ul class="simple"> <li>Manages MySQL server replication, replica, primary status, get and change primary host.</li> </ul> </section> <section id="requirements"> <h2>Requirements</h2> <p>The below requirements are needed on the host that executes this module.</p> <ul class="simple"> <li>mysqlclient (Python 3.5+) or</li> <li>PyMySQL (Python 2.7 and Python 3.x) or</li> <li>MySQLdb (Python 2.x)</li> </ul> </section> <section id="parameters"> <h2>Parameters</h2> <table class="colwidths-auto ansible-option-table docutils align-default" style="width: 100%"> <thead> <tr>
<th class="head"><p>Parameter</p></th> <th class="head"><p>Comments</p></th> </tr> </thead>  <tr>
<td><div class="ansible-option-cell">  
<p class="ansible-option-title" id="ansible-collections-community-mysql-mysql-replication-module-parameter-ssl-ca"><strong id="ansible-collections-community-mysql-mysql-replication-module-parameter-ca-cert">ca_cert</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-aliases">aliases: ssl_ca</span></p> <p class="ansible-option-type-line"><span class="ansible-option-type">path</span></p> </div></td> <td><div class="ansible-option-cell">
<p>The path to a Certificate Authority (CA) certificate. This option, if used, must specify the same certificate as used by the server.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-mysql-mysql-replication-module-parameter-channel"><strong>channel</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> <p><span class="ansible-option-versionadded">added in 0.1.0 of community.mysql</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Name of replication channel.</p> <p>Multi-source replication is supported from MySQL 5.7.</p> <p>Mutually exclusive with <em>connection_name</em>.</p> <p>For more information see <a class="reference external" href="https://dev.mysql.com/doc/refman/8.0/en/replication-multi-source.html">https://dev.mysql.com/doc/refman/8.0/en/replication-multi-source.html</a>.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-mysql-mysql-replication-module-parameter-check-hostname"><strong>check_hostname</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">boolean</span></p> <p><span class="ansible-option-versionadded">added in 1.1.0 of community.mysql</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Whether to validate the server host name when an SSL connection is required. Corresponds to MySQL CLIs <code>--ssl</code> switch.</p> <p>Setting this to <code>false</code> disables hostname verification. Use with caution.</p> <p>Requires pymysql &gt;= 0.7.11.</p> <p>This option has no effect on MySQLdb.</p> <p class="ansible-option-line"><span class="ansible-option-choices">Choices:</span></p> <ul class="simple"> <li><span class="ansible-option-choices-entry">no</span></li> <li><span class="ansible-option-choices-entry">yes</span></li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell">  
<p class="ansible-option-title" id="ansible-collections-community-mysql-mysql-replication-module-parameter-ssl-cert"><strong id="ansible-collections-community-mysql-mysql-replication-module-parameter-client-cert">client_cert</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-aliases">aliases: ssl_cert</span></p> <p class="ansible-option-type-line"><span class="ansible-option-type">path</span></p> </div></td> <td><div class="ansible-option-cell">
<p>The path to a client public key certificate.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell">  
<p class="ansible-option-title" id="ansible-collections-community-mysql-mysql-replication-module-parameter-ssl-key"><strong id="ansible-collections-community-mysql-mysql-replication-module-parameter-client-key">client_key</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-aliases">aliases: ssl_key</span></p> <p class="ansible-option-type-line"><span class="ansible-option-type">path</span></p> </div></td> <td><div class="ansible-option-cell">
<p>The path to the client private key.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-mysql-mysql-replication-module-parameter-config-file"><strong>config_file</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">path</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Specify a config file from which user and password are to be read.</p> <p class="ansible-option-line"><span class="ansible-option-default-bold">Default:</span> <span class="ansible-option-default">“~/.my.cnf”</span></p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-mysql-mysql-replication-module-parameter-connect-timeout"><strong>connect_timeout</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">integer</span></p> </div></td> <td><div class="ansible-option-cell">
<p>The connection timeout when connecting to the MySQL server.</p> <p class="ansible-option-line"><span class="ansible-option-default-bold">Default:</span> <span class="ansible-option-default">30</span></p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-mysql-mysql-replication-module-parameter-connection-name"><strong>connection_name</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> <p><span class="ansible-option-versionadded">added in 0.1.0 of community.mysql</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Name of the primary connection.</p> <p>Supported from MariaDB 10.0.1.</p> <p>Mutually exclusive with <em>channel</em>.</p> <p>For more information see <a class="reference external" href="https://mariadb.com/kb/en/library/multi-source-replication/">https://mariadb.com/kb/en/library/multi-source-replication/</a>.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-mysql-mysql-replication-module-parameter-fail-on-error"><strong>fail_on_error</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">boolean</span></p> <p><span class="ansible-option-versionadded">added in 0.1.0 of community.mysql</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Fails on error when calling mysql.</p> <p class="ansible-option-line"><span class="ansible-option-choices">Choices:</span></p> <ul class="simple"> <li>
<span class="ansible-option-default-bold">no</span> <span class="ansible-option-default">← (default)</span>
</li> <li><span class="ansible-option-choices-entry">yes</span></li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-mysql-mysql-replication-module-parameter-login-host"><strong>login_host</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Host running the database.</p> <p>In some cases for local connections the <em>login_unix_socket=/path/to/mysqld/socket</em>, that is usually <code>/var/run/mysqld/mysqld.sock</code>, needs to be used instead of <em>login_host=localhost</em>.</p> <p class="ansible-option-line"><span class="ansible-option-default-bold">Default:</span> <span class="ansible-option-default">“localhost”</span></p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-mysql-mysql-replication-module-parameter-login-password"><strong>login_password</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>The password used to authenticate with.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-mysql-mysql-replication-module-parameter-login-port"><strong>login_port</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">integer</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Port of the MySQL server. Requires <em>login_host</em> be defined as other than localhost if login_port is used.</p> <p class="ansible-option-line"><span class="ansible-option-default-bold">Default:</span> <span class="ansible-option-default">3306</span></p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-mysql-mysql-replication-module-parameter-login-unix-socket"><strong>login_unix_socket</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>The path to a Unix domain socket for local connections.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-mysql-mysql-replication-module-parameter-login-user"><strong>login_user</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>The username used to authenticate with.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-mysql-mysql-replication-module-parameter-mode"><strong>mode</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Module operating mode. Could be <code>changeprimary</code> (CHANGE PRIMARY TO), <code>getprimary</code> (SHOW PRIMARY STATUS), <code>getreplica</code> (SHOW REPLICA), <code>startreplica</code> (START REPLICA), <code>stopreplica</code> (STOP REPLICA), <code>resetprimary</code> (RESET PRIMARY) - supported since community.mysql 0.1.0, <code>resetreplica</code> (RESET REPLICA), <code>resetreplicaall</code> (RESET REPLICA ALL).</p> <p class="ansible-option-line"><span class="ansible-option-choices">Choices:</span></p> <ul class="simple"> <li><span class="ansible-option-choices-entry">changeprimary</span></li> <li><span class="ansible-option-choices-entry">getprimary</span></li> <li>
<span class="ansible-option-default-bold">getreplica</span> <span class="ansible-option-default">← (default)</span>
</li> <li><span class="ansible-option-choices-entry">startreplica</span></li> <li><span class="ansible-option-choices-entry">stopreplica</span></li> <li><span class="ansible-option-choices-entry">resetprimary</span></li> <li><span class="ansible-option-choices-entry">resetreplica</span></li> <li><span class="ansible-option-choices-entry">resetreplicaall</span></li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell">  
<p class="ansible-option-title" id="ansible-collections-community-mysql-mysql-replication-module-parameter-master-auto-position"><strong id="ansible-collections-community-mysql-mysql-replication-module-parameter-primary-auto-position">primary_auto_position</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-aliases">aliases: master_auto_position</span></p> <p class="ansible-option-type-line"><span class="ansible-option-type">boolean</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Whether the host uses GTID based replication or not.</p> <p>Same as the <code>MASTER_AUTO_POSITION</code> mysql variable.</p> <p class="ansible-option-line"><span class="ansible-option-choices">Choices:</span></p> <ul class="simple"> <li>
<span class="ansible-option-default-bold">no</span> <span class="ansible-option-default">← (default)</span>
</li> <li><span class="ansible-option-choices-entry">yes</span></li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell">  
<p class="ansible-option-title" id="ansible-collections-community-mysql-mysql-replication-module-parameter-master-connect-retry"><strong id="ansible-collections-community-mysql-mysql-replication-module-parameter-primary-connect-retry">primary_connect_retry</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-aliases">aliases: master_connect_retry</span></p> <p class="ansible-option-type-line"><span class="ansible-option-type">integer</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Same as the <code>MASTER_CONNECT_RETRY</code> mysql variable.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell">  
<p class="ansible-option-title" id="ansible-collections-community-mysql-mysql-replication-module-parameter-master-delay"><strong id="ansible-collections-community-mysql-mysql-replication-module-parameter-primary-delay">primary_delay</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-aliases">aliases: master_delay</span></p> <p class="ansible-option-type-line"><span class="ansible-option-type">integer</span></p> <p><span class="ansible-option-versionadded">added in 0.1.0 of community.mysql</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Time lag behind the primary’s state (in seconds).</p> <p>Same as the <code>MASTER_DELAY</code> mysql variable.</p> <p>Available from MySQL 5.6.</p> <p>For more information see <a class="reference external" href="https://dev.mysql.com/doc/refman/8.0/en/replication-delayed.html">https://dev.mysql.com/doc/refman/8.0/en/replication-delayed.html</a>.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell">  
<p class="ansible-option-title" id="ansible-collections-community-mysql-mysql-replication-module-parameter-master-host"><strong id="ansible-collections-community-mysql-mysql-replication-module-parameter-primary-host">primary_host</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-aliases">aliases: master_host</span></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Same as the <code>MASTER_HOST</code> mysql variable.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell">  
<p class="ansible-option-title" id="ansible-collections-community-mysql-mysql-replication-module-parameter-master-log-file"><strong id="ansible-collections-community-mysql-mysql-replication-module-parameter-primary-log-file">primary_log_file</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-aliases">aliases: master_log_file</span></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Same as the <code>MASTER_LOG_FILE</code> mysql variable.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell">  
<p class="ansible-option-title" id="ansible-collections-community-mysql-mysql-replication-module-parameter-master-log-pos"><strong id="ansible-collections-community-mysql-mysql-replication-module-parameter-primary-log-pos">primary_log_pos</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-aliases">aliases: master_log_pos</span></p> <p class="ansible-option-type-line"><span class="ansible-option-type">integer</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Same as the <code>MASTER_LOG_POS</code> mysql variable.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell">  
<p class="ansible-option-title" id="ansible-collections-community-mysql-mysql-replication-module-parameter-master-password"><strong id="ansible-collections-community-mysql-mysql-replication-module-parameter-primary-password">primary_password</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-aliases">aliases: master_password</span></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Same as the <code>MASTER_PASSWORD</code> mysql variable.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell">  
<p class="ansible-option-title" id="ansible-collections-community-mysql-mysql-replication-module-parameter-master-port"><strong id="ansible-collections-community-mysql-mysql-replication-module-parameter-primary-port">primary_port</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-aliases">aliases: master_port</span></p> <p class="ansible-option-type-line"><span class="ansible-option-type">integer</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Same as the <code>MASTER_PORT</code> mysql variable.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell">  
<p class="ansible-option-title" id="ansible-collections-community-mysql-mysql-replication-module-parameter-master-ssl"><strong id="ansible-collections-community-mysql-mysql-replication-module-parameter-primary-ssl">primary_ssl</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-aliases">aliases: master_ssl</span></p> <p class="ansible-option-type-line"><span class="ansible-option-type">boolean</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Same as the <code>MASTER_SSL</code> mysql variable.</p> <p>When setting it to <code>yes</code>, the connection attempt only succeeds if an encrypted connection can be established.</p> <p>For details, refer to <a class="reference external" href="https://dev.mysql.com/doc/refman/8.0/en/replication-solutions-encrypted-connections.html">MySQL encrypted replication documentation</a>.</p> <p class="ansible-option-line"><span class="ansible-option-choices">Choices:</span></p> <ul class="simple"> <li>
<span class="ansible-option-default-bold">no</span> <span class="ansible-option-default">← (default)</span>
</li> <li><span class="ansible-option-choices-entry">yes</span></li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell">  
<p class="ansible-option-title" id="ansible-collections-community-mysql-mysql-replication-module-parameter-master-ssl-ca"><strong id="ansible-collections-community-mysql-mysql-replication-module-parameter-primary-ssl-ca">primary_ssl_ca</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-aliases">aliases: master_ssl_ca</span></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Same as the <code>MASTER_SSL_CA</code> mysql variable.</p> <p>For details, refer to <a class="reference external" href="https://dev.mysql.com/doc/refman/8.0/en/replication-solutions-encrypted-connections.html">MySQL encrypted replication documentation</a>.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell">  
<p class="ansible-option-title" id="ansible-collections-community-mysql-mysql-replication-module-parameter-master-ssl-capath"><strong id="ansible-collections-community-mysql-mysql-replication-module-parameter-primary-ssl-capath">primary_ssl_capath</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-aliases">aliases: master_ssl_capath</span></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Same as the <code>MASTER_SSL_CAPATH</code> mysql variable.</p> <p>For details, refer to <a class="reference external" href="https://dev.mysql.com/doc/refman/8.0/en/replication-solutions-encrypted-connections.html">MySQL encrypted replication documentation</a>.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell">  
<p class="ansible-option-title" id="ansible-collections-community-mysql-mysql-replication-module-parameter-master-ssl-cert"><strong id="ansible-collections-community-mysql-mysql-replication-module-parameter-primary-ssl-cert">primary_ssl_cert</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-aliases">aliases: master_ssl_cert</span></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Same as the <code>MASTER_SSL_CERT</code> mysql variable.</p> <p>For details, refer to <a class="reference external" href="https://dev.mysql.com/doc/refman/8.0/en/replication-solutions-encrypted-connections.html">MySQL encrypted replication documentation</a>.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell">  
<p class="ansible-option-title" id="ansible-collections-community-mysql-mysql-replication-module-parameter-master-ssl-cipher"><strong id="ansible-collections-community-mysql-mysql-replication-module-parameter-primary-ssl-cipher">primary_ssl_cipher</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-aliases">aliases: master_ssl_cipher</span></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Same as the <code>MASTER_SSL_CIPHER</code> mysql variable.</p> <p>Specifies a colon-separated list of one or more ciphers permitted by the replica for the replication connection.</p> <p>For details, refer to <a class="reference external" href="https://dev.mysql.com/doc/refman/8.0/en/replication-solutions-encrypted-connections.html">MySQL encrypted replication documentation</a>.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell">  
<p class="ansible-option-title" id="ansible-collections-community-mysql-mysql-replication-module-parameter-master-ssl-key"><strong id="ansible-collections-community-mysql-mysql-replication-module-parameter-primary-ssl-key">primary_ssl_key</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-aliases">aliases: master_ssl_key</span></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Same as the <code>MASTER_SSL_KEY</code> mysql variable.</p> <p>For details, refer to <a class="reference external" href="https://dev.mysql.com/doc/refman/8.0/en/replication-solutions-encrypted-connections.html">MySQL encrypted replication documentation</a>.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell">  
<p class="ansible-option-title" id="ansible-collections-community-mysql-mysql-replication-module-parameter-master-use-gtid"><strong id="ansible-collections-community-mysql-mysql-replication-module-parameter-primary-use-gtid">primary_use_gtid</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-aliases">aliases: master_use_gtid</span></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> <p><span class="ansible-option-versionadded">added in 0.1.0 of community.mysql</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Configures the replica to use the MariaDB Global Transaction ID.</p> <p><code>disabled</code> equals MASTER_USE_GTID=no command.</p> <p>To find information about available values see <a class="reference external" href="https://mariadb.com/kb/en/library/change-master-to/#master_use_gtid">https://mariadb.com/kb/en/library/change-master-to/#master_use_gtid</a>.</p> <p>Available since MariaDB 10.0.2.</p> <p class="ansible-option-line"><span class="ansible-option-choices">Choices:</span></p> <ul class="simple"> <li><span class="ansible-option-choices-entry">current_pos</span></li> <li><span class="ansible-option-choices-entry">replica_pos</span></li> <li><span class="ansible-option-choices-entry">disabled</span></li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell">  
<p class="ansible-option-title" id="ansible-collections-community-mysql-mysql-replication-module-parameter-master-user"><strong id="ansible-collections-community-mysql-mysql-replication-module-parameter-primary-user">primary_user</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-aliases">aliases: master_user</span></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Same as the <code>MASTER_USER</code> mysql variable.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-mysql-mysql-replication-module-parameter-relay-log-file"><strong>relay_log_file</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Same as mysql variable.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-mysql-mysql-replication-module-parameter-relay-log-pos"><strong>relay_log_pos</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">integer</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Same as mysql variable.</p> </div></td> </tr>  </table> </section> <section id="notes"> <h2>Notes</h2> <div class="admonition note"> <p class="admonition-title">Note</p> <ul class="simple"> <li>If an empty value for the parameter of string type is needed, use an empty string.</li> <li>Requires the PyMySQL (Python 2.7 and Python 3.X) or MySQL-python (Python 2.X) package installed on the remote host. The Python package may be installed with apt-get install python-pymysql (Ubuntu; see <a class="reference internal" href="../../ansible/builtin/apt_module#ansible-collections-ansible-builtin-apt-module"><span class="std std-ref">ansible.builtin.apt</span></a>) or yum install python2-PyMySQL (RHEL/CentOS/Fedora; see <a class="reference internal" href="../../ansible/builtin/yum_module#ansible-collections-ansible-builtin-yum-module"><span class="std std-ref">ansible.builtin.yum</span></a>). You can also use dnf install python2-PyMySQL for newer versions of Fedora; see <a class="reference internal" href="../../ansible/builtin/dnf_module#ansible-collections-ansible-builtin-dnf-module"><span class="std std-ref">ansible.builtin.dnf</span></a>.</li> <li>Be sure you have mysqlclient, PyMySQL, or MySQLdb library installed on the target machine for the Python interpreter Ansible discovers. For example if ansible discovers and uses Python 3, you need to install the Python 3 version of PyMySQL or mysqlclient. If ansible discovers and uses Python 2, you need to install the Python 2 version of either PyMySQL or MySQL-python.</li> <li>If you have trouble, it may help to force Ansible to use the Python interpreter you need by specifying <code>ansible_python_interpreter</code>. For more information, see <a class="reference external" href="../../../reference_appendices/interpreter_discovery">https://docs.ansible.com/ansible/latest/reference_appendices/interpreter_discovery.html</a>.</li> <li>Both <code>login_password</code> and <code>login_user</code> are required when you are passing credentials. If none are present, the module will attempt to read the credentials from <code>~/.my.cnf</code>, and finally fall back to using the MySQL default login of ‘root’ with no password.</li> <li>If there are problems with local connections, using <em>login_unix_socket=/path/to/mysqld/socket</em> instead of <em>login_host=localhost</em> might help. As an example, the default MariaDB installation of version 10.4 and later uses the unix_socket authentication plugin by default that without using <em>login_unix_socket=/var/run/mysqld/mysqld.sock</em> (the default path) causes the error <code>Host '127.0.0.1' is not allowed to connect to this MariaDB server</code>.</li> <li>Alternatively, you can use the mysqlclient library instead of MySQL-python (MySQLdb) which supports both Python 2.X and Python &gt;=3.5. See <a class="reference external" href="https://pypi.org/project/mysqlclient/">https://pypi.org/project/mysqlclient/</a> how to install it.</li> </ul> </div> </section> <section id="see-also"> <h2>See Also</h2> <div class="admonition seealso"> <p class="admonition-title">See also</p> <dl class="simple"> <dt><a class="reference internal" href="mysql_info_module#ansible-collections-community-mysql-mysql-info-module"><span class="std std-ref">community.mysql.mysql_info</span></a></dt>
<dd>
<p>The official documentation on the <strong>community.mysql.mysql_info</strong> module.</p> </dd> <dt><a class="reference external" href="https://dev.mysql.com/doc/refman/8.0/en/replication.html">MySQL replication reference</a></dt>
<dd>
<p>Complete reference of the MySQL replication documentation.</p> </dd> <dt><a class="reference external" href="https://dev.mysql.com/doc/refman/8.0/en/replication-solutions-encrypted-connections.html">MySQL encrypted replication reference.</a></dt>
<dd>
<p>Setting up MySQL replication to use encrypted connection.</p> </dd> <dt><a class="reference external" href="https://mariadb.com/kb/en/library/setting-up-replication/">MariaDB replication reference</a></dt>
<dd>
<p>Complete reference of the MariaDB replication documentation.</p> </dd> </dl> </div> </section> <section id="examples"> <h2>Examples</h2> <pre data-language="yaml+jinja">- name: Stop mysql replica thread
  community.mysql.mysql_replication:
    mode: stopreplica

- name: Get primary binlog file name and binlog position
  community.mysql.mysql_replication:
    mode: getprimary

- name: Change primary to primary server 192.0.2.1 and use binary log 'mysql-bin.000009' with position 4578
  community.mysql.mysql_replication:
    mode: changeprimary
    primary_host: 192.0.2.1
    primary_log_file: mysql-bin.000009
    primary_log_pos: 4578

- name: Check replica status using port 3308
  community.mysql.mysql_replication:
    mode: getreplica
    login_host: ansible.example.com
    login_port: 3308

- name: On MariaDB change primary to use GTID current_pos
  community.mysql.mysql_replication:
    mode: changeprimary
    primary_use_gtid: current_pos

- name: Change primary to use replication delay 3600 seconds
  community.mysql.mysql_replication:
    mode: changeprimary
    primary_host: 192.0.2.1
    primary_delay: 3600

- name: Start MariaDB replica with connection name primary-1
  community.mysql.mysql_replication:
    mode: startreplica
    connection_name: primary-1

- name: Stop replication in channel primary-1
  community.mysql.mysql_replication:
    mode: stopreplica
    channel: primary-1

- name: &gt;
    Run RESET MASTER command which will delete all existing binary log files
    and reset the binary log index file on the primary
  community.mysql.mysql_replication:
    mode: resetprimary

- name: Run start replica and fail the task on errors
  community.mysql.mysql_replication:
    mode: startreplica
    connection_name: primary-1
    fail_on_error: yes

- name: Change primary and fail on error (like when replica thread is running)
  community.mysql.mysql_replication:
    mode: changeprimary
    fail_on_error: yes
</pre> </section> <section id="return-values"> <h2>Return Values</h2> <p>Common return values are documented <a class="reference internal" href="../../../reference_appendices/common_return_values#common-return-values"><span class="std std-ref">here</span></a>, the following are the fields unique to this module:</p> <table class="colwidths-auto ansible-option-table docutils align-default" style="width: 100%"> <thead> <tr>
<th class="head"><p>Key</p></th> <th class="head"><p>Description</p></th> </tr> </thead>  <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-mysql-mysql-replication-module-return-queries"><strong>queries</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">list</span> / <span class="ansible-option-elements">elements=string</span></p> <p><span class="ansible-option-versionadded">added in 0.1.0 of community.mysql</span></p> </div></td> <td><div class="ansible-option-cell">
<p>List of executed queries which modified DB’s state.</p> <p class="ansible-option-line"><span class="ansible-option-returned-bold">Returned:</span> always</p> <p class="ansible-option-line ansible-option-sample"><span class="ansible-option-sample-bold">Sample:</span> [“CHANGE MASTER TO MASTER_HOST=\u0027primary2.example.com\u0027,MASTER_PORT=3306”]</p> </div></td> </tr>  </table> <section id="authors"> <h3>Authors</h3> <ul class="simple"> <li>Balazs Pocze (@banyek)</li> <li>Andrew Klychkov (@Andersson007)</li> </ul> </section> <section id="collection-links"> <h3>Collection links</h3> <p class="ansible-links"> <a href="https://github.com/ansible-collections/community.mysql/issues" aria-role="button" target="_blank" rel="noopener external">Issue Tracker</a> <a href="https://github.com/ansible-collections/community.mysql" aria-role="button" target="_blank" rel="noopener external">Repository (Sources)</a> </p></section> </section> </section><div class="_attribution">
  <p class="_attribution-p">
    <a href="https://docs.ansible.com/ansible/latest/collections/community/mysql/mysql_replication_module.html" class="_attribution-link" target="_blank">https://docs.ansible.com/ansible/latest/collections/community/mysql/mysql_replication_module.html</a>
  </p>
</div>
