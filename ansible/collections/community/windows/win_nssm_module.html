<section id="community-windows-win-nssm-module-install-a-service-using-nssm"> <h1>community.windows.win_nssm module – Install a service using NSSM</h1> <div class="admonition note"> <p class="admonition-title">Note</p> <p>This module is part of the <a class="reference external" href="https://galaxy.ansible.com/community/windows">community.windows collection</a> (version 1.10.0).</p> <p>You might already have this collection installed if you are using the <code>ansible</code> package. It is not included in <code>ansible-core</code>. To check whether it is installed, run <code>ansible-galaxy collection list</code>.</p> <p>To install it, use: <code>ansible-galaxy collection install community.windows</code>.</p> <p>To use it in a playbook, specify: <code>community.windows.win_nssm</code>.</p> </div>  <ul class="simple"> <li><a class="reference internal" href="#synopsis" id="id1">Synopsis</a></li> <li><a class="reference internal" href="#requirements" id="id2">Requirements</a></li> <li><a class="reference internal" href="#parameters" id="id3">Parameters</a></li> <li><a class="reference internal" href="#notes" id="id4">Notes</a></li> <li><a class="reference internal" href="#see-also" id="id5">See Also</a></li> <li><a class="reference internal" href="#examples" id="id6">Examples</a></li> </ul>  <section id="synopsis"> <h2>Synopsis</h2> <ul class="simple"> <li>Install a Windows service using the NSSM wrapper.</li> <li>NSSM is a service helper which doesn’t suck. See <a class="reference external" href="https://nssm.cc/">https://nssm.cc/</a> for more information.</li> </ul> </section> <section id="requirements"> <h2>Requirements</h2> <p>The below requirements are needed on the host that executes this module.</p> <ul class="simple"> <li>nssm &gt;= 2.24.0 # (install via <a class="reference internal" href="../../chocolatey/chocolatey/win_chocolatey_module#ansible-collections-chocolatey-chocolatey-win-chocolatey-module"><span class="std std-ref">chocolatey.chocolatey.win_chocolatey</span></a>) <code>win_chocolatey: name=nssm</code>
</li> </ul> </section> <section id="parameters"> <h2>Parameters</h2> <table class="colwidths-auto ansible-option-table docutils align-default" style="width: 100%"> <thead> <tr>
<th class="head"><p>Parameter</p></th> <th class="head"><p>Comments</p></th> </tr> </thead>  <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-windows-win-nssm-module-parameter-app-environment"><strong>app_environment</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">dictionary</span></p> <p><span class="ansible-option-versionadded">added in 1.2.0 of community.windows</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Key/Value pairs which will be added to the environment of the service application.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-windows-win-nssm-module-parameter-app-parameters"><strong>app_parameters</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>A string representing a dictionary of parameters to be passed to the application when it starts.</p> <p>DEPRECATED since v2.8, please use <em>arguments</em> instead.</p> <p>This is mutually exclusive with <em>arguments</em>.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-windows-win-nssm-module-parameter-app-rotate-bytes"><strong>app_rotate_bytes</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">integer</span></p> </div></td> <td><div class="ansible-option-cell">
<p>NSSM will not rotate any file which is smaller than the configured number of bytes.</p> <p class="ansible-option-line"><span class="ansible-option-default-bold">Default:</span> <span class="ansible-option-default">104858</span></p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-windows-win-nssm-module-parameter-app-rotate-online"><strong>app_rotate_online</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">integer</span></p> </div></td> <td><div class="ansible-option-cell">
<p>If set to 1, nssm can rotate files which grow to the configured file size limit while the service is running.</p> <p class="ansible-option-line"><span class="ansible-option-choices">Choices:</span></p> <ul class="simple"> <li><span class="ansible-option-choices-entry">0</span></li> <li><span class="ansible-option-choices-entry">1</span></li> </ul> <p class="ansible-option-line"><span class="ansible-option-default-bold">Default:</span> <span class="ansible-option-default">0</span></p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-windows-win-nssm-module-parameter-app-stop-method-console"><strong>app_stop_method_console</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">integer</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Time to wait after sending Control-C.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-windows-win-nssm-module-parameter-app-stop-method-skip"><strong>app_stop_method_skip</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">integer</span></p> </div></td> <td><div class="ansible-option-cell">
<p>To disable service shutdown methods, set to the sum of one or more of the numbers</p> <p>1 - Don’t send Control-C to the console.</p> <p>2 - Don’t send WM_CLOSE to windows.</p> <p>4 - Don’t send WM_QUIT to threads.</p> <p>8 - Don’t call TerminateProcess().</p> <p class="ansible-option-line"><span class="ansible-option-choices">Choices:</span></p> <ul class="simple"> <li><span class="ansible-option-choices-entry">1</span></li> <li><span class="ansible-option-choices-entry">2</span></li> <li><span class="ansible-option-choices-entry">3</span></li> <li><span class="ansible-option-choices-entry">4</span></li> <li><span class="ansible-option-choices-entry">5</span></li> <li><span class="ansible-option-choices-entry">6</span></li> <li><span class="ansible-option-choices-entry">7</span></li> <li><span class="ansible-option-choices-entry">8</span></li> <li><span class="ansible-option-choices-entry">9</span></li> <li><span class="ansible-option-choices-entry">10</span></li> <li><span class="ansible-option-choices-entry">11</span></li> <li><span class="ansible-option-choices-entry">12</span></li> <li><span class="ansible-option-choices-entry">13</span></li> <li><span class="ansible-option-choices-entry">14</span></li> <li><span class="ansible-option-choices-entry">15</span></li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-windows-win-nssm-module-parameter-application"><strong>application</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">path</span></p> </div></td> <td><div class="ansible-option-cell">
<p>The application binary to run as a service</p> <p>Required when <em>state</em> is <code>present</code>, <code>started</code>, <code>stopped</code>, or <code>restarted</code>.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell">  
<p class="ansible-option-title" id="ansible-collections-community-windows-win-nssm-module-parameter-app-parameters-free-form"><strong id="ansible-collections-community-windows-win-nssm-module-parameter-arguments">arguments</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-aliases">aliases: app_parameters_free_form</span></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Parameters to be passed to the application when it starts.</p> <p>This can be either a simple string or a list.</p> <p>This is mutually exclusive with <em>app_parameters</em>.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-windows-win-nssm-module-parameter-dependencies"><strong>dependencies</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">list</span> / <span class="ansible-option-elements">elements=string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Service dependencies that has to be started to trigger startup, separated by comma.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-windows-win-nssm-module-parameter-description"><strong>description</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>The description to set for the service.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-windows-win-nssm-module-parameter-display-name"><strong>display_name</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>The display name to set for the service.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-windows-win-nssm-module-parameter-executable"><strong>executable</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">path</span></p> </div></td> <td><div class="ansible-option-cell">
<p>The location of the NSSM utility (in case it is not located in your PATH).</p> <p class="ansible-option-line"><span class="ansible-option-default-bold">Default:</span> <span class="ansible-option-default">“nssm.exe”</span></p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-windows-win-nssm-module-parameter-name"><strong>name</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span> / <span class="ansible-option-required">required</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Name of the service to operate on.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-windows-win-nssm-module-parameter-password"><strong>password</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Password to be used for service startup.</p> <p>This is not required for the well known service accounts and group managed service accounts.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-windows-win-nssm-module-parameter-start-mode"><strong>start_mode</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>If <code>auto</code> is selected, the service will start at bootup.</p> <p><code>delayed</code> causes a delayed but automatic start after boot.</p> <p><code>manual</code> means that the service will start only when another service needs it.</p> <p><code>disabled</code> means that the service will stay off, regardless if it is needed or not.</p> <p class="ansible-option-line"><span class="ansible-option-choices">Choices:</span></p> <ul class="simple"> <li>
<span class="ansible-option-default-bold">auto</span> <span class="ansible-option-default">← (default)</span>
</li> <li><span class="ansible-option-choices-entry">delayed</span></li> <li><span class="ansible-option-choices-entry">disabled</span></li> <li><span class="ansible-option-choices-entry">manual</span></li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-windows-win-nssm-module-parameter-state"><strong>state</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>State of the service on the system.</p> <p class="ansible-option-line"><span class="ansible-option-choices">Choices:</span></p> <ul class="simple"> <li><span class="ansible-option-choices-entry">absent</span></li> <li>
<span class="ansible-option-default-bold">present</span> <span class="ansible-option-default">← (default)</span>
</li> <li><span class="ansible-option-choices-entry">started</span></li> <li><span class="ansible-option-choices-entry">stopped</span></li> <li><span class="ansible-option-choices-entry">restarted</span></li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-windows-win-nssm-module-parameter-stderr-file"><strong>stderr_file</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">path</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Path to receive error output.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-windows-win-nssm-module-parameter-stdout-file"><strong>stdout_file</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">path</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Path to receive output.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell">  
<p class="ansible-option-title" id="ansible-collections-community-windows-win-nssm-module-parameter-user"><strong id="ansible-collections-community-windows-win-nssm-module-parameter-username">username</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-aliases">aliases: user</span></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>User to be used for service startup.</p> <p>Group managed service accounts must end with <code>$</code>.</p> <p>Before <code>1.8.0</code>, this parameter was just <code>user</code>.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell">   
<p class="ansible-option-title" id="ansible-collections-community-windows-win-nssm-module-parameter-chdir"><strong id="ansible-collections-community-windows-win-nssm-module-parameter-working-directory">working_directory</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-aliases">aliases: app_directory, chdir</span></p> <p class="ansible-option-type-line"><span class="ansible-option-type">path</span></p> </div></td> <td><div class="ansible-option-cell">
<p>The working directory to run the service executable from (defaults to the directory containing the application binary)</p> </div></td> </tr>  </table> </section> <section id="notes"> <h2>Notes</h2> <div class="admonition note"> <p class="admonition-title">Note</p> <ul class="simple"> <li>The service will NOT be started after its creation when <code>state=present</code>.</li> <li>Once the service is created, you can use the <a class="reference internal" href="../../ansible/windows/win_service_module#ansible-collections-ansible-windows-win-service-module"><span class="std std-ref">ansible.windows.win_service</span></a> module to start it or configure some additionals properties, such as its startup type, dependencies, service account, and so on.</li> </ul> </div> </section> <section id="see-also"> <h2>See Also</h2> <div class="admonition seealso"> <p class="admonition-title">See also</p> <dl class="simple"> <dt><a class="reference internal" href="../../ansible/windows/win_service_module#ansible-collections-ansible-windows-win-service-module"><span class="std std-ref">ansible.windows.win_service</span></a></dt>
<dd>
<p>The official documentation on the <strong>ansible.windows.win_service</strong> module.</p> </dd> </dl> </div> </section> <section id="examples"> <h2>Examples</h2> <pre data-language="yaml+jinja">- name: Install the foo service
  community.windows.win_nssm:
    name: foo
    application: C:\windows\foo.exe

# This will yield the following command: C:\windows\foo.exe bar "true"
- name: Install the Consul service with a list of parameters
  community.windows.win_nssm:
    name: Consul
    application: C:\consul\consul.exe
    arguments:
      - agent
      - -config-dir=C:\consul\config

# This is strictly equivalent to the previous example
- name: Install the Consul service with an arbitrary string of parameters
  community.windows.win_nssm:
    name: Consul
    application: C:\consul\consul.exe
    arguments: agent -config-dir=C:\consul\config


# Install the foo service, and then configure and start it with win_service
- name: Install the foo service, redirecting stdout and stderr to the same file
  community.windows.win_nssm:
    name: foo
    application: C:\windows\foo.exe
    stdout_file: C:\windows\foo.log
    stderr_file: C:\windows\foo.log

- name: Configure and start the foo service using win_service
  ansible.windows.win_service:
    name: foo
    dependencies: [ adf, tcpip ]
    username: foouser
    password: secret
    start_mode: manual
    state: started

- name: Install a script based service and define custom environment variables
  community.windows.win_nssm:
    name: &lt;ServiceName&gt;
    application: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
    arguments:
      - &lt;path-to-script&gt;
      - &lt;script arg&gt;
    app_environment:
      AUTH_TOKEN: &lt;token value&gt;
      SERVER_URL: https://example.com
      PATH: "&lt;path-prepends&gt;;{{ ansible_env.PATH }};&lt;path-appends&gt;"

- name: Remove the foo service
  community.windows.win_nssm:
    name: foo
    state: absent
</pre> <section id="authors"> <h3>Authors</h3> <ul class="simple"> <li>Adam Keech (@smadam813)</li> <li>George Frank (@georgefrank)</li> <li>Hans-Joachim Kliemeck (@h0nIg)</li> <li>Michael Wild (@themiwi)</li> <li>Kevin Subileau (@ksubileau)</li> <li>Shachaf Goldstein (@Shachaf92)</li> </ul> </section> <section id="collection-links"> <h3>Collection links</h3> <p class="ansible-links"> <a href="https://github.com/ansible-collections/community.windows/issues" aria-role="button" target="_blank" rel="noopener external">Issue Tracker</a> <a href="https://github.com/ansible-collections/community.windows" aria-role="button" target="_blank" rel="noopener external">Repository (Sources)</a> </p></section> </section> </section><div class="_attribution">
  <p class="_attribution-p">
    <a href="https://docs.ansible.com/ansible/latest/collections/community/windows/win_nssm_module.html" class="_attribution-link" target="_blank">https://docs.ansible.com/ansible/latest/collections/community/windows/win_nssm_module.html</a>
  </p>
</div>
