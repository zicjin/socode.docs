<section id="community-general-ldap-attrs-module-add-or-remove-multiple-ldap-attribute-values"> <h1>community.general.ldap_attrs module – Add or remove multiple LDAP attribute values</h1> <div class="admonition note"> <p class="admonition-title">Note</p> <p>This module is part of the <a class="reference external" href="https://galaxy.ansible.com/community/general">community.general collection</a> (version 5.4.0).</p> <p>You might already have this collection installed if you are using the <code>ansible</code> package. It is not included in <code>ansible-core</code>. To check whether it is installed, run <code>ansible-galaxy collection list</code>.</p> <p>To install it, use: <code>ansible-galaxy collection install community.general</code>.</p> <p>To use it in a playbook, specify: <code>community.general.ldap_attrs</code>.</p> </div> <div class="versionadded"> <p><span class="versionmodified added">New in version 0.2.0: </span>of community.general</p> </div>  <ul class="simple"> <li><a class="reference internal" href="#synopsis" id="id1">Synopsis</a></li> <li><a class="reference internal" href="#requirements" id="id2">Requirements</a></li> <li><a class="reference internal" href="#parameters" id="id3">Parameters</a></li> <li><a class="reference internal" href="#notes" id="id4">Notes</a></li> <li><a class="reference internal" href="#examples" id="id5">Examples</a></li> <li><a class="reference internal" href="#return-values" id="id6">Return Values</a></li> </ul>  <section id="synopsis"> <h2>Synopsis</h2> <ul class="simple"> <li>Add or remove multiple LDAP attribute values.</li> </ul> </section> <section id="requirements"> <h2>Requirements</h2> <p>The below requirements are needed on the host that executes this module.</p> <ul class="simple"> <li>python-ldap</li> </ul> </section> <section id="parameters"> <h2>Parameters</h2> <table class="colwidths-auto ansible-option-table docutils align-default" style="width: 100%"> <thead> <tr>
<th class="head"><p>Parameter</p></th> <th class="head"><p>Comments</p></th> </tr> </thead>  <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-general-ldap-attrs-module-parameter-attributes"><strong>attributes</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">dictionary</span> / <span class="ansible-option-required">required</span></p> </div></td> <td><div class="ansible-option-cell">
<p>The attribute(s) and value(s) to add or remove. The complex argument format is required in order to pass a list of strings (see examples).</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-general-ldap-attrs-module-parameter-bind-dn"><strong>bind_dn</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>A DN to bind with. If this is omitted, we’ll try a SASL bind with the EXTERNAL mechanism as default.</p> <p>If this is blank, we’ll use an anonymous bind.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-general-ldap-attrs-module-parameter-bind-pw"><strong>bind_pw</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>The password to use with <em>bind_dn</em>.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-general-ldap-attrs-module-parameter-dn"><strong>dn</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span> / <span class="ansible-option-required">required</span></p> </div></td> <td><div class="ansible-option-cell">
<p>The DN of the entry to add or remove.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-general-ldap-attrs-module-parameter-ordered"><strong>ordered</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">boolean</span></p> </div></td> <td><div class="ansible-option-cell">
<p>If <code>yes</code>, prepend list values with X-ORDERED index numbers in all attributes specified in the current task. This is useful mostly with <em>olcAccess</em> attribute to easily manage LDAP Access Control Lists.</p> <p class="ansible-option-line"><span class="ansible-option-choices">Choices:</span></p> <ul class="simple"> <li>
<span class="ansible-option-default-bold">no</span> <span class="ansible-option-default">← (default)</span>
</li> <li><span class="ansible-option-choices-entry">yes</span></li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-general-ldap-attrs-module-parameter-referrals-chasing"><strong>referrals_chasing</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> <p><span class="ansible-option-versionadded">added in 2.0.0 of community.general</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Set the referrals chasing behavior.</p> <p><code>anonymous</code> follow referrals anonymously. This is the default behavior.</p> <p><code>disabled</code> disable referrals chasing. This sets <code>OPT_REFERRALS</code> to off.</p> <p class="ansible-option-line"><span class="ansible-option-choices">Choices:</span></p> <ul class="simple"> <li><span class="ansible-option-choices-entry">disabled</span></li> <li>
<span class="ansible-option-default-bold">anonymous</span> <span class="ansible-option-default">← (default)</span>
</li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-general-ldap-attrs-module-parameter-sasl-class"><strong>sasl_class</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> <p><span class="ansible-option-versionadded">added in 2.0.0 of community.general</span></p> </div></td> <td><div class="ansible-option-cell">
<p>The class to use for SASL authentication.</p> <p>possible choices are <code>external</code>, <code>gssapi</code>.</p> <p class="ansible-option-line"><span class="ansible-option-choices">Choices:</span></p> <ul class="simple"> <li>
<span class="ansible-option-default-bold">external</span> <span class="ansible-option-default">← (default)</span>
</li> <li><span class="ansible-option-choices-entry">gssapi</span></li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-general-ldap-attrs-module-parameter-server-uri"><strong>server_uri</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>The <em>server_uri</em> parameter may be a comma- or whitespace-separated list of URIs containing only the schema, the host, and the port fields.</p> <p>The default value lets the underlying LDAP client library look for a UNIX domain socket in its default location.</p> <p>Note that when using multiple URIs you cannot determine to which URI your client gets connected.</p> <p>For URIs containing additional fields, particularly when using commas, behavior is undefined.</p> <p class="ansible-option-line"><span class="ansible-option-default-bold">Default:</span> <span class="ansible-option-default">“ldapi:///”</span></p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-general-ldap-attrs-module-parameter-start-tls"><strong>start_tls</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">boolean</span></p> </div></td> <td><div class="ansible-option-cell">
<p>If true, we’ll use the START_TLS LDAP extension.</p> <p class="ansible-option-line"><span class="ansible-option-choices">Choices:</span></p> <ul class="simple"> <li>
<span class="ansible-option-default-bold">no</span> <span class="ansible-option-default">← (default)</span>
</li> <li><span class="ansible-option-choices-entry">yes</span></li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-general-ldap-attrs-module-parameter-state"><strong>state</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>The state of the attribute values. If <code>present</code>, all given attribute values will be added if they’re missing. If <code>absent</code>, all given attribute values will be removed if present. If <code>exact</code>, the set of attribute values will be forced to exactly those provided and no others. If <em>state=exact</em> and the attribute <em>value</em> is empty, all values for this attribute will be removed.</p> <p class="ansible-option-line"><span class="ansible-option-choices">Choices:</span></p> <ul class="simple"> <li>
<span class="ansible-option-default-bold">present</span> <span class="ansible-option-default">← (default)</span>
</li> <li><span class="ansible-option-choices-entry">absent</span></li> <li><span class="ansible-option-choices-entry">exact</span></li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-general-ldap-attrs-module-parameter-validate-certs"><strong>validate_certs</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">boolean</span></p> </div></td> <td><div class="ansible-option-cell">
<p>If set to <code>no</code>, SSL certificates will not be validated.</p> <p>This should only be used on sites using self-signed certificates.</p> <p class="ansible-option-line"><span class="ansible-option-choices">Choices:</span></p> <ul class="simple"> <li><span class="ansible-option-choices-entry">no</span></li> <li>
<span class="ansible-option-default-bold">yes</span> <span class="ansible-option-default">← (default)</span>
</li> </ul> </div></td> </tr>  </table> </section> <section id="notes"> <h2>Notes</h2> <div class="admonition note"> <p class="admonition-title">Note</p> <ul class="simple"> <li>This only deals with attributes on existing entries. To add or remove whole entries, see <a class="reference internal" href="ldap_entry_module#ansible-collections-community-general-ldap-entry-module"><span class="std std-ref">community.general.ldap_entry</span></a>.</li> <li>The default authentication settings will attempt to use a SASL EXTERNAL bind over a UNIX domain socket. This works well with the default Ubuntu install for example, which includes a cn=peercred,cn=external,cn=auth ACL rule allowing root to modify the server configuration. If you need to use a simple bind to access your server, pass the credentials in <em>bind_dn</em> and <em>bind_pw</em>.</li> <li>For <em>state=present</em> and <em>state=absent</em>, all value comparisons are performed on the server for maximum accuracy. For <em>state=exact</em>, values have to be compared in Python, which obviously ignores LDAP matching rules. This should work out in most cases, but it is theoretically possible to see spurious changes when target and actual values are semantically identical but lexically distinct.</li> </ul> </div> </section> <section id="examples"> <h2>Examples</h2> <pre data-language="yaml+jinja">- name: Configure directory number 1 for example.com
  community.general.ldap_attrs:
    dn: olcDatabase={1}hdb,cn=config
    attributes:
        olcSuffix: dc=example,dc=com
    state: exact

# The complex argument format is required here to pass a list of ACL strings.
- name: Set up the ACL
  community.general.ldap_attrs:
    dn: olcDatabase={1}hdb,cn=config
    attributes:
        olcAccess:
          - &gt;-
            {0}to attrs=userPassword,shadowLastChange
            by self write
            by anonymous auth
            by dn="cn=admin,dc=example,dc=com" write
            by * none'
          - &gt;-
            {1}to dn.base="dc=example,dc=com"
            by dn="cn=admin,dc=example,dc=com" write
            by * read
    state: exact

# An alternative approach with automatic X-ORDERED numbering
- name: Set up the ACL
  community.general.ldap_attrs:
    dn: olcDatabase={1}hdb,cn=config
    attributes:
        olcAccess:
          - &gt;-
            to attrs=userPassword,shadowLastChange
            by self write
            by anonymous auth
            by dn="cn=admin,dc=example,dc=com" write
            by * none'
          - &gt;-
            to dn.base="dc=example,dc=com"
            by dn="cn=admin,dc=example,dc=com" write
            by * read
    ordered: yes
    state: exact

- name: Declare some indexes
  community.general.ldap_attrs:
    dn: olcDatabase={1}hdb,cn=config
    attributes:
        olcDbIndex:
            - objectClass eq
            - uid eq

- name: Set up a root user, which we can use later to bootstrap the directory
  community.general.ldap_attrs:
    dn: olcDatabase={1}hdb,cn=config
    attributes:
        olcRootDN: cn=root,dc=example,dc=com
        olcRootPW: "{SSHA}tabyipcHzhwESzRaGA7oQ/SDoBZQOGND"
    state: exact

- name: Remove an attribute with a specific value
  community.general.ldap_attrs:
    dn: uid=jdoe,ou=people,dc=example,dc=com
    attributes:
        description: "An example user account"
    state: absent
    server_uri: ldap://localhost/
    bind_dn: cn=admin,dc=example,dc=com
    bind_pw: password

- name: Remove specified attribute(s) from an entry
  community.general.ldap_attrs:
    dn: uid=jdoe,ou=people,dc=example,dc=com
    attributes:
        description: []
    state: exact
    server_uri: ldap://localhost/
    bind_dn: cn=admin,dc=example,dc=com
    bind_pw: password
</pre> </section> <section id="return-values"> <h2>Return Values</h2> <p>Common return values are documented <a class="reference internal" href="../../../reference_appendices/common_return_values#common-return-values"><span class="std std-ref">here</span></a>, the following are the fields unique to this module:</p> <table class="colwidths-auto ansible-option-table docutils align-default" style="width: 100%"> <thead> <tr>
<th class="head"><p>Key</p></th> <th class="head"><p>Description</p></th> </tr> </thead>  <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-general-ldap-attrs-module-return-modlist"><strong>modlist</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">list</span> / <span class="ansible-option-elements">elements=string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>list of modified parameters</p> <p class="ansible-option-line"><span class="ansible-option-returned-bold">Returned:</span> success</p> <p class="ansible-option-line ansible-option-sample"><span class="ansible-option-sample-bold">Sample:</span> “[[2, \”olcRootDN\”, [\”cn=root,dc=example,dc=com\”]]]”</p> </div></td> </tr>  </table> <section id="authors"> <h3>Authors</h3> <ul class="simple"> <li>Jiri Tyr (@jtyr)</li> <li>Alexander Korinek (@noles)</li> <li>Maciej Delmanowski (@drybjed)</li> </ul> </section> <section id="collection-links"> <h3>Collection links</h3> <p class="ansible-links"> <a href="https://github.com/ansible-collections/community.general/issues" aria-role="button" target="_blank" rel="noopener external">Issue Tracker</a> <a href="https://github.com/ansible-collections/community.general" aria-role="button" target="_blank" rel="noopener external">Repository (Sources)</a> <a href="https://github.com/ansible-collections/community.general/issues/new?assignees=&amp;labels=&amp;template=bug_report.yml" aria-role="button" target="_blank" rel="noopener external">Submit a bug report</a> <a href="https://github.com/ansible-collections/community.general/issues/new?assignees=&amp;labels=&amp;template=feature_request.yml" aria-role="button" target="_blank" rel="noopener external">Request a feature</a> <a href="index#communication-for-community-general" aria-role="button" target="_blank">Communication</a> </p></section> </section> </section><div class="_attribution">
  <p class="_attribution-p">
    <a href="https://docs.ansible.com/ansible/latest/collections/community/general/ldap_attrs_module.html" class="_attribution-link" target="_blank">https://docs.ansible.com/ansible/latest/collections/community/general/ldap_attrs_module.html</a>
  </p>
</div>
