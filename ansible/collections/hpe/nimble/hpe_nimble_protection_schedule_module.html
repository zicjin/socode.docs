<section id="hpe-nimble-hpe-nimble-protection-schedule-module-manage-the-hpe-nimble-storage-protection-schedules"> <h1>hpe.nimble.hpe_nimble_protection_schedule module – Manage the HPE Nimble Storage protection schedules</h1> <div class="admonition note"> <p class="admonition-title">Note</p> <p>This module is part of the <a class="reference external" href="https://galaxy.ansible.com/hpe/nimble">hpe.nimble collection</a> (version 1.1.4).</p> <p>You might already have this collection installed if you are using the <code>ansible</code> package. It is not included in <code>ansible-core</code>. To check whether it is installed, run <code>ansible-galaxy collection list</code>.</p> <p>To install it, use: <code>ansible-galaxy collection install hpe.nimble</code>.</p> <p>To use it in a playbook, specify: <code>hpe.nimble.hpe_nimble_protection_schedule</code>.</p> </div> <div class="versionadded"> <p><span class="versionmodified added">New in version 1.0.0: </span>of hpe.nimble</p> </div>  <ul class="simple"> <li><a class="reference internal" href="#synopsis" id="id1">Synopsis</a></li> <li><a class="reference internal" href="#requirements" id="id2">Requirements</a></li> <li><a class="reference internal" href="#parameters" id="id3">Parameters</a></li> <li><a class="reference internal" href="#notes" id="id4">Notes</a></li> <li><a class="reference internal" href="#examples" id="id5">Examples</a></li> </ul>  <section id="synopsis"> <h2>Synopsis</h2> <ul class="simple"> <li>Manage the protection schedules on an HPE Nimble Storage group.</li> </ul> </section> <section id="requirements"> <h2>Requirements</h2> <p>The below requirements are needed on the host that executes this module.</p> <ul class="simple"> <li>Ansible 2.9 or later</li> <li>Python 3.6 or later</li> <li>HPE Nimble Storage SDK for Python</li> <li>HPE Nimble Storage arrays running NimbleOS 5.0 or later</li> </ul> </section> <section id="parameters"> <h2>Parameters</h2> <table class="colwidths-auto ansible-option-table docutils align-default" style="width: 100%"> <thead> <tr>
<th class="head"><p>Parameter</p></th> <th class="head"><p>Comments</p></th> </tr> </thead>  <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-hpe-nimble-hpe-nimble-protection-schedule-module-parameter-at-time"><strong>at_time</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">integer</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Time of day when snapshot should be taken. In case repeat frequency specifies more than one snapshot in a day then the until_time option specifies until what time of day to take snapshots.</p> <p class="ansible-option-line"><span class="ansible-option-default-bold">Default:</span> <span class="ansible-option-default">0</span></p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-hpe-nimble-hpe-nimble-protection-schedule-module-parameter-change-name"><strong>change_name</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Change the name of existing protection schedule.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-hpe-nimble-hpe-nimble-protection-schedule-module-parameter-days"><strong>days</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Specifies which days snapshots should be taken. Comma separated list of days of the week or ‘all’.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-hpe-nimble-hpe-nimble-protection-schedule-module-parameter-description"><strong>description</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Description of the schedule.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-hpe-nimble-hpe-nimble-protection-schedule-module-parameter-disable-appsync"><strong>disable_appsync</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">boolean</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Disables application synchronized snapshots and creates crash consistent snapshots instead.</p> <p class="ansible-option-line"><span class="ansible-option-choices">Choices:</span></p> <ul class="simple"> <li><span class="ansible-option-choices-entry">no</span></li> <li><span class="ansible-option-choices-entry">yes</span></li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-hpe-nimble-hpe-nimble-protection-schedule-module-parameter-downstream-partner"><strong>downstream_partner</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Specifies the partner name if snapshots created by this schedule should be replicated.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-hpe-nimble-hpe-nimble-protection-schedule-module-parameter-host"><strong>host</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span> / <span class="ansible-option-required">required</span></p> </div></td> <td><div class="ansible-option-cell">
<p>HPE Nimble Storage IP address.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-hpe-nimble-hpe-nimble-protection-schedule-module-parameter-name"><strong>name</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span> / <span class="ansible-option-required">required</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Name of the protection schedule to create.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-hpe-nimble-hpe-nimble-protection-schedule-module-parameter-num-retain"><strong>num_retain</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">integer</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Number of snapshots to retain. If replication is enabled on this schedule the array will always retain the latest replicated snapshot, which may exceed the specified retention value. This is necessary to ensure efficient replication performance.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-hpe-nimble-hpe-nimble-protection-schedule-module-parameter-num-retain-replica"><strong>num_retain_replica</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">integer</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Number of snapshots to retain on the replica.</p> <p class="ansible-option-line"><span class="ansible-option-default-bold">Default:</span> <span class="ansible-option-default">0</span></p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-hpe-nimble-hpe-nimble-protection-schedule-module-parameter-password"><strong>password</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span> / <span class="ansible-option-required">required</span></p> </div></td> <td><div class="ansible-option-cell">
<p>HPE Nimble Storage password.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-hpe-nimble-hpe-nimble-protection-schedule-module-parameter-period"><strong>period</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">integer</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Repeat interval for snapshots with respect to the period_unit. For example, a value of 2 with the ‘period_unit’ of ‘hours’ results in one snapshot every 2 hours.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-hpe-nimble-hpe-nimble-protection-schedule-module-parameter-period-unit"><strong>period_unit</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Time unit over which to take the number of snapshots specified in ‘period’. For example, a value of ‘days’ with a ‘period’ of ‘1’ results in one snapshot every day.</p> <p class="ansible-option-line"><span class="ansible-option-choices">Choices:</span></p> <ul class="simple"> <li><span class="ansible-option-choices-entry">minutes</span></li> <li><span class="ansible-option-choices-entry">hours</span></li> <li><span class="ansible-option-choices-entry">days</span></li> <li><span class="ansible-option-choices-entry">weeks</span></li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-hpe-nimble-hpe-nimble-protection-schedule-module-parameter-prot-template-name"><strong>prot_template_name</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Name of the protection template in which this protection schedule is attached to.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-hpe-nimble-hpe-nimble-protection-schedule-module-parameter-repl-alert-thres"><strong>repl_alert_thres</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">integer</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Replication alert threshold in seconds. If the replication of a snapshot takes more than this amount of time to complete an alert will be generated. Enter 0 to disable this alert.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-hpe-nimble-hpe-nimble-protection-schedule-module-parameter-replicate-every"><strong>replicate_every</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">integer</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Specifies which snapshots should be replicated. If snapshots are replicated and this option is not specified, every snapshot is replicated.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-hpe-nimble-hpe-nimble-protection-schedule-module-parameter-schedule-type"><strong>schedule_type</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Normal schedules have internal timers which drive snapshot creation. An externally driven schedule has no internal timers. All snapshot activity is driven by an external trigger. In other words, these schedules are used only for externally driven manual snapshots.</p> <p class="ansible-option-line"><span class="ansible-option-choices">Choices:</span></p> <ul class="simple"> <li><span class="ansible-option-choices-entry">regular</span></li> <li><span class="ansible-option-choices-entry">external_trigger</span></li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-hpe-nimble-hpe-nimble-protection-schedule-module-parameter-skip-db-consistency-check"><strong>skip_db_consistency_check</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">boolean</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Skip consistency check for database files on snapshots created by this schedule. This option only applies to snapshot schedules of a protection template with application synchronization set to VSS, application ID set to MS Exchange 2010 or later w/DAG, this schedule’s snap_verify option set to yes, and its disable_appsync option set to false. Skipping consistency checks is only recommended if each database in a DAG has multiple copies.</p> <p class="ansible-option-line"><span class="ansible-option-choices">Choices:</span></p> <ul class="simple"> <li><span class="ansible-option-choices-entry">no</span></li> <li><span class="ansible-option-choices-entry">yes</span></li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-hpe-nimble-hpe-nimble-protection-schedule-module-parameter-snap-verify"><strong>snap_verify</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">boolean</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Run verification tool on snapshot created by this schedule. This option can only be used with snapshot schedules of a protection template that has application synchronization. The tool used to verify snapshot depends on the type of application. For example, if application synchronization is VSS and the application ID is Exchange, eseutil tool is run on the snapshots. If verification fails, the logs are not truncated.</p> <p class="ansible-option-line"><span class="ansible-option-choices">Choices:</span></p> <ul class="simple"> <li><span class="ansible-option-choices-entry">no</span></li> <li><span class="ansible-option-choices-entry">yes</span></li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-hpe-nimble-hpe-nimble-protection-schedule-module-parameter-state"><strong>state</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span> / <span class="ansible-option-required">required</span></p> </div></td> <td><div class="ansible-option-cell">
<p>The protection schedule operations</p> <p class="ansible-option-line"><span class="ansible-option-choices">Choices:</span></p> <ul class="simple"> <li><span class="ansible-option-choices-entry">present</span></li> <li><span class="ansible-option-choices-entry">absent</span></li> <li><span class="ansible-option-choices-entry">create</span></li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-hpe-nimble-hpe-nimble-protection-schedule-module-parameter-until-time"><strong>until_time</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">integer</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Time of day to stop taking snapshots. Applicable only when repeat frequency specifies more than one snapshot in a day.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-hpe-nimble-hpe-nimble-protection-schedule-module-parameter-use-downstream-for-dr"><strong>use_downstream_for_DR</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">boolean</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Break synchronous replication for the specified volume collection and present downstream volumes to host(s). Downstream volumes in the volume collection will be set to online and presented to the host(s) using new serial and LUN numbers. No changes will be made to the upstream volumes, their serial and LUN numbers, and their online state. The existing ACLs on the upstream volumes will be copied to the downstream volumes. Use this in conjunction with an empty downstream_partner_id. This unconfigures synchronous replication when the partner is removed from the last replicating schedule in the specified volume collection and presents the downstream volumes to host(s). Host(s) will need to be configured to access the new volumes with the newly assigned serial and LUN numbers. Use this option to expose downstream volumes in a synchronously replicated volume collection to host(s) only when the upstream partner is confirmed to be down and there is no communication between partners. Do not execute this operation if a previous Group Management Service takeover has been performed on a different array. Do not perform a subsequent Group Management Service takeover on a different array as it will lead to irreconcilable conflicts. This limitation is cleared once the Group management service backup array has successfully synchronized after reconnection.</p> <p class="ansible-option-line"><span class="ansible-option-choices">Choices:</span></p> <ul class="simple"> <li><span class="ansible-option-choices-entry">no</span></li> <li><span class="ansible-option-choices-entry">yes</span></li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-hpe-nimble-hpe-nimble-protection-schedule-module-parameter-username"><strong>username</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span> / <span class="ansible-option-required">required</span></p> </div></td> <td><div class="ansible-option-cell">
<p>HPE Nimble Storage user name.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-hpe-nimble-hpe-nimble-protection-schedule-module-parameter-volcoll-name"><strong>volcoll_name</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Name of the volume collection in which this protection schedule is attached to.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-hpe-nimble-hpe-nimble-protection-schedule-module-parameter-volcoll-or-prottmpl-type"><strong>volcoll_or_prottmpl_type</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span> / <span class="ansible-option-required">required</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Type of the protection policy this schedule is attached to.</p> <p class="ansible-option-line"><span class="ansible-option-choices">Choices:</span></p> <ul class="simple"> <li><span class="ansible-option-choices-entry">protection_template</span></li> <li><span class="ansible-option-choices-entry">volume_collection</span></li> </ul> </div></td> </tr>  </table> </section> <section id="notes"> <h2>Notes</h2> <div class="admonition note"> <p class="admonition-title">Note</p> <ul class="simple"> <li>This module does not support <code>check_mode</code>.</li> </ul> </div> </section> <section id="examples"> <h2>Examples</h2> <pre data-language="yaml+jinja"># if state is create , then create a protection schedule if not present. Fails if already present.
# if state is present, then create a protection schedule if not present. Succeed if it already exists.
- name: Create protection schedule if not present
  hpe.nimble.hpe_nimble_protection_schedule:
    host: "{{ host }}"
    username: "{{ username }}"
    password: "{{ password }}"
    name: "{{ name }}"
    description: "{{ description | default(None)}}"
    state: "{{ state | default('present') }}"
    volcoll_or_prottmpl_type: "{{ volcoll_or_prottmpl_type }}"
    prot_template_name: "{{ prot_template_name }}"
    num_retain: "{{ num_retain }}"

- name: Delete protection schedule
  hpe.nimble.hpe_nimble_protection_schedule:
    host: "{{ host }}"
    username: "{{ username }}"
    password: "{{ password }}"
    name: "{{ name }}"
    volcoll_or_prottmpl_type: "{{ volcoll_or_prottmpl_type }}"
    volcoll_name: "{{ volcoll_name }}"
    state: absent
</pre> <section id="authors"> <h3>Authors</h3> <ul class="simple"> <li>Alok Ranjan (@ranjanal)</li> </ul> </section> <section id="collection-links"> <h3>Collection links</h3> <p class="ansible-links"> <a href="https://github.com/hpe-storage/nimble-ansible-modules/issues" aria-role="button" target="_blank" rel="noopener external">Issue Tracker</a> <a href="http://hpe.com/storage/nimble" aria-role="button" target="_blank" rel="noopener external">Homepage</a> <a href="https://github.com/hpe-storage/nimble-ansible-modules" aria-role="button" target="_blank" rel="noopener external">Repository (Sources)</a> </p></section> </section> </section><div class="_attribution">
  <p class="_attribution-p">
    <a href="https://docs.ansible.com/ansible/latest/collections/hpe/nimble/hpe_nimble_protection_schedule_module.html" class="_attribution-link" target="_blank">https://docs.ansible.com/ansible/latest/collections/hpe/nimble/hpe_nimble_protection_schedule_module.html</a>
  </p>
</div>
