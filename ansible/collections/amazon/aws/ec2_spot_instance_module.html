<h1 id="amazon-aws-ec2-spot-instance-request-stop-reboot-or-cancel-spot-instance">amazon.aws.ec2_spot_instance – request, stop, reboot or cancel spot instance</h1> <div class="admonition note"> <p class="admonition-title">Note</p> <p>This plugin is part of the <a class="reference external" href="https://galaxy.ansible.com/amazon/aws">amazon.aws collection</a> (version 2.1.0).</p> <p>You might already have this collection installed if you are using the <code>ansible</code> package. It is not included in <code>ansible-core</code>. To check whether it is installed, run <code>ansible-galaxy collection list</code>.</p> <p>To install it, use: <code>ansible-galaxy collection install amazon.aws</code>.</p> <p>To use it in a playbook, specify: <code>amazon.aws.ec2_spot_instance</code>.</p> </div> <div class="versionadded"> <p><span class="versionmodified added">New in version 2.0.0: </span>of amazon.aws</p> </div>  <ul class="simple"> <li><a class="reference internal" href="#synopsis" id="id1">Synopsis</a></li> <li><a class="reference internal" href="#requirements" id="id2">Requirements</a></li> <li><a class="reference internal" href="#parameters" id="id3">Parameters</a></li> <li><a class="reference internal" href="#notes" id="id4">Notes</a></li> <li><a class="reference internal" href="#examples" id="id5">Examples</a></li> <li><a class="reference internal" href="#return-values" id="id6">Return Values</a></li> </ul>   <h2 id="synopsis">Synopsis</h2> <ul class="simple"> <li>Creates or cancels spot instance requests.</li> </ul>   <h2 id="requirements">Requirements</h2> <p>The below requirements are needed on the host that executes this module.</p> <ul class="simple"> <li>python &gt;= 3.6</li> <li>boto3 &gt;= 1.15.0</li> <li>botocore &gt;= 1.18.0</li> </ul>   <h2 id="parameters">Parameters</h2> <table class="documentation-table"> <tr> <th colspan="4">Parameter</th> <th>Choices/Defaults</th> <th width="100%">Comments</th> </tr> <tr> <td colspan="4">  <b>aws_access_key</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>
<code>AWS access key</code>. If not set then the value of the <code>AWS_ACCESS_KEY_ID</code>, <code>AWS_ACCESS_KEY</code> or <code>EC2_ACCESS_KEY</code> environment variable is used.</div> <div>If <em>profile</em> is set this parameter is ignored.</div> <div>Passing the <em>aws_access_key</em> and <em>profile</em> options at the same time has been deprecated and the options will be made mutually exclusive after 2022-06-01.</div> <div>
<br>aliases: ec2_access_key, access_key</div> </td> </tr> <tr> <td colspan="4">  <b>aws_ca_bundle</b>  <div> <span>path</span> </div> </td> <td> </td> <td> <div>The location of a CA Bundle to use when validating SSL certificates.</div> <div>Not used by boto 2 based modules.</div> <div>Note: The CA Bundle is read 'module' side and may need to be explicitly copied from the controller if not run locally.</div> </td> </tr> <tr> <td colspan="4">  <b>aws_config</b>  <div> <span>dictionary</span> </div> </td> <td> </td> <td> <div>A dictionary to modify the botocore configuration.</div> <div>Parameters can be found at <a href="https://botocore.amazonaws.com/v1/documentation/api/latest/reference/config.html#botocore.config.Config">https://botocore.amazonaws.com/v1/documentation/api/latest/reference/config.html#botocore.config.Config</a>.</div> <div>Only the 'user_agent' key is used for boto modules. See <a href="http://boto.cloudhackers.com/en/latest/boto_config_tut.html#boto">http://boto.cloudhackers.com/en/latest/boto_config_tut.html#boto</a> for more boto configuration.</div> </td> </tr> <tr> <td colspan="4">  <b>aws_secret_key</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>
<code>AWS secret key</code>. If not set then the value of the <code>AWS_SECRET_ACCESS_KEY</code>, <code>AWS_SECRET_KEY</code>, or <code>EC2_SECRET_KEY</code> environment variable is used.</div> <div>If <em>profile</em> is set this parameter is ignored.</div> <div>Passing the <em>aws_secret_key</em> and <em>profile</em> options at the same time has been deprecated and the options will be made mutually exclusive after 2022-06-01.</div> <div>
<br>aliases: ec2_secret_key, secret_key</div> </td> </tr> <tr> <td colspan="4">  <b>client_token</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>The idempotency token you provided when you launched the instance, if applicable.</div> </td> </tr> <tr> <td colspan="4">  <b>count</b>  <div> <span>integer</span> </div> </td> <td> <b>Default:</b><br><div>1</div> </td> <td> <div>Number of instances to launch.</div> </td> </tr> <tr> <td colspan="4">  <b>debug_botocore_endpoint_logs</b>  <div> <span>boolean</span> </div> </td> <td> <ul>
<b>Choices:</b> <li><div>
<b>no</b> ←</div></li> <li>yes</li> </ul> </td> <td> <div>Use a botocore.endpoint logger to parse the unique (rather than total) "resource:action" API calls made during a task, outputing the set to the resource_actions key in the task results. Use the aws_resource_action callback to output to total list made during a playbook. The ANSIBLE_DEBUG_BOTOCORE_LOGS environment variable may also be used.</div> </td> </tr> <tr> <td colspan="4">  <b>ec2_url</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>URL to use to connect to EC2 or your Eucalyptus cloud (by default the module will use EC2 endpoints). Ignored for modules where region is required. Must be specified for all other modules if region is not used. If not set then the value of the EC2_URL environment variable, if any, is used.</div> <div>
<br>aliases: aws_endpoint_url, endpoint_url</div> </td> </tr> <tr> <td colspan="4">  <b>interruption</b>  <div> <span>string</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>hibernate</li> <li>stop</li> <li><div>
<b>terminate</b> ←</div></li> </ul> </td> <td> <div>The behavior when a Spot Instance is interrupted.</div> </td> </tr> <tr> <td colspan="4">  <b>launch_group</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Launch group for spot requests, see <a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/how-spot-instances-work.html#spot-launch-group">https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/how-spot-instances-work.html#spot-launch-group</a>.</div> </td> </tr> <tr> <td colspan="4">  <b>launch_specification</b>  <div> <span>dictionary</span> </div> </td> <td> </td> <td> <div>The launch specification.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="3">  <b>block_device_mappings</b>  <div> <span>list</span> / <span>elements=dictionary</span> </div> </td> <td> </td> <td> <div>A list of hash/dictionaries of volumes to add to the new instance.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="2">  <b>device_name</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>The device name (for example, /dev/sdh or xvdh ).</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="2">  <b>ebs</b>  <div> <span>dictionary</span> </div> </td> <td> </td> <td> <div>Parameters used to automatically set up EBS volumes when the instance is launched, see <a href="https://boto3.amazonaws.com/v1/documentation/api/latest/reference/services/ec2.html#EC2.Client.request_spot_instances">https://boto3.amazonaws.com/v1/documentation/api/latest/reference/services/ec2.html#EC2.Client.request_spot_instances</a>
</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="2">  <b>no_device</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>To omit the device from the block device mapping, specify an empty string.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="2">  <b>virtual_name</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>The virtual device name</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="3">  <b>ebs_optimized</b>  <div> <span>boolean</span> </div> </td> <td> <ul>
<b>Choices:</b> <li><div>
<b>no</b> ←</div></li> <li>yes</li> </ul> </td> <td> <div>Whether instance is using optimized EBS volumes, see <a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/EBSOptimized.html">https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/EBSOptimized.html</a>.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="3">  <b>iam_instance_profile</b>  <div> <span>dictionary</span> </div> </td> <td> </td> <td> <div>The IAM instance profile.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="2">  <b>arn</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>The Amazon Resource Name (ARN) of the instance profile.</div> <div>Only one of <em>arn</em> or <em>name</em> may be specified.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="2">  <b>name</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>The name of the instance profile.</div> <div>Only one of <em>arn</em> or <em>name</em> may be specified.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="3">  <b>image_id</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>The ID of the AMI.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="3">  <b>instance_type</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Instance type to use for the instance, see <a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/instance-types.html">https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/instance-types.html</a>.</div> <div>Required when creating a new instance.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="3">  <b>kernel_id</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>The ID of the kernel.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="3">  <b>key_name</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Key to use on the instance.</div> <div>The SSH key must already exist in AWS in order to use this argument.</div> <div>Keys can be created / deleted using the <a href="ec2_key_module" class="module">amazon.aws.ec2_key</a> module.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="3">  <b>monitoring</b>  <div> <span>dictionary</span> </div> </td> <td> </td> <td> <div>Indicates whether basic or detailed monitoring is enabled for the instance.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="2">  <b>enabled</b>  <div> <span>boolean</span> </div> </td> <td> <ul>
<b>Choices:</b> <li><div>
<b>no</b> ←</div></li> <li>yes</li> </ul> </td> <td> <div>Indicates whether detailed monitoring is enabled. Otherwise, basic monitoring is enabled.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="3">  <b>network_interfaces</b>  <div> <span>list</span> / <span>elements=dictionary</span> </div> </td> <td> </td> <td> <div>One or more network interfaces. If you specify a network interface, you must specify subnet IDs and security group IDs using the network interface.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="2">  <b>associate_carrier_ip_address</b>  <div> <span>boolean</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>no</li> <li>yes</li> </ul> </td> <td> <div>Indicates whether to assign a carrier IP address to the network interface.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="2">  <b>associate_public_ip_address</b>  <div> <span>boolean</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>no</li> <li>yes</li> </ul> </td> <td> <div>Indicates whether to assign a public IPv4 address to an instance you launch in a VPC.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="2">  <b>delete_on_termination</b>  <div> <span>boolean</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>no</li> <li>yes</li> </ul> </td> <td> <div>If set to true , the interface is deleted when the instance is terminated. You can specify true only if creating a new network interface when launching an instance.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="2">  <b>description</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>The description of the network interface. Applies only if creating a network interface when launching an instance.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="2">  <b>device_index</b>  <div> <span>integer</span> </div> </td> <td> </td> <td> <div>The position of the network interface in the attachment order. A primary network interface has a device index of 0.</div> <div>If you specify a network interface when launching an instance, you must specify the device index.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="2">  <b>groups</b>  <div> <span>list</span> / <span>elements=string</span> </div> </td> <td> </td> <td> <div>The IDs of the security groups for the network interface. Applies only if creating a network interface when launching an instance.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="2">  <b>interface_type</b>  <div> <span>string</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>interface</li> <li>efa</li> </ul> </td> <td> <div>The type of network interface.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="2">  <b>ipv4_prefix_count</b>  <div> <span>integer</span> </div> </td> <td> </td> <td> <div>The number of IPv4 delegated prefixes to be automatically assigned to the network interface</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="2">  <b>ipv4_prefixes</b>  <div> <span>list</span> / <span>elements=dictionary</span> </div> </td> <td> </td> <td> <div>One or more IPv4 delegated prefixes to be assigned to the network interface.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="2">  <b>ipv6_address_count</b>  <div> <span>integer</span> </div> </td> <td> </td> <td> <div>A number of IPv6 addresses to assign to the network interface</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="2">  <b>ipv6_addresses</b>  <div> <span>list</span> / <span>elements=dictionary</span> </div> </td> <td> </td> <td> <div>One or more IPv6 addresses to assign to the network interface.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="1">  <b>ipv6address</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>The IPv6 address.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="2">  <b>ipv6_prefix_count</b>  <div> <span>integer</span> </div> </td> <td> </td> <td> <div>The number of IPv6 delegated prefixes to be automatically assigned to the network interface</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="2">  <b>ipv6_prefixes</b>  <div> <span>list</span> / <span>elements=dictionary</span> </div> </td> <td> </td> <td> <div>One or more IPv6 delegated prefixes to be assigned to the network interface</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="2">  <b>network_card_index</b>  <div> <span>integer</span> </div> </td> <td> </td> <td> <div>The index of the network card.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="2">  <b>network_interface_id</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>The ID of the network interface.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="2">  <b>private_ip_address</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>The private IPv4 address of the network interface</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="2">  <b>private_ip_addresses</b>  <div> <span>list</span> / <span>elements=dictionary</span> </div> </td> <td> </td> <td> <div>One or more private IPv4 addresses to assign to the network interface</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="2">  <b>secondary_private_ip_address_count</b>  <div> <span>integer</span> </div> </td> <td> </td> <td> <div>The number of secondary private IPv4 addresses.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="2">  <b>subnet_id</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>The ID of the subnet associated with the network interface</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="3">  <b>placement</b>  <div> <span>dictionary</span> </div> </td> <td> </td> <td> <div>The placement information for the instance.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="2">  <b>availability_zone</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>The Availability Zone.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="2">  <b>group_name</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>The name of the placement group.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="2">  <b>tenancy</b>  <div> <span>string</span> </div> </td> <td> <ul>
<b>Choices:</b> <li><div>
<b>default</b> ←</div></li> <li>dedicated</li> <li>host</li> </ul> </td> <td> <div>the tenancy of the host</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="3">  <b>ramdisk_id</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>The ID of the RAM disk.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="3">  <b>security_group_ids</b>  <div> <span>list</span> / <span>elements=string</span> </div> </td> <td> </td> <td> <div>Security group id (or list of ids) to use with the instance.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="3">  <b>security_groups</b>  <div> <span>list</span> / <span>elements=string</span> </div> </td> <td> </td> <td> <div>Security group name (or list of group names) to use with the instance.</div> <div>Only supported with EC2 Classic. To launch in a VPC, use <code>group_id</code>
</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="3">  <b>subnet_id</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>The ID of the subnet in which to launch the instance.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="3">  <b>user_data</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>The base64-encoded user data for the instance. User data is limited to 16 KB.</div> </td> </tr> <tr> <td colspan="4">  <b>profile</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Using <em>profile</em> will override <em>aws_access_key</em>, <em>aws_secret_key</em> and <em>security_token</em> and support for passing them at the same time as <em>profile</em> has been deprecated.</div> <div>
<em>aws_access_key</em>, <em>aws_secret_key</em> and <em>security_token</em> will be made mutually exclusive with <em>profile</em> after 2022-06-01.</div> <div>
<br>aliases: aws_profile</div> </td> </tr> <tr> <td colspan="4">  <b>region</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>The AWS region to use. If not specified then the value of the AWS_REGION or EC2_REGION environment variable, if any, is used. See <a href="http://docs.aws.amazon.com/general/latest/gr/rande.html#ec2_region">http://docs.aws.amazon.com/general/latest/gr/rande.html#ec2_region</a>
</div> <div>
<br>aliases: aws_region, ec2_region</div> </td> </tr> <tr> <td colspan="4">  <b>security_token</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>
<code>AWS STS security token</code>. If not set then the value of the <code>AWS_SECURITY_TOKEN</code> or <code>EC2_SECURITY_TOKEN</code> environment variable is used.</div> <div>If <em>profile</em> is set this parameter is ignored.</div> <div>Passing the <em>security_token</em> and <em>profile</em> options at the same time has been deprecated and the options will be made mutually exclusive after 2022-06-01.</div> <div>
<br>aliases: aws_security_token, access_token</div> </td> </tr> <tr> <td colspan="4">  <b>spot_instance_request_ids</b>  <div> <span>list</span> / <span>elements=string</span> </div> </td> <td> <b>Default:</b><br><div>[]</div> </td> <td> <div>List of strings with IDs of spot requests to be cancelled</div> </td> </tr> <tr> <td colspan="4">  <b>spot_price</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Maximum spot price to bid. If not set, a regular on-demand instance is requested.</div> <div>A spot request is made with this maximum bid. When it is filled, the instance is started.</div> </td> </tr> <tr> <td colspan="4">  <b>spot_type</b>  <div> <span>string</span> </div> </td> <td> <ul>
<b>Choices:</b> <li><div>
<b>one-time</b> ←</div></li> <li>persistent</li> </ul> </td> <td> <div>The type of spot request.</div> <div>After being interrupted a <code>persistent</code> spot instance will be started once there is capacity to fill the request again.</div> </td> </tr> <tr> <td colspan="4">  <b>state</b>  <div> <span>string</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>absent</li> <li><div>
<b>present</b> ←</div></li> </ul> </td> <td> <div>Whether the spot request should be created or removed.</div> <div>When <em>state=present</em>, <em>launch_specification</em> is required.</div> <div>When <em>state=absent</em>, <em>spot_instance_request_ids</em> is required.</div> </td> </tr> <tr> <td colspan="4">  <b>tags</b>  <div> <span>dictionary</span> </div> </td> <td> </td> <td> <div>A dictionary of key-value pairs for tagging the Spot Instance request on creation.</div> </td> </tr> <tr> <td colspan="4">  <b>validate_certs</b>  <div> <span>boolean</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>no</li> <li><div>
<b>yes</b> ←</div></li> </ul> </td> <td> <div>When set to "no", SSL certificates will not be validated for communication with the AWS APIs.</div> </td> </tr> <tr> <td colspan="4">  <b>zone_group</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Name for logical grouping of spot requests.</div> <div>All spot instances in the request are launched in the same availability zone.</div> </td> </tr> </table> <br>  <h2 id="notes">Notes</h2> <div class="admonition note"> <p class="admonition-title">Note</p> <ul class="simple"> <li>If parameters are not set within the module, the following environment variables can be used in decreasing order of precedence <code>AWS_URL</code> or <code>EC2_URL</code>, <code>AWS_PROFILE</code> or <code>AWS_DEFAULT_PROFILE</code>, <code>AWS_ACCESS_KEY_ID</code> or <code>AWS_ACCESS_KEY</code> or <code>EC2_ACCESS_KEY</code>, <code>AWS_SECRET_ACCESS_KEY</code> or <code>AWS_SECRET_KEY</code> or <code>EC2_SECRET_KEY</code>, <code>AWS_SECURITY_TOKEN</code> or <code>EC2_SECURITY_TOKEN</code>, <code>AWS_REGION</code> or <code>EC2_REGION</code>, <code>AWS_CA_BUNDLE</code>
</li> <li>When no credentials are explicitly provided the AWS SDK (boto3) that Ansible uses will fall back to its configuration files (typically <code>~/.aws/credentials</code>). See <a class="reference external" href="https://boto3.amazonaws.com/v1/documentation/api/latest/guide/credentials.html">https://boto3.amazonaws.com/v1/documentation/api/latest/guide/credentials.html</a> for more information.</li> <li>Modules based on the original AWS SDK (boto) may read their default configuration from different files. See <a class="reference external" href="https://boto.readthedocs.io/en/latest/boto_config_tut.html">https://boto.readthedocs.io/en/latest/boto_config_tut.html</a> for more information.</li> <li>
<code>AWS_REGION</code> or <code>EC2_REGION</code> can be typically be used to specify the AWS region, when required, but this can also be defined in the configuration files.</li> </ul> </div>   <h2 id="examples">Examples</h2> <pre data-language="yaml+jinja"># Note: These examples do not set authentication details, see the AWS Guide for details.

- name: Simple Spot Request Creation
  amazon.aws.ec2_spot_instance:
    launch_specification:
      image_id: ami-123456789
      key_name: my-keypair
      instance_type: t2.medium

- name: Spot Request Creation with more options
  amazon.aws.ec2_spot_instance:
    launch_specification:
      image_id: ami-123456789
      key_name: my-keypair
      instance_type: t2.medium
      subnet_id: subnet-12345678
      block_device_mappings:
        - device_name: /dev/sdb
          ebs:
            delete_on_termination: True
            volume_type: gp3
            volume_size: 5
        - device_name: /dev/sdc
          ebs:
            delete_on_termination: True
            volume_type: io2
            volume_size: 30
      network_interfaces:
        - associate_public_ip_address: False
          delete_on_termination: True
          device_index: 0
      placement:
        availability_zone: us-west-2a
      monitoring:
        enabled: False
    spot_price: 0.002
    tags:
      Environment: Testing

- name: Spot Request Termination
  amazon.aws.ec2_spot_instance:
    spot_instance_request_ids: ['sir-12345678', 'sir-abcdefgh']
    state: absent
</pre>   <h2 id="return-values">Return Values</h2> <p>Common return values are documented <a class="reference internal" href="../../../reference_appendices/common_return_values#common-return-values"><span class="std std-ref">here</span></a>, the following are the fields unique to this module:</p> <table class="documentation-table"> <tr> <th colspan="1">Key</th> <th>Returned</th> <th width="100%">Description</th> </tr> <tr> <td colspan="1">  <b>cancelled_spot_request</b>  <div> <span>string</span> </div> </td> <td>always</td> <td> <div>The spot instance request details that has been cancelled</div> <br> <div><b>Sample:</b></div> <div>Spot requests with IDs: sir-1234abcd have been cancelled</div> </td> </tr> <tr> <td colspan="1">  <b>spot_request</b>  <div> <span>dictionary</span> </div> </td> <td>when success</td> <td> <div>The spot instance request details after creation</div> <br> <div><b>Sample:</b></div> <div>{'create_time': '2021-08-23T22:59:12+00:00', 'instance_interruption_behavior': 'terminate', 'launch_specification': {'block_device_mappings': [{'device_name': '/dev/sdb', 'ebs': {'delete_on_termination': True, 'volume_size': 5, 'volume_type': 'gp3'}}], 'ebs_optimized': False, 'iam_instance_profile': {'arn': 'arn:aws:iam::EXAMPLE:instance-profile/myinstanceprofile'}, 'image_id': 'ami-083ac7c7ecf9bb9b0', 'instance_type': 't2.small', 'key_name': 'mykey', 'monitoring': {'enabled': False}, 'network_interfaces': [{'associate_public_ip_address': False, 'delete_on_termination': True, 'device_index': 0}], 'placement': {'availability_zone': 'us-west-2a', 'tenancy': 'default'}, 'security_groups': [{'group_name': 'default'}]}, 'product_description': 'Linux/UNIX', 'spot_instance_request_id': 'sir-1234abcd', 'spot_price': '0.00600', 'state': 'open', 'status': {'code': 'pending-evaluation', 'message': 'Your Spot request has been submitted for review, and is pending evaluation.', 'update_time': '2021-08-23T22:59:12+00:00'}, 'type': 'one-time'}</div> </td> </tr> </table> <br><br> <h3 id="authors">Authors</h3> <ul class="simple"> <li>Sri Rachana Achyuthuni (@srirachanaachyuthuni)</li> </ul><div class="_attribution">
  <p class="_attribution-p">
    <a href="https://docs.ansible.com/ansible/latest/collections/amazon/aws/ec2_spot_instance_module.html" class="_attribution-link" target="_blank">https://docs.ansible.com/ansible/latest/collections/amazon/aws/ec2_spot_instance_module.html</a>
  </p>
</div>
