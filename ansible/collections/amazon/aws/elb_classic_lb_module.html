<h1 id="amazon-aws-elb-classic-lb-creates-updates-or-destroys-an-amazon-elb">amazon.aws.elb_classic_lb – creates, updates or destroys an Amazon ELB.</h1> <div class="admonition note"> <p class="admonition-title">Note</p> <p>This plugin is part of the <a class="reference external" href="https://galaxy.ansible.com/amazon/aws">amazon.aws collection</a> (version 2.1.0).</p> <p>You might already have this collection installed if you are using the <code>ansible</code> package. It is not included in <code>ansible-core</code>. To check whether it is installed, run <code>ansible-galaxy collection list</code>.</p> <p>To install it, use: <code>ansible-galaxy collection install amazon.aws</code>.</p> <p>To use it in a playbook, specify: <code>amazon.aws.elb_classic_lb</code>.</p> </div> <div class="versionadded"> <p><span class="versionmodified added">New in version 1.0.0: </span>of amazon.aws</p> </div>  <ul class="simple"> <li><a class="reference internal" href="#synopsis" id="id1">Synopsis</a></li> <li><a class="reference internal" href="#requirements" id="id2">Requirements</a></li> <li><a class="reference internal" href="#parameters" id="id3">Parameters</a></li> <li><a class="reference internal" href="#notes" id="id4">Notes</a></li> <li><a class="reference internal" href="#examples" id="id5">Examples</a></li> <li><a class="reference internal" href="#return-values" id="id6">Return Values</a></li> </ul>   <h2 id="synopsis">Synopsis</h2> <ul class="simple"> <li>Creates, updates or destroys an Amazon Elastic Load Balancer (ELB).</li> <li>This module was renamed from <code>amazon.aws.ec2_elb_lb</code> to <a class="reference internal" href="#ansible-collections-amazon-aws-elb-classic-lb-module"><span class="std std-ref">amazon.aws.elb_classic_lb</span></a> in version 2.1.0 of the amazon.aws collection.</li> </ul>   <h2 id="requirements">Requirements</h2> <p>The below requirements are needed on the host that executes this module.</p> <ul class="simple"> <li>python &gt;= 3.6</li> <li>boto3 &gt;= 1.15.0</li> <li>botocore &gt;= 1.18.0</li> </ul>   <h2 id="parameters">Parameters</h2> <table class="documentation-table"> <tr> <th colspan="2">Parameter</th> <th>Choices/Defaults</th> <th width="100%">Comments</th> </tr> <tr> <td colspan="2">  <b>access_logs</b>  <div> <span>dictionary</span> </div> </td> <td> </td> <td> <div>A dictionary of access logs configuration settings (see examples).</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>enabled</b>  <div> <span>boolean</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>no</li> <li><div>
<b>yes</b> ←</div></li> </ul> </td> <td> <div>When set to <code>True</code> will configure delivery of access logs to an S3 bucket.</div> <div>When set to <code>False</code> will disable delivery of access logs.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>interval</b>  <div> <span>integer</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>5</li> <li>60</li> </ul> <b>Default:</b><br><div>60</div> </td> <td> <div>The interval for publishing the access logs to S3.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>s3_location</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>The S3 bucket to deliver access logs to.</div> <div>See <a href="https://docs.aws.amazon.com/elasticloadbalancing/latest/classic/enable-access-logs.html">https://docs.aws.amazon.com/elasticloadbalancing/latest/classic/enable-access-logs.html</a> for more information about the necessary S3 bucket policies.</div> <div>Required when <em>enabled=True</em>.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>s3_prefix</b>  <div> <span>string</span> </div> </td> <td> <b>Default:</b><br><div>""</div> </td> <td> <div>Where in the S3 bucket to deliver the logs.</div> <div>If the prefix is not provided or set to <code>""</code>, the log is placed at the root level of the bucket.</div> </td> </tr> <tr> <td colspan="2">  <b>aws_access_key</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>
<code>AWS access key</code>. If not set then the value of the <code>AWS_ACCESS_KEY_ID</code>, <code>AWS_ACCESS_KEY</code> or <code>EC2_ACCESS_KEY</code> environment variable is used.</div> <div>If <em>profile</em> is set this parameter is ignored.</div> <div>Passing the <em>aws_access_key</em> and <em>profile</em> options at the same time has been deprecated and the options will be made mutually exclusive after 2022-06-01.</div> <div>
<br>aliases: ec2_access_key, access_key</div> </td> </tr> <tr> <td colspan="2">  <b>aws_ca_bundle</b>  <div> <span>path</span> </div> </td> <td> </td> <td> <div>The location of a CA Bundle to use when validating SSL certificates.</div> <div>Not used by boto 2 based modules.</div> <div>Note: The CA Bundle is read 'module' side and may need to be explicitly copied from the controller if not run locally.</div> </td> </tr> <tr> <td colspan="2">  <b>aws_config</b>  <div> <span>dictionary</span> </div> </td> <td> </td> <td> <div>A dictionary to modify the botocore configuration.</div> <div>Parameters can be found at <a href="https://botocore.amazonaws.com/v1/documentation/api/latest/reference/config.html#botocore.config.Config">https://botocore.amazonaws.com/v1/documentation/api/latest/reference/config.html#botocore.config.Config</a>.</div> <div>Only the 'user_agent' key is used for boto modules. See <a href="http://boto.cloudhackers.com/en/latest/boto_config_tut.html#boto">http://boto.cloudhackers.com/en/latest/boto_config_tut.html#boto</a> for more boto configuration.</div> </td> </tr> <tr> <td colspan="2">  <b>aws_secret_key</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>
<code>AWS secret key</code>. If not set then the value of the <code>AWS_SECRET_ACCESS_KEY</code>, <code>AWS_SECRET_KEY</code>, or <code>EC2_SECRET_KEY</code> environment variable is used.</div> <div>If <em>profile</em> is set this parameter is ignored.</div> <div>Passing the <em>aws_secret_key</em> and <em>profile</em> options at the same time has been deprecated and the options will be made mutually exclusive after 2022-06-01.</div> <div>
<br>aliases: ec2_secret_key, secret_key</div> </td> </tr> <tr> <td colspan="2">  <b>connection_draining_timeout</b>  <div> <span>integer</span> </div> </td> <td> </td> <td> <div>Wait a specified timeout allowing connections to drain before terminating an instance.</div> <div>Set to <code>0</code> to disable connection draining.</div> </td> </tr> <tr> <td colspan="2">  <b>cross_az_load_balancing</b>  <div> <span>boolean</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>no</li> <li>yes</li> </ul> </td> <td> <div>Distribute load across all configured Availability Zones.</div> <div>Defaults to <code>false</code>.</div> </td> </tr> <tr> <td colspan="2">  <b>debug_botocore_endpoint_logs</b>  <div> <span>boolean</span> </div> </td> <td> <ul>
<b>Choices:</b> <li><div>
<b>no</b> ←</div></li> <li>yes</li> </ul> </td> <td> <div>Use a botocore.endpoint logger to parse the unique (rather than total) "resource:action" API calls made during a task, outputing the set to the resource_actions key in the task results. Use the aws_resource_action callback to output to total list made during a playbook. The ANSIBLE_DEBUG_BOTOCORE_LOGS environment variable may also be used.</div> </td> </tr> <tr> <td colspan="2">  <b>ec2_url</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>URL to use to connect to EC2 or your Eucalyptus cloud (by default the module will use EC2 endpoints). Ignored for modules where region is required. Must be specified for all other modules if region is not used. If not set then the value of the EC2_URL environment variable, if any, is used.</div> <div>
<br>aliases: aws_endpoint_url, endpoint_url</div> </td> </tr> <tr> <td colspan="2">  <b>health_check</b>  <div> <span>dictionary</span> </div> </td> <td> </td> <td> <div>A dictionary of health check configuration settings (see examples).</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>healthy_threshold</b>  <div> <span>integer</span> / <span>required</span> </div> </td> <td> </td> <td> <div>The number of consecutive health checks successes required before moving the instance to the Healthy state.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>interval</b>  <div> <span>integer</span> / <span>required</span> </div> </td> <td> </td> <td> <div>The approximate interval, in seconds, between health checks of an individual instance.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>ping_path</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>The URI path which the ELB health check will query when performing a health check.</div> <div>Required when <em>ping_protocol=HTTP</em> or <em>ping_protocol=HTTPS</em>.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>ping_port</b>  <div> <span>integer</span> / <span>required</span> </div> </td> <td> </td> <td> <div>The TCP port to which the ELB will connect when performing a health check.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>ping_protocol</b>  <div> <span>string</span> / <span>required</span> </div> </td> <td> </td> <td> <div>The protocol which the ELB health check will use when performing a health check.</div> <div>Valid values are <code>'HTTP'</code>, <code>'HTTPS'</code>, <code>'TCP'</code> and <code>'SSL'</code>.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>timeout</b>  <div> <span>integer</span> / <span>required</span> </div> </td> <td> </td> <td> <div>The amount of time, in seconds, after which no response means a failed health check.</div> <div>
<br>aliases: response_timeout</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>unhealthy_threshold</b>  <div> <span>integer</span> / <span>required</span> </div> </td> <td> </td> <td> <div>The number of consecutive health check failures required before moving the instance to the Unhealthy state.</div> </td> </tr> <tr> <td colspan="2">  <b>idle_timeout</b>  <div> <span>integer</span> </div> </td> <td> </td> <td> <div>ELB connections from clients and to servers are timed out after this amount of time.</div> </td> </tr> <tr> <td colspan="2">  <b>instance_ids</b>  <div> <span>list</span> / <span>elements=string</span> </div> </td> <td> </td> <td> <div>List of instance ids to attach to this ELB.</div> </td> </tr> <tr> <td colspan="2">  <b>listeners</b>  <div> <span>list</span> / <span>elements=dictionary</span> </div> </td> <td> </td> <td> <div>List of ports/protocols for this ELB to listen on (see examples).</div> <div>Required when <em>state=present</em> and the ELB doesn't exist.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>instance_port</b>  <div> <span>integer</span> / <span>required</span> </div> </td> <td> </td> <td> <div>The port on which the instance is listening.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>instance_protocol</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>The protocol to use for routing traffic to instances.</div> <div>Valid values are <code>HTTP</code>, <code>HTTPS</code>, <code>TCP</code>, or <code>SSL</code>,</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>load_balancer_port</b>  <div> <span>integer</span> / <span>required</span> </div> </td> <td> </td> <td> <div>The port on which the load balancer will listen.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>protocol</b>  <div> <span>string</span> / <span>required</span> </div> </td> <td> </td> <td> <div>The transport protocol to use for routing.</div> <div>Valid values are <code>HTTP</code>, <code>HTTPS</code>, <code>TCP</code>, or <code>SSL</code>.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>proxy_protocol</b>  <div> <span>boolean</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>no</li> <li>yes</li> </ul> </td> <td> <div>Enable proxy protocol for the listener.</div> <div>Beware, ELB controls for the proxy protocol are based on the <em>instance_port</em>. If you have multiple listeners talking to the same <em>instance_port</em>, this will affect all of them.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>ssl_certificate_id</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>The Amazon Resource Name (ARN) of the SSL certificate.</div> </td> </tr> <tr> <td colspan="2">  <b>name</b>  <div> <span>string</span> / <span>required</span> </div> </td> <td> </td> <td> <div>The name of the ELB.</div> <div>The name of an ELB must be less than 32 characters and unique per-region per-account.</div> </td> </tr> <tr> <td colspan="2">  <b>profile</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Using <em>profile</em> will override <em>aws_access_key</em>, <em>aws_secret_key</em> and <em>security_token</em> and support for passing them at the same time as <em>profile</em> has been deprecated.</div> <div>
<em>aws_access_key</em>, <em>aws_secret_key</em> and <em>security_token</em> will be made mutually exclusive with <em>profile</em> after 2022-06-01.</div> <div>
<br>aliases: aws_profile</div> </td> </tr> <tr> <td colspan="2">  <b>purge_instance_ids</b>  <div> <span>boolean</span> </div> </td> <td> <ul>
<b>Choices:</b> <li><div>
<b>no</b> ←</div></li> <li>yes</li> </ul> </td> <td> <div>Purge existing instance ids on ELB that are not found in <em>instance_ids</em>.</div> </td> </tr> <tr> <td colspan="2">  <b>purge_listeners</b>  <div> <span>boolean</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>no</li> <li><div>
<b>yes</b> ←</div></li> </ul> </td> <td> <div>Purge existing listeners on ELB that are not found in listeners.</div> </td> </tr> <tr> <td colspan="2">  <b>purge_subnets</b>  <div> <span>boolean</span> </div> </td> <td> <ul>
<b>Choices:</b> <li><div>
<b>no</b> ←</div></li> <li>yes</li> </ul> </td> <td> <div>Purge existing subnets on the ELB that are not found in <em>subnets</em>.</div> <div>Because it is not permitted to add multiple subnets from the same availability zone, subnets to be purged will be removed before new subnets are added. This may cause a brief outage if you try to replace all subnets at once.</div> </td> </tr> <tr> <td colspan="2">  <b>purge_tags</b>  <div> <span>boolean</span> </div> <div> added in 2.1.0 of amazon.aws </div> </td> <td> <ul>
<b>Choices:</b> <li>no</li> <li><div>
<b>yes</b> ←</div></li> </ul> </td> <td> <div>Whether to remove existing tags that aren't passed in the <em>tags</em> parameter.</div> </td> </tr> <tr> <td colspan="2">  <b>purge_zones</b>  <div> <span>boolean</span> </div> </td> <td> <ul>
<b>Choices:</b> <li><div>
<b>no</b> ←</div></li> <li>yes</li> </ul> </td> <td> <div>Purge existing availability zones on ELB that are not found in <em>zones</em>.</div> </td> </tr> <tr> <td colspan="2">  <b>region</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>The AWS region to use. If not specified then the value of the AWS_REGION or EC2_REGION environment variable, if any, is used. See <a href="http://docs.aws.amazon.com/general/latest/gr/rande.html#ec2_region">http://docs.aws.amazon.com/general/latest/gr/rande.html#ec2_region</a>
</div> <div>
<br>aliases: aws_region, ec2_region</div> </td> </tr> <tr> <td colspan="2">  <b>scheme</b>  <div> <span>string</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>internal</li> <li>internet-facing</li> </ul> </td> <td> <div>The scheme to use when creating the ELB.</div> <div>For a private VPC-visible ELB use <code>internal</code>.</div> <div>If you choose to update your scheme with a different value the ELB will be destroyed and a new ELB created.</div> <div>Defaults to <em>scheme=internet-facing</em>.</div> </td> </tr> <tr> <td colspan="2">  <b>security_group_ids</b>  <div> <span>list</span> / <span>elements=string</span> </div> </td> <td> </td> <td> <div>A list of security groups to apply to the ELB.</div> </td> </tr> <tr> <td colspan="2">  <b>security_group_names</b>  <div> <span>list</span> / <span>elements=string</span> </div> </td> <td> </td> <td> <div>A list of security group names to apply to the ELB.</div> </td> </tr> <tr> <td colspan="2">  <b>security_token</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>
<code>AWS STS security token</code>. If not set then the value of the <code>AWS_SECURITY_TOKEN</code> or <code>EC2_SECURITY_TOKEN</code> environment variable is used.</div> <div>If <em>profile</em> is set this parameter is ignored.</div> <div>Passing the <em>security_token</em> and <em>profile</em> options at the same time has been deprecated and the options will be made mutually exclusive after 2022-06-01.</div> <div>
<br>aliases: aws_security_token, access_token</div> </td> </tr> <tr> <td colspan="2">  <b>state</b>  <div> <span>string</span> / <span>required</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>absent</li> <li>present</li> </ul> </td> <td> <div>Create or destroy the ELB.</div> </td> </tr> <tr> <td colspan="2">  <b>stickiness</b>  <div> <span>dictionary</span> </div> </td> <td> </td> <td> <div>A dictionary of stickiness policy settings.</div> <div>Policy will be applied to all listeners (see examples).</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>cookie</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>The name of the application cookie used for stickiness.</div> <div>Required if <em>enabled=true</em> and <em>type=application</em>.</div> <div>Ignored if <em>enabled=false</em>.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>enabled</b>  <div> <span>boolean</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>no</li> <li><div>
<b>yes</b> ←</div></li> </ul> </td> <td> <div>When <em>enabled=false</em> session stickiness will be disabled for all listeners.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>expiration</b>  <div> <span>integer</span> </div> </td> <td> </td> <td> <div>The time period, in seconds, after which the cookie should be considered stale.</div> <div>If this parameter is not specified, the stickiness session lasts for the duration of the browser session.</div> <div>Ignored if <em>enabled=false</em>.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>type</b>  <div> <span>string</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>application</li> <li>loadbalancer</li> </ul> </td> <td> <div>The type of stickiness policy to apply.</div> <div>Required if <em>enabled=true</em>.</div> <div>Ignored if <em>enabled=false</em>.</div> </td> </tr> <tr> <td colspan="2">  <b>subnets</b>  <div> <span>list</span> / <span>elements=string</span> </div> </td> <td> </td> <td> <div>A list of VPC subnets to use when creating the ELB.</div> <div>Mutually exclusive with <em>zones</em>.</div> </td> </tr> <tr> <td colspan="2">  <b>tags</b>  <div> <span>dictionary</span> </div> </td> <td> </td> <td> <div>A dictionary of tags to apply to the ELB.</div> <div>To delete all tags supply an empty dict (<code>{}</code>) and set <em>purge_tags=true</em>.</div> </td> </tr> <tr> <td colspan="2">  <b>validate_certs</b>  <div> <span>boolean</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>no</li> <li><div>
<b>yes</b> ←</div></li> </ul> </td> <td> <div>When set to "no", SSL certificates will not be validated for communication with the AWS APIs.</div> </td> </tr> <tr> <td colspan="2">  <b>wait</b>  <div> <span>boolean</span> </div> </td> <td> <ul>
<b>Choices:</b> <li><div>
<b>no</b> ←</div></li> <li>yes</li> </ul> </td> <td> <div>When creating, deleting, or adding instances to an ELB, if <em>wait=true</em> Ansible will wait for both the load balancer and related network interfaces to finish creating/deleting.</div> <div>Support for waiting when adding instances was added in release 2.1.0.</div> </td> </tr> <tr> <td colspan="2">  <b>wait_timeout</b>  <div> <span>integer</span> </div> </td> <td> <b>Default:</b><br><div>180</div> </td> <td> <div>Used in conjunction with wait. Number of seconds to wait for the ELB to be terminated.</div> <div>A maximum of 600 seconds (10 minutes) is allowed.</div> </td> </tr> <tr> <td colspan="2">  <b>zones</b>  <div> <span>list</span> / <span>elements=string</span> </div> </td> <td> </td> <td> <div>List of availability zones to enable on this ELB.</div> <div>Mutually exclusive with <em>subnets</em>.</div> </td> </tr> </table> <br>  <h2 id="notes">Notes</h2> <div class="admonition note"> <p class="admonition-title">Note</p> <ul class="simple"> <li>The ec2_elb fact currently set by this module has been deprecated and will no longer be set after release 4.0.0 of the collection.</li> <li>If parameters are not set within the module, the following environment variables can be used in decreasing order of precedence <code>AWS_URL</code> or <code>EC2_URL</code>, <code>AWS_PROFILE</code> or <code>AWS_DEFAULT_PROFILE</code>, <code>AWS_ACCESS_KEY_ID</code> or <code>AWS_ACCESS_KEY</code> or <code>EC2_ACCESS_KEY</code>, <code>AWS_SECRET_ACCESS_KEY</code> or <code>AWS_SECRET_KEY</code> or <code>EC2_SECRET_KEY</code>, <code>AWS_SECURITY_TOKEN</code> or <code>EC2_SECURITY_TOKEN</code>, <code>AWS_REGION</code> or <code>EC2_REGION</code>, <code>AWS_CA_BUNDLE</code>
</li> <li>When no credentials are explicitly provided the AWS SDK (boto3) that Ansible uses will fall back to its configuration files (typically <code>~/.aws/credentials</code>). See <a class="reference external" href="https://boto3.amazonaws.com/v1/documentation/api/latest/guide/credentials.html">https://boto3.amazonaws.com/v1/documentation/api/latest/guide/credentials.html</a> for more information.</li> <li>Modules based on the original AWS SDK (boto) may read their default configuration from different files. See <a class="reference external" href="https://boto.readthedocs.io/en/latest/boto_config_tut.html">https://boto.readthedocs.io/en/latest/boto_config_tut.html</a> for more information.</li> <li>
<code>AWS_REGION</code> or <code>EC2_REGION</code> can be typically be used to specify the AWS region, when required, but this can also be defined in the configuration files.</li> </ul> </div>   <h2 id="examples">Examples</h2> <pre data-language="yaml+jinja"># Note: None of these examples set aws_access_key, aws_secret_key, or region.
# It is assumed that their matching environment variables are set.

# Basic provisioning example (non-VPC)

- amazon.aws.elb_classic_lb:
    name: "test-please-delete"
    state: present
    zones:
      - us-east-1a
      - us-east-1d
    listeners:
      - protocol: http # options are http, https, ssl, tcp
        load_balancer_port: 80
        instance_port: 80
        proxy_protocol: True
      - protocol: https
        load_balancer_port: 443
        instance_protocol: http # optional, defaults to value of protocol setting
        instance_port: 80
        # ssl certificate required for https or ssl
        ssl_certificate_id: "arn:aws:iam::123456789012:server-certificate/company/servercerts/ProdServerCert"

# Internal ELB example

- amazon.aws.elb_classic_lb:
    name: "test-vpc"
    scheme: internal
    state: present
    instance_ids:
      - i-abcd1234
    purge_instance_ids: true
    subnets:
      - subnet-abcd1234
      - subnet-1a2b3c4d
    listeners:
      - protocol: http # options are http, https, ssl, tcp
        load_balancer_port: 80
        instance_port: 80

# Configure a health check and the access logs
- amazon.aws.elb_classic_lb:
    name: "test-please-delete"
    state: present
    zones:
      - us-east-1d
    listeners:
      - protocol: http
        load_balancer_port: 80
        instance_port: 80
    health_check:
        ping_protocol: http # options are http, https, ssl, tcp
        ping_port: 80
        ping_path: "/index.html" # not required for tcp or ssl
        response_timeout: 5 # seconds
        interval: 30 # seconds
        unhealthy_threshold: 2
        healthy_threshold: 10
    access_logs:
        interval: 5 # minutes (defaults to 60)
        s3_location: "my-bucket" # This value is required if access_logs is set
        s3_prefix: "logs"

# Ensure ELB is gone
- amazon.aws.elb_classic_lb:
    name: "test-please-delete"
    state: absent

# Ensure ELB is gone and wait for check (for default timeout)
- amazon.aws.elb_classic_lb:
    name: "test-please-delete"
    state: absent
    wait: yes

# Ensure ELB is gone and wait for check with timeout value
- amazon.aws.elb_classic_lb:
    name: "test-please-delete"
    state: absent
    wait: yes
    wait_timeout: 600

# Normally, this module will purge any listeners that exist on the ELB
# but aren't specified in the listeners parameter. If purge_listeners is
# false it leaves them alone
- amazon.aws.elb_classic_lb:
    name: "test-please-delete"
    state: present
    zones:
      - us-east-1a
      - us-east-1d
    listeners:
      - protocol: http
        load_balancer_port: 80
        instance_port: 80
    purge_listeners: no

# Normally, this module will leave availability zones that are enabled
# on the ELB alone. If purge_zones is true, then any extraneous zones
# will be removed
- amazon.aws.elb_classic_lb:
    name: "test-please-delete"
    state: present
    zones:
      - us-east-1a
      - us-east-1d
    listeners:
      - protocol: http
        load_balancer_port: 80
        instance_port: 80
    purge_zones: yes

# Creates a ELB and assigns a list of subnets to it.
- amazon.aws.elb_classic_lb:
    state: present
    name: 'New ELB'
    security_group_ids: 'sg-123456, sg-67890'
    subnets: 'subnet-123456,subnet-67890'
    purge_subnets: yes
    listeners:
      - protocol: http
        load_balancer_port: 80
        instance_port: 80

# Create an ELB with connection draining, increased idle timeout and cross availability
# zone load balancing
- amazon.aws.elb_classic_lb:
    name: "New ELB"
    state: present
    connection_draining_timeout: 60
    idle_timeout: 300
    cross_az_load_balancing: "yes"
    zones:
      - us-east-1a
      - us-east-1d
    listeners:
      - protocol: http
        load_balancer_port: 80
        instance_port: 80

# Create an ELB with load balancer stickiness enabled
- amazon.aws.elb_classic_lb:
    name: "New ELB"
    state: present
    zones:
      - us-east-1a
      - us-east-1d
    listeners:
      - protocol: http
        load_balancer_port: 80
        instance_port: 80
    stickiness:
      type: loadbalancer
      enabled: yes
      expiration: 300

# Create an ELB with application stickiness enabled
- amazon.aws.elb_classic_lb:
    name: "New ELB"
    state: present
    zones:
      - us-east-1a
      - us-east-1d
    listeners:
      - protocol: http
        load_balancer_port: 80
        instance_port: 80
    stickiness:
      type: application
      enabled: yes
      cookie: SESSIONID

# Create an ELB and add tags
- amazon.aws.elb_classic_lb:
    name: "New ELB"
    state: present
    zones:
      - us-east-1a
      - us-east-1d
    listeners:
      - protocol: http
        load_balancer_port: 80
        instance_port: 80
    tags:
      Name: "New ELB"
      stack: "production"
      client: "Bob"

# Delete all tags from an ELB
- amazon.aws.elb_classic_lb:
    name: "New ELB"
    state: present
    zones:
      - us-east-1a
      - us-east-1d
    listeners:
      - protocol: http
        load_balancer_port: 80
        instance_port: 80
    tags: {}
</pre>   <h2 id="return-values">Return Values</h2> <p>Common return values are documented <a class="reference internal" href="../../../reference_appendices/common_return_values#common-return-values"><span class="std std-ref">here</span></a>, the following are the fields unique to this module:</p> <table class="documentation-table"> <tr> <th colspan="3">Key</th> <th>Returned</th> <th width="100%">Description</th> </tr> <tr> <td colspan="3">  <b>elb</b>  <div> <span>dictionary</span> </div> </td> <td>always</td> <td> <div>Load Balancer attributes</div> <br> </td> </tr> <tr> <td class="elbow-placeholder"> </td> <td colspan="2">  <b>app_cookie_policy</b>  <div> <span>string</span> </div> </td> <td>when state is not 'absent'</td> <td> <div>The name of the policy used to control if the ELB is using a application cookie stickiness policy.</div> <br> <div><b>Sample:</b></div> <div>ec2-elb-lb-AppCookieStickinessPolicyType</div> </td> </tr> <tr> <td class="elbow-placeholder"> </td> <td colspan="2">  <b>backends</b>  <div> <span>string</span> </div> </td> <td>when state is not 'absent'</td> <td> <div>A description of the backend policy applied to the ELB (instance-port:policy-name).</div> <br> <div><b>Sample:</b></div> <div>8181:ProxyProtocol-policy</div> </td> </tr> <tr> <td class="elbow-placeholder"> </td> <td colspan="2">  <b>connection_draining_timeout</b>  <div> <span>integer</span> </div> </td> <td>when state is not 'absent'</td> <td> <div>The maximum time, in seconds, to keep the existing connections open before deregistering the instances.</div> <br> <div><b>Sample:</b></div> <div>25</div> </td> </tr> <tr> <td class="elbow-placeholder"> </td> <td colspan="2">  <b>cross_az_load_balancing</b>  <div> <span>string</span> </div> </td> <td>when state is not 'absent'</td> <td> <div>Either <code>'yes'</code> if cross-AZ load balancing is enabled, or <code>'no'</code> if cross-AZ load balancing is disabled.</div> <br> <div><b>Sample:</b></div> <div>yes</div> </td> </tr> <tr> <td class="elbow-placeholder"> </td> <td colspan="2">  <b>dns_name</b>  <div> <span>string</span> </div> </td> <td>when state is not 'absent'</td> <td> <div>The DNS name of the ELB.</div> <br> <div><b>Sample:</b></div> <div>internal-ansible-test-935c585850ac-1516306744.us-east-1.elb.amazonaws.com</div> </td> </tr> <tr> <td class="elbow-placeholder"> </td> <td colspan="2">  <b>health_check</b>  <div> <span>dictionary</span> </div> </td> <td>when state is not 'absent'</td> <td> <div>A dictionary describing the health check used for the ELB.</div> <br> </td> </tr> <tr> <td class="elbow-placeholder"> </td> <td class="elbow-placeholder"> </td> <td colspan="1">  <b>healthy_threshold</b>  <div> <span>integer</span> </div> </td> <td>success</td> <td> <div>The number of consecutive successful health checks before marking an instance as healthy.</div> <br> <div><b>Sample:</b></div> <div>2</div> </td> </tr> <tr> <td class="elbow-placeholder"> </td> <td class="elbow-placeholder"> </td> <td colspan="1">  <b>interval</b>  <div> <span>integer</span> </div> </td> <td>success</td> <td> <div>The time, in seconds, between each health check.</div> <br> <div><b>Sample:</b></div> <div>10</div> </td> </tr> <tr> <td class="elbow-placeholder"> </td> <td class="elbow-placeholder"> </td> <td colspan="1">  <b>target</b>  <div> <span>string</span> </div> </td> <td>success</td> <td> <div>The Protocol, Port, and for HTTP(S) health checks the path tested by the health check.</div> <br> <div><b>Sample:</b></div> <div>TCP:22</div> </td> </tr> <tr> <td class="elbow-placeholder"> </td> <td class="elbow-placeholder"> </td> <td colspan="1">  <b>timeout</b>  <div> <span>integer</span> </div> </td> <td>success</td> <td> <div>The time, in seconds, after which an in progress health check is considered failed due to a timeout.</div> <br> <div><b>Sample:</b></div> <div>5</div> </td> </tr> <tr> <td class="elbow-placeholder"> </td> <td class="elbow-placeholder"> </td> <td colspan="1">  <b>unhealthy_threshold</b>  <div> <span>integer</span> </div> </td> <td>success</td> <td> <div>The number of consecutive failed health checks before marking an instance as unhealthy.</div> <br> <div><b>Sample:</b></div> <div>2</div> </td> </tr> <tr> <td class="elbow-placeholder"> </td> <td colspan="2">  <b>hosted_zone_id</b>  <div> <span>string</span> </div> </td> <td>when state is not 'absent'</td> <td> <div>The ID of the Amazon Route 53 hosted zone for the load balancer.</div> <br> <div><b>Sample:</b></div> <div>Z35SXDOTRQ7X7K</div> </td> </tr> <tr> <td class="elbow-placeholder"> </td> <td colspan="2">  <b>hosted_zone_name</b>  <div> <span>string</span> </div> </td> <td>when state is not 'absent'</td> <td> <div>The DNS name of the load balancer when using a custom hostname.</div> <br> <div><b>Sample:</b></div> <div>ansible-module.example</div> </td> </tr> <tr> <td class="elbow-placeholder"> </td> <td colspan="2">  <b>idle_timeout</b>  <div> <span>integer</span> </div> </td> <td>when state is not 'absent'</td> <td> <div>The length of of time before an idle connection is dropped by the ELB.</div> <br> <div><b>Sample:</b></div> <div>50</div> </td> </tr> <tr> <td class="elbow-placeholder"> </td> <td colspan="2">  <b>in_service_count</b>  <div> <span>integer</span> </div> </td> <td>when state is not 'absent'</td> <td> <div>The number of instances attached to the ELB in an in-service state.</div> <br> <div><b>Sample:</b></div> <div>1</div> </td> </tr> <tr> <td class="elbow-placeholder"> </td> <td colspan="2">  <b>instance_health</b>  <div> <span>list</span> / <span>elements=dictionary</span> </div> </td> <td>when state is not 'absent'</td> <td> <div>A list of dictionaries describing the health of each instance attached to the ELB.</div> <br> </td> </tr> <tr> <td class="elbow-placeholder"> </td> <td class="elbow-placeholder"> </td> <td colspan="1">  <b>description</b>  <div> <span>string</span> </div> </td> <td>when state is not 'absent'</td> <td> <div>A human readable description of why the instance is not in service.</div> <br> <div><b>Sample:</b></div> <div>N/A</div> </td> </tr> <tr> <td class="elbow-placeholder"> </td> <td class="elbow-placeholder"> </td> <td colspan="1">  <b>instance_id</b>  <div> <span>string</span> </div> </td> <td>when state is not 'absent'</td> <td> <div>The ID of the instance.</div> <br> <div><b>Sample:</b></div> <div>i-03dcc8953a03d6435</div> </td> </tr> <tr> <td class="elbow-placeholder"> </td> <td class="elbow-placeholder"> </td> <td colspan="1">  <b>reason_code</b>  <div> <span>string</span> </div> </td> <td>when state is not 'absent'</td> <td> <div>A code describing why the instance is not in service.</div> <br> <div><b>Sample:</b></div> <div>N/A</div> </td> </tr> <tr> <td class="elbow-placeholder"> </td> <td class="elbow-placeholder"> </td> <td colspan="1">  <b>state</b>  <div> <span>string</span> </div> </td> <td>when state is not 'absent'</td> <td> <div>The current service state of the instance.</div> <br> <div><b>Sample:</b></div> <div>InService</div> </td> </tr> <tr> <td class="elbow-placeholder"> </td> <td colspan="2">  <b>instances</b>  <div> <span>list</span> / <span>elements=string</span> </div> </td> <td>when state is not 'absent'</td> <td> <div>A list of the IDs of instances attached to the ELB.</div> <br> <div><b>Sample:</b></div> <div>['i-03dcc8953a03d6435']</div> </td> </tr> <tr> <td class="elbow-placeholder"> </td> <td colspan="2">  <b>lb_cookie_policy</b>  <div> <span>string</span> </div> </td> <td>when state is not 'absent'</td> <td> <div>The name of the policy used to control if the ELB is using a cookie stickiness policy.</div> <br> <div><b>Sample:</b></div> <div>ec2-elb-lb-LBCookieStickinessPolicyType</div> </td> </tr> <tr> <td class="elbow-placeholder"> </td> <td colspan="2">  <b>listeners</b>  <div> <span>list</span> / <span>elements=list</span> </div> </td> <td>when state is not 'absent'</td> <td> <div>A list of lists describing the listeners attached to the ELB.</div> <div>The nested list contains the listener port, the instance port, the listener protoco, the instance port, and where appropriate the ID of the SSL certificate for the port.</div> <br> <div><b>Sample:</b></div> <div>[[22, 22, 'TCP', 'TCP'], [80, 8181, 'HTTP', 'HTTP']]</div> </td> </tr> <tr> <td class="elbow-placeholder"> </td> <td colspan="2">  <b>name</b>  <div> <span>string</span> </div> </td> <td>when state is not 'absent'</td> <td> <div>The name of the ELB. This name is unique per-region, per-account.</div> <br> <div><b>Sample:</b></div> <div>ansible-test-935c585850ac</div> </td> </tr> <tr> <td class="elbow-placeholder"> </td> <td colspan="2">  <b>out_of_service_count</b>  <div> <span>integer</span> </div> </td> <td>when state is not 'absent'</td> <td> <div>The number of instances attached to the ELB in an out-of-service state.</div> <br> </td> </tr> <tr> <td class="elbow-placeholder"> </td> <td colspan="2">  <b>proxy_policy</b>  <div> <span>string</span> </div> </td> <td>when the proxy protocol policy exists.</td> <td> <div>The name of the policy used to control if the ELB operates using the Proxy protocol.</div> <br> <div><b>Sample:</b></div> <div>ProxyProtocol-policy</div> </td> </tr> <tr> <td class="elbow-placeholder"> </td> <td colspan="2">  <b>region</b>  <div> <span>string</span> </div> </td> <td>always</td> <td> <div>The AWS region in which the ELB is running.</div> <br> <div><b>Sample:</b></div> <div>us-east-1</div> </td> </tr> <tr> <td class="elbow-placeholder"> </td> <td colspan="2">  <b>scheme</b>  <div> <span>string</span> </div> </td> <td>when state is not 'absent'</td> <td> <div>Whether the ELB is an <code>'internal'</code> or a <code>'internet-facing'</code> load balancer.</div> <br> <div><b>Sample:</b></div> <div>internal</div> </td> </tr> <tr> <td class="elbow-placeholder"> </td> <td colspan="2">  <b>security_group_ids</b>  <div> <span>list</span> / <span>elements=string</span> </div> </td> <td>when state is not 'absent'</td> <td> <div>A list of the IDs of the Security Groups attached to the ELB.</div> <br> <div><b>Sample:</b></div> <div>['sg-0c12ebd82f2fb97dc', 'sg-01ec7378d0c7342e6']</div> </td> </tr> <tr> <td class="elbow-placeholder"> </td> <td colspan="2">  <b>status</b>  <div> <span>string</span> </div> </td> <td>always</td> <td> <div>A minimal description of the current state of the ELB. Valid values are <code>'exists'</code>, <code>'gone'</code>, <code>'deleted'</code>, <code>'created'</code>.</div> <br> <div><b>Sample:</b></div> <div>exists</div> </td> </tr> <tr> <td class="elbow-placeholder"> </td> <td colspan="2">  <b>subnets</b>  <div> <span>list</span> / <span>elements=string</span> </div> </td> <td>when state is not 'absent'</td> <td> <div>A list of the subnet IDs attached to the ELB.</div> <br> <div><b>Sample:</b></div> <div>['subnet-00d9d0f70c7e5f63c', 'subnet-03fa5253586b2d2d5']</div> </td> </tr> <tr> <td class="elbow-placeholder"> </td> <td colspan="2">  <b>tags</b>  <div> <span>dictionary</span> </div> </td> <td>when state is not 'absent'</td> <td> <div>A dictionary describing the tags attached to the ELB.</div> <br> <div><b>Sample:</b></div> <div>{'ExampleTag': 'Example Value', 'Name': 'ansible-test-935c585850ac'}</div> </td> </tr> <tr> <td class="elbow-placeholder"> </td> <td colspan="2">  <b>unknown_instance_state_count</b>  <div> <span>integer</span> </div> </td> <td>when state is not 'absent'</td> <td> <div>The number of instances attached to the ELB in an unknown state.</div> <br> </td> </tr> <tr> <td class="elbow-placeholder"> </td> <td colspan="2">  <b>zones</b>  <div> <span>list</span> / <span>elements=string</span> </div> </td> <td>when state is not 'absent'</td> <td> <div>A list of the AWS regions in which the ELB is running.</div> <br> <div><b>Sample:</b></div> <div>['us-east-1b', 'us-east-1a']</div> </td> </tr> </table> <br><br> <h3 id="authors">Authors</h3> <ul class="simple"> <li>Jim Dalton (@jsdalton)</li> <li>Mark Chappell (@tremble)</li> </ul><div class="_attribution">
  <p class="_attribution-p">
    <a href="https://docs.ansible.com/ansible/latest/collections/amazon/aws/elb_classic_lb_module.html" class="_attribution-link" target="_blank">https://docs.ansible.com/ansible/latest/collections/amazon/aws/elb_classic_lb_module.html</a>
  </p>
</div>
