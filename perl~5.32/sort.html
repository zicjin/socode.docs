<h1>sort</h1>    <h2><a id="toc">CONTENTS</a></h2> <ul> <li> <a class="text-decoration-none" href="#NAME">NAME</a> </li> <li> <a class="text-decoration-none" href="#SYNOPSIS">SYNOPSIS</a> </li> <li> <a class="text-decoration-none" href="#DESCRIPTION">DESCRIPTION</a> </li> <li> <a class="text-decoration-none" href="#CAVEATS">CAVEATS</a> </li> </ul> <h2 id="NAME">NAME</h2> <p>sort - perl pragma to control sort() behaviour</p> <h2 id="SYNOPSIS">SYNOPSIS</h2> <pre data-language="perl"><code class="prettyprint">use sort 'stable';          # guarantee stability
use sort 'defaults';        # revert to default behavior
no  sort 'stable';          # stability not important

my $current;
BEGIN {
    $current = sort::current();     # identify prevailing pragmata
}</code></pre> <h2 id="DESCRIPTION">DESCRIPTION</h2> <p>With the <code>sort</code> pragma you can control the behaviour of the builtin <code>sort()</code> function.</p> <p>A stable sort means that for records that compare equal, the original input ordering is preserved. Stability will matter only if elements that compare equal can be distinguished in some other way. That means that simple numerical and lexical sorts do not profit from stability, since equal elements are indistinguishable. However, with a comparison such as</p> <pre data-language="perl"><code class="prettyprint">{ substr($a, 0, 3) cmp substr($b, 0, 3) }</code></pre> <p>stability might matter because elements that compare equal on the first 3 characters may be distinguished based on subsequent characters.</p> <p>Whether sorting is stable by default is an accident of implementation that can change (and has changed) between Perl versions. If stability is important, be sure to say so with a</p> <pre data-language="perl"><code class="prettyprint">use sort 'stable';</code></pre> <p>The <code>no sort</code> pragma doesn't <i>forbid</i> what follows, it just leaves the choice open. Thus, after</p> <pre data-language="perl"><code class="prettyprint">no sort 'stable';</code></pre> <p>sorting may happen to be stable anyway.</p> <h2 id="CAVEATS">CAVEATS</h2> <p>As of Perl 5.10, this pragma is lexically scoped and takes effect at compile time. In earlier versions its effect was global and took effect at run-time; the documentation suggested using <code>eval()</code> to change the behaviour:</p> <pre data-language="perl"><code class="prettyprint">{ eval 'no sort "stable"';      # stability not wanted
  print sort::current . "\n";
  @a = sort @b;
  eval 'use sort "defaults"';   # clean up, for others
}
{ eval 'use sort qw(defaults stable)';     # force stability
  print sort::current . "\n";
  @c = sort @d;
  eval 'use sort "defaults"';   # clean up, for others
}</code></pre> <p>Such code no longer has the desired effect, for two reasons. Firstly, the use of <code>eval()</code> means that the sorting algorithm is not changed until runtime, by which time it's too late to have any effect. Secondly, <code>sort::current</code> is also called at run-time, when in fact the compile-time value of <code>sort::current</code> is the one that matters.</p> <p>So now this code would be written:</p> <pre data-language="perl"><code class="prettyprint">{ no sort "stable";      # stability not wanted
  my $current;
  BEGIN { $current = sort::current; }
  print "$current\n";
  @a = sort @b;
  # Pragmas go out of scope at the end of the block
}
{ use sort qw(defaults stable);     # force stability
  my $current;
  BEGIN { $current = sort::current; }
  print "$current\n";
  @c = sort @d;
}</code></pre><div class="_attribution">
  <p class="_attribution-p">
    &copy; 1993&ndash;2020 Larry Wall and others<br>Licensed under the GNU General Public License version 1 or later, or the Artistic License.<br>The Perl logo is a trademark of the Perl Foundation.<br>
    <a href="https://perldoc.perl.org/5.32.0/sort" class="_attribution-link">https://perldoc.perl.org/5.32.0/sort</a>
  </p>
</div>
