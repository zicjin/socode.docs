 <div class="theme-default-content content__default">
<h1 id="frontmatter-title"> Data Option <div class="migration-badge-wrapper" data-v-cb310528><span class="migration-badge is-breaking" data-v-cb310528> breaking </span></div>
</h1> <h2 id="overview"> Overview</h2> <ul>
<li><p><strong>BREAKING</strong>: <code>data</code> component option declaration no longer accepts a plain JavaScript <code>object</code> and expects a <code>function</code> declaration.</p></li> <li><p><strong>BREAKING</strong>: when merging multiple <code>data</code> return values from mixins or extends, the merge is now shallow instead of deep (only root-level properties are merged).</p></li>
</ul> <h2 id="_2-x-syntax"> 2.x Syntax</h2> <p>In 2.x, developers could define the <code>data</code> option with either an <code>object</code> or a <code>function</code>.</p> <p>For example:</p> <div class="language-html line-numbers-mode">
<pre class="language-html" data-language="javascript">&lt;!-- Object Declaration --&gt;
&lt;script&gt;
  const app = new Vue({
    data: {
      apiKey: 'a1b2c3'
    }
  })
&lt;/script&gt;

&lt;!-- Function Declaration --&gt;
&lt;script&gt;
  const app = new Vue({
    data() {
      return {
        apiKey: 'a1b2c3'
      }
    }
  })
&lt;/script&gt;</pre> </div>
<p>Though this provided some convenience in terms of root instances having a shared state, this has led to confusion due to the fact that its only possible on the root instance.</p> <h2 id="_3-x-update"> 3.x Update</h2> <p>In 3.x, the <code>data</code> option has been standardized to only accept a <code>function</code> that returns an <code>object</code>.</p> <p>Using the example above, there would only be one possible implementation of the code:</p> <div class="language-html line-numbers-mode">
<pre class="language-html" data-language="javascript">&lt;script&gt;
  import { createApp } from 'vue'

  createApp({
    data() {
      return {
        apiKey: 'a1b2c3'
      }
    }
  }).mount('#app')
&lt;/script&gt;</pre> </div>
<h2 id="mixin-merge-behavior-change"> Mixin Merge Behavior Change</h2> <p>In addition, when <code>data()</code> from a component and its mixins or extends base are merged, the merge is now performed <em>shallowly</em>:</p> <div class="language-js line-numbers-mode">
<pre class="language-js" data-language="javascript">const Mixin = {
  data() {
    return {
      user: {
        name: 'Jack',
        id: 1
      }
    }
  }
}

const CompA = {
  mixins: [Mixin],
  data() {
    return {
      user: {
        id: 2
      }
    }
  }
}</pre> </div>
<p>In Vue 2.x, the resulting <code>$data</code> is:</p> <div class="language-json line-numbers-mode">
<pre class="language-json" data-language="javascript">{
  "user": {
    "id": 2,
    "name": "Jack"
  }
}</pre> </div>
<p>In 3.0, the result will be:</p> <div class="language-json line-numbers-mode">
<pre class="language-json" data-language="javascript">{
  "user": {
    "id": 2
  }
}</pre> </div>
<p><a href="migration-build#compat-configuration">Migration build flag: <code>OPTIONS_DATA_FN</code></a></p> <h2 id="migration-strategy"> Migration Strategy</h2> <p>For users relying on the object declaration, we recommend:</p> <ul>
<li>Extracting the shared data into an external object and using it as a property in <code>data</code>
</li> <li>Rewrite references to the shared data to point to a new shared object</li>
</ul> <p>For users relying on the deep merge behavior from mixins, we recommend refactoring your code to avoid such reliance altogether, since deep merges from mixins are very implicit and can make the code logic more difficult to understand and debug.</p> <p><a href="migration-build#compat-configuration">Migration build flags:</a></p> <ul>
<li><code>OPTIONS_DATA_FN</code></li> <li><code>OPTIONS_DATA_MERGE</code></li>
</ul>
</div>   <div class="_attribution">
  <p class="_attribution-p">
    <a href="https://v3.vuejs.org/guide/migration/data-option.html" class="_attribution-link" target="_blank">https://v3.vuejs.org/guide/migration/data-option.html</a>
  </p>
</div>
