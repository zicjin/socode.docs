 <div class="theme-default-content content__default">
<h1 id="render-function-api"> Render Function API <div class="migration-badge-wrapper" data-v-cb310528><span class="migration-badge is-breaking" data-v-cb310528> breaking </span></div>
</h1> <h2 id="overview"> Overview</h2> <p>This change will not affect <code>&lt;template&gt;</code> users.</p> <p>Here is a quick summary of what has changed:</p> <ul>
<li>
<code>h</code> is now globally imported instead of passed to render functions as an argument</li> <li>render function arguments changed to be more consistent between stateful and functional components</li> <li>VNodes now have a flat props structure</li>
</ul> <p>For more information, read on!</p> <h2 id="render-function-argument"> Render Function Argument</h2> <h3 id="_2-x-syntax"> 2.x Syntax</h3> <p>In 2.x, the <code>render</code> function would automatically receive the <code>h</code> function (which is a conventional alias for <code>createElement</code>) as an argument:</p> <div class="language-js line-numbers-mode">
<pre class="language-js" data-language="javascript">// Vue 2 Render Function Example
export default {
  render(h) {
    return h('div')
  }
}</pre> </div>
<h3 id="_3-x-syntax"> 3.x Syntax</h3> <p>In 3.x, <code>h</code> is now globally imported instead of being automatically passed as an argument.</p> <div class="language-js line-numbers-mode">
<pre class="language-js" data-language="javascript">// Vue 3 Render Function Example
import { h } from 'vue'

export default {
  render() {
    return h('div')
  }
}</pre> </div>
<h2 id="render-function-signature-change"> Render Function Signature Change</h2> <h3 id="_2-x-syntax-2"> 2.x Syntax</h3> <p>In 2.x, the <code>render</code> function automatically received arguments such as <code>h</code>.</p> <div class="language-js line-numbers-mode">
<pre class="language-js" data-language="javascript">// Vue 2 Render Function Example
export default {
  render(h) {
    return h('div')
  }
}</pre> </div>
<h3 id="_3-x-syntax-2"> 3.x Syntax</h3> <p>In 3.x, since the <code>render</code> function no longer receives any arguments, it will primarily be used inside of the <code>setup()</code> function. This has the added benefit of gaining access to reactive state and functions declared in scope, as well as the arguments passed to <code>setup()</code>.</p> <div class="language-js line-numbers-mode">
<pre class="language-js" data-language="javascript">import { h, reactive } from 'vue'

export default {
  setup(props, { slots, attrs, emit }) {
    const state = reactive({
      count: 0
    })

    function increment() {
      state.count++
    }

    // return the render function
    return () =&gt;
      h(
        'div',
        {
          onClick: increment
        },
        state.count
      )
  }
}</pre> </div>
<p>For more information on how <code>setup()</code> works, see our <a href="../composition-api-introduction">Composition API Guide</a>.</p> <h2 id="vnode-props-format"> VNode Props Format</h2> <h3 id="_2-x-syntax-3"> 2.x Syntax</h3> <p>In 2.x, <code>domProps</code> contained a nested list within the VNode props:</p> <div class="language-js line-numbers-mode">
<pre class="language-js" data-language="javascript">// 2.x
{
  staticClass: 'button',
  class: {'is-outlined': isOutlined },
  staticStyle: { color: '#34495E' },
  style: { backgroundColor: buttonColor },
  attrs: { id: 'submit' },
  domProps: { innerHTML: '' },
  on: { click: submitForm },
  key: 'submit-button'
}</pre> </div>
<h3 id="_3-x-syntax-3"> 3.x Syntax</h3> <p>In 3.x, the entire VNode props structure is flattened. Using the example from above, here is what it would look like now.</p> <div class="language-js line-numbers-mode">
<pre class="language-js" data-language="javascript">// 3.x Syntax
{
  class: ['button', { 'is-outlined': isOutlined }],
  style: [{ color: '#34495E' }, { backgroundColor: buttonColor }],
  id: 'submit',
  innerHTML: '',
  onClick: submitForm,
  key: 'submit-button'
}</pre> </div>
<h2 id="registered-component"> Registered Component</h2> <h3 id="_2-x-syntax-4"> 2.x Syntax</h3> <p>In 2.x, when a component has been registered, the render function would work well when passing the component's name as a string to the first argument:</p> <div class="language-js line-numbers-mode">
<pre class="language-js" data-language="javascript">// 2.x
Vue.component('button-counter', {
  data() {
    return {
      count: 0
    }
  }
  template: `
    &lt;button @click="count++"&gt;
      Clicked {{ count }} times.
    &lt;/button&gt;
  `
})

export default {
  render(h) {
    return h('button-counter')
  }
}</pre> </div>
<h3 id="_3-x-syntax-4"> 3.x Syntax</h3> <p>In 3.x, with VNodes being context-free, we can no longer use a string ID to implicitly lookup registered components. Instead, we need to use an imported <code>resolveComponent</code> method:</p> <div class="language-js line-numbers-mode">
<pre class="language-js" data-language="javascript">// 3.x
import { h, resolveComponent } from 'vue'

export default {
  setup() {
    const ButtonCounter = resolveComponent('button-counter')
    return () =&gt; h(ButtonCounter)
  }
}</pre> </div>
<p>For more information, see <a href="https://github.com/vuejs/rfcs/blob/master/active-rfcs/0008-render-function-api-change.md#context-free-vnodes" target="_blank" rel="noopener noreferrer">The Render Function Api Change RFC<span> <span class="sr-only">(opens new window)</span></span></a>.</p> <h2 id="migration-strategy"> Migration Strategy</h2> <p><a href="migration-build#compat-configuration">Migration build flag: <code>RENDER_FUNCTION</code></a></p> <h3 id="library-authors"> Library Authors</h3> <p><code>h</code> being globally imported means that any library that contains Vue components will include <code>import { h } from 'vue'</code> somewhere. As a result, this creates a bit of overhead since it requires library authors to properly configure the externalization of Vue in their build setup:</p> <ul>
<li>Vue should not be bundled into the library</li> <li>For module builds, the import should be left alone and be handled by the end user bundler</li> <li>For UMD / browser builds, it should try the global Vue.h first and fallback to require calls</li>
</ul> <h2 id="next-steps"> Next Steps</h2> <p>See <a href="../render-function">Render Function Guide</a> for more detailed documentation!</p>
</div>   <div class="_attribution">
  <p class="_attribution-p">
    <a href="https://v3.vuejs.org/guide/migration/render-function-api.html" class="_attribution-link" target="_blank">https://v3.vuejs.org/guide/migration/render-function-api.html</a>
  </p>
</div>
