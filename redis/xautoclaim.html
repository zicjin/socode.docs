<h1 class="command">XAUTOCLAIM</h1>
<pre>XAUTOCLAIM key group consumer min-idle-time start [COUNT count] [JUSTID]</pre>   <div class="metadata"> <p><strong>Available since 6.2.0.</strong></p> <p><strong>Time complexity:</strong> O(1) if COUNT is small.</p> </div> <p>This command transfers ownership of pending stream entries that match the specified criteria. Conceptually, <a href="xautoclaim">XAUTOCLAIM</a> is equivalent to calling <a href="xpending">XPENDING</a> and then <a href="xclaim">XCLAIM</a>, but provides a more straightforward way to deal with message delivery failures via <a href="scan">SCAN</a>-like semantics.</p> <p>Like <a href="xclaim">XCLAIM</a>, the command operates on the stream entries at <code>&lt;key&gt;</code> and in the context of the provided <code>&lt;group&gt;</code>. It transfers ownership to <code>&lt;consumer&gt;</code> of messages pending for more than <code>&lt;min-idle-time&gt;</code> milliseconds and having an equal or greater ID than <code>&lt;start&gt;</code>.</p> <p>The optional <code>&lt;count&gt;</code> argument, which defaults to 100, is the upper limit of the number of entries that the command attempts to claim. Internally, the command begins scanning the consumer group's Pending Entries List (PEL) from <code>&lt;start&gt;</code> and filters out entries having an idle time less than or equal to <code>&lt;min-idle-time&gt;</code>. The maximum number of pending entries that the command scans is the product of multiplying <code>&lt;count&gt;</code>'s value by 10 (hard-coded). It is possible, therefore, that the number of entries claimed will be less than the specified value.</p> <p>The optional <code>JUSTID</code> argument changes the reply to return just an array of IDs of messages successfully claimed, without returning the actual message. Using this option means the retry counter is not incremented.</p> <p>The command returns the claimed entries as an array. It also returns a stream ID intended for cursor-like use as the <code>&lt;start&gt;</code> argument for its subsequent call. When there are no remaining PEL entries, the command returns the special <code>0-0</code> ID to signal completion. However, note that you may want to continue calling <a href="xautoclaim">XAUTOCLAIM</a> even after the scan is complete with the <code>0-0</code> as <code>&lt;start&gt;</code> ID, because enough time passed, so older pending entries may now be eligible for claiming.</p> <p>Note that only messages that are idle longer than <code>&lt;min-idle-time&gt;</code> are claimed, and claiming a message resets its idle time. This ensures that only a single consumer can successfully claim a given pending message at a specific instant of time and trivially reduces the probability of processing the same message multiple times.</p> <p>Lastly, claiming a message with <a href="xautoclaim">XAUTOCLAIM</a> also increments the attempted deliveries count for that message, unless the <code>JUSTID</code> option has been specified (which only delivers the message ID, not the message itself). Messages that cannot be processed for some reason - for example, because consumers systematically crash when processing them - will exhibit high attempted delivery counts that can be detected by monitoring.</p> <h2>Return value</h2> <p><a href="https://redis.io/topics/protocol#array-reply">Array reply</a>, specifically:</p> <p>An array with two elements:</p> <ol> <li>The first element is a stream ID to be used as the <code>&lt;start&gt;</code> argument for the next call to <a href="xautoclaim">XAUTOCLAIM</a>
</li> <li>The second element is an array containing all the successfully claimed messages in the same format as <a href="xrange">XRANGE</a>.</li> </ol> <h2>Examples</h2> <pre>&gt; XAUTOCLAIM mystream mygroup Alice 3600000 0-0 COUNT 25
1) "0-0"
2) 1) 1) "1609338752495-0"
      2) 1) "field"
         2) "value"
</pre> <p>In the above example, we attempt to claim up to 25 entries that are pending and idle (not having been acknowledged or claimed) for at least an hour, starting at the stream's beginning. The consumer "Alice" from the "mygroup" group acquires ownership of these messages. Note that the stream ID returned in the example is <code>0-0</code>, indicating that the entire stream was scanned.</p>  <div class="_attribution">
  <p class="_attribution-p">
    <a href="https://redis.io/commands/xautoclaim" class="_attribution-link" target="_blank">https://redis.io/commands/xautoclaim</a>
  </p>
</div>
